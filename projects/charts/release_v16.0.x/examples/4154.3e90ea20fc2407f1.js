"use strict";(self.webpackChunkexamples=self.webpackChunkexamples||[]).push([[4154],{44154:(Y,f,m)=>{m.r(f),m.d(f,{default:()=>X});var A=m(97474),a=m(29091),c=m(36735),E=m(90618),D=m(65164),e=m(99019),B=m(28508),d=m.n(B),g=m(54739),_=m(93078),S=m(60598),F=m(29261),T=m(8410),y=m(43846);function M(r,l){if(1&r){const t=e.RV6();e.j41(0,"nui-legend-series",11),e.bIt("mouseenter",function(){const o=e.eBV(t).$implicit,n=e.XpG();return e.Njj(n.chartAssist.emphasizeSeries(o.id))})("isSelectedChange",function(i){const n=e.eBV(t).$implicit,u=e.XpG();return e.Njj(u.chartAssist.toggleSeries(n.id,i))}),e.j41(1,"nui-rich-legend-tile",12),e.nrm(2,"nui-chart-marker",13),e.k0s()()}if(2&r){const t=l.$implicit,s=e.XpG();e.Y8G("descriptionPrimary",t.name)("seriesRenderState",null==s.chartAssist.renderStatesIndex[t.id]?null:s.chartAssist.renderStatesIndex[t.id].state)("isSelected",!s.chartAssist.isSeriesHidden(t.id)),e.R7$(1),e.Y8G("value",s.chartAssist.getHighlightedValue(t,"y"))("backgroundColor",s.chartAssist.palette.standardColors.get(t.id))("color",s.chartAssist.palette.textColors.get(t.id)),e.R7$(1),e.Y8G("marker",s.chartAssist.markers.get(t.id))("color",s.chartAssist.palette.standardColors.get(t.id))}}let C=(()=>{class r{history;dataSourceService;series={"Tex-lab-aus-2621":[18,27,35,33,26,50,36,47,58,66,65,50,40,31,42,62,57,99,75,55,73,69,77,57,61,68,82,81,78,67],"Cz-lab-brn-02":[41,50,56,40,44,35,27,42,38,23,20,13,29,42,84,93,71,60,54,79,64,49,48,59,76,63,52,84,89,80]};fromDate=d()("2018-05-01 15:00:00").subtract(5.2,"days");toDate=d()("2019-01-01 15:00:00");chart=new c.t1X(new c.SFt);chartAssist=new c.Wiz(this.chart);timeFrame;xScale=new c.UAQ("time-scale");yScale=new c.kck;seriesSet=[];filteringSubscription;constructor(t,s){this.history=t,this.dataSourceService=s}ngOnInit(){const t=new c.fpW(this.chartAssist.palette.standardColors,this.chartAssist.markers),s=new c.Epf;this.yScale.domainCalculator=(0,c.zk6)([0,100]),this.seriesSet=Object.keys(this.series).map(i=>({id:i,name:i,data:I(this.fromDate,this.toDate,this.series[i]),accessors:t,renderer:s,scales:{x:this.xScale,y:this.yScale}})),this.timeFrame=this.history.save({startDatetime:this.fromDate,endDatetime:this.toDate,selectedPresetId:void 0}),this.chart.addPlugins(new c.jnT),this.chart.getEventBus().getStream(c.Nfs).subscribe(i=>{const n=i.data[this.xScale.id];this.timeFrame=this.history.save({startDatetime:d()(n[0]),endDatetime:d()(n[1]),selectedPresetId:void 0}),this.dataSourceService.applyFilters()}),this.filteringSubscription=this.setUpFiltering(),this.dataSourceService.applyFilters()}ngOnDestroy(){this.filteringSubscription&&this.filteringSubscription.unsubscribe()}updateTimeFrame(t){this.timeFrame=this.history.restart(t),this.dataSourceService.applyFilters()}zoomUndo(){this.timeFrame=this.history.undo(),this.dataSourceService.applyFilters()}zoomReset(t){this.timeFrame=this.history.restart(t),this.dataSourceService.applyFilters()}setUpFiltering(){return this.dataSourceService.registerComponent({timeframe:{componentInstance:{getFilters:()=>({type:"ITimeframe",value:this.timeFrame})}}}),this.dataSourceService.outputsSubject.subscribe(t=>{this.xScale.fixDomain([t.timeframe.value.startDatetime.toDate(),t.timeframe.value.endDatetime.toDate()]),this.chartAssist.update(this.seriesSet)})}static \u0275fac=function(s){return new(s||r)(e.rXU(a.wbf),e.rXU(a.ZHp))};static \u0275cmp=e.VBU({type:r,selectors:[["nui-time-frame-bar-example"]],features:[e.Jv_([a.ZHp,a.wbf])],decls:15,vars:12,consts:function(){let t;return t=$localize`:␟a8a8afdb3773c92f866263dd8ceabcc3d92682fb␟8471193138456330657:Average CPU load (%)`,[[3,"timeFrame","historyIndex","minDate","maxDate","timeFrameChange","undo","clear"],["icon","calendar",1,"pr-3"],["timeFrameSelection",""],[1,"nui-chart-layout","p-3"],[1,"axis-label-left","nui-text-small"],t,[1,"chart"],[1,"d-flex","w-100","h-100",3,"chart"],[1,"legend"],["seriesUnitLabel","%",3,"active","interactive","mouseleave"],[3,"descriptionPrimary","seriesRenderState","isSelected","mouseenter","isSelectedChange",4,"ngFor","ngForOf","ngForTrackBy"],[3,"descriptionPrimary","seriesRenderState","isSelected","mouseenter","isSelectedChange"],[3,"value","backgroundColor","color"],["rightEdge","",3,"marker","color"]]},template:function(s,i){1&s&&(e.j41(0,"nui-time-frame-bar",0),e.bIt("timeFrameChange",function(n){return i.updateTimeFrame(n)})("undo",function(){return i.zoomUndo()})("clear",function(){return i.zoomReset()}),e.nrm(1,"nui-icon",1),e.EFF(2),e.nI1(3,"timeFrame"),e.j41(4,"nui-quick-picker",2),e.nrm(5,"nui-time-frame-picker"),e.k0s()(),e.j41(6,"div",3)(7,"div",4)(8,"strong"),e.pXf(9,5),e.k0s()(),e.j41(10,"div",6),e.nrm(11,"nui-chart",7),e.k0s(),e.j41(12,"div",8)(13,"nui-legend",9),e.bIt("mouseleave",function(){return i.chartAssist.resetVisibleSeries()}),e.DNE(14,M,3,8,"nui-legend-series",10),e.k0s()()()),2&s&&(e.Y8G("timeFrame",i.timeFrame)("historyIndex",i.history.index)("minDate",i.fromDate)("maxDate",i.toDate),e.R7$(2),e.SpI(" ",e.bMT(3,10,i.timeFrame)," "),e.R7$(9),e.Y8G("chart",i.chart),e.R7$(2),e.Y8G("active",i.chartAssist.isLegendActive)("interactive",!0),e.R7$(1),e.Y8G("ngForOf",i.chartAssist.legendSeriesSet)("ngForTrackBy",i.chartAssist.seriesTrackByFn))},dependencies:[g.Sq,_.f,S.q,F.L,T.Q,y.C,a.RlV,a.xCO,a.M_D,a.$dl,a.ccK],encapsulation:2})}return r})();function I(r,l,t){const s=t.length;if(!r||!l||0===s)return[];const i=s>1?l.diff(r)/(s-1):0;return t.map((o,n)=>({x:r.clone().add(d().duration(n*i)),y:o}))}let x=(()=>{class r{static \u0275fac=function(s){return new(s||r)};static \u0275cmp=e.VBU({type:r,selectors:[["nui-chart-docs-time-frame-bar"]],decls:6,vars:0,consts:[["filenamePrefix","time-frame-bar-basic","exampleTitle","Time Frame Bar"]],template:function(s,i){1&s&&(e.j41(0,"h1"),e.EFF(1,"Time Frame Bar"),e.k0s(),e.j41(2,"p"),e.EFF(3," This example shows the current way of implementing a chart with zooming capability and a time frame bar. We don't provide components that would encapsulate this logic, so it needs to be implemented from scratch like this. It takes advantage of the filtering session implementation to connect the filtering components on the page.\n"),e.k0s(),e.j41(4,"nui-example-wrapper",0),e.nrm(5,"nui-time-frame-bar-example"),e.k0s())},dependencies:[a.tZW,C],encapsulation:2})}return r})();var k=m(23007),P=m(73e3),h=function(r){return r[r.Poll=5]="Poll",r[r.Hour=60]="Hour",r}(h||{});class j{factors={day:[42,7,63,33,10,16,57,16,88,44,35,85,46,73,29,35,51,52,100,51,40,87,42,90,75,90,70,16,4,43,18,63,28,15,86,81,48,86,91,89,15,89,66,35,65,18,59,75,69,64,55,67,60,76,29,81,87,73,10,19,29,83,16,72,80,43,28,53,38,24,88,81,14,68,80,44,72,56,89,83,6,1,1,11,66,39,42,81,31,48,11,76,41,60,40,15,75,33,90,80,37,40,39,58,69,31,61,80,85,57,38,3,45,36,71,66,36,58,82,70,90,78,33,72,98,36,32,61,44,13,22,90,66,87,55,21,63,70,41,61,19,42,65,79,17,14,85,69,79,77,99,86,5,31,94,2,37,54,79,32,63,83,64,52,59,35,18,45,58,23,58,99,61,60,78,95,63,35,27,93,46,86,51,80,73,6,66,72,96,7,90,94,3,66,1,38,30,11,58,91,84,100,90,70,51,77,56,53,49,42,84,10,76,11,66,41,38,68,24,84,89,72,74,54,29,18,36,13,17,18,82,14,50,10,47,12,1,4,63,59,62,78,83,5,25,8,59,59,28,56,35,33,31,37,5,67,34,93,25,66,69,64,23,69,60,24,26,81,88,66,80,45,91,68,83,8,83,43,96,85,8,47,67,14,64,26,96,45],year:[64,70,41,96,74,38,38,79,77,24,98,78,22,90,7,42,95,76,92,86,13,5,80,6,9,90,40,94,66,12,28,7,76,74,23,79,82,9,9,84,59,92,63,15,25,18,83,35,46,14,22,84,34,17,9,25,34,89,48,80,76,38,60,43,41,88,35,32,62,80,76,64,41,49,23,61,27,56,3,88,37,24,15,88,85,18,41,74,81,13,40,10,39,30,45,21,32,46,54,8,28,19,74,87,36,43,74,15,58,24,98,14,49,96,51,83,4,4,13,72,42,62,26,80,85,46,74,60,14,5,97,16,90,84,52,10,18,26,8,49,71,34,87,32,15,46,23,10,86,7,18,51,31,72,20,43,10,91,74,51,86,89,32,79,94,5,41,16,79,66,84,24,74,78,69,85,46,57,92,92,3,14,5,12,63,1,6,37,85,79,18,88,42,8,25,94,87,7,52,16,35,43,65,63,46,38,98,55,100,14,45,50,49,90,98,47,20,83,84,84,58,79,100,19,75,94,34,5,94,29,96,80,46,33,73,82,58,68,98,100,10,46,96,87,96,5,64,53,5,7,19,65,91,78,59,14,19,12,15,92,8,15,19,99,26,25,45,29,39,1,61,74,88,27,43,1,93,75,91,97,38,39,24,94,29,18,88,56,62,7,88,13,34,21,20,41,90,95,2,17,26,4,44,70,18,65,75,62,18,46,18,73,76,95,2,30,31,77,77,80,23,51,48,42,78,65,78,56,37,46,96,72,49,48,8,45,89,42,87,28,42,53,94,73,57,30,75,53,77,62,9,71,9,48,97,92,91,24,44,83,8,86,41,6,21,45],century:[85,83,87,82,77,65,67,72,75,76,82,87,91,93,94,90,84,89,86,88,86,85,82,84,81,77,77,77,80,97,18,6,25,85,90,25,72,99,61,79,62,7,50,41,40,6,60,65,1,98,90,31,57,74,50,57,68,20,12,16,33,1,32,53,76,57,89,33,48,28,89,35,15,3,33,77,10,1,36,4,36,88,26,66,50,3,66,37,77,70,9,40,20,14,55,96,88,14,9,54]};seriesValueFunctions={"Tex-lab-aus-2621":([l,t,s])=>l+.1*(t-30)+(s-50),"Cz-lab-brn-02":([l,t,s])=>l+.01*t*(t-50)+20*Math.cos(.02*s*Math.PI)};getChartData(l,t,s=0){const i=this.seriesValueFunctions,o={},u=d().duration(t.diff(l)).asHours()>12?h.Hour:h.Poll;for(const p of Object.keys(i))o[p]=this.getData(l,t,i[p],u);return(0,k.of)(o).pipe((0,P.c)(s))}getData(l,t,s,i=h.Poll){const o=l.minutes()%i,n=l.clone().subtract(o,"minutes").seconds(0),u=i-t.minutes()%i,p=t.clone().add(u,"minutes").seconds(0),U=Math.ceil(d().duration(p.diff(n)).asMinutes()/i),v=[];for(let b=0;b<U;b++){const w=this.factors.day[Math.ceil((60*n.hours()+n.minutes())/5)],z=this.factors.year[n.dayOfYear()],V=this.factors.century[n.year()%100];v.push({x:n.clone(),y:s([V,z,w])}),n.add(i,"minutes")}return v}}var $=m(60719);function O(r,l){if(1&r){const t=e.RV6();e.j41(0,"nui-legend-series",16),e.bIt("mouseenter",function(){const o=e.eBV(t).$implicit,n=e.XpG();return e.Njj(n.chartAssist.emphasizeSeries(o.id))})("isSelectedChange",function(i){const n=e.eBV(t).$implicit,u=e.XpG();return e.Njj(u.chartAssist.toggleSeries(n.id,i))}),e.j41(1,"nui-rich-legend-tile",17),e.nrm(2,"nui-chart-marker",18),e.k0s()()}if(2&r){const t=l.$implicit,s=e.XpG();e.Y8G("descriptionPrimary",t.name)("seriesRenderState",null==s.chartAssist.renderStatesIndex[t.id]?null:s.chartAssist.renderStatesIndex[t.id].state)("isSelected",!s.chartAssist.isSeriesHidden(t.id)),e.R7$(1),e.Y8G("value",s.chartAssist.getHighlightedValue(t,"y"))("backgroundColor",s.chartAssist.palette.standardColors.get(t.id))("color",s.chartAssist.palette.textColors.get(t.id)),e.R7$(1),e.Y8G("marker",s.chartAssist.markers.get(t.id))("color",s.chartAssist.palette.standardColors.get(t.id))}}const N=[{path:"",component:x,data:{srlc:{stage:a.lcf.beta},showThemeSwitcher:!0}},{path:"example",component:C,data:{srlc:{hideIndicator:!0}}},{path:"test",component:(()=>{class r{history;dataSourceService;fromDate=d()("2018-05-01 15:00:00").subtract(2,"days");toDate=d()("2018-05-01 15:00:00");chart=new c.t1X(new c.SFt);chartAssist=new c.Wiz(this.chart);timeFrame;busy;addDelay=!0;xScale=new c.UAQ("time-scale");yScale=new c.kck;accessors=new c.fpW(this.chartAssist.palette.standardColors,this.chartAssist.markers);renderer=new c.Epf;filteringSubscription;dataService=new j;constructor(t,s){this.history=t,this.dataSourceService=s}ngAfterContentInit(){this.yScale.domainCalculator=(0,c.zk6)([0,100]),this.chart.addPlugins(new c.jnT),this.filteringSubscription=this.setUpFiltering(),this.chart.getEventBus().getStream(c.Nfs).subscribe(t=>{const i=t.data[this.xScale.id];this.applyFilters(this.history.save({startDatetime:d()(i[0]),endDatetime:d()(i[1]),selectedPresetId:void 0}))}),this.applyFilters(this.history.save({startDatetime:this.fromDate,endDatetime:this.toDate,selectedPresetId:void 0}))}ngOnDestroy(){this.filteringSubscription&&this.filteringSubscription.unsubscribe()}updateTimeFrame(t){this.applyFilters(this.history.restart(t))}zoomUndo(){this.applyFilters(this.history.undo())}applyFilters(t){this.busy=!0,this.timeFrame=t,this.xScale.fixDomain([t.startDatetime.toDate(),t.endDatetime.toDate()]),this.chart.updateDimensions(),this.dataSourceService.applyFilters()}setUpFiltering(){return this.dataSourceService.registerComponent({timeframe:{componentInstance:{getFilters:()=>({type:"ITimeframe",value:this.timeFrame})}}}),this.dataSourceService.outputsSubject.subscribe(t=>{this.dataService.getChartData(t.timeframe.value.startDatetime,t.timeframe.value.endDatetime,this.addDelay?1e3:0).subscribe(o=>{this.chartAssist.update(Object.keys(o).map(n=>({id:n,name:n,data:o[n],accessors:this.accessors,renderer:this.renderer,scales:{x:this.xScale,y:this.yScale}}))),this.busy=!1})})}static \u0275fac=function(s){return new(s||r)(e.rXU(a.wbf),e.rXU(a.ZHp))};static \u0275cmp=e.VBU({type:r,selectors:[["nui-time-frame-bar-test"]],features:[e.Jv_([a.ZHp,a.wbf])],decls:22,vars:14,consts:function(){let t;return t=$localize`:␟a8a8afdb3773c92f866263dd8ceabcc3d92682fb␟8471193138456330657:Average CPU load (%)`,[[1,"nui-time-frame-bar-test"],["nui-busy","",1,"m-5",2,"border","1px solid lightgrey",3,"busy"],[1,"time-frame-bar",2,"display","block","border-bottom","1px solid lightgrey",3,"timeFrame","historyIndex","minDate","maxDate","timeFrameChange","undo","clear"],["icon","calendar",1,"pr-3"],["timeFrameSelection",""],[1,"nui-chart-layout","p-3"],[1,"axis-label-left","nui-text-small"],t,[1,"chart"],[1,"w-100",3,"chart"],[1,"legend"],["seriesUnitLabel","%",3,"active","interactive","mouseleave"],[3,"descriptionPrimary","seriesRenderState","isSelected","mouseenter","isSelectedChange",4,"ngFor","ngForOf","ngForTrackBy"],[1,"p-5"],["id","delay","name","delay","type","checkbox",3,"checked","change"],["for","delay",1,"pl-2"],[3,"descriptionPrimary","seriesRenderState","isSelected","mouseenter","isSelectedChange"],[3,"value","backgroundColor","color"],["rightEdge","",3,"marker","color"]]},template:function(s,i){1&s&&(e.j41(0,"charts-test-harness")(1,"div",0)(2,"div",1)(3,"nui-time-frame-bar",2),e.bIt("timeFrameChange",function(n){return i.updateTimeFrame(n)})("undo",function(){return i.zoomUndo()})("clear",function(){return i.updateTimeFrame()}),e.nrm(4,"nui-icon",3),e.EFF(5),e.nI1(6,"timeFrame"),e.j41(7,"nui-quick-picker",4),e.nrm(8,"nui-time-frame-picker"),e.k0s()(),e.j41(9,"div",5)(10,"div",6)(11,"strong"),e.pXf(12,7),e.k0s()(),e.j41(13,"div",8),e.nrm(14,"nui-chart",9),e.k0s(),e.j41(15,"div",10)(16,"nui-legend",11),e.bIt("mouseleave",function(){return i.chartAssist.resetVisibleSeries()}),e.DNE(17,O,3,8,"nui-legend-series",12),e.k0s()()()(),e.j41(18,"div",13)(19,"input",14),e.bIt("change",function(){return i.addDelay=!i.addDelay}),e.k0s(),e.j41(20,"label",15),e.EFF(21,"Add delay to server requests"),e.k0s()()()()),2&s&&(e.R7$(2),e.Y8G("busy",i.busy),e.R7$(1),e.Y8G("timeFrame",i.timeFrame)("historyIndex",i.history.index)("minDate",i.fromDate)("maxDate",i.toDate),e.R7$(2),e.SpI(" ",e.bMT(6,12,i.timeFrame)," "),e.R7$(9),e.Y8G("chart",i.chart),e.R7$(2),e.Y8G("active",i.chartAssist.isLegendActive)("interactive",!0),e.R7$(1),e.Y8G("ngForOf",i.chartAssist.legendSeriesSet)("ngForTrackBy",i.chartAssist.seriesTrackByFn),e.R7$(2),e.Y8G("checked",i.addDelay))},dependencies:[$.f,g.Sq,a.jwP,_.f,S.q,F.L,T.Q,y.C,a.RlV,a.xCO,a.M_D,a.$dl,a.ccK],encapsulation:2})}return r})(),data:{srlc:{hideIndicator:!0}}}];let X=(()=>{class r{static \u0275fac=function(s){return new(s||r)};static \u0275mod=e.$C({type:r});static \u0275inj=e.G2t({providers:[{provide:a.uzs,useValue:(0,E.R)("time-frame-bar")}],imports:[D.r,a.dfW,a.cec,c.StF,a.WrP,a.ZdM,a.a4p,a.s6u,a.BQ6,a.W0p,a.n$U,a.yyX,a.guG,A.iI.forChild(N)]})}return r})()}}]);