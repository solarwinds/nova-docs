import{A as J,Ea as ot,I as K,K as d,Na as u,Q as U,Sa as it,Ua as rt,Va as at,W as tt,d as q,e as $,fa as l,j as Z,ma as et,na as nt,qa as c}from"./chunk-JLRCU3YI.js";import{La as Y,U as L,V as W,W as F,ja as H,ka as Q,la as j,ma as X}from"./chunk-PJ4NWNDH.js";import{e as N,f as V}from"./chunk-JQPMAK7F.js";import{Aa as _,Gb as G,Ma as m,Na as z,Ta as f,Ua as y,Va as h,Za as k,gb as D,hb as E,ja as a,kb as B,mb as v,nb as P,ob as x,pa as g,qb as A,ra as S,rb as R,s as M,t as T,va as I}from"./chunk-YSXLQTCP.js";var dt=["templatePortalGrid"],lt=["gridChartPlaceholder"];function ct(n,C){n&1&&h(0,"div",10,1)}function pt(n,C){if(n&1&&(f(0,"div",4),h(1,"nui-icon",5),f(2,"div",6)(3,"span"),A(4),y()(),f(5,"div",7),_(6,ct,2,0,"div",8),h(7,"nui-chart",9),y()()),n&2){let t=C.$implicit,e=C.first;a(),B("icon",t.icon),a(),z("width",200,"px"),a(2),R(t.url),a(2),m("ngIf",e),a(),m("chart",t.chart)}}function gt(n,C){if(n&1&&h(0,"nui-chart",9),n&2){let t=E();m("chart",t.gridChart)}}var Pt=(()=>{class n{overlay;overlayPositionBuilder;_viewContainerRef;scrollStrategyOptions;palette=new K(new ot({connect:d[0],dns:d[1],send:d[2],ttfb:d[3],cdownload:d[4]}));gridChart=new l(new c);positionStrategy;templatePortal;listItems=[{url:"http://www.google.com",size:924,icon:"xml-file",chart:new l(new c(new u({showBottomAxis:!1}))),data:[{type:"connect",start:0,end:22},{type:"dns",start:22,end:39},{type:"send",start:39,end:59},{type:"ttfb",start:59,end:109},{type:"cdownload",start:109,end:178}]},{url:"http://www2.google.com",size:924,icon:"xml-file",chart:new l(new c(new u({showBottomAxis:!1}))),data:[{type:"connect",start:0,end:22},{type:"dns",start:22,end:39},{type:"send",start:39,end:59},{type:"ttfb",start:59,end:109},{type:"cdownload",start:109,end:788}]},{url:"http://www.google.com/cat.png",size:3333,icon:"image",chart:new l(new c(new u({showBottomAxis:!1}))),data:[{type:"connect",start:178,end:222},{type:"dns",start:222,end:239},{type:"send",start:239,end:259},{type:"ttfb",start:259,end:309},{type:"cdownload",start:309,end:578}]},{url:"http://www.google.com/revenge.png",size:3333,icon:"image",chart:new l(new c(new u({showBottomAxis:!1}))),data:[{type:"connect",start:578,end:590},{type:"dns",start:590,end:799},{type:"send",start:799,end:888},{type:"ttfb",start:888,end:900},{type:"cdownload",start:900,end:990}]}];scales;templatePortalGrid;gridChartPlaceholder;constructor(t,e,o,i){this.overlay=t,this.overlayPositionBuilder=e,this._viewContainerRef=o,this.scrollStrategyOptions=i}ngOnInit(){this.gridChart.addPlugin(new it),this.gridChart.getEventBus().getStream(Z).subscribe(t=>{let e=t.data;this.listItems.forEach(o=>{this.scales.x.fixDomain(e[this.scales.x.id]),o.chart.updateDimensions()})})}ngAfterViewInit(){this.templatePortal=new H(this.templatePortalGrid,this._viewContainerRef);let t=[{overlayX:"start",overlayY:"top",originX:"start",originY:"top"}];this.positionStrategy=this.overlayPositionBuilder.flexibleConnectedTo(this.gridChartPlaceholder).withPositions(t).withFlexibleDimensions(!0).withPush(!0);let e=this.overlay.create({positionStrategy:this.positionStrategy,scrollStrategy:this.scrollStrategyOptions.close()}),o=new nt,i=new et;i.fixDomain([0,1e3]),o.fixDomain(["cat1"]),this.scales={y:o,x:i},this.scales.x.formatters.tick=r=>`${Number(r/1e3).toFixed(1)}s`;let O=new tt,w=new U;w.data.color=r=>this.palette.standardColors.get(r.type);let b=0;this.listItems.forEach(r=>{let st=[{id:"series-1",name:"Series 1",data:r.data.map(p=>({value:p.end-p.start,category:"cat1",type:p.type,__bar:{start:p.start,end:p.end}})),accessors:w,scales:this.scales,renderer:O}];r.chart.update(st),r.chart.getEventBus().getStream(q).subscribe(console.log),r.chart.getEventBus().getStream($).subscribe(console.log),b=r.chart.getGrid().config().dimension.width()});let s=this.gridChart.getGrid().config();s.dimension.height(this.listItems.length*32),s.dimension.width(b),s.dimension.autoHeight=!1,s.axis.left.visible=!1,s.axis.left.gridTicks=!1,s.axis.bottom.gridTicks=!0,this.gridChart.update([{id:"i am grid",name:"i am grid",data:[],accessors:new rt,scales:this.scales,renderer:new at}]),this.gridChart.updateDimensions(),e.attach(this.templatePortal)}drop(t){L(this.listItems,t.previousIndex,t.currentIndex)}static \u0275fac=function(e){return new(e||n)(g(X),g(j),g(S),g(Q))};static \u0275cmp=I({type:n,selectors:[["nui-chart-waterfall-test"]],viewQuery:function(e,o){if(e&1&&(v(dt,5),v(lt,5)),e&2){let i;P(i=x())&&(o.templatePortalGrid=i.first),P(i=x())&&(o.gridChartPlaceholder=i.first)}},standalone:!1,decls:5,vars:1,consts:[["templatePortalGrid",""],["gridChartPlaceholder",""],["cdkDropList","",1,"example-list",3,"cdkDropListDropped"],["class","d-flex flex-row align-items-center waterfall-chart-list-item","cdkDrag","",4,"ngFor","ngForOf"],["cdkDrag","",1,"d-flex","flex-row","align-items-center","waterfall-chart-list-item"],[1,"p-2",3,"icon"],[1,"p-2",2,"overflow","hidden"],[1,"d-flex"],["class","d-flex h-100",4,"ngIf"],[1,"d-flex",3,"chart"],[1,"d-flex","h-100"]],template:function(e,o){if(e&1){let i=k();f(0,"div")(1,"div",2),D("cdkDropListDropped",function(w){return M(i),T(o.drop(w))}),_(2,pt,8,6,"div",3),y()(),_(3,gt,1,1,"ng-template",null,0,G)}e&2&&(a(2),m("ngForOf",o.listItems))},dependencies:[F,W,Y,N,V,J],styles:['.nui-dnd-hover-state[_ngcontent-%COMP%]{background:#f2f2f2}.nui-dnd-raised-state[_ngcontent-%COMP%]{z-index:1;box-sizing:border-box;box-shadow:0 2px 10px 0 var(--nui-shadow-color, rgba(17, 17, 17, .3))}.nui-dnd-preview[_ngcontent-%COMP%]{border:1px #d9d9d9 solid;background:#f2f2f2;z-index:1;box-sizing:border-box;box-shadow:0 2px 10px 0 var(--nui-shadow-color, rgba(17, 17, 17, .3))}.nui-dnd-dropzone.nui-dnd-dropzone--active[_ngcontent-%COMP%]{border:4px dashed #999!important}.nui-dnd-dropzone.nui-dnd-dropzone--drop-allowed[_ngcontent-%COMP%]{cursor:move;border:4px solid #00c4d2!important;background-color:#00c4d233}.nui-dnd-dropzone.nui-dnd-dropzone--drop-not-allowed[_ngcontent-%COMP%]{cursor:move;border:4px solid #dd2c00!important;background-color:#dd2c0033}.nui-dnd-dropzone[_ngcontent-%COMP%]   .centered-overlay[_ngcontent-%COMP%], .nui-dnd-dropzone[_ngcontent-%COMP%]   .nui-icon-item[_ngcontent-%COMP%]:before{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);-o-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.nui-dnd-dropzone[_ngcontent-%COMP%]   .nui-icon-item[_ngcontent-%COMP%]:before{border-radius:50%;content:"";display:block;height:40px;width:40px;z-index:-1}.nui-dnd-dropzone[_ngcontent-%COMP%]   .drop-circle-permanent[_ngcontent-%COMP%]   .nui-icon-item[_ngcontent-%COMP%]:before{background-color:#fff}.nui-dnd-dropzone[_ngcontent-%COMP%]   .drop-circle-permanent[_ngcontent-%COMP%]   .nui-icon-item[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   polygon[_ngcontent-%COMP%]{fill:#111}.nui-dnd-dropzone[_ngcontent-%COMP%]   .drop-circle-allowed[_ngcontent-%COMP%]   .nui-icon-item[_ngcontent-%COMP%]:before{background-color:#00c4d2}.nui-dnd-dropzone[_ngcontent-%COMP%]   .drop-circle-allowed[_ngcontent-%COMP%]   .nui-icon-item[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   polygon[_ngcontent-%COMP%]{clip-path:circle(5px);fill:#fff}.nui-dnd-dropzone[_ngcontent-%COMP%]   .drop-circle-not-allowed[_ngcontent-%COMP%]   .nui-icon-item[_ngcontent-%COMP%]:before{background-color:#dd2c00}.nui-dnd-dropzone[_ngcontent-%COMP%]   .drop-circle-not-allowed[_ngcontent-%COMP%]   .nui-icon-item[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]{clip-path:circle(5px);fill:#fff}.waterfall-chart-list-item[_ngcontent-%COMP%]:hover{background-color:var(--nui-color-selected,rgba(0, 196, 210, .1))}.waterfall-chart-list-item[_ngcontent-%COMP%]{background-color:var(--nui-color-bg-content,#fff)}']})}return n})();export{Pt as a};
