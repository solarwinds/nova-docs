import{A as N,C as L,D as V,F as $,Ia as Q,Sa as W,Z as z,_ as U,fa as X,ga as j,j as k,la as H,ma as G,qa as q,z as w}from"./chunk-JLRCU3YI.js";import{Hb as I,Ib as R,Jb as P,Kb as O,La as x,Pa as h,Ub as S}from"./chunk-PJ4NWNDH.js";import{e as b}from"./chunk-JQPMAK7F.js";import{a as Z}from"./chunk-6NQICH4K.js";import{Aa as v,Cb as D,Db as M,Ma as s,Ta as o,Ua as c,Va as d,Za as E,cb as A,gb as u,hb as _,ja as m,pa as C,qb as T,s as g,sb as y,t as f,va as F,wb as B}from"./chunk-YSXLQTCP.js";import{g as Y}from"./chunk-B7O3QC5Z.js";var l=Y(Z());function J(r,p){if(r&1){let e=E();o(0,"nui-legend-series",11),u("mouseenter",function(){let t=g(e).$implicit,a=_();return f(a.chartAssist.emphasizeSeries(t.id))})("isSelectedChange",function(t){let a=g(e).$implicit,n=_();return f(n.chartAssist.toggleSeries(a.id,t))}),o(1,"nui-rich-legend-tile",12),d(2,"nui-chart-marker",13),c()()}if(r&2){let e=p.$implicit,i=_();s("descriptionPrimary",e.name)("seriesRenderState",i.chartAssist.renderStatesIndex[e.id]==null?null:i.chartAssist.renderStatesIndex[e.id].state)("isSelected",!i.chartAssist.isSeriesHidden(e.id)),m(),s("value",i.chartAssist.getHighlightedValue(e,"y"))("backgroundColor",i.chartAssist.palette.standardColors.get(e.id))("color",i.chartAssist.palette.textColors.get(e.id)),m(),s("marker",i.chartAssist.markers.get(e.id))("color",i.chartAssist.palette.standardColors.get(e.id))}}var de=(()=>{class r{history;dataSourceService;series=K();fromDate=(0,l.default)("2018-05-01 15:00:00").subtract(5.2,"days");toDate=(0,l.default)("2019-01-01 15:00:00");chart=new X(new q);chartAssist=new j(this.chart);timeFrame;xScale=new Q("time-scale");yScale=new G;seriesSet=[];filteringSubscription;constructor(e,i){this.history=e,this.dataSourceService=i}ngOnInit(){let e=new z(this.chartAssist.palette.standardColors,this.chartAssist.markers),i=new U;this.yScale.domainCalculator=H([0,100]),this.seriesSet=Object.keys(this.series).map(t=>({id:t,name:t,data:ee(this.fromDate,this.toDate,this.series[t]),accessors:e,renderer:i,scales:{x:this.xScale,y:this.yScale}})),this.timeFrame=this.history.save({startDatetime:this.fromDate,endDatetime:this.toDate,selectedPresetId:void 0}),this.chart.addPlugins(new W),this.chart.getEventBus().getStream(k).subscribe(t=>{let n=t.data[this.xScale.id];this.timeFrame=this.history.save({startDatetime:(0,l.default)(n[0]),endDatetime:(0,l.default)(n[1]),selectedPresetId:void 0}),this.dataSourceService.applyFilters()}),this.filteringSubscription=this.setUpFiltering(),this.dataSourceService.applyFilters()}ngOnDestroy(){this.filteringSubscription&&this.filteringSubscription.unsubscribe()}updateTimeFrame(e){this.timeFrame=this.history.restart(e),this.dataSourceService.applyFilters()}zoomUndo(){this.timeFrame=this.history.undo(),this.dataSourceService.applyFilters()}zoomReset(e){this.timeFrame=this.history.restart(e),this.dataSourceService.applyFilters()}setUpFiltering(){return this.dataSourceService.registerComponent({timeframe:{componentInstance:{getFilters:()=>({type:"ITimeframe",value:this.timeFrame})}}}),this.dataSourceService.outputsSubject.subscribe(e=>{this.xScale.fixDomain([e.timeframe.value.startDatetime.toDate(),e.timeframe.value.endDatetime.toDate()]),this.chartAssist.update(this.seriesSet)})}static \u0275fac=function(i){return new(i||r)(C(h),C(S))};static \u0275cmp=F({type:r,selectors:[["nui-time-frame-bar-example"]],standalone:!1,features:[B([S,h])],decls:15,vars:12,consts:()=>{let e;return e=$localize`:␟a8a8afdb3773c92f866263dd8ceabcc3d92682fb␟8471193138456330657:Average CPU load (%)`,[e,[3,"timeFrameChange","undo","clear","timeFrame","historyIndex","minDate","maxDate"],["icon","calendar",1,"pr-3"],["timeFrameSelection",""],[1,"nui-chart-layout","p-3"],[1,"axis-label-left","nui-text-small"],[1,"chart"],[1,"d-flex","w-100","h-100",3,"chart"],[1,"legend"],["seriesUnitLabel","%",3,"mouseleave","active","interactive"],[3,"descriptionPrimary","seriesRenderState","isSelected","mouseenter","isSelectedChange",4,"ngFor","ngForOf","ngForTrackBy"],[3,"mouseenter","isSelectedChange","descriptionPrimary","seriesRenderState","isSelected"],[3,"value","backgroundColor","color"],["rightEdge","",3,"marker","color"]]},template:function(i,t){i&1&&(o(0,"nui-time-frame-bar",1),u("timeFrameChange",function(n){return t.updateTimeFrame(n)})("undo",function(){return t.zoomUndo()})("clear",function(){return t.zoomReset()}),d(1,"nui-icon",2),T(2),D(3,"timeFrame"),o(4,"nui-quick-picker",3),d(5,"nui-time-frame-picker"),c()(),o(6,"div",4)(7,"div",5)(8,"strong"),A(9,0),c()(),o(10,"div",6),d(11,"nui-chart",7),c(),o(12,"div",8)(13,"nui-legend",9),u("mouseleave",function(){return t.chartAssist.resetVisibleSeries()}),v(14,J,3,8,"nui-legend-series",10),c()()()),i&2&&(s("timeFrame",t.timeFrame)("historyIndex",t.history.index)("minDate",t.fromDate)("maxDate",t.toDate),m(2),y(" ",M(3,10,t.timeFrame)," "),m(9),s("chart",t.chart),m(2),s("active",t.chartAssist.isLegendActive)("interactive",!0),m(),s("ngForOf",t.chartAssist.legendSeriesSet)("ngForTrackBy",t.chartAssist.seriesTrackByFn))},dependencies:[b,L,V,$,N,w,x,I,R,P,O],encapsulation:2})}return r})();function K(){return{"Tex-lab-aus-2621":[18,27,35,33,26,50,36,47,58,66,65,50,40,31,42,62,57,99,75,55,73,69,77,57,61,68,82,81,78,67],"Cz-lab-brn-02":[41,50,56,40,44,35,27,42,38,23,20,13,29,42,84,93,71,60,54,79,64,49,48,59,76,63,52,84,89,80]}}function ee(r,p,e){let i=e.length;if(!r||!p||i===0)return[];let t=i>1?p.diff(r)/(i-1):0;return e.map((a,n)=>({x:r.clone().add(l.default.duration(n*t)),y:a}))}export{de as a};
