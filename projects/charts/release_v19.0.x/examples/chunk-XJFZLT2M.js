import{a as se}from"./chunk-UTJFTRZ5.js";import{A as H,C as $,D as z,Ea as ae,F as X,I as F,K as j,M as Y,W as E,Wa as L,Xa as P,Ya as k,Z as J,_ as K,fa as U,ga as Z,ma as ee,na as te,oa as ie,qa as ne,ua as b,wa as B}from"./chunk-JLRCU3YI.js";import{La as N,jb as Q,kb as q}from"./chunk-PJ4NWNDH.js";import{e as V,f as G,n as W}from"./chunk-JQPMAK7F.js";import{Aa as g,Cb as y,Db as v,Ma as o,Ta as l,Ua as c,Va as _,Za as R,gb as h,hb as u,ja as s,kb as M,qb as C,s as f,sb as S,t as w,tb as D,ub as x,va as I,vb as A}from"./chunk-YSXLQTCP.js";import{g as re}from"./chunk-B7O3QC5Z.js";var O=re(se());function oe(a,d){if(a&1&&(l(0,"nui-radio",9),C(1),y(2,"titlecase"),c()),a&2){let t=d.$implicit;o("value",t),s(),S(" ",v(2,2,t)," ")}}function le(a,d){if(a&1&&_(0,"nui-icon",13),a&2){let t=u().$implicit,i=u();o("icon",i.iconMap[t.id])}}function ce(a,d){if(a&1){let t=R();l(0,"nui-legend-series",10),y(1,"titlecase"),h("mouseenter",function(){let e=f(t).$implicit,n=u();return w(n.chartAssist.emphasizeSeries(e.id))})("isSelectedChange",function(e){let n=f(t).$implicit,r=u();return w(r.chartAssist.toggleSeries(n.id,e))}),_(2,"nui-rich-legend-tile",11),g(3,le,1,1,"nui-icon",12),c()}if(a&2){let t=d.$implicit,i=u();M("descriptionPrimary",v(1,7,t.id)),o("seriesRenderState",i.chartAssist.renderStatesIndex[t.id]==null?null:i.chartAssist.renderStatesIndex[t.id].state)("isSelected",!i.chartAssist.isSeriesHidden(t.id)),s(2),o("value",i.accessors.data.value(t.data[0],0,null,null))("backgroundColor",i.chartAssist.palette.standardColors.get(t.id))("color",i.chartAssist.palette.textColors.get(t.id)),s(),o("ngIf",i.iconMap[t.id])}}function pe(a,d){if(a&1&&(l(0,"nui-radio",9),C(1),y(2,"titlecase"),c()),a&2){let t=d.$implicit;o("value",t),s(),S(" ",v(2,2,t)," ")}}var p=function(a){return a.StackedBar="stacked bar",a.GroupedBar="grouped bar",a.Line="line",a}(p||{}),ve=(()=>{class a{chartTypes=[p.StackedBar,p.GroupedBar,p.Line];chartType=this.chartTypes[0];mainCategoryOptions=["quarters","statuses"];mainCategory=this.mainCategoryOptions[0];statuses=["down","critical","warning","unknown","ok","other"];quarters=["Q1","Q2","Q3","Q4"];iconNames=["down","critical","warning","unknown","up","unmanaged"];categories;subCategories;values=[[24,16,7,6,97,4],[13,8,5,17,5,25],[97,41,24,6,7,6],[45,87,23,48,24,9]];valueAccessor;iconMap=(0,O.default)(this.statuses,this.iconNames.map(t=>`status_${t}`));palette;chartAssist;accessors;renderer;scales;ngOnInit(){this.updateMainCategory()}updateMainCategory(){let t=new F(new ae((0,O.default)(this.statuses,Y.filter((n,r)=>r%2===0)))),i=new F(j),e=this.mainCategory===this.mainCategoryOptions[0];this.categories=e?this.statuses:this.quarters,this.subCategories=e?this.quarters:this.statuses,this.valueAccessor=e?(n,r)=>this.values[n][r]:(n,r)=>this.values[r][n],this.palette=e?i:t,this.updateChartType()}updateChartType(){this.buildChart(),this.updateChart()}buildChart(){let{grid:t,accessors:i,renderer:e,scales:n,preprocessor:r}=this.getChartAttributes(this.chartType);this.renderer=e,this.accessors=i,this.scales=n;let m=new U(t);m.addPlugin(new ie),this.chartAssist=new Z(m,r,this.palette),this.chartType===p.StackedBar&&(this.chartAssist.seriesProcessor=B)}updateChart(){this.chartAssist.update(this.buildChartSeries(this.categories,this.subCategories,this.valueAccessor))}buildChartSeries(t,i,e){return i.map((n,r)=>({id:n,name:n,data:t.map((m,T)=>({category:m,value:e(r,T)||0})),accessors:this.accessors,renderer:this.renderer,scales:this.scales}))}getChartAttributes(t){let i=this.getChartTools(t),e={grid:i.gridFunction(),accessors:i.accessorFunction(),renderer:i.rendererFunction(),scales:i.scaleFunction()};return i.preprocessor&&(e.preprocessor=i.preprocessor),e}getChartTools(t){return{[p.StackedBar]:{preprocessor:B,gridFunction:L,rendererFunction:()=>new E({highlightStrategy:new k("x")}),accessorFunction:()=>P(void 0,this.palette.standardColors),scaleFunction:b},[p.GroupedBar]:{gridFunction:()=>L({grouped:!0}),rendererFunction:()=>new E({highlightStrategy:new k("x")}),accessorFunction:()=>{let e=P({grouped:!0},this.palette.standardColors);return e.data.category=(n,r,m,T)=>[n.category,T.name],e},scaleFunction:()=>b({grouped:!0})},[p.Line]:{gridFunction:()=>new ne,rendererFunction:()=>new K,accessorFunction:()=>{let e=new J(this.palette.standardColors);return e.data.x=n=>n.category,e.data.y=n=>n.value,e.data.value=n=>n.value,e},scaleFunction:()=>({x:new te().fixDomain(this.categories),y:new ee})}}[t]}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=I({type:a,selectors:[["nui-chart-two-dimensional-data-example"]],standalone:!1,decls:13,vars:9,consts:[[1,"nui-radio-group-inline",3,"valueChange","value"],[3,"value",4,"ngFor","ngForOf"],[1,"nui-chart-layout"],[1,"chart"],[1,"w-100",3,"chart"],[1,"legend"],[3,"mouseleave","active","interactive"],[3,"descriptionPrimary","seriesRenderState","isSelected","mouseenter","isSelectedChange",4,"ngFor","ngForOf","ngForTrackBy"],[1,"legend-bottom"],[3,"value"],[3,"mouseenter","isSelectedChange","descriptionPrimary","seriesRenderState","isSelected"],[3,"value","backgroundColor","color"],["class","mt-1 ml-3",3,"icon",4,"ngIf"],[1,"mt-1","ml-3",3,"icon"]],template:function(i,e){i&1&&(l(0,"h3"),C(1," Legend by "),l(2,"nui-radio-group",0),A("valueChange",function(r){return x(e.mainCategory,r)||(e.mainCategory=r),r}),h("valueChange",function(){return e.updateMainCategory()}),g(3,oe,3,4,"nui-radio",1),c()(),l(4,"div",2)(5,"div",3),_(6,"nui-chart",4),c(),l(7,"div",5)(8,"nui-legend",6),h("mouseleave",function(){return e.chartAssist.resetVisibleSeries()}),g(9,ce,4,9,"nui-legend-series",7),c()(),l(10,"div",8)(11,"nui-radio-group",0),A("valueChange",function(r){return x(e.chartType,r)||(e.chartType=r),r}),h("valueChange",function(){return e.updateChartType()}),g(12,pe,3,4,"nui-radio",1),c()()()),i&2&&(s(2),D("value",e.mainCategory),s(),o("ngForOf",e.mainCategoryOptions),s(3),o("chart",e.chartAssist.chart),s(2),o("active",e.chartAssist.isLegendActive)("interactive",!1),s(),o("ngForOf",e.chartAssist.legendSeriesSet)("ngForTrackBy",e.chartAssist.seriesTrackByFn),s(2),D("value",e.chartType),s(),o("ngForOf",e.chartTypes))},dependencies:[V,G,$,z,X,H,N,q,Q,W],encapsulation:2})}return a})();export{ve as a};
