import{$ as j,A as L,B as M,C as O,D as b,Ea as $,F,I as z,Ia as X,M as m,R as f,U as V,W as N,X as B,Z as H,_ as U,fa as y,ga as _,hb as Y,ib as q,la as W,ma as Z,na as T,qa as v,z as G}from"./chunk-FM3MSO55.js";import{Ba as Q}from"./chunk-JEEHY2QT.js";import{e as R}from"./chunk-FWIJ3MN4.js";import{A as g,Fa as d,Ga as c,Ha as S,La as E,Ua as C,Va as l,fa as o,ga as I,q as w,wa as P,y as x,ya as a,z as p}from"./chunk-VSZOZJXN.js";import{a as k,b as D,g as K}from"./chunk-7KJRK3NW.js";var J=K(Q());function ee(n,u){if(n&1){let e=E();d(0,"nui-legend-series",6),C("mouseenter",function(){let t=p(e).$implicit,i=l();return g(i.chartAssist.emphasizeSeries(t.id))})("isSelectedChange",function(t){let i=p(e).$implicit,r=l();return g(r.chartAssist.toggleSeries(i.id,t))}),d(1,"nui-rich-legend-tile",7),S(2,"nui-chart-marker",8),c()()}if(n&2){let e=u.$implicit,s=l();a("descriptionPrimary",e.name)("seriesRenderState",s.chartAssist.renderStatesIndex[e.id]==null?null:s.chartAssist.renderStatesIndex[e.id].state)("isSelected",!s.chartAssist.isSeriesHidden(e.id)),o(),a("value",s.chartAssist.getHighlightedValue(e,"y"))("backgroundColor",s.chartAssist.palette.standardColors.get(e.id))("color",s.chartAssist.palette.textColors.get(e.id)),o(),a("marker",s.chartAssist.markers.get(e.id))("color",s.chartAssist.palette.standardColors.get(e.id))}}var ue=(()=>{class n{thresholdsService;data;zones;startDate;uid=V.uuid();chart=new y(new v(q()));summaryChart=new y(new v(Y()));chartAssist=new _(this.chart);summaryChartAssist=new _(this.summaryChart);tooltipsPlugin;thresholdsPalette;thicknessMap;accessors;renderer;scales;backgroundScales;summaryScales;constructor(e){this.thresholdsService=e,this.scales={x:new X,y:new Z},this.backgroundScales={x:this.scales.x,y:new T},this.summaryScales={x:this.scales.x,y:new T},this.configureGrids(this.scales.y.id),this.summaryChartAssist.syncWithChartAssist(this.chartAssist),this.scales.y.domainCalculator=W([0,100]),this.backgroundScales.y.fixDomain(f.STATUS_DOMAIN),this.summaryScales.y.fixDomain(f.STATUS_DOMAIN),this.thresholdsPalette=new z(new $({error:m[2],warning:m[4],ok:m[8]},"transparent")),this.thicknessMap={ok:N.THIN},this.renderer=new U,this.accessors=new H(this.chartAssist.palette.standardColors,this.chartAssist.markers)}ngOnInit(){this.update(this.data)}ngOnChanges(e){(e.data||e.zones)&&this.update(this.data)}update(e){let s=te(e,this.accessors,this.startDate).map(r=>D(k({},r),{renderer:this.renderer,scales:this.scales})),t=[...s].map(r=>{let h=[...this.zones,{status:"ok"}],A=this.thresholdsService.getThresholdZones(r,h,this.thresholdsPalette.standardColors);return this.thresholdsService.injectThresholdsData(r,A),this.thresholdsService.getBackgrounds(r,A,this.summaryScales,this.thresholdsPalette.standardColors,this.thicknessMap,(0,J.default)(B))}),i=[];for(let r of s){let h=this.thresholdsService.getThresholdZones(r,this.zones,this.thresholdsPalette.standardColors);this.thresholdsService.injectThresholdsData(r,h),i.push(this.thresholdsService.getBackgrounds(r,h,this.backgroundScales,this.thresholdsPalette.backgroundColors),...this.thresholdsService.getThresholdLines(h),...this.thresholdsService.getSideIndicators(h,this.scales))}this.chartAssist.update([...i,...s]),this.summaryChartAssist.update(t)}configureGrids(e){let s=this.chart.getGrid();s.leftScaleId=e;let t=s.config();t.dimension.width(400),t.dimension.height(110),t.dimension.autoWidth=!1,t.dimension.autoHeight=!1;let i=this.summaryChart.getGrid().config();i.dimension.width(400),i.dimension.autoWidth=!1}static \u0275fac=function(s){return new(s||n)(I(j))};static \u0275cmp=w({type:n,selectors:[["nui-thresholds-summary-test"]],inputs:{data:"data",zones:"zones",startDate:"startDate"},features:[x],decls:6,vars:8,consts:[[1,"d-flex","align-items-start"],[1,"d-flex","flex-column"],[1,"thresholds-main-chart",3,"chart","nuiChartCollectionId"],[1,"thresholds-summary-chart",3,"chart","nuiChartCollectionId"],["seriesUnitLabel","sec",1,"ml-2","thresholds-legend",3,"mouseleave","active","interactive"],[3,"descriptionPrimary","seriesRenderState","isSelected","mouseenter","isSelectedChange",4,"ngFor","ngForOf","ngForTrackBy"],[3,"mouseenter","isSelectedChange","descriptionPrimary","seriesRenderState","isSelected"],[3,"value","backgroundColor","color"],["rightEdge","",3,"marker","color"]],template:function(s,t){s&1&&(d(0,"div",0)(1,"div",1),S(2,"nui-chart",2)(3,"nui-chart",3),c(),d(4,"nui-legend",4),C("mouseleave",function(){return t.chartAssist.resetVisibleSeries()}),P(5,ee,3,8,"nui-legend-series",5),c()()),s&2&&(o(2),a("chart",t.chart)("nuiChartCollectionId",t.uid),o(),a("chart",t.summaryChart)("nuiChartCollectionId",t.uid),o(),a("active",t.chartAssist.isLegendActive)("interactive",!0),o(),a("ngForOf",t.chartAssist.legendSeriesSet)("ngForTrackBy",t.chartAssist.seriesTrackByFn))},dependencies:[R,O,b,F,L,M,G],encapsulation:2})}return n})();function te(n,u,e){let s=(t,i)=>({x:e.clone().add(i,"d"),y:t});return Object.keys(n).map(t=>{let r=n[t].map(s);return{id:t,name:t,data:r,accessors:u}})}export{ue as a};
