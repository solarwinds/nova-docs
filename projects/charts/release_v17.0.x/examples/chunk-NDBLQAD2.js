import{a as Ee}from"./chunk-7D4B5ONT.js";import{a as ye}from"./chunk-G6GWPXJQ.js";import{A as K,C as Z,D as ee,E as te,Ea as he,I as ie,M as re,W as A,Wa as N,Xa as V,Ya as me,Z as ne,Za as _e,_ as se,ab as Te,b as M,c as U,d as Q,e as $,f as z,fa as ae,g as W,ga as oe,h as X,i as j,k as J,l as Y,ma as ce,na as le,oa as de,q as o,qa as pe,ua as f,va as ue,z as q}from"./chunk-FM3MSO55.js";import{O as ve,hb as G}from"./chunk-JEEHY2QT.js";import{e as H,f as L,n as D,p as B}from"./chunk-FWIJ3MN4.js";import{A as E,Fa as s,Ga as a,Ha as g,Hb as b,La as v,Ua as u,Va as h,cb as _,db as O,fa as l,ga as x,pb as y,q as k,qb as I,wa as C,ya as d,z as T}from"./chunk-VSZOZJXN.js";import{a as F,b as P,g as R}from"./chunk-7KJRK3NW.js";var ge=R(ve()),Se=R(ye());function Ie(n,m){if(n&1){let e=v();s(0,"nui-legend-series",13),y(1,"titlecase"),u("mouseenter",function(){let i=T(e).$implicit,r=h();return E(r.chartAssist.emphasizeSeries(i.id))})("isSelectedChange",function(i){let r=T(e).$implicit,c=h();return E(c.chartAssist.toggleSeries(r.id,i))}),s(2,"nui-basic-legend-tile"),g(3,"nui-chart-marker",14),a()()}if(n&2){let e=m.$implicit,t=h();d("descriptionPrimary",I(1,5,e.name))("seriesRenderState",t.chartAssist.renderStatesIndex[e.id]==null?null:t.chartAssist.renderStatesIndex[e.id].state)("isSelected",!t.chartAssist.isSeriesHidden(e.id)),l(3),d("marker",t.chartAssist.markers.get(e.id))("color",t.chartAssist.palette.standardColors.get(e.id))}}function Ae(n,m){if(n&1){let e=v();s(0,"div",9)(1,"strong"),_(2,"Interaction Type:"),a(),s(3,"nui-select",8),u("changed",function(i){T(e);let r=h();return E(r.onInteractionTypeChange(i.newValue))}),a()()}if(n&2){let e=h();l(3),d("itemsSource",e.selectedEvent.interactionTypes)("value",e.selectedInteractionType)}}var p=function(n){return n.StackedBar="Stacked Bar",n.GroupedBar="Grouped Bar",n.Line="Line",n}(p||{}),be=(()=>{class n{changeDetector;parsedEvent={};eventFilters=[{id:M,name:"MOUSE_ACTIVE_EVENT"},{id:U,name:"INTERACTION_VALUES_EVENT",interactionTypes:[o.Click,o.MouseMove]},{id:X,name:"INTERACTION_DATA_POINTS_EVENT",interactionTypes:[o.Click,o.MouseMove]},{id:j,name:"INTERACTION_DATA_POINT_EVENT",interactionTypes:[o.Click,o.Hover]},{id:Q,name:"HIGHLIGHT_DATA_POINT_EVENT",interactionTypes:[o.MouseMove]},{id:z,name:"HIGHLIGHT_SERIES_EVENT",interactionTypes:[o.MouseMove]},{id:W,name:"INTERACTION_SERIES_EVENT",interactionTypes:[o.Click]},{id:$,name:"SELECT_DATA_POINT_EVENT",interactionTypes:[o.Click]},{id:J,name:"CHART_VIEW_STATUS_EVENT"},{id:Y,name:"SERIES_STATE_CHANGE_EVENT"}];selectedEvent=this.eventFilters[0];selectedInteractionType="";chartTypes=[p.GroupedBar,p.StackedBar,p.Line];selectedChartType;categories=["Q1","Q2","Q3","Q4"];subCategories=["down","critical","warning","unknown","ok","other"];values=[[24,16,7,6,97,4],[13,8,5,17,5,25],[97,41,24,6,7,6],[45,87,23,48,24,9]];valueAccessor;chartAssist;palette;accessors;renderer;scales;seriesProcessor;onEventFilterChange(e){this.selectedEvent=e,this.selectedInteractionType=this.selectedEvent.interactionTypes?this.selectedEvent.interactionTypes[0]:""}onInteractionTypeChange(e){this.selectedInteractionType=e}constructor(e){this.changeDetector=e}ngOnInit(){this.valueAccessor=(e,t)=>this.values[t][e],this.palette=new ie(new he((0,Se.default)(this.subCategories,re.filter(Ee)))),this.updateChartType(this.chartTypes[0])}updateChartType(e){this.selectedChartType=e,this.buildChart(),this.subscribeToChart(),this.updateChart()}buildChart(){let{grid:e,accessors:t,renderer:i,scales:r,seriesProcessor:c}=this.getChartAttributes(this.selectedChartType);this.chartAssist=new oe(new ae(e)),this.chartAssist.palette=this.palette,this.chartAssist.chart.addPlugin(new de),this.renderer=i,this.accessors=t,this.scales=r,this.seriesProcessor=c}subscribeToChart(){(0,ge.default)(this.eventFilters,e=>{this.chartAssist.chart.getEventBus().getStream(e.id).subscribe(t=>{this.selectedEvent.id===e.id&&(!t.data.interactionType||this.selectedInteractionType===t.data.interactionType)&&(Ce(t,"dataSeries","<< IChartSeries info is available here (replaced in output for brevity) >>"),this.parsedEvent=t,this.changeDetector.markForCheck())})})}updateChart(){let e=this.buildChartSeries(this.categories,this.subCategories,this.valueAccessor);e=this.seriesProcessor?this.seriesProcessor(e,()=>!0):e,this.chartAssist.update(e)}buildChartSeries(e,t,i){return t.map((r,c)=>({id:r,name:r,data:e.map((w,S)=>({category:w,value:i(c,S)||0})),accessors:this.accessors,renderer:this.renderer,scales:this.scales}))}getChartAttributes(e){let t=this.getChartTools(e),i={grid:t.gridFunction(),accessors:t.accessorFunction(),renderer:t.rendererFunction(),scales:t.scaleFunction()};return t.seriesProcessor&&(i=P(F({},i),{seriesProcessor:t.seriesProcessor})),i}getChartTools(e){return{[p.StackedBar]:{seriesProcessor:ue,gridFunction:N,rendererFunction:()=>new A({highlightStrategy:new me("x")}),accessorFunction:()=>V(void 0,this.palette.standardColors),scaleFunction:f},[p.GroupedBar]:{gridFunction:()=>N({grouped:!0}),rendererFunction:()=>new A({highlightStrategy:new _e("x")}),accessorFunction:()=>{let i=V({grouped:!0},this.palette.standardColors);return i.data.category=(r,c,w,S)=>[r.category,S.name],i},scaleFunction:()=>f({grouped:!0})},[p.Line]:{gridFunction:()=>new pe,rendererFunction:()=>new se({interactionStrategy:new Te,markerInteraction:{enabled:!0,clickable:!0}}),accessorFunction:()=>{let i=new ne(this.palette.standardColors);return i.data.x=r=>r.category,i.data.y=r=>r.value,i.data.value=r=>r.value,i},scaleFunction:()=>({x:new le().fixDomain(this.categories),y:new ce})}}[e]}static \u0275fac=function(t){return new(t||n)(x(b))};static \u0275cmp=k({type:n,selectors:[["nui-chart-event-sampler"]],decls:21,vars:12,consts:[[1,"nui-chart-layout"],[1,"chart"],[1,"w-100",3,"chart"],[1,"legend"],[3,"mouseleave","interactive"],[3,"descriptionPrimary","seriesRenderState","isSelected","mouseenter","isSelectedChange",4,"ngFor","ngForOf","ngForTrackBy"],[1,"d-flex"],[1,"d-flex","align-items-center"],[1,"ml-2",3,"changed","itemsSource","value"],[1,"d-flex","align-items-center","ml-3"],["displayValue","name",1,"ml-2",3,"changed","itemsSource","value"],["class","d-flex align-items-center ml-3",4,"ngIf"],[1,"mt-3","sampler-output__container"],[3,"mouseenter","isSelectedChange","descriptionPrimary","seriesRenderState","isSelected"],[3,"marker","color"]],template:function(t,i){t&1&&(s(0,"div",0)(1,"div",1),g(2,"nui-chart",2),a(),s(3,"div",3)(4,"nui-legend",4),u("mouseleave",function(){return i.chartAssist.resetVisibleSeries()}),C(5,Ie,4,7,"nui-legend-series",5),a()()(),g(6,"hr"),s(7,"div",6)(8,"div",7)(9,"strong"),_(10,"Chart Type:"),a(),s(11,"nui-select",8),u("changed",function(c){return i.updateChartType(c.newValue)}),a()(),s(12,"div",9)(13,"strong"),_(14,"Event:"),a(),s(15,"nui-select",10),u("changed",function(c){return i.onEventFilterChange(c.newValue)}),a()(),C(16,Ae,4,2,"div",11),a(),s(17,"div",12)(18,"pre"),_(19),y(20,"json"),a()()),t&2&&(l(2),d("chart",i.chartAssist.chart),l(2),d("interactive",!0),l(),d("ngForOf",i.chartAssist.legendSeriesSet)("ngForTrackBy",i.chartAssist.seriesTrackByFn),l(6),d("itemsSource",i.chartTypes)("value",i.selectedChartType),l(4),d("itemsSource",i.eventFilters)("value",i.selectedEvent),l(),d("ngIf",!!i.selectedInteractionType),l(3),O(I(20,10,i.parsedEvent)))},dependencies:[Z,ee,te,K,q,H,L,G,B,D],styles:[".sampler-output__container[_ngcontent-%COMP%]{height:660px;overflow-y:scroll}"],changeDetection:0})}return n})();function Ce(n,m,e){for(let t in n)t===m?n[t]=e:typeof n[t]=="object"&&Ce(n[t],m,e)}export{be as a};
