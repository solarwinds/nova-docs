import{A as q,B as $,Ea as et,I as Z,K as c,Na as nt,Q as J,Sa as it,Ua as ot,Va as rt,W as K,Ya as at,fa as p,j,ma as U,na as tt,qa as g}from"./chunk-YA4MYKC2.js";import{La as Y,U as V,V as H,W as L,ja as N,ka as F,la as Q,ma as X}from"./chunk-HL7NY4QC.js";import{e as G,f as W}from"./chunk-FWIJ3MN4.js";import{$a as b,A as I,Fa as s,Ga as w,Ha as l,La as A,Ua as P,Va as x,Ya as R,_a as O,ab as M,ca as k,cb as T,db as B,fa as r,ga as f,pa as D,q as S,tb as E,wa as v,ya as h,z,za as _}from"./chunk-VSZOZJXN.js";var st=["templatePortalGrid"],lt=["gridChartPlaceholder"];function ct(i,u){i&1&&l(0,"div",11)}function pt(i,u){if(i&1&&(s(0,"div",5),l(1,"nui-icon",6),s(2,"div",7)(3,"span"),T(4),w()(),s(5,"div",8),v(6,ct,1,0,"div",9),l(7,"nui-chart",10),w()()),i&2){let t=u.$implicit,e=u.first,n=x();r(),R("icon",t.icon),r(),_("width",n.rowSize,"px"),r(2),B(t.url),r(2),h("ngIf",e),r(),h("chart",t.chart)}}function gt(i,u){if(i&1&&l(0,"nui-chart",10),i&2){let t=x();h("chart",t.gridChart)}}var Ot=(()=>{class i{overlay;overlayPositionBuilder;_viewContainerRef;scrollStrategyOptions;seriesChartConfig=new nt({showBottomAxis:!1});iconSize=20;rowSize=200;palette=new Z(new et({connect:c[0],dns:c[1],send:c[2],ttfb:c[3],cdownload:c[4]}));gridChart=new p(new g);positionStrategy;templatePortal;listItems=mt(this.seriesChartConfig);scales;overlayRef;templatePortalGrid;gridChartPlaceholder;updateGridPosition(){this.overlayRef.updatePosition()}constructor(t,e,n,o){this.overlay=t,this.overlayPositionBuilder=e,this._viewContainerRef=n,this.scrollStrategyOptions=o}ngOnInit(){this.gridChart.addPlugin(new it),this.gridChart.getEventBus().getStream(j).subscribe(t=>{let e=t.data;this.listItems.forEach(n=>{this.scales.x.fixDomain(e[this.scales.x.id]),n.chart.updateDimensions()})})}ngAfterViewInit(){this.templatePortal=new N(this.templatePortalGrid,this._viewContainerRef);let t=[{originX:"start",originY:"top",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"top"}];this.positionStrategy=this.overlay.position().flexibleConnectedTo(this.gridChartPlaceholder).withPositions(t).withPush(!1),this.overlayRef=this.overlay.create({positionStrategy:this.positionStrategy,scrollStrategy:this.scrollStrategyOptions.reposition()});let e=new tt,n=new U;n.fixDomain([0,1e3]),e.fixDomain(["cat1"]),this.scales={x:n,y:e},this.scales.x.formatters.tick=a=>`${Number(a/1e3).toFixed(1)}s`;let o=new K({highlightStrategy:new at("x")}),y=new J;y.data.color=a=>this.palette.standardColors.get(a.type);let C=0;this.listItems.forEach(a=>{let dt=[{id:"series-1",name:"Series 1",data:a.data.map(m=>({value:m.end-m.start,start:m.start,end:m.end,category:"cat1",type:m.type})),accessors:y,scales:this.scales,renderer:o}];a.chart.update(dt),C=a.chart.getGrid().config().dimension.width()});let d=this.gridChart.getGrid().config();d.dimension.height(this.listItems.length*this.seriesChartConfig.dimension.height()),d.dimension.width(C),d.dimension.autoHeight=!1,d.axis.left.visible=!1,d.axis.left.gridTicks=!1,d.axis.bottom.gridTicks=!0,this.gridChart.update([{id:"i am grid",name:"i am grid",data:[],accessors:new ot,scales:this.scales,renderer:new rt}]),this.gridChart.updateDimensions(),this.overlayRef.attach(this.templatePortal)}drop(t){V(this.listItems,t.previousIndex,t.currentIndex)}static \u0275fac=function(e){return new(e||i)(f(X),f(Q),f(D),f(F))};static \u0275cmp=S({type:i,selectors:[["nui-waterfall-chart-advanced-example"]],viewQuery:function(e,n){if(e&1&&(O(st,5),O(lt,5)),e&2){let o;b(o=M())&&(n.templatePortalGrid=o.first),b(o=M())&&(n.gridChartPlaceholder=o.first)}},hostBindings:function(e,n){e&1&&P("click",function(){return n.updateGridPosition()},!1,k)},decls:7,vars:3,consts:[["gridChartPlaceholder",""],["templatePortalGrid",""],[1,"chart","mb-5"],["cdkDropList","",1,"example-list",3,"cdkDropListDropped"],["class","d-flex flex-row align-items-center waterfall-chart-list-item","cdkDrag","",4,"ngFor","ngForOf"],["cdkDrag","",1,"d-flex","flex-row","align-items-center","waterfall-chart-list-item"],[1,"p-1",3,"icon"],[1,"p-1",2,"overflow","hidden"],[1,"d-flex"],["class","d-flex h-100",4,"ngIf"],["nuiChartCollectionId","1",1,"d-flex",3,"chart"],[1,"d-flex","h-100"]],template:function(e,n){if(e&1){let o=A();s(0,"div",2),l(1,"div",null,0),s(3,"div",3),P("cdkDropListDropped",function(C){return z(o),I(n.drop(C))}),v(4,pt,8,6,"div",4),w()(),v(5,gt,1,1,"ng-template",null,1,E)}e&2&&(r(),_("margin-left",n.rowSize+n.iconSize,"px"),r(3),h("ngForOf",n.listItems))},dependencies:[L,H,Y,G,W,q,$],styles:['.nui-dnd-hover-state[_ngcontent-%COMP%]{background:#f2f2f2}.nui-dnd-raised-state[_ngcontent-%COMP%]{z-index:1;box-sizing:border-box;box-shadow:0 2px 10px 0 var(--nui-shadow-color, rgba(17, 17, 17, .3))}.nui-dnd-preview[_ngcontent-%COMP%]{border:1px #d9d9d9 solid;background:#f2f2f2;z-index:1;box-sizing:border-box;box-shadow:0 2px 10px 0 var(--nui-shadow-color, rgba(17, 17, 17, .3))}.nui-dnd-dropzone.nui-dnd-dropzone--active[_ngcontent-%COMP%]{border:4px dashed #999!important}.nui-dnd-dropzone.nui-dnd-dropzone--drop-allowed[_ngcontent-%COMP%]{cursor:move;border:4px solid #00c4d2!important;background-color:#00c4d233}.nui-dnd-dropzone.nui-dnd-dropzone--drop-not-allowed[_ngcontent-%COMP%]{cursor:move;border:4px solid #dd2c00!important;background-color:#dd2c0033}.nui-dnd-dropzone[_ngcontent-%COMP%]   .centered-overlay[_ngcontent-%COMP%], .nui-dnd-dropzone[_ngcontent-%COMP%]   .nui-icon-item[_ngcontent-%COMP%]:before{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);-o-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.nui-dnd-dropzone[_ngcontent-%COMP%]   .nui-icon-item[_ngcontent-%COMP%]:before{border-radius:50%;content:"";display:block;height:40px;width:40px;z-index:-1}.nui-dnd-dropzone[_ngcontent-%COMP%]   .drop-circle-permanent[_ngcontent-%COMP%]   .nui-icon-item[_ngcontent-%COMP%]:before{background-color:#fff}.nui-dnd-dropzone[_ngcontent-%COMP%]   .drop-circle-permanent[_ngcontent-%COMP%]   .nui-icon-item[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   polygon[_ngcontent-%COMP%]{fill:#111}.nui-dnd-dropzone[_ngcontent-%COMP%]   .drop-circle-allowed[_ngcontent-%COMP%]   .nui-icon-item[_ngcontent-%COMP%]:before{background-color:#00c4d2}.nui-dnd-dropzone[_ngcontent-%COMP%]   .drop-circle-allowed[_ngcontent-%COMP%]   .nui-icon-item[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   polygon[_ngcontent-%COMP%]{clip-path:circle(5px);fill:#fff}.nui-dnd-dropzone[_ngcontent-%COMP%]   .drop-circle-not-allowed[_ngcontent-%COMP%]   .nui-icon-item[_ngcontent-%COMP%]:before{background-color:#dd2c00}.nui-dnd-dropzone[_ngcontent-%COMP%]   .drop-circle-not-allowed[_ngcontent-%COMP%]   .nui-icon-item[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]{clip-path:circle(5px);fill:#fff}.waterfall-chart-list-item[_ngcontent-%COMP%]:hover{background-color:var(--nui-color-selected,rgba(0, 196, 210, .1))}.waterfall-chart-list-item[_ngcontent-%COMP%]{background-color:var(--nui-color-bg-content,#fff)}']})}return i})();function mt(i){return[{url:"http://www.google.com",size:924,icon:"xml-file",chart:new p(new g(i)),data:[{type:"connect",start:0,end:22},{type:"dns",start:22,end:39},{type:"send",start:39,end:59},{type:"ttfb",start:59,end:109},{type:"cdownload",start:109,end:178}]},{url:"http://www2.google.com",size:924,icon:"xml-file",chart:new p(new g(i)),data:[{type:"connect",start:0,end:22},{type:"dns",start:22,end:39},{type:"send",start:39,end:59},{type:"ttfb",start:59,end:109},{type:"cdownload",start:109,end:788}]},{url:"http://www.google.com/cat.png",size:3333,icon:"image",chart:new p(new g(i)),data:[{type:"connect",start:178,end:222},{type:"dns",start:222,end:239},{type:"send",start:239,end:259},{type:"ttfb",start:259,end:309},{type:"cdownload",start:309,end:578}]},{url:"http://www.google.com/revenge.png",size:3333,icon:"image",chart:new p(new g(i)),data:[{type:"connect",start:578,end:590},{type:"dns",start:590,end:799},{type:"send",start:799,end:888},{type:"ttfb",start:888,end:900},{type:"cdownload",start:900,end:990}]}]}export{Ot as a};
