"use strict";(self.webpackChunk_nova_ui_dashboards=self.webpackChunk_nova_ui_dashboards||[]).push([[387],{55387:function(e,t,i){i.r(t),i.d(t,{ConfiguratorTestModule:function(){return z}});var r=i(99763),o=i(46806),s=i(69063),d=i(91580),n=i(98462),a=i(48791),l=i(10325),p=i(40844),c=i(59311),g=i.n(c),u=i(79765),h=i(15257),v=i(46782),m=i(38583),f=i(33018),w=i(37524),b=i.n(w),C=i(12666),y=i.n(C),S=i(77459);const I={widget1:{cols:6,rows:6,y:0,x:0},widget2:{cols:6,rows:6,y:0,x:6},widget3:{cols:7,rows:6,y:6,x:0},widget4:{cols:5,rows:6,y:6,x:7}},T=[{id:"widget1",type:"kpi",pizzagna:{[s.xW5.Configuration]:{header:{properties:{title:"KPI Widget!",subtitle:"A bunch of number boxes"}},tiles:{properties:{nodes:["kpi1","kpi2"]}},kpi1:{id:"kpi1",componentType:s.ufE.lateLoadKey,providers:{[s.Muk.DataSource]:{providerId:n.Of.providerId},[s.Muk.Adapter]:{providerId:s.u1$,properties:{componentId:"kpi1",propertyPath:"widgetData",thresholds:{showThresholds:!0,warningThresholdValue:5,criticalThresholdValue:8}}}},properties:{elementClass:"flex-grow-1",widgetData:{id:"totalStorage",value:0,label:"Total storage"}}},kpi2:{id:"kpi2",componentType:s.ufE.lateLoadKey,providers:{[s.Muk.DataSource]:{providerId:n.v8.providerId},[s.Muk.Adapter]:{providerId:s.u1$,properties:{componentId:"kpi2",propertyPath:"widgetData",thresholds:{warningThresholdValue:120,criticalThresholdValue:150}}}},properties:{elementClass:"flex-grow-1",widgetData:{id:"downloadSpeed",value:0,label:"Download speed"}}}}}},{id:"widget2",type:"proportional",pizzagna:{[s.xW5.Configuration]:{header:{properties:{title:"Proportional Widget!",subtitle:"Proportional widget with legend formatters"}},chart:{providers:{[s.Muk.DataSource]:{providerId:a.DU.providerId}},properties:{configuration:{chartOptions:{type:s.EMX.PieChart,legendPlacement:s.woB.Right,legendFormatter:{componentType:s.s9y.lateLoadKey}}}}}}}},{id:"widget3",type:"timeseries",pizzagna:{[s.xW5.Configuration]:{[s.XMI]:{providers:{[s.Muk.DataSource]:{providerId:p.GS.providerId}}},header:{properties:{title:"Timeseries Widget!",subtitle:"Basic timeseries widget"}},chart:{providers:{[s.Muk.Adapter]:{properties:{series:[{id:"series-1",label:"Average CPU Load",selectedSeriesId:"series-1"},{id:"series-2",label:"Average CPU Load",selectedSeriesId:"series-2"},{id:"series-3",label:"Average CPU Load",selectedSeriesId:"series-3"}]}}},properties:{configuration:{legendPlacement:s.woB.Right,enableZoom:!0,leftAxisLabel:"Utilization (%)"}}},timeframeSelection:{properties:{timeframe:{startDatetime:(0,S.ad)().subtract(7,"day").format(),endDatetime:(0,S.ad)().format(),selectedPresetId:null}}}}}},{id:"widget4",type:"table",pizzagna:{[s.xW5.Configuration]:{header:{properties:{title:"Table Widget!",subtitle:"Basic table widget"}},table:{providers:{[s.Muk.DataSource]:{providerId:l.P.providerId}},properties:{configuration:{columns:[{id:"column1",label:"No",isActive:!0,formatter:{componentType:s.aDR.lateLoadKey,properties:{dataFieldIds:{value:"position"}}}},{id:"column2",label:"Name",isActive:!0,formatter:{componentType:s.aDR.lateLoadKey,properties:{dataFieldIds:{value:"name"}}}},{id:"column3",label:"Location",isActive:!0,formatter:{componentType:s.s9y.lateLoadKey,properties:{dataFieldIds:{value:"firstUrlLabel",link:"firstUrl"}}}}],sorterConfiguration:{descendantSorting:!0,sortBy:"column1"},hasVirtualScroll:!0}}}}}}];function k(e,t){if(1&e&&(f.TgZ(0,"div",3),f.TgZ(1,"div",4),f._uU(2),f.qZA(),f.qZA()),2&e){const e=t.item;f.xp6(2),f.hij(" ",e.title," ")}}let x=(()=>{class e{constructor(e){this.widgetTypesService=e,this.widgetSelected=new f.vpe,this.widgetItems=[]}ngOnInit(){const e=new m.rS;this.widgetItems=T.map(t=>(console.log(t),{title:e.transform(t.type),widget:this.widgetTypesService.mergeWithWidgetType(t)})),this.onSelect([this.widgetItems[0]]),T.forEach(e=>{this.addUnconfiguredWidgetWithConfigLayer(e)})}addUnconfiguredWidgetWithConfigLayer(e){const t=(new m.rS).transform(e.type);this.widgetItems.push({title:`Unconfigured ${t} With Config Layer`,widget:Object.assign(Object.assign({},b()(this.widgetTypesService.mergeWithWidgetType(e))),{id:`unconfiguredWithConfigLayer${t}`,metadata:{needsConfiguration:!0}})}),y()(this.widgetItems[this.widgetItems.length-1].widget.pizzagna,`${s.xW5.Configuration}.header.properties.title`,`Unconfigured ${t} With Config Layer`)}onSelect(e){this.widgetSelected.emit(e[0].widget),this.widgetSelection=e}}return e.lateLoadKey="AcmeCloneSelectionComponent",e.\u0275fac=function(t){return new(t||e)(f.Y36(s.xTe))},e.\u0275cmp=f.Xpm({type:e,selectors:[["acme-clone-selection"]],outputs:{widgetSelected:"widgetSelected"},decls:4,vars:3,consts:[[1,"nui-widget-cloner"],["selectionMode","singleWithRequiredSelection",3,"itemsSource","selection","repeatItemTemplateRef","selectionChange"],["widgetClonerItem",""],[1,"nui-widget-cloner__item","d-flex","pt-2","pb-2","align-items-center"],[1,"text-info","ml-3"]],template:function(e,t){if(1&e&&(f.TgZ(0,"div",0),f.TgZ(1,"nui-repeat",1),f.NdJ("selectionChange",function(e){return t.onSelect(e)}),f.qZA(),f.qZA(),f.YNc(2,k,3,1,"ng-template",null,2,f.W1O)),2&e){const e=f.MAs(3);f.xp6(1),f.Q6J("itemsSource",t.widgetItems)("selection",t.widgetSelection)("repeatItemTemplateRef",e)}},directives:[o.$N6],styles:[".nui-widget-cloner__item[_ngcontent-%COMP%]{height:60px}"]}),e})(),W=(()=>{class e{constructor(e){this.toastService=e,this.allowSubmit=!0,this.allowRemoval=!0,this.trySubmit=e=>{const t=new u.xQ;return setTimeout(()=>{if(this.allowSubmit)t.next(e);else{const e=$localize`Submit failed.`;this.toastService.error({title:e}),t.error(e)}},1e3),t.asObservable()},this.tryRemove=e=>{const t=new u.xQ;return setTimeout(()=>{if(this.allowRemoval)t.next(e);else{const e=$localize`Widget removal failed.`;this.toastService.error({title:e}),t.error(e)}},200),t.asObservable()},this.toastService.setConfig({timeOut:2e3})}}return e.\u0275fac=function(t){return new(t||e)(f.LFG(o.klp))},e.\u0275prov=f.Yz7({token:e,factory:e.\u0275fac}),e})();var D=i(5457),M=i(46276),A=i(54607);const P=[{path:"",component:(()=>{class e{constructor(e,t,i,r,d){this.providerRegistry=e,this.submitHandler=t,this.themeSwitcherService=i,this.widgetTypesService=r,this.widgetClonerService=d,this.destroy$=new u.xQ,this.dashboard={positions:{},widgets:{}},this.gridsterConfig={minCols:12,maxCols:12,minRows:12},this.editMode=!1,this.dsError=!1,this.providerRegistry.setProviders({[n.Of.providerId]:{provide:s.Fk3,useClass:n.Of,deps:[]},[n.v8.providerId]:{provide:s.Fk3,useClass:n.v8,deps:[]},[a.U8.providerId]:{provide:s.Fk3,useClass:a.U8,deps:[]},[a.DU.providerId]:{provide:s.Fk3,useClass:a.DU,deps:[]},[a.An.providerId]:{provide:s.Fk3,useClass:a.An,deps:[]},[l.P.providerId]:{provide:s.Fk3,useClass:l.P,deps:[o.oDG,s.nYw]},[l.B.providerId]:{provide:s.Fk3,useClass:l.B,deps:[o.oDG,s.nYw]},[p.GS.providerId]:{provide:s.Fk3,useClass:p.GS,deps:[]},[p.mx.providerId]:{provide:s.Fk3,useClass:p.mx,deps:[]}})}ngOnInit(){const e=T.map(e=>Object.assign(Object.assign({},e),{pizzagna:Object.assign(Object.assign({},this.widgetTypesService.getWidgetType(e.type,e.version).widget),e.pizzagna)})),t=g()(e,e=>e.id);this.dashboard={positions:I,widgets:t}}onDsErrorChange(e){n.Of.mockError=e,p.GS.mockError=e,l.P.mockError=e,a.DU.mockError=e}onCloneWidget(){this.widgetClonerService.open({dashboardComponent:this.dashboardComponent,trySubmit:this.submitHandler.trySubmit,widgetSelectionComponentType:x}).pipe((0,h.q)(1),(0,v.R)(this.destroy$)).subscribe()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return e.\u0275fac=function(t){return new(t||e)(f.Y36(s.CNH),f.Y36(W),f.Y36(o.ERq),f.Y36(s.xTe),f.Y36(s.$Ie))},e.\u0275cmp=f.Xpm({type:e,selectors:[["acme-dashboard"]],viewQuery:function(e,t){if(1&e&&f.Gf(s.MXM,7),2&e){let e;f.iGM(e=f.CRH())&&(t.dashboardComponent=e.first)}},features:[f._Bn([W])],decls:5,vars:6,consts:function(){let e;return e=$localize`:␟08a1b409eac8269dd4dce8a2b3bd976356ba40ee␟7260316479095556147:Create Widget Clone`,[["type","button","nui-button","",1,"mb-3","ml-4","nui-widget-cloner-test-button",3,"click"],e,[3,"editMode","dsError","editModeChange","dsErrorChange"],[1,"dashboard"],[3,"nuiWidgetEditor","dashboard","gridsterConfig","editMode","dashboardChange","gridsterConfigChange"]]},template:function(e,t){1&e&&(f.TgZ(0,"button",0),f.NdJ("click",function(){return t.onCloneWidget()}),f.SDv(1,1),f.qZA(),f.TgZ(2,"dashboard-test-harness",2),f.NdJ("editModeChange",function(e){return t.editMode=e})("dsErrorChange",function(e){return t.onDsErrorChange(e)}),f.TgZ(3,"div",3),f.TgZ(4,"nui-dashboard",4),f.NdJ("dashboardChange",function(e){return t.dashboard=e})("gridsterConfigChange",function(e){return t.gridsterConfig=e}),f.qZA(),f.qZA(),f.qZA()),2&e&&(f.xp6(2),f.Q6J("editMode",t.editMode)("dsError",t.dsError),f.xp6(2),f.Q6J("nuiWidgetEditor",t.submitHandler)("dashboard",t.dashboard)("gridsterConfig",t.gridsterConfig)("editMode",t.editMode))},directives:[o.r0F,D.W,M.M,A.t],styles:[".dashboard[_ngcontent-%COMP%]{height:725px;width:1000px}"]}),e})(),data:{srlc:{hideIndicator:!0}}}];let z=(()=>{class e{constructor(e){var t;this.widgetTypesService=e,null===(t=this.widgetTypesService.getWidgetType("proportional",1).widget.structure[s.XMI].providers)||void 0===t||delete t.refresher,this.setDataSourceProviders("table",[l.P.providerId,l.B.providerId]),this.setDataSourceProviders("kpi",[n.Of.providerId,n.v8.providerId]),this.setDataSourceProviders("proportional",[a.U8.providerId,a.DU.providerId,a.An.providerId]),this.setDataSourceProviders("timeseries",[p.GS.providerId,p.mx.providerId])}setDataSourceProviders(e,t){const i=this.widgetTypesService.getWidgetType(e,1);this.widgetTypesService.setNode(i,"configurator",s.ACc.DataSourceProviders,t)}}return e.\u0275fac=function(t){return new(t||e)(f.LFG(s.xTe))},e.\u0275mod=f.oAB({type:e}),e.\u0275inj=f.cJS({providers:[s.CNH],imports:[[d.o,s.Pi,o.Gsl,o.Az_,o.vvu,o.cJ5,o.Ts3,o.ZuS,r.Bz.forChild(P)]]}),e})()}}]);