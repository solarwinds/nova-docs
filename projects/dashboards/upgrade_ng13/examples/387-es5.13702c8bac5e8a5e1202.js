!function(){"use strict";var e,t,i;function r(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}(self.webpackChunk_nova_ui_dashboards=self.webpackChunk_nova_ui_dashboards||[]).push([[387],{55387:function(n,a,l){var c,p,u;l.r(a),l.d(a,{ConfiguratorTestModule:function(){return q}});var g=l(99763),v=l(46806),h=l(69063),f=l(91580),m=l(98462),w=l(48791),b=l(10325),y=l(40844),C=l(59311),S=l.n(C),I=l(79765),k=l(15257),T=l(46782),x=l(38583),W=l(33018),D=l(37524),P=l.n(D),M=l(12666),A=l.n(M),O=l(77459),z={widget1:{cols:6,rows:6,y:0,x:0},widget2:{cols:6,rows:6,y:0,x:6},widget3:{cols:7,rows:6,y:6,x:0},widget4:{cols:5,rows:6,y:6,x:7}},E=[{id:"widget1",type:"kpi",pizzagna:s({},h.xW5.Configuration,{header:{properties:{title:"KPI Widget!",subtitle:"A bunch of number boxes"}},tiles:{properties:{nodes:["kpi1","kpi2"]}},kpi1:{id:"kpi1",componentType:h.ufE.lateLoadKey,providers:(c={},s(c,h.Muk.DataSource,{providerId:m.Of.providerId}),s(c,h.Muk.Adapter,{providerId:h.u1$,properties:{componentId:"kpi1",propertyPath:"widgetData",thresholds:{showThresholds:!0,warningThresholdValue:5,criticalThresholdValue:8}}}),c),properties:{elementClass:"flex-grow-1",widgetData:{id:"totalStorage",value:0,label:"Total storage"}}},kpi2:{id:"kpi2",componentType:h.ufE.lateLoadKey,providers:(p={},s(p,h.Muk.DataSource,{providerId:m.v8.providerId}),s(p,h.Muk.Adapter,{providerId:h.u1$,properties:{componentId:"kpi2",propertyPath:"widgetData",thresholds:{warningThresholdValue:120,criticalThresholdValue:150}}}),p),properties:{elementClass:"flex-grow-1",widgetData:{id:"downloadSpeed",value:0,label:"Download speed"}}}})},{id:"widget2",type:"proportional",pizzagna:s({},h.xW5.Configuration,{header:{properties:{title:"Proportional Widget!",subtitle:"Proportional widget with legend formatters"}},chart:{providers:s({},h.Muk.DataSource,{providerId:w.DU.providerId}),properties:{configuration:{chartOptions:{type:h.EMX.PieChart,legendPlacement:h.woB.Right,legendFormatter:{componentType:h.s9y.lateLoadKey}}}}}})},{id:"widget3",type:"timeseries",pizzagna:s({},h.xW5.Configuration,(u={},s(u,h.XMI,{providers:s({},h.Muk.DataSource,{providerId:y.GS.providerId})}),s(u,"header",{properties:{title:"Timeseries Widget!",subtitle:"Basic timeseries widget"}}),s(u,"chart",{providers:s({},h.Muk.Adapter,{properties:{series:[{id:"series-1",label:"Average CPU Load",selectedSeriesId:"series-1"},{id:"series-2",label:"Average CPU Load",selectedSeriesId:"series-2"},{id:"series-3",label:"Average CPU Load",selectedSeriesId:"series-3"}]}}),properties:{configuration:{legendPlacement:h.woB.Right,enableZoom:!0,leftAxisLabel:"Utilization (%)"}}}),s(u,"timeframeSelection",{properties:{timeframe:{startDatetime:(0,O.ad)().subtract(7,"day").format(),endDatetime:(0,O.ad)().format(),selectedPresetId:null}}}),u))},{id:"widget4",type:"table",pizzagna:s({},h.xW5.Configuration,{header:{properties:{title:"Table Widget!",subtitle:"Basic table widget"}},table:{providers:s({},h.Muk.DataSource,{providerId:b.P.providerId}),properties:{configuration:{columns:[{id:"column1",label:"No",isActive:!0,formatter:{componentType:h.aDR.lateLoadKey,properties:{dataFieldIds:{value:"position"}}}},{id:"column2",label:"Name",isActive:!0,formatter:{componentType:h.aDR.lateLoadKey,properties:{dataFieldIds:{value:"name"}}}},{id:"column3",label:"Location",isActive:!0,formatter:{componentType:h.s9y.lateLoadKey,properties:{dataFieldIds:{value:"firstUrlLabel",link:"firstUrl"}}}}],sorterConfiguration:{descendantSorting:!0,sortBy:"column1"},hasVirtualScroll:!0}}}})}];function L(e,t){if(1&e&&(W.TgZ(0,"div",3),W.TgZ(1,"div",4),W._uU(2),W.qZA(),W.qZA()),2&e){var i=t.item;W.xp6(2),W.hij(" ",i.title," ")}}var U,Z=((U=function(){function e(t){o(this,e),this.widgetTypesService=t,this.widgetSelected=new W.vpe,this.widgetItems=[]}return d(e,[{key:"ngOnInit",value:function(){var e=this,t=new x.rS;this.widgetItems=E.map(function(i){return console.log(i),{title:t.transform(i.type),widget:e.widgetTypesService.mergeWithWidgetType(i)}}),this.onSelect([this.widgetItems[0]]),E.forEach(function(t){e.addUnconfiguredWidgetWithConfigLayer(t)})}},{key:"addUnconfiguredWidgetWithConfigLayer",value:function(e){var t=(new x.rS).transform(e.type);this.widgetItems.push({title:"Unconfigured ".concat(t," With Config Layer"),widget:Object.assign(Object.assign({},P()(this.widgetTypesService.mergeWithWidgetType(e))),{id:"unconfiguredWithConfigLayer".concat(t),metadata:{needsConfiguration:!0}})}),A()(this.widgetItems[this.widgetItems.length-1].widget.pizzagna,"".concat(h.xW5.Configuration,".header.properties.title"),"Unconfigured ".concat(t," With Config Layer"))}},{key:"onSelect",value:function(e){this.widgetSelected.emit(e[0].widget),this.widgetSelection=e}}]),e}()).lateLoadKey="AcmeCloneSelectionComponent",U.\u0275fac=function(e){return new(e||U)(W.Y36(h.xTe))},U.\u0275cmp=W.Xpm({type:U,selectors:[["acme-clone-selection"]],outputs:{widgetSelected:"widgetSelected"},decls:4,vars:3,consts:[[1,"nui-widget-cloner"],["selectionMode","singleWithRequiredSelection",3,"itemsSource","selection","repeatItemTemplateRef","selectionChange"],["widgetClonerItem",""],[1,"nui-widget-cloner__item","d-flex","pt-2","pb-2","align-items-center"],[1,"text-info","ml-3"]],template:function(e,t){if(1&e&&(W.TgZ(0,"div",0),W.TgZ(1,"nui-repeat",1),W.NdJ("selectionChange",function(e){return t.onSelect(e)}),W.qZA(),W.qZA(),W.YNc(2,L,3,1,"ng-template",null,2,W.W1O)),2&e){var i=W.MAs(3);W.xp6(1),W.Q6J("itemsSource",t.widgetItems)("selection",t.widgetSelection)("repeatItemTemplateRef",i)}},directives:[v.$N6],styles:[".nui-widget-cloner__item[_ngcontent-%COMP%]{height:60px}"]}),U),F=function(){var i=d(function i(n){var d=this;o(this,i),this.toastService=n,this.allowSubmit=!0,this.allowRemoval=!0,this.trySubmit=function(t){var i=new I.xQ;return setTimeout(function(){if(d.allowSubmit)i.next(t);else{var o=$localize(e||(e=r(["Submit failed."])));d.toastService.error({title:o}),i.error(o)}},1e3),i.asObservable()},this.tryRemove=function(e){var i=new I.xQ;return setTimeout(function(){if(d.allowRemoval)i.next(e);else{var o=$localize(t||(t=r(["Widget removal failed."])));d.toastService.error({title:o}),i.error(o)}},200),i.asObservable()},this.toastService.setConfig({timeOut:2e3})});return i.\u0275fac=function(e){return new(e||i)(W.LFG(v.klp))},i.\u0275prov=W.Yz7({token:i,factory:i.\u0275fac}),i}(),R=l(5457),_=l(46276),j=l(54607),G=[{path:"",component:function(){var e=function(){function e(t,i,r,n,d){var a;o(this,e),this.providerRegistry=t,this.submitHandler=i,this.themeSwitcherService=r,this.widgetTypesService=n,this.widgetClonerService=d,this.destroy$=new I.xQ,this.dashboard={positions:{},widgets:{}},this.gridsterConfig={minCols:12,maxCols:12,minRows:12},this.editMode=!1,this.dsError=!1,this.providerRegistry.setProviders((s(a={},m.Of.providerId,{provide:h.Fk3,useClass:m.Of,deps:[]}),s(a,m.v8.providerId,{provide:h.Fk3,useClass:m.v8,deps:[]}),s(a,w.U8.providerId,{provide:h.Fk3,useClass:w.U8,deps:[]}),s(a,w.DU.providerId,{provide:h.Fk3,useClass:w.DU,deps:[]}),s(a,w.An.providerId,{provide:h.Fk3,useClass:w.An,deps:[]}),s(a,b.P.providerId,{provide:h.Fk3,useClass:b.P,deps:[v.oDG,h.nYw]}),s(a,b.B.providerId,{provide:h.Fk3,useClass:b.B,deps:[v.oDG,h.nYw]}),s(a,y.GS.providerId,{provide:h.Fk3,useClass:y.GS,deps:[]}),s(a,y.mx.providerId,{provide:h.Fk3,useClass:y.mx,deps:[]}),a))}return d(e,[{key:"ngOnInit",value:function(){var e=this,t=E.map(function(t){return Object.assign(Object.assign({},t),{pizzagna:Object.assign(Object.assign({},e.widgetTypesService.getWidgetType(t.type,t.version).widget),t.pizzagna)})}),i=S()(t,function(e){return e.id});this.dashboard={positions:z,widgets:i}}},{key:"onDsErrorChange",value:function(e){m.Of.mockError=e,y.GS.mockError=e,b.P.mockError=e,w.DU.mockError=e}},{key:"onCloneWidget",value:function(){this.widgetClonerService.open({dashboardComponent:this.dashboardComponent,trySubmit:this.submitHandler.trySubmit,widgetSelectionComponentType:Z}).pipe((0,k.q)(1),(0,T.R)(this.destroy$)).subscribe()}},{key:"ngOnDestroy",value:function(){this.destroy$.next(),this.destroy$.complete()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(W.Y36(h.CNH),W.Y36(F),W.Y36(v.ERq),W.Y36(h.xTe),W.Y36(h.$Ie))},e.\u0275cmp=W.Xpm({type:e,selectors:[["acme-dashboard"]],viewQuery:function(e,t){var i;(1&e&&W.Gf(h.MXM,7),2&e)&&(W.iGM(i=W.CRH())&&(t.dashboardComponent=i.first))},features:[W._Bn([F])],decls:5,vars:6,consts:function(){return[["type","button","nui-button","",1,"mb-3","ml-4","nui-widget-cloner-test-button",3,"click"],$localize(i||(i=r([":\u241f08a1b409eac8269dd4dce8a2b3bd976356ba40ee\u241f7260316479095556147:Create Widget Clone"]))),[3,"editMode","dsError","editModeChange","dsErrorChange"],[1,"dashboard"],[3,"nuiWidgetEditor","dashboard","gridsterConfig","editMode","dashboardChange","gridsterConfigChange"]]},template:function(e,t){1&e&&(W.TgZ(0,"button",0),W.NdJ("click",function(){return t.onCloneWidget()}),W.SDv(1,1),W.qZA(),W.TgZ(2,"dashboard-test-harness",2),W.NdJ("editModeChange",function(e){return t.editMode=e})("dsErrorChange",function(e){return t.onDsErrorChange(e)}),W.TgZ(3,"div",3),W.TgZ(4,"nui-dashboard",4),W.NdJ("dashboardChange",function(e){return t.dashboard=e})("gridsterConfigChange",function(e){return t.gridsterConfig=e}),W.qZA(),W.qZA(),W.qZA()),2&e&&(W.xp6(2),W.Q6J("editMode",t.editMode)("dsError",t.dsError),W.xp6(2),W.Q6J("nuiWidgetEditor",t.submitHandler)("dashboard",t.dashboard)("gridsterConfig",t.gridsterConfig)("editMode",t.editMode))},directives:[v.r0F,R.W,_.M,j.t],styles:[".dashboard[_ngcontent-%COMP%]{height:725px;width:1000px}"]}),e}(),data:{srlc:{hideIndicator:!0}}}],q=function(){var e=function(){function e(t){var i;o(this,e),this.widgetTypesService=t,null===(i=this.widgetTypesService.getWidgetType("proportional",1).widget.structure[h.XMI].providers)||void 0===i||delete i.refresher,this.setDataSourceProviders("table",[b.P.providerId,b.B.providerId]),this.setDataSourceProviders("kpi",[m.Of.providerId,m.v8.providerId]),this.setDataSourceProviders("proportional",[w.U8.providerId,w.DU.providerId,w.An.providerId]),this.setDataSourceProviders("timeseries",[y.GS.providerId,y.mx.providerId])}return d(e,[{key:"setDataSourceProviders",value:function(e,t){var i=this.widgetTypesService.getWidgetType(e,1);this.widgetTypesService.setNode(i,"configurator",h.ACc.DataSourceProviders,t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(W.LFG(h.xTe))},e.\u0275mod=W.oAB({type:e}),e.\u0275inj=W.cJS({providers:[h.CNH],imports:[[f.o,h.Pi,v.Gsl,v.Az_,v.vvu,v.cJ5,v.Ts3,v.ZuS,g.Bz.forChild(G)]]}),e}()}}])}();