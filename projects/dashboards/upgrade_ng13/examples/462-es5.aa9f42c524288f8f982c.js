!function(){"use strict";var e,t,i,n,r,o;function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var i,n=d(e);if(t){var r=d(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return c(this,i)}}function c(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function p(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t,i){return t&&h(e.prototype,t),i&&h(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}(self.webpackChunk_nova_ui_dashboards=self.webpackChunk_nova_ui_dashboards||[]).push([[462],{6462:function(s,c,d){var h,m;d.r(c),d.d(c,{WidgetCreationModule:function(){return Q}});var v=d(38583),w=d(91841),b=d(99763),y=d(46806),Z=d(69063),T=d(33018),_=d(64762),S=d(79765),k=d(26215),A=d(15257),C=d(46782),q=d(68939),U=d(46276),x=d(54607);function I(e,t){if(1&e&&(T.TgZ(0,"div",3),T.TgZ(1,"div",4),T._uU(2),T.qZA(),T.qZA()),2&e){var i=t.item;T.xp6(2),T.Oqu(i.name)}}var W,M=".dashboard[_ngcontent-%COMP%]{height:800px}.nui-widget-cloner__item[_ngcontent-%COMP%]{height:60px}",R=((W=function(){function e(t){g(this,e),this.widgetTypesService=t,this.widgetSelected=new T.vpe,this.widgetItems=[]}return f(e,[{key:"ngOnInit",value:function(){this.widgetItems=[{name:"Fully Configured KPI Widget",widget:this.widgetTypesService.mergeWithWidgetType(N)},{name:"Unconfigured Proportional Widget",widget:this.widgetTypesService.mergeWithWidgetType(F)}]}},{key:"onSelect",value:function(e){this.widgetSelected.emit(e[0].widget),this.widgetSelection=e}}]),e}()).\u0275fac=function(e){return new(e||W)(T.Y36(Z.xTe))},W.\u0275cmp=T.Xpm({type:W,selectors:[["widget-template-selection"]],outputs:{widgetSelected:"widgetSelected"},decls:4,vars:3,consts:[[1,"nui-widget-cloner"],["selectionMode","singleWithRequiredSelection",3,"itemsSource","selection","repeatItemTemplateRef","selectionChange"],["widgetClonerItem",""],[1,"nui-widget-cloner__item","d-flex","pt-2","pb-2","align-items-center"],[1,"text-info","ml-3"]],template:function(e,t){if(1&e&&(T.TgZ(0,"div",0),T.TgZ(1,"nui-repeat",1),T.NdJ("selectionChange",function(e){return t.onSelect(e)}),T.qZA(),T.qZA(),T.YNc(2,I,3,1,"ng-template",null,2,T.W1O)),2&e){var i=T.MAs(3);T.xp6(1),T.Q6J("itemsSource",t.widgetItems)("selection",t.widgetSelection)("repeatItemTemplateRef",i)}},directives:[y.$N6],styles:[M]}),W),O=function(){var r=f(function r(o){var a=this;g(this,r),this.toastService=o,this.persistenceSucceeded=!0,this.trySubmit=function(i){var n=new S.xQ;return i.id||(i.id=(0,y.VjN)()),setTimeout(function(){if(a.persistenceSucceeded)n.next(i),a.toastService.success({title:$localize(e||(e=p(["Submit succeeded."])))});else{var r=$localize(t||(t=p(["Submit failed."])));a.toastService.error({title:r}),n.error(r)}n.complete()},1e3),n.asObservable()},this.tryRemove=function(e){var t=new S.xQ;return setTimeout(function(){if(a.persistenceSucceeded)t.next(e),a.toastService.success({title:$localize(i||(i=p(["Removal success"])))});else{var r=$localize(n||(n=p(["Removal failed."])));a.toastService.error({title:r}),t.error(r)}t.complete()},1e3),t.asObservable()},this.toastService.setConfig({timeOut:2e3})});return r.\u0275fac=function(e){return new(e||r)(T.LFG(y.klp))},r.\u0275prov=T.Yz7({token:r,factory:r.\u0275fac}),r}(),P=function(){var e=function(){function e(t,i,n,r){g(this,e),this.widgetTypesService=t,this.providerRegistry=i,this.persistenceHandler=n,this.widgetClonerService=r,this.gridsterConfig={defaultItemCols:3,defaultItemRows:5},this.editMode=!1,this.destroy$=new S.xQ}return f(e,[{key:"ngOnInit",value:function(){var e,t=this.widgetTypesService.getWidgetType("kpi",1),i=this.widgetTypesService.getWidgetType("proportional",1);this.widgetTypesService.setNode(i,"configurator",Z.ACc.DataSourceProviders,[D.providerId]),this.widgetTypesService.setNode(t,"configurator",Z.ACc.DataSourceProviders,[j.providerId,z.providerId]),this.providerRegistry.setProviders((l(e={},j.providerId,{provide:Z.Fk3,useClass:j,deps:[w.eN]}),l(e,z.providerId,{provide:Z.Fk3,useClass:z,deps:[w.eN]}),l(e,D.providerId,{provide:Z.Fk3,useClass:D,deps:[]}),e)),this.initializeDashboard()}},{key:"onCreateWidget",value:function(){this.widgetClonerService.open({dashboardComponent:this.dashboardComponent,trySubmit:this.persistenceHandler.trySubmit,widgetSelectionComponentType:R}).pipe((0,A.q)(1),(0,C.R)(this.destroy$)).subscribe()}},{key:"initializeDashboard",value:function(){var e=N,t=l({},e.id,this.widgetTypesService.mergeWithWidgetType(e));this.dashboard={positions:l({},e.id,{cols:3,rows:5,y:0,x:0}),widgets:t}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(T.Y36(Z.xTe),T.Y36(Z.CNH),T.Y36(O),T.Y36(Z.$Ie))},e.\u0275cmp=T.Xpm({type:e,selectors:[["widget-creation"]],viewQuery:function(e,t){var i;(1&e&&T.Gf(Z.MXM,7),2&e)&&(T.iGM(i=T.CRH())&&(t.dashboardComponent=i.first))},features:[T._Bn([O])],decls:7,vars:5,consts:function(){return[[1,"my-3","d-flex","align-items-center"],[1,"ml-3",3,"value","valueChange"],$localize(r||(r=p([":\u241f8c375764db42f5d736fb56d01b8052c006ccc8e2\u241f6407712033679505505:Edit Mode"]))),["type","button","nui-button","",1,"ml-4",3,"click"],$localize(o||(o=p([":\u241f1af9862ac515933a9a72e92970c3e92bda63f6e8\u241f8076137290276236439:Create Widget"]))),[1,"w-100","dashboard"],[3,"dashboard","gridsterConfig","editMode","nuiWidgetEditor","dashboardChange","gridsterConfigChange"]]},template:function(e,t){1&e&&(T.TgZ(0,"div",0),T.TgZ(1,"nui-switch",1),T.NdJ("valueChange",function(e){return t.editMode=e}),T.SDv(2,2),T.qZA(),T.TgZ(3,"button",3),T.NdJ("click",function(){return t.onCreateWidget()}),T.SDv(4,4),T.qZA(),T.qZA(),T.TgZ(5,"div",5),T.TgZ(6,"nui-dashboard",6),T.NdJ("dashboardChange",function(e){return t.dashboard=e})("gridsterConfigChange",function(e){return t.gridsterConfig=e}),T.qZA(),T.qZA()),2&e&&(T.xp6(1),T.Q6J("value",t.editMode),T.xp6(5),T.Q6J("dashboard",t.dashboard)("gridsterConfig",t.gridsterConfig)("editMode",t.editMode)("nuiWidgetEditor",t.persistenceHandler))},directives:[y.qUD,y.r0F,U.M,x.t],styles:[M]}),e}(),D=function(){var e=function(){function e(){g(this,e),this.outputsSubject=new S.xQ}return f(e,[{key:"applyFilters",value:function(){var e=this;setTimeout(function(){e.outputsSubject.next({result:e.getRandomProportionalWidgetData()})},1e3)}},{key:"ngOnDestroy",value:function(){this.outputsSubject.complete()}},{key:"getRandomProportionalWidgetData",value:function(){return[{id:"Down",name:"Down",data:[Math.round(100*Math.random())],icon:"status_down",link:"https://en.wikipedia.org/wiki/Brno",value:"Brno"},{id:"Critical",name:"Critical",data:[Math.round(100*Math.random())],icon:"status_critical",link:"https://en.wikipedia.org/wiki/Kyiv",value:"Kyiv"},{id:"Warning",name:"Warning",data:[Math.round(100*Math.random())],icon:"status_warning",link:"https://en.wikipedia.org/wiki/Austin",value:"Austin"},{id:"Unknown",name:"Unknown",data:[Math.round(100*Math.random())],icon:"status_unknown",link:"https://en.wikipedia.org/wiki/Lisbon",value:"Lisbon"},{id:"Up",name:"Up",data:[Math.round(100*Math.random())],icon:"status_up",link:"https://en.wikipedia.org/wiki/Sydney",value:"Sydney"},{id:"Unmanaged",name:"Unmanaged",data:[Math.round(100*Math.random())],icon:"status_unmanaged",link:"https://en.wikipedia.org/wiki/Nur-Sultan",value:"Nur-Sultan"}]}}]),e}();return e.providerId="RandomCitiesProportionalDataSource",e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=T.Yz7({token:e,factory:e.\u0275fac}),e}(),j=function(){var e=function(e){a(i,e);var t=u(i);function i(e){var n;return g(this,i),(n=t.call(this)).http=e,n.busy=new k.X(!1),n}return f(i,[{key:"getFilteredData",value:function(){return(0,_.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.busy.next(!0),new Promise(function(e){t.http.get("https://www.googleapis.com/books/v1/volumes/5MQFrgEACAAJ").pipe((0,q.x)(function(){return t.busy.next(!1)})).subscribe({next:function(t){e({result:{value:t.volumeInfo.averageRating}})},error:function(t){e({result:null,error:{type:t.status}})}})})));case 1:case"end":return e.stop()}},e,this)}))}},{key:"ngOnDestroy",value:function(){this.outputsSubject.complete()}}]),i}(y.LvN);return e.providerId="AverageRatingKpiDataSource",e.\u0275fac=function(t){return new(t||e)(T.LFG(w.eN))},e.\u0275prov=T.Yz7({token:e,factory:e.\u0275fac}),e}(),z=function(){var e=function(e){a(i,e);var t=u(i);function i(e){var n;return g(this,i),(n=t.call(this)).http=e,n.busy=new k.X(!1),n}return f(i,[{key:"getFilteredData",value:function(){return(0,_.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.busy.next(!0),new Promise(function(e){t.http.get("https://www.googleapis.com/books/v1/volumes/5MQFrgEACAAJ").pipe((0,q.x)(function(){return t.busy.next(!1)})).subscribe({next:function(t){e({result:{value:t.volumeInfo.ratingsCount}})},error:function(t){e({result:null,error:{type:t.status}})}})})));case 1:case"end":return e.stop()}},e,this)}))}},{key:"ngOnDestroy",value:function(){this.outputsSubject.complete()}}]),i}(y.LvN);return e.providerId="RatingsCountKpiDataSource",e.\u0275fac=function(t){return new(t||e)(T.LFG(w.eN))},e.\u0275prov=T.Yz7({token:e,factory:e.\u0275fac}),e}(),N={id:"widget1",type:"kpi",pizzagna:l({},Z.xW5.Configuration,(m={},l(m,Z.XMI,{providers:l({},Z.Muk.Refresher,{properties:{interval:600,enabled:!0}})}),l(m,"header",{properties:{title:"Harry Potter and the Sorcerer's Stone",subtitle:"By J. K. Rowling"}}),l(m,"tiles",{properties:{nodes:["kpi1"]}}),l(m,"kpi1",{id:"kpi1",componentType:Z.ufE.lateLoadKey,properties:{widgetData:{units:"out of 5 Stars",label:"Average Rating"}},providers:(h={},l(h,Z.Muk.DataSource,{providerId:j.providerId}),l(h,Z.Muk.Adapter,{providerId:Z.u1$,properties:{componentId:"kpi1",propertyPath:"widgetData"}}),h)}),m))},F={id:"widget2",type:"proportional",metadata:{needsConfiguration:!0},pizzagna:l({},Z.xW5.Configuration,{header:{properties:{title:"*New Proportional Widget*"}}})},J=[{path:"",component:function(){var e=f(function e(){g(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=T.Xpm({type:e,selectors:[["nui-dashboard-widget-creation-docs"]],decls:87,vars:3,consts:[["href","../injectables/ProviderRegistryService.html","target","_blank"],["href","../injectables/WidgetClonerService.html","target","_blank"],["href","../additional-documentation/getting-started.html","target","_parent"],["href","../interfaces/IWidgetTemplateSelector.html","target","_blank"],["href","../interfaces/IWidgetMetadata.html#needsConfiguration","target","_blank"],["type","info",3,"allowDismiss"],["href","../interfaces/IWidgetSelector.html","target","_blank"],["href","../injectables/WidgetClonerService.html#open","target","_blank"],["filenamePrefix","widget-creation.component","exampleTitle","Widget Creation"]],template:function(e,t){1&e&&(T.TgZ(0,"h1"),T._uU(1,"Widget Creation"),T.qZA(),T.TgZ(2,"p"),T._uU(3," In this tutorial we'll cover how to add a widget creation wizard which allows end-users to create new widget instances based on existing widget configurations. The wizard's first step, or page, will use a custom component that lets users choose a widget to create. In the example below we'll implement a sample widget selection component that provides a proportional widget and a kpi widget as options.\n"),T.qZA(),T.TgZ(4,"h2"),T._uU(5,"Fundamental Concepts"),T.qZA(),T.TgZ(6,"ul"),T.TgZ(7,"li"),T.TgZ(8,"a",0),T.TgZ(9,"code"),T._uU(10,"ProviderRegistryService"),T.qZA(),T.qZA(),T.qZA(),T.TgZ(11,"li"),T.TgZ(12,"a",1),T.TgZ(13,"code"),T._uU(14,"WidgetClonerService"),T.qZA(),T.qZA(),T.qZA(),T.TgZ(15,"li"),T._uU(16,"Widget configurations"),T.qZA(),T.TgZ(17,"li"),T._uU(18,"Custom component for widget selection"),T.qZA(),T.qZA(),T.TgZ(19,"h2"),T._uU(20,"Basic Steps"),T.qZA(),T.TgZ(21,"ol"),T.TgZ(22,"li"),T._uU(23," Follow the instructions "),T.TgZ(24,"a",2),T._uU(25,"here"),T.qZA(),T._uU(26," to set up your environment for dashboard development. "),T.qZA(),T.TgZ(27,"li"),T._uU(28," Follow the instructions from previous tutorials to get a basic dashboard up and running. "),T.qZA(),T.TgZ(29,"li"),T._uU(30," Create a widget template selector component which will act as the first step in the wizard. The selector component should implement the "),T.TgZ(31,"a",3),T.TgZ(32,"code"),T._uU(33,"IWidgetTemplateSelector"),T.qZA(),T.qZA(),T._uU(34," interface which requires a widgetSelected output that should emit a widget to be cloned. For any widgets that require further configuration before they should be placed on the dashboard, set the widget's "),T.TgZ(35,"code"),T.TgZ(36,"a",4),T._uU(37,"metadata.needsConfiguration"),T.qZA(),T.qZA(),T._uU(38," property to "),T.TgZ(39,"code"),T._uU(40,"true"),T.qZA(),T._uU(41,'. This will hide the "Create Widget" button whenever an unconfigured widget is selected. '),T.TgZ(42,"nui-message",5),T.TgZ(43,"strong"),T._uU(44,"Note:"),T.qZA(),T._uU(45," In the example below, the widget selector is implemented in the same file as the dashboard component, but it's recommended to define it in a separate file. Additionally, after implementing it, remember to add it to your module declarations. "),T.qZA(),T.qZA(),T.TgZ(46,"li"),T._uU(47," Ensure that "),T.TgZ(48,"code"),T._uU(49,"NuiRepeatModule"),T.qZA(),T._uU(50," and "),T.TgZ(51,"code"),T._uU(52,"NuiImageModule"),T.qZA(),T._uU(53," are included in the imports of the widget template selector component's parent module. "),T.TgZ(54,"nui-message",5),T.TgZ(55,"strong"),T._uU(56,"Note:"),T.qZA(),T._uU(57," Importing these modules is required in this example because, in this case, the widget template selector uses the Nova repeat component and a couple of images from the Nova image repository. "),T.qZA(),T.qZA(),T.TgZ(58,"li"),T._uU(59," Invoke the "),T.TgZ(60,"code"),T._uU(61,"open"),T.qZA(),T._uU(62," method on the "),T.TgZ(63,"a",1),T.TgZ(64,"code"),T._uU(65,"WidgetClonerService"),T.qZA(),T.qZA(),T._uU(66," with an argument of type "),T.TgZ(67,"a",6),T.TgZ(68,"code"),T._uU(69,"IWidgetSelector"),T.qZA(),T.qZA(),T._uU(70,". Only two things are required in that object: a reference to the dashboardComponent instance and the typename of the widget selector created in the previous step. Optionally, the argument object may also contain a "),T.TgZ(71,"code"),T._uU(72,"trySubmit"),T.qZA(),T._uU(73," function with logic for persisting the new widget on a backend. "),T.qZA(),T.TgZ(74,"li"),T._uU(75," Subscribe to the "),T.TgZ(76,"code"),T._uU(77,"Observable"),T.qZA(),T._uU(78," returned by the "),T.TgZ(79,"a",7),T.TgZ(80,"code"),T._uU(81,"widgetClonerService.open"),T.qZA(),T.qZA(),T._uU(82," method in order to activate the handling of form submission and the subsequent updating of the dashboard with a newly created widget. "),T.qZA(),T.qZA(),T.TgZ(83,"nui-message",5),T._uU(84," For more detailed information about widget creation, take a look at the inline comments under the source expander of the following example.\n"),T.qZA(),T.TgZ(85,"nui-example-wrapper",8),T._UZ(86,"widget-creation"),T.qZA()),2&e&&(T.xp6(42),T.Q6J("allowDismiss",!1),T.xp6(12),T.Q6J("allowDismiss",!1),T.xp6(29),T.Q6J("allowDismiss",!1))},directives:[y.qqZ,y.hD2,P],encapsulation:2}),e}(),data:{srlc:{hideIndicator:!0},showThemeSwitcher:!0}},{path:"example",component:P,data:{srlc:{hideIndicator:!0}}}],Q=function(){var e=f(function e(){g(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=T.oAB({type:e}),e.\u0275inj=T.cJS({imports:[[v.ez,w.JF,Z.Pi,y.vvu,y.gkT,y.cJ5,y.tez,y.Az_,y.ZuS,y.sF0,b.Bz.forChild(J)]]}),e}()}}])}();