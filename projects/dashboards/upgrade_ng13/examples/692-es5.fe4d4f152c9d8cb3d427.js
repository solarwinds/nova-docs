!function(){"use strict";var e,t,i,n,r,o,a,s,c,u,d,l;function f(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function g(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==i)return;var n,r,o=[],a=!0,s=!1;try{for(i=i.call(e);!(a=(n=i.next()).done)&&(o.push(n.value),!t||o.length!==t);a=!0);}catch(c){s=!0,r=c}finally{try{a||null==i.return||i.return()}finally{if(s)throw r}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return h(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e,t,i){return t&&m(e.prototype,t),i&&m(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var i,n=T(e);if(t){var r=T(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return C(this,i)}}function C(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(self.webpackChunk_nova_ui_dashboards=self.webpackChunk_nova_ui_dashboards||[]).push([[692],{55692:function(h,m,w){w.r(m),w.d(m,{ManyWidgetsModule:function(){return ce}});var C,T=w(38583),I=w(91841),x=w(99763),k=w(46806),Z=w(69063),A=w(93877),W=w(40837),O=w(5596),R=w(33618),z=w(85631),D=w(6376),q=w(55350),_=w(55206),j=w(64762),M=w(26215),P=w(68939),J=w(33018),N=((C=function(e){b(i,e);var t=S(i);function i(e){var n;return v(this,i),(n=t.call(this)).http=e,n.busy=new M.X(!1),n}return y(i,[{key:"getFilteredData",value:function(){return(0,j.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.busy.next(!0),t=Math.floor(Math.random()*Math.floor(99))+1,e.abrupt("return",new Promise(function(e){i.http.get("https://jsonplaceholder.typicode.com/todos/".concat(t)).pipe((0,P.x)(function(){return i.busy.next(!1)})).subscribe({next:function(t){e({result:{value:t.id,label:t.title}})},error:function(t){e({result:null,error:{type:t.status}})}})}));case 3:case"end":return e.stop()}},e,this)}))}},{key:"ngOnDestroy",value:function(){this.outputsSubject.complete()}}]),i}(k.LvN)).providerId="AcmeKpiDataSource",C.mockError=!1,C.\u0275fac=function(e){return new(e||C)(J.LFG(I.eN))},C.\u0275prov=J.Yz7({token:C,factory:C.\u0275fac}),C),L=w(59311),$=w.n(L),E=w(79765),Q=w(15257),Y=w(46782),B=w(37524),F=w.n(B),U=w(12666),H=w.n(U),K=function(e){var t;return{id:"".concat(e),type:"kpi",pizzagna:g({},Z.xW5.Configuration,{header:{properties:{title:"KPI Widget!",subtitle:"A bunch of number boxes",collapsible:!0}},tiles:{providers:{},properties:{nodes:["kpi1"]}},kpi1:{id:"kpi1",providers:(t={},g(t,Z.Muk.DataSource,{providerId:N.providerId}),g(t,Z.Muk.Adapter,{providerId:Z.u1$,properties:{componentId:"kpi1",propertyPath:"widgetData"}}),t)}})}},G=p(function(e){for(var t=[],i={},n={cols:8,rows:6,y:0,x:0},r=0;r<=15;r++){var o="widget".concat(r.toString()),a=K(o),s=i["widget".concat((r-1).toString())],c=s?Object.assign(Object.assign({},s),{y:s.y+6}):n;t.push(a),i[o]=c}return[t,i]}(),2),X=G[0],V=G[1];function ee(e,t){if(1&e&&(J.TgZ(0,"div",3),J.TgZ(1,"div",4),J._uU(2),J.qZA(),J.qZA()),2&e){var i=t.item;J.xp6(2),J.hij(" ",i.title," ")}}var te=function(){var e=function(){function e(t){v(this,e),this.widgetTypesService=t,this.widgetSelected=new J.vpe,this.widgetItems=[]}return y(e,[{key:"ngOnInit",value:function(){var e=this,t=new T.rS;this.widgetItems=X.map(function(i){return{title:t.transform(i.type),widget:e.widgetTypesService.mergeWithWidgetType(i)}}),X.forEach(function(t){e.addUnconfiguredWidgetWithConfigLayer(t)})}},{key:"addUnconfiguredWidget",value:function(e){var t=(new T.rS).transform(e);this.widgetItems.push({title:"Unconfigured ".concat(t),widget:{id:"unconfigured".concat(t),type:e,metadata:{needsConfiguration:!0},pizzagna:F()(this.widgetTypesService.getWidgetType(e).widget)}}),H()(this.widgetItems[this.widgetItems.length-1].widget.pizzagna,"".concat(Z.xW5.Structure,".header.properties.title"),"Unconfigured ".concat(t))}},{key:"addUnconfiguredWidgetWithConfigLayer",value:function(e){var t=(new T.rS).transform(e.type);this.widgetItems.push({title:"Unconfigured ".concat(t," With Config Layer"),widget:Object.assign(Object.assign({},F()(this.widgetTypesService.mergeWithWidgetType(e))),{id:"unconfiguredWithConfigLayer".concat(t),metadata:{needsConfiguration:!0}})}),H()(this.widgetItems[this.widgetItems.length-1].widget.pizzagna,"".concat(Z.xW5.Configuration,".header.properties.title"),"Unconfigured ".concat(t," With Config Layer"))}},{key:"onSelect",value:function(e){this.widgetSelected.emit(e[0].widget),this.widgetSelection=e}}]),e}();return e.lateLoadKey="AcmeCloneSelectionComponent",e.\u0275fac=function(t){return new(t||e)(J.Y36(Z.xTe))},e.\u0275cmp=J.Xpm({type:e,selectors:[["acme-clone-selection"]],outputs:{widgetSelected:"widgetSelected"},decls:4,vars:3,consts:[[1,"nui-widget-cloner"],["selectionMode","singleWithRequiredSelection",3,"itemsSource","selection","repeatItemTemplateRef","selectionChange"],["widgetClonerItem",""],[1,"nui-widget-cloner__item","d-flex","pt-2","pb-2","align-items-center"],[1,"text-info","ml-3"]],template:function(e,t){if(1&e&&(J.TgZ(0,"div",0),J.TgZ(1,"nui-repeat",1),J.NdJ("selectionChange",function(e){return t.onSelect(e)}),J.qZA(),J.qZA(),J.YNc(2,ee,3,1,"ng-template",null,2,J.W1O)),2&e){var i=J.MAs(3);J.xp6(1),J.Q6J("itemsSource",t.widgetItems)("selection",t.widgetSelection)("repeatItemTemplateRef",i)}},directives:[k.$N6],styles:[".nui-widget-cloner__item[_ngcontent-%COMP%]{height:60px}"]}),e}();function ie(e,t){if(1&e&&(J.TgZ(0,"div",3),J.TgZ(1,"div",4),J._uU(2),J.qZA(),J.qZA()),2&e){var i=t.item;J.xp6(2),J.hij(" ",i.title," ")}}var ne=function(){var e=function(e){b(i,e);var t=S(i);function i(e){return v(this,i),t.call(this,e)}return y(i,[{key:"ngOnInit",value:function(){var e=this,t=new T.rS;this.widgetItems=X.map(function(i){return{title:t.transform(i.type),widget:e.widgetTypesService.mergeWithWidgetType(i)}})}}]),i}(te);return e.lateLoadKey="AcmeCloneSelectionComponent",e.\u0275fac=function(t){return new(t||e)(J.Y36(Z.xTe))},e.\u0275cmp=J.Xpm({type:e,selectors:[["acme-clone-selection"]],features:[J.qOj],decls:4,vars:3,consts:[[1,"nui-widget-cloner"],["selectionMode","singleWithRequiredSelection",3,"itemsSource","selection","repeatItemTemplateRef","selectionChange"],["widgetClonerItem",""],[1,"nui-widget-cloner__item","d-flex","pt-2","pb-2","align-items-center"],[1,"text-info","ml-3"]],template:function(e,t){if(1&e&&(J.TgZ(0,"div",0),J.TgZ(1,"nui-repeat",1),J.NdJ("selectionChange",function(e){return t.onSelect(e)}),J.qZA(),J.qZA(),J.YNc(2,ie,3,1,"ng-template",null,2,J.W1O)),2&e){var i=J.MAs(3);J.xp6(1),J.Q6J("itemsSource",t.widgetItems)("selection",t.widgetSelection)("repeatItemTemplateRef",i)}},directives:[k.$N6],styles:[".nui-widget-cloner__item[_ngcontent-%COMP%]{height:60px}"]}),e}(),re=function(){var i=y(function i(n){var r=this;v(this,i),this.toastService=n,this.allowSubmit=!0,this.allowRemoval=!0,this.trySubmit=function(t,i){var n=new E.xQ;return setTimeout(function(){if(r.allowSubmit)n.next(t);else{var i=$localize(e||(e=f(["Submit failed."])));r.toastService.error({title:i}),n.error(i)}},1e3),n.asObservable()},this.tryRemove=function(e){var i=new E.xQ;return setTimeout(function(){if(r.allowRemoval)i.next(e);else{var n=$localize(t||(t=f(["Widget removal failed."])));r.toastService.error({title:n}),i.error(n)}},200),i.asObservable()},this.toastService.setConfig({timeOut:2e3})});return i.\u0275fac=function(e){return new(e||i)(J.LFG(k.klp))},i.\u0275prov=J.Yz7({token:i,factory:i.\u0275fac}),i}(),oe=w(46276),ae=w(54607),se=[{path:"",component:function(){var e=function(){function e(t,i,n,r,o){v(this,e),this.providerRegistry=t,this.submitHandler=i,this.widgetTypesService=n,this.widgetClonerService=r,this.refreshSettings=o,this.dashboard={positions:{},widgets:{}},this.gridsterConfig={minCols:12,maxCols:12,minRows:12},this.editMode=!1,this.systemRefreshInterval=60,this.belowFoldLazyLoadingConfig={enabled:!0},this.destroy$=new E.xQ,this.providerRegistry.setProviders(g({},N.providerId,{provide:Z.Fk3,useClass:N,deps:[I.eN]}))}return y(e,[{key:"ngOnInit",value:function(){var e,t,i=this;null===(t=null===(e=this.widgetTypesService.getWidgetType("table").configurator)||void 0===e?void 0:e[Z.xW5.Structure].presentation.properties)||void 0===t||t.nodes.push("refresher"),this.refreshSettings.refreshRateSeconds=this.systemRefreshInterval;var n=X.map(function(e){return i.widgetTypesService.mergeWithWidgetType(e)}),r=$()(n,function(e){return e.id});this.dashboard={positions:V,widgets:r}}},{key:"onDsErrorSwitch",value:function(e){N.mockError=e}},{key:"onShowButtonSwitch",value:function(e,t){for(var i=0,n=Object.keys(this.dashboard.widgets);i<n.length;i++){var r=n[i];this.dashboard=(0,k.zdu)(this.dashboard,"widgets.".concat(r,".pizzagna.configuration.header.properties.").concat(t),e)}}},{key:"ngAfterViewInit",value:function(){var e=this;this.dashboardComponent.eventBus.subscribeUntil(Z.MOJ,this.destroy$,function(t){e.widgetClonerService.open({widget:e.dashboard.widgets[t.widgetId],dashboardComponent:e.dashboardComponent,trySubmit:e.submitHandler.trySubmit,widgetSelectionComponentType:ne}).pipe((0,Q.q)(1),(0,Y.R)(e.destroy$)).subscribe()})}},{key:"onCloneWidget",value:function(){this.widgetClonerService.open({dashboardComponent:this.dashboardComponent,trySubmit:this.submitHandler.trySubmit,widgetSelectionComponentType:te}).pipe((0,Q.q)(1),(0,Y.R)(this.destroy$)).subscribe()}},{key:"onEditWithCloner",value:function(){this.dashboardComponent.eventBus.next(Z.MOJ,{widgetId:X[0].id})}},{key:"ngOnDestroy",value:function(){this.destroy$.next(),this.destroy$.complete()}},{key:"onSystemRefreshIntervalClick",value:function(){this.refreshSettings.refreshRateSeconds=this.systemRefreshInterval}}]),e}();return e.\u0275fac=function(t){return new(t||e)(J.Y36(Z.CNH),J.Y36(re),J.Y36(Z.xTe),J.Y36(Z.$Ie),J.Y36(Z.g4s))},e.\u0275cmp=J.Xpm({type:e,selectors:[["many-widgets-dashboard-dashboard"]],viewQuery:function(e,t){var i;(1&e&&J.Gf(Z.MXM,7),2&e)&&(J.iGM(i=J.CRH())&&(t.dashboardComponent=i.first))},features:[J._Bn([re])],decls:25,vars:11,consts:function(){return[["type","button","nui-button","",1,"mb-3","ml-4",3,"click"],$localize(i||(i=f([":\u241f08a1b409eac8269dd4dce8a2b3bd976356ba40ee\u241f7260316479095556147:Create Widget Clone"]))),$localize(n||(n=f([":\u241f4e17d1961186f54a679f7623cd03e5c49c411f65\u241f639090956363340116:Simulate edit with cloner"]))),[1,"w-100",2,"height","725px"],[3,"nuiWidgetEditor","dashboard","gridsterConfig","editMode","belowFoldLazyLoadingConfig","dashboardChange","gridsterConfigChange"],[1,"my-3","d-flex","align-items-center"],[1,"ml-3",3,"value","valueChange"],$localize(r||(r=f([":\u241fc0390f914462a77b0ab8e053abf7c77af5b1da81\u241f6640158718767573444: Edit mode "]))),$localize(o||(o=f([":\u241fdb70aaa4da7a9f7c0fa3a218907f9fa354a19038\u241f5855643886473775120: Allow Submit "]))),$localize(a||(a=f([":\u241fd289dfdc6c4e23b49a96db083f95f1087ed1400a\u241f3687117978364204872: Allow Removal "]))),$localize(s||(s=f([":\u241f3299af3b186d7701f4c0626e41eba58af8382723\u241f4106211393112768148: Show Edit Button "]))),$localize(c||(c=f([":\u241f30251ad3dcd7facd3a222d48fb2ba02f8503c52c\u241f8096484277280346189: Show Remove Button "]))),[1,"ml-3",3,"valueChange"],$localize(u||(u=f([":\u241fc355f0feb3f72b3594e6e975456cd0a2dac1d929\u241f870224976565315483: Data Source Error "]))),[1,"d-flex","flex-row"],[2,"width","300px"],["caption",$localize(d||(d=f([":\u241f90504d9af68fb3aa81accb4bc3005526deb04093\u241f5488473345097746222:System refresh interval (seconds)"])))],[3,"value","valueChange"],["type","button","nui-button","",1,"ml-4",3,"click"],$localize(l||(l=f([":\u241f4de55e520d95a021a3b6dcb94b34b5b2364abef8\u241f1472280137824054907:Update system refresh interval "])))]},template:function(e,t){1&e&&(J.TgZ(0,"button",0),J.NdJ("click",function(){return t.onCloneWidget()}),J.SDv(1,1),J.qZA(),J.TgZ(2,"button",0),J.NdJ("click",function(){return t.onEditWithCloner()}),J.SDv(3,2),J.qZA(),J.TgZ(4,"div",3),J.TgZ(5,"nui-dashboard",4),J.NdJ("dashboardChange",function(e){return t.dashboard=e})("gridsterConfigChange",function(e){return t.gridsterConfig=e}),J.qZA(),J.qZA(),J.TgZ(6,"div",5),J.TgZ(7,"nui-switch",6),J.NdJ("valueChange",function(e){return t.editMode=e}),J.SDv(8,7),J.qZA(),J.TgZ(9,"nui-switch",6),J.NdJ("valueChange",function(e){return t.submitHandler.allowSubmit=e}),J.SDv(10,8),J.qZA(),J.TgZ(11,"nui-switch",6),J.NdJ("valueChange",function(e){return t.submitHandler.allowRemoval=e}),J.SDv(12,9),J.qZA(),J.TgZ(13,"nui-switch",6),J.NdJ("valueChange",function(e){return t.onShowButtonSwitch(e,"editable")}),J.SDv(14,10),J.qZA(),J.TgZ(15,"nui-switch",6),J.NdJ("valueChange",function(e){return t.onShowButtonSwitch(e,"removable")}),J.SDv(16,11),J.qZA(),J.TgZ(17,"nui-switch",12),J.NdJ("valueChange",function(e){return t.onDsErrorSwitch(e)}),J.SDv(18,13),J.qZA(),J.qZA(),J.TgZ(19,"div",14),J.TgZ(20,"div",15),J.TgZ(21,"nui-form-field",16),J.TgZ(22,"nui-textbox-number",17),J.NdJ("valueChange",function(e){return t.systemRefreshInterval=e}),J.qZA(),J.qZA(),J.qZA(),J.TgZ(23,"button",18),J.NdJ("click",function(){return t.onSystemRefreshIntervalClick()}),J.SDv(24,19),J.qZA(),J.qZA()),2&e&&(J.xp6(5),J.Q6J("nuiWidgetEditor",t.submitHandler)("dashboard",t.dashboard)("gridsterConfig",t.gridsterConfig)("editMode",t.editMode)("belowFoldLazyLoadingConfig",t.belowFoldLazyLoadingConfig),J.xp6(2),J.Q6J("value",t.editMode),J.xp6(2),J.Q6J("value",t.submitHandler.allowSubmit),J.xp6(2),J.Q6J("value",t.submitHandler.allowRemoval),J.xp6(2),J.Q6J("value",!0),J.xp6(2),J.Q6J("value",!0),J.xp6(7),J.Q6J("value",t.systemRefreshInterval))},directives:[k.r0F,oe.M,ae.t,k.qUD,k.hgI,k.I5I],styles:[".nui-theme-switcher-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;padding:10px;background-color:#fff;background-color:var(--nui-color-bg-light,#fff)}"]}),e}(),data:{srlc:{hideIndicator:!0},showThemeSwitcher:!0}}],ce=function(){var e=function(){function e(t,i){v(this,e),this.widgetTypesService=t,this.componentRegistry=i,this.setupDataSourceProviders(),this.setupCustomProportionalWidgetDSConfig()}return y(e,[{key:"setupCustomProportionalWidgetDSConfig",value:function(){var e,t=this.widgetTypesService.getWidgetType("proportional",1);null===(e=t.widget.structure[Z.XMI].providers)||void 0===e||delete e.refresher,this.widgetTypesService.setNode(t,"configurator",Z.ACc.DataSourceConfigComponentType,A.b.lateLoadKey),this.componentRegistry.registerByLateLoadKey(A.b)}},{key:"setupDataSourceProviders",value:function(){this.setDataSourceProviders("table",[O.g.providerId,R.W.providerId,z.t.providerId,q.n.providerId,D.a.providerId]);var e=this.widgetTypesService.getWidgetType("kpi",1);this.widgetTypesService.setNode(e,"configurator",Z.ACc.DataSourceConfigComponentType,Z.cY_.lateLoadKey),this.setDataSourceProviders("kpi",[{providerId:N.providerId,label:"Acme KPI Data Source 1"}]),this.setDataSourceProviders("proportional",[W.Q.providerId,W.s.providerId]),this.setDataSourceProviders("timeseries",[_.wi.providerId,_.u2.providerId])}},{key:"setDataSourceProviders",value:function(e,t){var i=this.widgetTypesService.getWidgetType(e,1);this.widgetTypesService.setNode(i,"configurator",Z.ACc.DataSourceProviders,t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(J.LFG(Z.xTe),J.LFG(Z.hiK))},e.\u0275mod=J.oAB({type:e}),e.\u0275inj=J.cJS({providers:[Z.CNH],imports:[[T.ez,I.JF,Z.Pi,k.Gsl,k.Az_,k.vvu,k.cJ5,k.Ts3,k.sF0,k.ZuS,x.Bz.forChild(se),k.C6o,k.YMY]]}),e}()}}])}();