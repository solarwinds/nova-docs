"use strict";(self.webpackChunk_nova_ui_dashboards=self.webpackChunk_nova_ui_dashboards||[]).push([[462],{6462:function(e,t,i){i.r(t),i.d(t,{WidgetCreationModule:function(){return k}});var o=i(38583),n=i(91841),r=i(99763),a=i(46806),s=i(69063),d=i(33018),u=i(64762),c=i(79765),l=i(26215),g=i(15257),p=i(46782),h=i(68939),m=i(46276),w=i(54607);function f(e,t){if(1&e&&(d.TgZ(0,"div",3),d.TgZ(1,"div",4),d._uU(2),d.qZA(),d.qZA()),2&e){const e=t.item;d.xp6(2),d.Oqu(e.name)}}const v=".dashboard[_ngcontent-%COMP%]{height:800px}.nui-widget-cloner__item[_ngcontent-%COMP%]{height:60px}";let Z=(()=>{class e{constructor(e){this.widgetTypesService=e,this.widgetSelected=new d.vpe,this.widgetItems=[]}ngOnInit(){this.widgetItems=[{name:"Fully Configured KPI Widget",widget:this.widgetTypesService.mergeWithWidgetType(A)},{name:"Unconfigured Proportional Widget",widget:this.widgetTypesService.mergeWithWidgetType(C)}]}onSelect(e){this.widgetSelected.emit(e[0].widget),this.widgetSelection=e}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(s.xTe))},e.\u0275cmp=d.Xpm({type:e,selectors:[["widget-template-selection"]],outputs:{widgetSelected:"widgetSelected"},decls:4,vars:3,consts:[[1,"nui-widget-cloner"],["selectionMode","singleWithRequiredSelection",3,"itemsSource","selection","repeatItemTemplateRef","selectionChange"],["widgetClonerItem",""],[1,"nui-widget-cloner__item","d-flex","pt-2","pb-2","align-items-center"],[1,"text-info","ml-3"]],template:function(e,t){if(1&e&&(d.TgZ(0,"div",0),d.TgZ(1,"nui-repeat",1),d.NdJ("selectionChange",function(e){return t.onSelect(e)}),d.qZA(),d.qZA(),d.YNc(2,f,3,1,"ng-template",null,2,d.W1O)),2&e){const e=d.MAs(3);d.xp6(1),d.Q6J("itemsSource",t.widgetItems)("selection",t.widgetSelection)("repeatItemTemplateRef",e)}},directives:[a.$N6],styles:[v]}),e})(),b=(()=>{class e{constructor(e){this.toastService=e,this.persistenceSucceeded=!0,this.trySubmit=e=>{const t=new c.xQ;return e.id||(e.id=(0,a.VjN)()),setTimeout(()=>{if(this.persistenceSucceeded)t.next(e),this.toastService.success({title:$localize`Submit succeeded.`});else{const e=$localize`Submit failed.`;this.toastService.error({title:e}),t.error(e)}t.complete()},1e3),t.asObservable()},this.tryRemove=e=>{const t=new c.xQ;return setTimeout(()=>{if(this.persistenceSucceeded)t.next(e),this.toastService.success({title:$localize`Removal success`});else{const e=$localize`Removal failed.`;this.toastService.error({title:e}),t.error(e)}t.complete()},1e3),t.asObservable()},this.toastService.setConfig({timeOut:2e3})}}return e.\u0275fac=function(t){return new(t||e)(d.LFG(a.klp))},e.\u0275prov=d.Yz7({token:e,factory:e.\u0275fac}),e})(),T=(()=>{class e{constructor(e,t,i,o){this.widgetTypesService=e,this.providerRegistry=t,this.persistenceHandler=i,this.widgetClonerService=o,this.gridsterConfig={defaultItemCols:3,defaultItemRows:5},this.editMode=!1,this.destroy$=new c.xQ}ngOnInit(){const e=this.widgetTypesService.getWidgetType("kpi",1),t=this.widgetTypesService.getWidgetType("proportional",1);this.widgetTypesService.setNode(t,"configurator",s.ACc.DataSourceProviders,[y.providerId]),this.widgetTypesService.setNode(e,"configurator",s.ACc.DataSourceProviders,[S.providerId,_.providerId]),this.providerRegistry.setProviders({[S.providerId]:{provide:s.Fk3,useClass:S,deps:[n.eN]},[_.providerId]:{provide:s.Fk3,useClass:_,deps:[n.eN]},[y.providerId]:{provide:s.Fk3,useClass:y,deps:[]}}),this.initializeDashboard()}onCreateWidget(){this.widgetClonerService.open({dashboardComponent:this.dashboardComponent,trySubmit:this.persistenceHandler.trySubmit,widgetSelectionComponentType:Z}).pipe((0,g.q)(1),(0,p.R)(this.destroy$)).subscribe()}initializeDashboard(){const e=A,t={[e.id]:this.widgetTypesService.mergeWithWidgetType(e)};this.dashboard={positions:{[e.id]:{cols:3,rows:5,y:0,x:0}},widgets:t}}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(s.xTe),d.Y36(s.CNH),d.Y36(b),d.Y36(s.$Ie))},e.\u0275cmp=d.Xpm({type:e,selectors:[["widget-creation"]],viewQuery:function(e,t){if(1&e&&d.Gf(s.MXM,7),2&e){let e;d.iGM(e=d.CRH())&&(t.dashboardComponent=e.first)}},features:[d._Bn([b])],decls:7,vars:5,consts:function(){let e,t;return e=$localize`:␟8c375764db42f5d736fb56d01b8052c006ccc8e2␟6407712033679505505:Edit Mode`,t=$localize`:␟1af9862ac515933a9a72e92970c3e92bda63f6e8␟8076137290276236439:Create Widget`,[[1,"my-3","d-flex","align-items-center"],[1,"ml-3",3,"value","valueChange"],e,["type","button","nui-button","",1,"ml-4",3,"click"],t,[1,"w-100","dashboard"],[3,"dashboard","gridsterConfig","editMode","nuiWidgetEditor","dashboardChange","gridsterConfigChange"]]},template:function(e,t){1&e&&(d.TgZ(0,"div",0),d.TgZ(1,"nui-switch",1),d.NdJ("valueChange",function(e){return t.editMode=e}),d.SDv(2,2),d.qZA(),d.TgZ(3,"button",3),d.NdJ("click",function(){return t.onCreateWidget()}),d.SDv(4,4),d.qZA(),d.qZA(),d.TgZ(5,"div",5),d.TgZ(6,"nui-dashboard",6),d.NdJ("dashboardChange",function(e){return t.dashboard=e})("gridsterConfigChange",function(e){return t.gridsterConfig=e}),d.qZA(),d.qZA()),2&e&&(d.xp6(1),d.Q6J("value",t.editMode),d.xp6(5),d.Q6J("dashboard",t.dashboard)("gridsterConfig",t.gridsterConfig)("editMode",t.editMode)("nuiWidgetEditor",t.persistenceHandler))},directives:[a.qUD,a.r0F,m.M,w.t],styles:[v]}),e})(),y=(()=>{class e{constructor(){this.outputsSubject=new c.xQ}applyFilters(){setTimeout(()=>{this.outputsSubject.next({result:this.getRandomProportionalWidgetData()})},1e3)}ngOnDestroy(){this.outputsSubject.complete()}getRandomProportionalWidgetData(){return[{id:"Down",name:"Down",data:[Math.round(100*Math.random())],icon:"status_down",link:"https://en.wikipedia.org/wiki/Brno",value:"Brno"},{id:"Critical",name:"Critical",data:[Math.round(100*Math.random())],icon:"status_critical",link:"https://en.wikipedia.org/wiki/Kyiv",value:"Kyiv"},{id:"Warning",name:"Warning",data:[Math.round(100*Math.random())],icon:"status_warning",link:"https://en.wikipedia.org/wiki/Austin",value:"Austin"},{id:"Unknown",name:"Unknown",data:[Math.round(100*Math.random())],icon:"status_unknown",link:"https://en.wikipedia.org/wiki/Lisbon",value:"Lisbon"},{id:"Up",name:"Up",data:[Math.round(100*Math.random())],icon:"status_up",link:"https://en.wikipedia.org/wiki/Sydney",value:"Sydney"},{id:"Unmanaged",name:"Unmanaged",data:[Math.round(100*Math.random())],icon:"status_unmanaged",link:"https://en.wikipedia.org/wiki/Nur-Sultan",value:"Nur-Sultan"}]}}return e.providerId="RandomCitiesProportionalDataSource",e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=d.Yz7({token:e,factory:e.\u0275fac}),e})(),S=(()=>{class e extends a.LvN{constructor(e){super(),this.http=e,this.busy=new l.X(!1)}getFilteredData(){return(0,u.mG)(this,void 0,void 0,function*(){return this.busy.next(!0),new Promise(e=>{this.http.get("https://www.googleapis.com/books/v1/volumes/5MQFrgEACAAJ").pipe((0,h.x)(()=>this.busy.next(!1))).subscribe({next:t=>{e({result:{value:t.volumeInfo.averageRating}})},error:t=>{e({result:null,error:{type:t.status}})}})})})}ngOnDestroy(){this.outputsSubject.complete()}}return e.providerId="AverageRatingKpiDataSource",e.\u0275fac=function(t){return new(t||e)(d.LFG(n.eN))},e.\u0275prov=d.Yz7({token:e,factory:e.\u0275fac}),e})(),_=(()=>{class e extends a.LvN{constructor(e){super(),this.http=e,this.busy=new l.X(!1)}getFilteredData(){return(0,u.mG)(this,void 0,void 0,function*(){return this.busy.next(!0),new Promise(e=>{this.http.get("https://www.googleapis.com/books/v1/volumes/5MQFrgEACAAJ").pipe((0,h.x)(()=>this.busy.next(!1))).subscribe({next:t=>{e({result:{value:t.volumeInfo.ratingsCount}})},error:t=>{e({result:null,error:{type:t.status}})}})})})}ngOnDestroy(){this.outputsSubject.complete()}}return e.providerId="RatingsCountKpiDataSource",e.\u0275fac=function(t){return new(t||e)(d.LFG(n.eN))},e.\u0275prov=d.Yz7({token:e,factory:e.\u0275fac}),e})();const A={id:"widget1",type:"kpi",pizzagna:{[s.xW5.Configuration]:{[s.XMI]:{providers:{[s.Muk.Refresher]:{properties:{interval:600,enabled:!0}}}},header:{properties:{title:"Harry Potter and the Sorcerer's Stone",subtitle:"By J. K. Rowling"}},tiles:{properties:{nodes:["kpi1"]}},kpi1:{id:"kpi1",componentType:s.ufE.lateLoadKey,properties:{widgetData:{units:"out of 5 Stars",label:"Average Rating"}},providers:{[s.Muk.DataSource]:{providerId:S.providerId},[s.Muk.Adapter]:{providerId:s.u1$,properties:{componentId:"kpi1",propertyPath:"widgetData"}}}}}}},C={id:"widget2",type:"proportional",metadata:{needsConfiguration:!0},pizzagna:{[s.xW5.Configuration]:{header:{properties:{title:"*New Proportional Widget*"}}}}},q=[{path:"",component:(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=d.Xpm({type:e,selectors:[["nui-dashboard-widget-creation-docs"]],decls:87,vars:3,consts:[["href","../injectables/ProviderRegistryService.html","target","_blank"],["href","../injectables/WidgetClonerService.html","target","_blank"],["href","../additional-documentation/getting-started.html","target","_parent"],["href","../interfaces/IWidgetTemplateSelector.html","target","_blank"],["href","../interfaces/IWidgetMetadata.html#needsConfiguration","target","_blank"],["type","info",3,"allowDismiss"],["href","../interfaces/IWidgetSelector.html","target","_blank"],["href","../injectables/WidgetClonerService.html#open","target","_blank"],["filenamePrefix","widget-creation.component","exampleTitle","Widget Creation"]],template:function(e,t){1&e&&(d.TgZ(0,"h1"),d._uU(1,"Widget Creation"),d.qZA(),d.TgZ(2,"p"),d._uU(3," In this tutorial we'll cover how to add a widget creation wizard which allows end-users to create new widget instances based on existing widget configurations. The wizard's first step, or page, will use a custom component that lets users choose a widget to create. In the example below we'll implement a sample widget selection component that provides a proportional widget and a kpi widget as options.\n"),d.qZA(),d.TgZ(4,"h2"),d._uU(5,"Fundamental Concepts"),d.qZA(),d.TgZ(6,"ul"),d.TgZ(7,"li"),d.TgZ(8,"a",0),d.TgZ(9,"code"),d._uU(10,"ProviderRegistryService"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(11,"li"),d.TgZ(12,"a",1),d.TgZ(13,"code"),d._uU(14,"WidgetClonerService"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(15,"li"),d._uU(16,"Widget configurations"),d.qZA(),d.TgZ(17,"li"),d._uU(18,"Custom component for widget selection"),d.qZA(),d.qZA(),d.TgZ(19,"h2"),d._uU(20,"Basic Steps"),d.qZA(),d.TgZ(21,"ol"),d.TgZ(22,"li"),d._uU(23," Follow the instructions "),d.TgZ(24,"a",2),d._uU(25,"here"),d.qZA(),d._uU(26," to set up your environment for dashboard development. "),d.qZA(),d.TgZ(27,"li"),d._uU(28," Follow the instructions from previous tutorials to get a basic dashboard up and running. "),d.qZA(),d.TgZ(29,"li"),d._uU(30," Create a widget template selector component which will act as the first step in the wizard. The selector component should implement the "),d.TgZ(31,"a",3),d.TgZ(32,"code"),d._uU(33,"IWidgetTemplateSelector"),d.qZA(),d.qZA(),d._uU(34," interface which requires a widgetSelected output that should emit a widget to be cloned. For any widgets that require further configuration before they should be placed on the dashboard, set the widget's "),d.TgZ(35,"code"),d.TgZ(36,"a",4),d._uU(37,"metadata.needsConfiguration"),d.qZA(),d.qZA(),d._uU(38," property to "),d.TgZ(39,"code"),d._uU(40,"true"),d.qZA(),d._uU(41,'. This will hide the "Create Widget" button whenever an unconfigured widget is selected. '),d.TgZ(42,"nui-message",5),d.TgZ(43,"strong"),d._uU(44,"Note:"),d.qZA(),d._uU(45," In the example below, the widget selector is implemented in the same file as the dashboard component, but it's recommended to define it in a separate file. Additionally, after implementing it, remember to add it to your module declarations. "),d.qZA(),d.qZA(),d.TgZ(46,"li"),d._uU(47," Ensure that "),d.TgZ(48,"code"),d._uU(49,"NuiRepeatModule"),d.qZA(),d._uU(50," and "),d.TgZ(51,"code"),d._uU(52,"NuiImageModule"),d.qZA(),d._uU(53," are included in the imports of the widget template selector component's parent module. "),d.TgZ(54,"nui-message",5),d.TgZ(55,"strong"),d._uU(56,"Note:"),d.qZA(),d._uU(57," Importing these modules is required in this example because, in this case, the widget template selector uses the Nova repeat component and a couple of images from the Nova image repository. "),d.qZA(),d.qZA(),d.TgZ(58,"li"),d._uU(59," Invoke the "),d.TgZ(60,"code"),d._uU(61,"open"),d.qZA(),d._uU(62," method on the "),d.TgZ(63,"a",1),d.TgZ(64,"code"),d._uU(65,"WidgetClonerService"),d.qZA(),d.qZA(),d._uU(66," with an argument of type "),d.TgZ(67,"a",6),d.TgZ(68,"code"),d._uU(69,"IWidgetSelector"),d.qZA(),d.qZA(),d._uU(70,". Only two things are required in that object: a reference to the dashboardComponent instance and the typename of the widget selector created in the previous step. Optionally, the argument object may also contain a "),d.TgZ(71,"code"),d._uU(72,"trySubmit"),d.qZA(),d._uU(73," function with logic for persisting the new widget on a backend. "),d.qZA(),d.TgZ(74,"li"),d._uU(75," Subscribe to the "),d.TgZ(76,"code"),d._uU(77,"Observable"),d.qZA(),d._uU(78," returned by the "),d.TgZ(79,"a",7),d.TgZ(80,"code"),d._uU(81,"widgetClonerService.open"),d.qZA(),d.qZA(),d._uU(82," method in order to activate the handling of form submission and the subsequent updating of the dashboard with a newly created widget. "),d.qZA(),d.qZA(),d.TgZ(83,"nui-message",5),d._uU(84," For more detailed information about widget creation, take a look at the inline comments under the source expander of the following example.\n"),d.qZA(),d.TgZ(85,"nui-example-wrapper",8),d._UZ(86,"widget-creation"),d.qZA()),2&e&&(d.xp6(42),d.Q6J("allowDismiss",!1),d.xp6(12),d.Q6J("allowDismiss",!1),d.xp6(29),d.Q6J("allowDismiss",!1))},directives:[a.qqZ,a.hD2,T],encapsulation:2}),e})(),data:{srlc:{hideIndicator:!0},showThemeSwitcher:!0}},{path:"example",component:T,data:{srlc:{hideIndicator:!0}}}];let k=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({imports:[[o.ez,n.JF,s.Pi,a.vvu,a.gkT,a.cJ5,a.tez,a.Az_,a.ZuS,a.sF0,r.Bz.forChild(q)]]}),e})()}}]);