"use strict";(self.webpackChunk_nova_ui_dashboards=self.webpackChunk_nova_ui_dashboards||[]).push([[175],{175:function(e,t,i){i.r(t),i.d(t,{TableWidgetPrototypeModule:function(){return $}});var r=i(38583),o=i(91841),a=i(99763),n=i(46806),s=i(69063),d=i(93877),l=i(4758),c=i(40837),p=i(5596),u=i(33618),g=i(85631),m=i(6376),h=i(55350),v=i(55206),f=i(59311),w=i.n(f),b=i(79765),y=i(15257),S=i(46782),C=i(33018),I=i(37524),T=i.n(I),D=i(12666),W=i.n(D),x=i(16738),k=i.n(x);const A={widget1:{cols:5,rows:6,y:0,x:0},widget2:{cols:7,rows:6,y:0,x:5},widget3:{cols:6,rows:6,y:6,x:0},widget4:{cols:6,rows:6,y:6,x:6},widget5:{cols:7,rows:6,y:12,x:5},widget6:{cols:5,rows:6,y:12,x:0},widget7:{cols:6,rows:6,y:18,x:0},widget8:{cols:6,rows:6,y:18,x:6}},M=[{id:"widget1",type:"table",pizzagna:{[s.xW5.Configuration]:{[s.XMI]:{providers:{[s.Muk.InteractionHandler]:{providerId:s.DJm}}},header:{properties:{title:"Table Widget!",subtitle:"Basic table widget",collapsible:!0}},table:{providers:{[s.Muk.DataSource]:{providerId:h.n.providerId}},properties:{configuration:{interactive:!0,columns:[{id:"column1",label:"No.",isActive:!0,formatter:{componentType:s.aDR.lateLoadKey,properties:{dataFieldIds:{value:"position"}}}},{id:"column2",label:"Name",isActive:!0,formatter:{componentType:s.aDR.lateLoadKey,properties:{dataFieldIds:{value:"name"}}}},{id:"column3",label:"Status",isActive:!0,formatter:{componentType:s.aDR.lateLoadKey,properties:{dataFieldIds:{value:"status"}}}}],sorterConfiguration:{descendantSorting:!1,sortBy:"column1"},hasVirtualScroll:!0,searchConfiguration:{enabled:!0}}}}}}},{id:"widget2",type:"proportional",pizzagna:{[s.xW5.Configuration]:{[s.XMI]:{providers:{[s.Muk.InteractionHandler]:{providerId:s.DJm,properties:{url:"${data.link}"}}}},header:{properties:{title:"Proportional Widget!",subtitle:"Proportional widget with legend formatters"}},chart:{providers:{[s.Muk.DataSource]:{providerId:c.Q.providerId},[s.Muk.Adapter]:{properties:{[s.Muk.DataSource]:{properties:{isEuropeOnly:!1}}}}},properties:{configuration:{interactive:!0,chartDonutContentLabel:"Some label",chartDonutContentIcon:"printer",chartOptions:{type:s.EMX.VerticalBarChart,legendPlacement:s.woB.Right},chartColors:["var(--nui-color-chart-eight)","var(--nui-color-chart-nine)","var(--nui-color-chart-ten)"]}}}}}},{id:"widget3",type:"timeseries",pizzagna:{[s.xW5.Configuration]:{[s.XMI]:{providers:{[s.Muk.DataSource]:{providerId:v.wi.providerId},[s.Muk.InteractionHandler]:{providerId:s.DJm}}},header:{properties:{title:"Timeseries Widget!",subtitle:"Basic timeseries widget"}},chart:{providers:{[s.Muk.Adapter]:{properties:{series:[{id:"series-2",label:"Average CPU Load",selectedSeriesId:"series-2"}]}}},properties:{configuration:{legendPlacement:s.woB.Right,enableZoom:!0,leftAxisLabel:"Utilization (%)",chartColors:["var(--nui-color-chart-eight)","var(--nui-color-chart-nine)","var(--nui-color-chart-ten)"]}}},timeframeSelection:{properties:{timeframe:{selectedPresetId:"last7Days"},minDate:k()().subtract(10,"days").format(),maxDate:k()().format()}}}}},{id:"widget4",type:"table",pizzagna:{[s.xW5.Configuration]:{[s.XMI]:{providers:{[s.Muk.InteractionHandler]:{providerId:s.DJm}}},header:{properties:{title:"Table Widget!",subtitle:"Basic table widget",collapsible:!0}},table:{providers:{[s.Muk.DataSource]:{providerId:h.n.providerId}},properties:{configuration:{interactive:!0,columns:[{id:"column1",label:"No.",isActive:!0,formatter:{componentType:s.aDR.lateLoadKey,properties:{dataFieldIds:{value:"position"}}}},{id:"column2",label:"Name",isActive:!0,formatter:{componentType:s.aDR.lateLoadKey,properties:{dataFieldIds:{value:"name"}}}},{id:"column3",label:"Status",isActive:!0,formatter:{componentType:s.aDR.lateLoadKey,properties:{dataFieldIds:{value:"status"}}}}],sorterConfiguration:{descendantSorting:!1,sortBy:"column1"},hasVirtualScroll:!0,searchConfiguration:{enabled:!0}}}}}}},{id:"widget5",type:"proportional",pizzagna:{[s.xW5.Configuration]:{[s.XMI]:{providers:{[s.Muk.InteractionHandler]:{providerId:s.DJm,properties:{url:"${data.link}"}}}},header:{properties:{title:"Proportional Widget!",subtitle:"Proportional widget with legend formatters"}},chart:{providers:{[s.Muk.DataSource]:{providerId:c.Q.providerId},[s.Muk.Adapter]:{properties:{[s.Muk.DataSource]:{properties:{isEuropeOnly:!1}}}}},properties:{configuration:{interactive:!0,chartDonutContentLabel:"Some label",chartDonutContentIcon:"printer",chartOptions:{type:s.EMX.VerticalBarChart,legendPlacement:s.woB.Right},chartColors:["var(--nui-color-chart-eight)","var(--nui-color-chart-nine)","var(--nui-color-chart-ten)"]}}}}}},{id:"widget6",type:"table",pizzagna:{[s.xW5.Configuration]:{[s.XMI]:{providers:{[s.Muk.InteractionHandler]:{providerId:s.DJm}}},header:{properties:{title:"Table Widget!",subtitle:"Basic table widget",collapsible:!0}},table:{providers:{[s.Muk.DataSource]:{providerId:h.n.providerId}},properties:{configuration:{interactive:!0,columns:[{id:"column1",label:"No.",isActive:!0,formatter:{componentType:s.aDR.lateLoadKey,properties:{dataFieldIds:{value:"position"}}}},{id:"column2",label:"Name",isActive:!0,formatter:{componentType:s.aDR.lateLoadKey,properties:{dataFieldIds:{value:"name"}}}},{id:"column3",label:"Status",isActive:!0,formatter:{componentType:s.aDR.lateLoadKey,properties:{dataFieldIds:{value:"status"}}}}],sorterConfiguration:{descendantSorting:!1,sortBy:"column1"},hasVirtualScroll:!0,searchConfiguration:{enabled:!0}}}}}}},{id:"widget7",type:"timeseries",pizzagna:{[s.xW5.Configuration]:{[s.XMI]:{providers:{[s.Muk.DataSource]:{providerId:v.wi.providerId},[s.Muk.InteractionHandler]:{providerId:s.DJm}}},header:{properties:{title:"Timeseries Widget!",subtitle:"Basic timeseries widget"}},chart:{providers:{[s.Muk.Adapter]:{properties:{series:[{id:"series-2",label:"Average CPU Load",selectedSeriesId:"series-2"}]}}},properties:{configuration:{legendPlacement:s.woB.Right,enableZoom:!0,leftAxisLabel:"Utilization (%)",chartColors:["var(--nui-color-chart-eight)","var(--nui-color-chart-nine)","var(--nui-color-chart-ten)"]}}},timeframeSelection:{properties:{timeframe:{selectedPresetId:"last7Days"},minDate:k()().subtract(10,"days").format(),maxDate:k()().format()}}}}},{id:"widget8",type:"table",pizzagna:{[s.xW5.Configuration]:{[s.XMI]:{providers:{[s.Muk.InteractionHandler]:{providerId:s.DJm}}},header:{properties:{title:"Table Widget!",subtitle:"Basic table widget",collapsible:!0}},table:{providers:{[s.Muk.DataSource]:{providerId:h.n.providerId}},properties:{configuration:{interactive:!0,columns:[{id:"column1",label:"No.",isActive:!0,formatter:{componentType:s.aDR.lateLoadKey,properties:{dataFieldIds:{value:"position"}}}},{id:"column2",label:"Name",isActive:!0,formatter:{componentType:s.aDR.lateLoadKey,properties:{dataFieldIds:{value:"name"}}}},{id:"column3",label:"Status",isActive:!0,formatter:{componentType:s.aDR.lateLoadKey,properties:{dataFieldIds:{value:"status"}}}}],sorterConfiguration:{descendantSorting:!1,sortBy:"column1"},hasVirtualScroll:!0,searchConfiguration:{enabled:!0}}}}}}}];function z(e,t){if(1&e&&(C.TgZ(0,"div",3),C.TgZ(1,"div",4),C._uU(2),C.qZA(),C.qZA()),2&e){const e=t.item;C.xp6(2),C.hij(" ",e.title," ")}}let Z=(()=>{class e{constructor(e){this.widgetTypesService=e,this.widgetSelected=new C.vpe,this.widgetItems=[]}ngOnInit(){const e=new r.rS;this.widgetItems=M.map(t=>({title:e.transform(t.type),widget:this.widgetTypesService.mergeWithWidgetType(t)})),M.forEach(e=>{this.addUnconfiguredWidgetWithConfigLayer(e)})}addUnconfiguredWidget(e){const t=(new r.rS).transform(e);this.widgetItems.push({title:`Unconfigured ${t}`,widget:{id:`unconfigured${t}`,type:e,metadata:{needsConfiguration:!0},pizzagna:T()(this.widgetTypesService.getWidgetType(e).widget)}}),W()(this.widgetItems[this.widgetItems.length-1].widget.pizzagna,`${s.xW5.Structure}.header.properties.title`,`Unconfigured ${t}`)}addUnconfiguredWidgetWithConfigLayer(e){const t=(new r.rS).transform(e.type);this.widgetItems.push({title:`Unconfigured ${t} With Config Layer`,widget:Object.assign(Object.assign({},T()(this.widgetTypesService.mergeWithWidgetType(e))),{id:`unconfiguredWithConfigLayer${t}`,metadata:{needsConfiguration:!0}})}),W()(this.widgetItems[this.widgetItems.length-1].widget.pizzagna,`${s.xW5.Configuration}.header.properties.title`,`Unconfigured ${t} With Config Layer`)}onSelect(e){this.widgetSelected.emit(e[0].widget),this.widgetSelection=e}}return e.lateLoadKey="AcmeCloneSelectionComponent",e.\u0275fac=function(t){return new(t||e)(C.Y36(s.xTe))},e.\u0275cmp=C.Xpm({type:e,selectors:[["acme-clone-selection"]],outputs:{widgetSelected:"widgetSelected"},decls:4,vars:3,consts:[[1,"nui-widget-cloner"],["selectionMode","singleWithRequiredSelection",3,"itemsSource","selection","repeatItemTemplateRef","selectionChange"],["widgetClonerItem",""],[1,"nui-widget-cloner__item","d-flex","pt-2","pb-2","align-items-center"],[1,"text-info","ml-3"]],template:function(e,t){if(1&e&&(C.TgZ(0,"div",0),C.TgZ(1,"nui-repeat",1),C.NdJ("selectionChange",function(e){return t.onSelect(e)}),C.qZA(),C.qZA(),C.YNc(2,z,3,1,"ng-template",null,2,C.W1O)),2&e){const e=C.MAs(3);C.xp6(1),C.Q6J("itemsSource",t.widgetItems)("selection",t.widgetSelection)("repeatItemTemplateRef",e)}},directives:[n.$N6],styles:[".nui-widget-cloner__item[_ngcontent-%COMP%]{height:60px}"]}),e})();function R(e,t){if(1&e&&(C.TgZ(0,"div",3),C.TgZ(1,"div",4),C._uU(2),C.qZA(),C.qZA()),2&e){const e=t.item;C.xp6(2),C.hij(" ",e.title," ")}}let L=(()=>{class e extends Z{constructor(e){super(e)}ngOnInit(){const e=new r.rS;this.widgetItems=M.map(t=>({title:e.transform(t.type),widget:this.widgetTypesService.mergeWithWidgetType(t)}))}}return e.lateLoadKey="AcmeCloneSelectionComponent",e.\u0275fac=function(t){return new(t||e)(C.Y36(s.xTe))},e.\u0275cmp=C.Xpm({type:e,selectors:[["acme-clone-selection"]],features:[C.qOj],decls:4,vars:3,consts:[[1,"nui-widget-cloner"],["selectionMode","singleWithRequiredSelection",3,"itemsSource","selection","repeatItemTemplateRef","selectionChange"],["widgetClonerItem",""],[1,"nui-widget-cloner__item","d-flex","pt-2","pb-2","align-items-center"],[1,"text-info","ml-3"]],template:function(e,t){if(1&e&&(C.TgZ(0,"div",0),C.TgZ(1,"nui-repeat",1),C.NdJ("selectionChange",function(e){return t.onSelect(e)}),C.qZA(),C.qZA(),C.YNc(2,R,3,1,"ng-template",null,2,C.W1O)),2&e){const e=C.MAs(3);C.xp6(1),C.Q6J("itemsSource",t.widgetItems)("selection",t.widgetSelection)("repeatItemTemplateRef",e)}},directives:[n.$N6],styles:[".nui-widget-cloner__item[_ngcontent-%COMP%]{height:60px}"]}),e})(),N=(()=>{class e{constructor(e){this.toastService=e,this.allowSubmit=!0,this.allowRemoval=!0,this.trySubmit=(e,t)=>{const i=new b.xQ;return setTimeout(()=>{if(this.allowSubmit)i.next(e);else{const e=$localize`Submit failed.`;this.toastService.error({title:e}),i.error(e)}},1e3),i.asObservable()},this.tryRemove=e=>{const t=new b.xQ;return setTimeout(()=>{if(this.allowRemoval)t.next(e);else{const e=$localize`Widget removal failed.`;this.toastService.error({title:e}),t.error(e)}},200),t.asObservable()},this.toastService.setConfig({timeOut:2e3})}}return e.\u0275fac=function(t){return new(t||e)(C.LFG(n.klp))},e.\u0275prov=C.Yz7({token:e,factory:e.\u0275fac}),e})();var J=i(46276),F=i(54607);const P=[{path:"",component:(()=>{class e{constructor(e,t,i,r){this.providerRegistry=e,this.submitHandler=t,this.widgetTypesService=i,this.widgetClonerService=r,this.dashboard={positions:{},widgets:{}},this.gridsterConfig={minCols:12,maxCols:12,minRows:12},this.editMode=!1,this.destroy$=new b.xQ,this.providerRegistry.setProviders({[l.i.providerId]:{provide:s.Fk3,useClass:l.i,deps:[o.eN]},[l.L2.providerId]:{provide:s.Fk3,useClass:l.L2,deps:[o.eN]},[l.sR.providerId]:{provide:s.Fk3,useClass:l.sR,deps:[]},[c.Q.providerId]:{provide:s.Fk3,useClass:c.Q,deps:[o.eN]},[c.s.providerId]:{provide:s.Fk3,useClass:c.s,deps:[]},[p.g.providerId]:{provide:s.Fk3,useClass:p.g,deps:[n.mQy,o.eN]},[u.W.providerId]:{provide:s.Fk3,useClass:u.W,deps:[n.mQy]},[g.t.providerId]:{provide:s.Fk3,useClass:g.t,deps:[n.mQy]},[h.n.providerId]:{provide:s.Fk3,useClass:h.n,deps:[n.oDG]},[v.wi.providerId]:{provide:s.Fk3,useClass:v.wi,deps:[o.eN]},[v.u2.providerId]:{provide:s.Fk3,useClass:v.u2,deps:[]},[m.a.providerId]:{provide:s.Fk3,useClass:m.a,deps:[n.mQy,o.eN]}})}ngOnInit(){var e,t;null===(t=null===(e=this.widgetTypesService.getWidgetType("table").configurator)||void 0===e?void 0:e[s.xW5.Structure].presentation.properties)||void 0===t||t.nodes.push("refresher");const i=M.map(e=>this.widgetTypesService.mergeWithWidgetType(e)),r=w()(i,e=>e.id);this.dashboard={positions:A,widgets:r}}onDsErrorSwitch(e){c.Q.mockError=e,l.i.mockError=e,l.L2.mockError=e,p.g.mockError=e,v.wi.mockError=e}onShowButtonSwitch(e,t){for(const i of Object.keys(this.dashboard.widgets))this.dashboard=(0,n.zdu)(this.dashboard,`widgets.${i}.pizzagna.configuration.header.properties.${t}`,e)}ngAfterViewInit(){this.dashboardComponent.eventBus.subscribeUntil(s.MOJ,this.destroy$,e=>{this.widgetClonerService.open({widget:this.dashboard.widgets[e.widgetId],dashboardComponent:this.dashboardComponent,trySubmit:this.submitHandler.trySubmit,widgetSelectionComponentType:L}).pipe((0,y.q)(1),(0,S.R)(this.destroy$)).subscribe()})}onCloneWidget(){this.widgetClonerService.open({dashboardComponent:this.dashboardComponent,trySubmit:this.submitHandler.trySubmit,widgetSelectionComponentType:Z}).pipe((0,y.q)(1),(0,S.R)(this.destroy$)).subscribe()}onEditWithCloner(){this.dashboardComponent.eventBus.next(s.MOJ,{widgetId:M[0].id})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return e.\u0275fac=function(t){return new(t||e)(C.Y36(s.CNH),C.Y36(N),C.Y36(s.xTe),C.Y36(s.$Ie))},e.\u0275cmp=C.Xpm({type:e,selectors:[["acme-dashboard"]],viewQuery:function(e,t){if(1&e&&C.Gf(s.MXM,7),2&e){let e;C.iGM(e=C.CRH())&&(t.dashboardComponent=e.first)}},features:[C._Bn([N])],decls:19,vars:9,consts:function(){let e,t,i,r,o,a,n,s;return e=$localize`:␟08a1b409eac8269dd4dce8a2b3bd976356ba40ee␟7260316479095556147:Create Widget Clone`,t=$localize`:␟4e17d1961186f54a679f7623cd03e5c49c411f65␟639090956363340116:Simulate edit with cloner`,i=$localize`:␟c0390f914462a77b0ab8e053abf7c77af5b1da81␟6640158718767573444: Edit mode `,r=$localize`:␟db70aaa4da7a9f7c0fa3a218907f9fa354a19038␟5855643886473775120: Allow Submit `,o=$localize`:␟d289dfdc6c4e23b49a96db083f95f1087ed1400a␟3687117978364204872: Allow Removal `,a=$localize`:␟3299af3b186d7701f4c0626e41eba58af8382723␟4106211393112768148: Show Edit Button `,n=$localize`:␟30251ad3dcd7facd3a222d48fb2ba02f8503c52c␟8096484277280346189: Show Remove Button `,s=$localize`:␟c355f0feb3f72b3594e6e975456cd0a2dac1d929␟870224976565315483: Data Source Error `,[["type","button","nui-button","",1,"mb-3","ml-4",3,"click"],e,t,[1,"w-100",2,"height","725px"],[3,"nuiWidgetEditor","dashboard","gridsterConfig","editMode","dashboardChange","gridsterConfigChange"],[1,"my-3","d-flex","align-items-center"],[1,"ml-3",3,"value","valueChange"],i,r,o,a,n,[1,"ml-3",3,"valueChange"],s]},template:function(e,t){1&e&&(C.TgZ(0,"button",0),C.NdJ("click",function(){return t.onCloneWidget()}),C.SDv(1,1),C.qZA(),C.TgZ(2,"button",0),C.NdJ("click",function(){return t.onEditWithCloner()}),C.SDv(3,2),C.qZA(),C.TgZ(4,"div",3),C.TgZ(5,"nui-dashboard",4),C.NdJ("dashboardChange",function(e){return t.dashboard=e})("gridsterConfigChange",function(e){return t.gridsterConfig=e}),C.qZA(),C.qZA(),C.TgZ(6,"div",5),C.TgZ(7,"nui-switch",6),C.NdJ("valueChange",function(e){return t.editMode=e}),C.SDv(8,7),C.qZA(),C.TgZ(9,"nui-switch",6),C.NdJ("valueChange",function(e){return t.submitHandler.allowSubmit=e}),C.SDv(10,8),C.qZA(),C.TgZ(11,"nui-switch",6),C.NdJ("valueChange",function(e){return t.submitHandler.allowRemoval=e}),C.SDv(12,9),C.qZA(),C.TgZ(13,"nui-switch",6),C.NdJ("valueChange",function(e){return t.onShowButtonSwitch(e,"editable")}),C.SDv(14,10),C.qZA(),C.TgZ(15,"nui-switch",6),C.NdJ("valueChange",function(e){return t.onShowButtonSwitch(e,"removable")}),C.SDv(16,11),C.qZA(),C.TgZ(17,"nui-switch",12),C.NdJ("valueChange",function(e){return t.onDsErrorSwitch(e)}),C.SDv(18,13),C.qZA(),C.qZA()),2&e&&(C.xp6(5),C.Q6J("nuiWidgetEditor",t.submitHandler)("dashboard",t.dashboard)("gridsterConfig",t.gridsterConfig)("editMode",t.editMode),C.xp6(2),C.Q6J("value",t.editMode),C.xp6(2),C.Q6J("value",t.submitHandler.allowSubmit),C.xp6(2),C.Q6J("value",t.submitHandler.allowRemoval),C.xp6(2),C.Q6J("value",!0),C.xp6(2),C.Q6J("value",!0))},directives:[n.r0F,J.M,F.t,n.qUD],styles:[".nui-theme-switcher-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;padding:10px;background-color:#fff;background-color:var(--nui-color-bg-light,#fff)}"]}),e})(),data:{srlc:{hideIndicator:!0},showThemeSwitcher:!0}}];let $=(()=>{class e{constructor(e,t){this.widgetTypesService=e,this.componentRegistry=t,this.setupDataSourceProviders(),this.setupCustomProportionalWidgetDSConfig()}setupCustomProportionalWidgetDSConfig(){var e;const t=this.widgetTypesService.getWidgetType("proportional",1);null===(e=t.widget.structure[s.XMI].providers)||void 0===e||delete e.refresher,this.widgetTypesService.setNode(t,"configurator",s.ACc.DataSourceConfigComponentType,d.b.lateLoadKey),this.componentRegistry.registerByLateLoadKey(d.b)}setupDataSourceProviders(){this.setDataSourceProviders("table",[p.g.providerId,u.W.providerId,g.t.providerId,h.n.providerId,m.a.providerId]);const e=this.widgetTypesService.getWidgetType("kpi",1);this.widgetTypesService.setNode(e,"configurator",s.ACc.DataSourceConfigComponentType,s.cY_.lateLoadKey),this.setDataSourceProviders("kpi",[{providerId:l.i.providerId,label:"Acme KPI Data Source 1"},{providerId:l.L2.providerId,label:"Acme KPI Data Source 2",properties:{numberFormat:"1.1-1"}},{providerId:l.sR.providerId,label:"Acme KPI Data Source 3"}]),this.setDataSourceProviders("proportional",[c.Q.providerId,c.s.providerId]),this.setDataSourceProviders("timeseries",[v.wi.providerId,v.u2.providerId])}setDataSourceProviders(e,t){const i=this.widgetTypesService.getWidgetType(e,1);this.widgetTypesService.setNode(i,"configurator",s.ACc.DataSourceProviders,t)}}return e.\u0275fac=function(t){return new(t||e)(C.LFG(s.xTe),C.LFG(s.hiK))},e.\u0275mod=C.oAB({type:e}),e.\u0275inj=C.cJS({providers:[s.CNH],imports:[[r.ez,o.JF,s.Pi,n.Gsl,n.Az_,n.vvu,n.cJ5,n.Ts3,n.sF0,n.ZuS,a.Bz.forChild(P)]]}),e})()}}]);