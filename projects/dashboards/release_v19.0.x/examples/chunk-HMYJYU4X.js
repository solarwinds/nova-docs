import{a as b,b as l,c as I}from"./chunk-KOJX7MOQ.js";import{a as c,b as A}from"./chunk-UTN7YCLT.js";import{e as Z}from"./chunk-5YDSK5GN.js";import{a as m,b as D}from"./chunk-MRY6LEWN.js";import{a as p,b as f}from"./chunk-URNVATU6.js";import{a as Re,b as Oe}from"./chunk-YNEQTNRT.js";import{a as L,h as Pe,j as We,k as Me}from"./chunk-PPQN6QZA.js";import{a as h}from"./chunk-MD6F45Z7.js";import"./chunk-LVFB3RKU.js";import"./chunk-SPPZFYNP.js";import"./chunk-GDLY3HLX.js";import"./chunk-KJJ6TWPM.js";import"./chunk-LA47LHC2.js";import"./chunk-4HXDNOXI.js";import"./chunk-5ELJRXLQ.js";import"./chunk-TGKM7UGT.js";import"./chunk-IYRXTWZX.js";import"./chunk-ZXV5URGJ.js";import"./chunk-BC67S2GR.js";import"./chunk-OGZVPW3S.js";import"./chunk-4GVDWU57.js";import"./chunk-OZALKHRQ.js";import"./chunk-AZWDHRVR.js";import"./chunk-EWX2S4QW.js";import"./chunk-SE5ZEHMX.js";import"./chunk-RDGFC72M.js";import"./chunk-LZOJVJPM.js";import"./chunk-NZJJPQMD.js";import"./chunk-3J5U6KSS.js";import"./chunk-K6DXWVOP.js";import{a as B}from"./chunk-SBSX6PXY.js";import"./chunk-ZKE5BQF3.js";import"./chunk-KJCSOJ3W.js";import{a as Ee}from"./chunk-LTNK7SWM.js";import{a as G}from"./chunk-5RQCZS6F.js";import"./chunk-7ZQISLLB.js";import"./chunk-LZEECJLY.js";import{a as $}from"./chunk-OPPBYCVB.js";import"./chunk-NVJ4XKOU.js";import"./chunk-JOEIBHEU.js";import"./chunk-POOVCM3L.js";import"./chunk-EU2T5UE6.js";import{A as x,Aa as V,Ja as O,b as Be,c as R,ca as j,ea as s,ha as a,ia as Ae,ka as g}from"./chunk-573U3PX6.js";import"./chunk-URWUMSY2.js";import"./chunk-GDYE5MCV.js";import{Ac as K,Dd as _e,Gc as Se,Hc as ve,Kd as be,Zb as Ve,oc as Ce,od as Te,se as Ie,te as De,ub as je,vd as ye,xd as we}from"./chunk-PMWUHOKA.js";import{N as fe,n as F}from"./chunk-YHLZAVJ5.js";import{Ac as me,Ba as te,Bc as ce,Ca as ie,Db as W,Dc as ue,Eb as oe,Ec as z,Fc as M,Gc as U,Hc as ge,Ib as ne,La as re,O as q,Sc as he,Ub as v,bc as u,cc as T,da as J,h as w,hc as se,ka as Y,la as ee,mc as ae,pa as P,qc as _,rb as S,xb as d,xc as de,yc as pe,zc as le}from"./chunk-MCPF2SEG.js";import"./chunk-CUY44B7R.js";import{a as C,b as E,g as k}from"./chunk-VBFW7A5V.js";var ke=k(Ve()),ze=k(je());var Le={widget1:{cols:6,rows:6,y:0,x:0},widget2:{cols:6,rows:6,y:0,x:6},widget3:{cols:7,rows:6,y:6,x:0},widget4:{cols:5,rows:6,y:6,x:7}},y=[{id:"widget1",type:"kpi",pizzagna:{[g.Configuration]:{header:{properties:{title:"KPI Widget!",subtitle:"A bunch of number boxes"}},tiles:{properties:{nodes:["kpi1","kpi2"]}},kpi1:{id:"kpi1",componentType:B.lateLoadKey,providers:{[a.DataSource]:{providerId:p.providerId},[a.Adapter]:{providerId:x,properties:{componentId:"kpi1",propertyPath:"widgetData",thresholds:{showThresholds:!0,warningThresholdValue:5,criticalThresholdValue:8}}}},properties:{elementClass:"flex-grow-1",widgetData:{id:"totalStorage",value:0,label:"Total storage"}}},kpi2:{id:"kpi2",componentType:B.lateLoadKey,providers:{[a.DataSource]:{providerId:f.providerId},[a.Adapter]:{providerId:x,properties:{componentId:"kpi2",propertyPath:"widgetData",thresholds:{warningThresholdValue:120,criticalThresholdValue:150}}}},properties:{elementClass:"flex-grow-1",widgetData:{id:"downloadSpeed",value:0,label:"Download speed"}}}}}},{id:"widget2",type:"proportional",pizzagna:{[g.Configuration]:{header:{properties:{title:"Proportional Widget!",subtitle:"Proportional widget with legend formatters"}},chart:{providers:{[a.DataSource]:{providerId:l.providerId}},properties:{configuration:{chartOptions:{type:Ee.PieChart,legendPlacement:V.Right,legendFormatter:{componentType:G.lateLoadKey}}}}}}}},{id:"widget3",type:"timeseries",pizzagna:{[g.Configuration]:{[R]:{providers:{[a.DataSource]:{providerId:c.providerId}}},header:{properties:{title:"Timeseries Widget!",subtitle:"Basic timeseries widget"}},chart:{providers:{[a.Adapter]:{properties:{series:[{id:"series-1",label:"Average CPU Load",selectedSeriesId:"series-1"},{id:"series-2",label:"Average CPU Load",selectedSeriesId:"series-2"},{id:"series-3",label:"Average CPU Load",selectedSeriesId:"series-3"}]}}},properties:{configuration:{legendPlacement:V.Right,enableZoom:!0,leftAxisLabel:"Utilization (%)"}}},timeframeSelection:{properties:{timeframe:{startDatetime:Z().subtract(7,"day").format(),endDatetime:Z().format(),selectedPresetId:null}}}}}},{id:"widget4",type:"table",pizzagna:{[g.Configuration]:{header:{properties:{title:"Table Widget!",subtitle:"Basic table widget"}},table:{providers:{[a.DataSource]:{providerId:m.providerId}},properties:{configuration:{columns:[{id:"column1",label:"No",isActive:!0,formatter:{componentType:$.lateLoadKey,properties:{dataFieldIds:{value:"position"}}}},{id:"column2",label:"Name",isActive:!0,formatter:{componentType:$.lateLoadKey,properties:{dataFieldIds:{value:"name"}}}},{id:"column3",label:"Location",isActive:!0,formatter:{componentType:G.lateLoadKey,properties:{dataFieldIds:{value:"firstUrlLabel",link:"firstUrl"}}}}],sorterConfiguration:{descendantSorting:!0,sortBy:"column1"},hasVirtualScroll:!0}}}}}}];function Ge(r,Ke){if(r&1&&(u(0,"div",3)(1,"div",4),ce(2),T()()),r&2){let t=Ke.item;S(2),ue(" ",t.title," ")}}var X=(()=>{class r{static{this.lateLoadKey="AcmeCloneSelectionComponent"}constructor(t){this.widgetTypesService=t,this.widgetSelected=new re,this.widgetItems=[]}ngOnInit(){let t=new F;this.widgetItems=y.map(i=>({title:t.transform(i.type),widget:this.widgetTypesService.mergeWithWidgetType(i)})),this.onSelect([this.widgetItems[0]]),y.forEach(i=>{this.addUnconfiguredWidgetWithConfigLayer(i)})}addUnconfiguredWidgetWithConfigLayer(t){let i=new F().transform(t.type);this.widgetItems.push({title:`Unconfigured ${i} With Config Layer`,widget:E(C({},(0,ke.default)(this.widgetTypesService.mergeWithWidgetType(t))),{id:`unconfiguredWithConfigLayer${i}`,metadata:{needsConfiguration:!0}})}),(0,ze.default)(this.widgetItems[this.widgetItems.length-1].widget.pizzagna,`${g.Configuration}.header.properties.title`,`Unconfigured ${i} With Config Layer`)}onSelect(t){this.widgetSelected.emit(t[0].widget),this.widgetSelection=t}static{this.\u0275fac=function(i){return new(i||r)(d(h))}}static{this.\u0275cmp=W({type:r,selectors:[["acme-clone-selection"]],outputs:{widgetSelected:"widgetSelected"},standalone:!1,decls:4,vars:3,consts:[["widgetClonerItem",""],[1,"nui-widget-cloner"],["selectionMode","singleWithRequiredSelection",3,"selectionChange","itemsSource","selection","repeatItemTemplateRef"],[1,"nui-widget-cloner__item","d-flex","pt-2","pb-2","align-items-center"],[1,"text-info","ml-3"]],template:function(i,e){if(i&1){let o=se();u(0,"div",1)(1,"nui-repeat",2),_("selectionChange",function(xe){return te(o),ie(e.onSelect(xe))}),T()(),ne(2,Ge,3,1,"ng-template",null,0,he)}if(i&2){let o=me(3);S(),v("itemsSource",e.widgetItems)("selection",e.widgetSelection)("repeatItemTemplateRef",o)}},dependencies:[ye],styles:[".nui-widget-cloner__item[_ngcontent-%COMP%]{height:60px}"]})}}return r})();var Ue=k(Be());var N=(()=>{class r{constructor(t){this.toastService=t,this.allowSubmit=!0,this.allowRemoval=!0,this.trySubmit=i=>{let e=new w;return setTimeout(()=>{if(this.allowSubmit)e.next(i);else{let o=$localize`Submit failed.`;this.toastService.error({title:o}),e.error(o)}},1e3),e.asObservable()},this.tryRemove=i=>{let e=new w;return setTimeout(()=>{if(this.allowRemoval)e.next(i);else{let o=$localize`Widget removal failed.`;this.toastService.error({title:o}),e.error(o)}},200),e.asObservable()},this.toastService.setConfig({timeOut:2e3})}static{this.\u0275fac=function(i){return new(i||r)(P(be))}}static{this.\u0275prov=Y({token:r,factory:r.\u0275fac})}}return r})();var Fe=(()=>{class r{constructor(t,i,e,o,n){this.providerRegistry=t,this.submitHandler=i,this.themeSwitcherService=e,this.widgetTypesService=o,this.widgetClonerService=n,this.destroy$=new w,this.dashboard={positions:{},widgets:{}},this.gridsterConfig={minCols:12,maxCols:12,minRows:12},this.editMode=!1,this.dsError=!1,this.providerRegistry.setProviders({[p.providerId]:{provide:s,useClass:p,deps:[]},[f.providerId]:{provide:s,useClass:f,deps:[]},[b.providerId]:{provide:s,useClass:b,deps:[]},[l.providerId]:{provide:s,useClass:l,deps:[]},[I.providerId]:{provide:s,useClass:I,deps:[]},[m.providerId]:{provide:s,useClass:m,deps:[K,j]},[D.providerId]:{provide:s,useClass:D,deps:[K,j]},[c.providerId]:{provide:s,useClass:c,deps:[]},[A.providerId]:{provide:s,useClass:A,deps:[]}})}ngOnInit(){let t=y.map(e=>E(C({},e),{pizzagna:C(C({},this.widgetTypesService.getWidgetType(e.type,e.version).widget),e.pizzagna)})),i=(0,Ue.default)(t,e=>e.id);this.dashboard={positions:Le,widgets:i}}onDsErrorChange(t){p.mockError=t,c.mockError=t,m.mockError=t,l.mockError=t}onCloneWidget(){let t={dashboardComponent:this.dashboardComponent,trySubmit:this.submitHandler.trySubmit,widgetSelectionComponentType:X};this.widgetClonerService.open(t).pipe(q(1),J(this.destroy$)).subscribe()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static{this.\u0275fac=function(i){return new(i||r)(d(O),d(N),d(Ie),d(h),d(Pe))}}static{this.\u0275cmp=W({type:r,selectors:[["acme-dashboard"]],viewQuery:function(i,e){if(i&1&&de(L,7),i&2){let o;pe(o=le())&&(e.dashboardComponent=o.first)}},standalone:!1,features:[ge([N])],decls:5,vars:6,consts:()=>{let t;return t=$localize`:␟489801ff09de9b4a6ca8b6e05a475fa1ca00d98e␟5813529530812520031: Create Widget Clone
`,[t,["type","button","nui-button","",1,"mb-3","ml-4","nui-widget-cloner-test-button",3,"click"],[3,"editModeChange","dsErrorChange","editMode","dsError"],[1,"dashboard"],[3,"dashboardChange","gridsterConfigChange","nuiWidgetEditor","dashboard","gridsterConfig","editMode"]]},template:function(i,e){i&1&&(u(0,"button",1),_("click",function(){return e.onCloneWidget()}),ae(1,0),T(),u(2,"dashboard-test-harness",2),U("editModeChange",function(n){return M(e.editMode,n)||(e.editMode=n),n}),_("dsErrorChange",function(n){return e.onDsErrorChange(n)}),u(3,"div",3)(4,"nui-dashboard",4),U("dashboardChange",function(n){return M(e.dashboard,n)||(e.dashboard=n),n})("gridsterConfigChange",function(n){return M(e.gridsterConfig,n)||(e.gridsterConfig=n),n}),T()()()),i&2&&(S(2),z("editMode",e.editMode),v("dsError",e.dsError),S(2),v("nuiWidgetEditor",e.submitHandler),z("dashboard",e.dashboard)("gridsterConfig",e.gridsterConfig),v("editMode",e.editMode))},dependencies:[Re,L,We,Ce],styles:[".dashboard[_ngcontent-%COMP%]{height:725px;width:1000px}"]})}}return r})();var Ze=[{path:"",component:Fe,data:{srlc:{hideIndicator:!0}}}],Xt=(()=>{class r{constructor(t){this.widgetTypesService=t;let i=this.widgetTypesService.getWidgetType("proportional",1);delete i.widget.structure[R].providers?.refresher,this.setDataSourceProviders("table",[m.providerId,D.providerId]),this.setDataSourceProviders("kpi",[p.providerId,f.providerId]),this.setDataSourceProviders("proportional",[b.providerId,l.providerId,I.providerId]),this.setDataSourceProviders("timeseries",[c.providerId,A.providerId])}setDataSourceProviders(t,i){let e=this.widgetTypesService.getWidgetType(t,1);this.widgetTypesService.setNode(e,"configurator",Ae.DataSourceProviders,i)}static{this.\u0275fac=function(i){return new(i||r)(P(h))}}static{this.\u0275mod=oe({type:r})}static{this.\u0275inj=ee({providers:[O],imports:[Oe,Me,_e,ve,De,Te,Se,we,fe.forChild(Ze)]})}}return r})();export{Xt as ConfiguratorTestModule};
