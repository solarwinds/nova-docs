import{a as z}from"./chunk-POOVCM3L.js";import{d as W,e as Z,f as K,g as J}from"./chunk-EU2T5UE6.js";import{Ja as q,ca as x,ra as k,sa as H,ta as Y}from"./chunk-573U3PX6.js";import{Ba as $,Id as V,Jc as j,_c as B,hd as X,kc as U,ld as w,ma as y,oa as D,pa as F,va as G,wa as b,ya as L}from"./chunk-PMWUHOKA.js";import{e as A,l as M}from"./chunk-YHLZAVJ5.js";import{Aa as f,Bc as v,Db as E,Dc as I,Ha as C,Ib as g,La as N,O as m,Oc as c,Pc as O,Qc as R,Ub as n,Xc as h,bc as p,cc as _,dc as T,h as u,j as S,mc as l,qc as P,rb as s,xb as r}from"./chunk-MCPF2SEG.js";function oe(a,Q){if(a&1&&(p(0,"nui-select-v2-option",14),v(1),_()),a&2){let e=Q.$implicit;n("value",e),s(),I(" ",e," ")}}var he=(()=>{class a{static{this.lateLoadKey="AcmeProportionalDSConfigComponent"}constructor(e,o,i,t,d,ee,ie){this.changeDetector=e,this.formBuilder=o,this.configuratorHeading=i,this.providerRegistryService=t,this.eventBus=d,this.injector=ee,this.logger=ie,this.dataSourceProviders=[],this.formReady=new N,this.dsOutput=new S(1),this.dataFieldIds=new u,this.destroy$=new u}ngOnInit(){this.form=this.formBuilder.group({providerId:[this.providerId||"",[y.required]],properties:this.formBuilder.group({isEuropeOnly:!1})}),this.formReady.emit(this.form)}ngOnChanges(e){e.providerId&&!e.providerId.isFirstChange()&&e.providerId.previousValue!==this.providerId&&(this.form.get("providerId")?.setValue(this.providerId),this.invokeDataSource(this.providerId)),e.properties&&!e.properties.isFirstChange()&&e.properties.previousValue?.isEuropeOnly!==this.properties.isEuropeOnly&&this.form.get("properties.isEuropeOnly")?.setValue(this.properties.isEuropeOnly)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}onDataSourceChange(e){this.eventBus.next(H,{}),this.invokeDataSource(e)}invokeDataSource(e){if(!e)return;let o=this.providerRegistryService.getProvider(e);o?(this.dataSource=this.providerRegistryService.getProviderInstance(o,this.injector),this.eventBus.next(Y,{payload:this.dataSource}),this.dataSource.outputsSubject.pipe(m(1)).subscribe(i=>{this.eventBus.next(k,{payload:i}),this.dsOutput.next(i);let t=i?.result||i;t&&this.dataFieldIds.next(Object.keys(t))}),setTimeout(()=>{this.dataSource.applyFilters()})):this.logger.warn("No provider found for id:",e)}static{this.\u0275fac=function(o){return new(o||a)(r(h),r($),r(z),r(q),r(x),r(C),r(U))}}static{this.\u0275cmp=E({type:a,selectors:[["acme-proportional-ds-config"]],inputs:{dataSourceProviders:"dataSourceProviders",properties:"properties",providerId:"providerId"},outputs:{formReady:"formReady"},standalone:!1,features:[f],decls:19,vars:19,consts:()=>{let e;e=$localize`:␟7f3bce5049b2c517378a6624460b84d2da9ce332␟7245698475792706694:Select Data Source`;let o;o=$localize`:␟18c18c5d61f92ef5c3caa37df00fc514fef3d90c␟4806513497858020797:Data Sources`;let i;i=$localize`:␟8eb0e5b7a8ec1199d38c9e92ca26bd4b3aae7f2c␟8999046125839025839: This field is required `;let t;return t=$localize`:␟3318195914856889c5a2fbab445b0a53999bebd3␟9193916618150782014: Show Europe Only `,[i,t,[3,"formGroup","state"],["headerTitle","Data Source",3,"headerIcon","subtitle"],[1,"datasource-configuration__accordion-content"],[1,"mb-4"],["caption",e,3,"control"],["placeholder",o,"formControlName","providerId",3,"valueSelected","popupViewportMargin"],[3,"value",4,"ngFor","ngForOf"],["for","required"],["formGroupName","properties"],[3,"control"],["formControlName","isEuropeOnly",1,"nui-checkbox--justified"],[1,"datasource-configuration__checkbox-label"],[3,"value"]]},template:function(o,i){if(o&1&&(p(0,"nui-widget-editor-accordion",2),c(1,"nuiWidgetEditorAccordionFormState"),c(2,"async"),T(3,"nui-widget-editor-accordion-header",3),c(4,"nuiFormHeaderIconPipe"),c(5,"async"),p(6,"div",4)(7,"div",5)(8,"nui-form-field",6)(9,"nui-select-v2",7),c(10,"async"),P("valueSelected",function(d){return i.onDataSourceChange(d)}),g(11,oe,2,2,"nui-select-v2-option",8),_(),p(12,"nui-validation-message",9),l(13,0),_()()(),p(14,"div",10)(15,"nui-form-field",11)(16,"nui-checkbox",12)(17,"div",13),l(18,1),_()()()()()()),o&2){let t;n("formGroup",i.form)("state",O(2,10,O(1,8,i.form))),s(3),n("headerIcon",O(5,15,R(4,12,i.form,"database")))("subtitle",(t=i.form.get("providerId"))==null?null:t.value),s(5),n("control",i.form.get("providerId")),s(),n("popupViewportMargin",O(10,17,i.configuratorHeading.height$)),s(2),n("ngForOf",i.dataSourceProviders),s(4),n("control",i.form.get("properties.isEuropeOnly"))}},dependencies:[A,D,F,G,L,b,Z,W,j,V,w,B,X,M,K,J],styles:[".datasource-configuration__accordion-content[_ngcontent-%COMP%]{padding:15px 15px 15px 46px}.datasource-configuration__checkbox-label[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}"],changeDetection:0})}}return a})();export{he as a};
