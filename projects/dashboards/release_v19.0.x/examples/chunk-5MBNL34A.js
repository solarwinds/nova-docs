import{a as B,j as J}from"./chunk-PPQN6QZA.js";import{a as X}from"./chunk-MD6F45Z7.js";import{a as G}from"./chunk-SBSX6PXY.js";import{A as F,Ja as $,c as U,ea as N,ha as f,ia as K,ka as V}from"./chunk-573U3PX6.js";import{Dc as j,Kd as z,Xc as k,oc as W,we as D}from"./chunk-PMWUHOKA.js";import{C as s,f as H}from"./chunk-YHLZAVJ5.js";import{Ba as u,Ca as g,Db as M,Ec as w,Fc as S,Gc as I,Hc as x,Ib as y,U as T,Ub as _,Xc as L,bc as d,cc as n,h as b,hc as P,i as v,ka as p,mc as R,pa as l,qc as O,rb as h,rc as c,xb as a}from"./chunk-MCPF2SEG.js";import{i as E}from"./chunk-VBFW7A5V.js";function q(r,Z){if(r&1){let e=P();d(0,"button",7),O("click",function(){u(e);let i=c();return g(i.reInitializeDashboard())}),R(1,1),n()}}function Y(r,Z){if(r&1){let e=P();d(0,"nui-dashboard",8),I("dashboardChange",function(i){u(e);let o=c();return S(o.dashboard,i)||(o.dashboard=i),g(i)})("gridsterConfigChange",function(i){u(e);let o=c();return S(o.gridsterConfig,i)||(o.gridsterConfig=i),g(i)}),n()}if(r&2){let e=c();w("dashboard",e.dashboard)("gridsterConfig",e.gridsterConfig),_("editMode",e.editMode)("nuiWidgetEditor",e.persistenceHandler)}}var Q=(()=>{class r{constructor(e){this.toastService=e,this.persistenceSucceeded=!0,this.trySubmit=t=>{let i=new b;return t.id||(t.id=j()),setTimeout(()=>{if(this.persistenceSucceeded)i.next(t),this.toastService.success({title:$localize`Submit succeeded.`});else{let o=$localize`Submit failed.`;this.toastService.error({title:o}),i.error(o)}i.complete()},1e3),i.asObservable()},this.tryRemove=t=>{let i=new b;return setTimeout(()=>{if(this.persistenceSucceeded)i.next(t),this.toastService.success({title:$localize`Removal succeeded.`});else{let o=$localize`Removal failed.`;this.toastService.error({title:o}),i.error(o)}i.complete()},1e3),i.asObservable()},this.toastService.setConfig({timeOut:2e3})}static{this.\u0275fac=function(t){return new(t||r)(l(z))}}static{this.\u0275prov=p({token:r,factory:r.\u0275fac})}}return r})(),Se=(()=>{class r{constructor(e,t,i,o){this.widgetTypesService=e,this.providerRegistry=t,this.persistenceHandler=i,this.changeDetectorRef=o,this.gridsterConfig={},this.editMode=!1}ngOnInit(){let e=this.widgetTypesService.getWidgetType("kpi",1);this.widgetTypesService.setNode(e,"configurator",K.DataSourceProviders,[m.providerId,A.providerId]),this.providerRegistry.setProviders({[m.providerId]:{provide:N,useClass:m,deps:[s]},[A.providerId]:{provide:N,useClass:A,deps:[s]}}),this.initializeDashboard()}reInitializeDashboard(){this.dashboard=void 0,this.changeDetectorRef.detectChanges(),this.initializeDashboard()}initializeDashboard(){let e=ee,t={[e.id]:this.widgetTypesService.mergeWithWidgetType(e)},i={[e.id]:{cols:4,rows:6,y:0,x:0}};this.dashboard={positions:i,widgets:t}}static{this.\u0275fac=function(t){return new(t||r)(a(X),a($),a(Q),a(L))}}static{this.\u0275cmp=M({type:r,selectors:[["persistence-handler-setup"]],standalone:!1,features:[x([Q])],decls:6,vars:3,consts:()=>{let e;e=$localize`:␟8c375764db42f5d736fb56d01b8052c006ccc8e2␟6407712033679505505:Edit Mode`;let t;return t=$localize`:␟d5f3a9f5327ea05dc5ebdb3041c289676a0115a5␟1797884770484430607: Restore Widget `,[e,t,[1,"my-3","d-flex","align-items-center"],[1,"ml-3",3,"valueChange","value"],["type","button","displayStyle","action","nui-button","",3,"click",4,"ngIf"],[1,"w-100","dashboard"],[3,"dashboard","gridsterConfig","editMode","nuiWidgetEditor","dashboardChange","gridsterConfigChange",4,"ngIf"],["type","button","displayStyle","action","nui-button","",3,"click"],[3,"dashboardChange","gridsterConfigChange","dashboard","gridsterConfig","editMode","nuiWidgetEditor"]]},template:function(t,i){t&1&&(d(0,"div",2)(1,"nui-switch",3),I("valueChange",function(C){return S(i.editMode,C)||(i.editMode=C),C}),R(2,0),n(),y(3,q,2,0,"button",4),n(),d(4,"div",5),y(5,Y,1,4,"nui-dashboard",6),n()),t&2&&(h(),w("value",i.editMode),h(2),_("ngIf",!(i.dashboard!=null&&i.dashboard.widgets.widget1)),h(2),_("ngIf",i.dashboard))},dependencies:[H,B,J,k,W],styles:[".dashboard[_ngcontent-%COMP%]{height:800px}"]})}}return r})(),m=(()=>{class r extends D{static{this.providerId="AverageRatingKpiDataSource"}constructor(e){super(),this.http=e,this.busy=new v(!1)}getFilteredData(){return E(this,null,function*(){return this.busy.next(!0),new Promise(e=>{this.http.get("https://www.googleapis.com/books/v1/volumes/5MQFrgEACAAJ").pipe(T(()=>this.busy.next(!1))).subscribe({next:t=>{e({result:{value:t.volumeInfo.averageRating}})},error:t=>{e({result:null,error:{type:t.status}})}})})})}ngOnDestroy(){this.outputsSubject.complete()}static{this.\u0275fac=function(t){return new(t||r)(l(s))}}static{this.\u0275prov=p({token:r,factory:r.\u0275fac})}}return r})(),A=(()=>{class r extends D{static{this.providerId="RatingsCountKpiDataSource"}constructor(e){super(),this.http=e,this.busy=new v(!1)}getFilteredData(){return E(this,null,function*(){return this.busy.next(!0),new Promise(e=>{this.http.get("https://www.googleapis.com/books/v1/volumes/5MQFrgEACAAJ").pipe(T(()=>this.busy.next(!1))).subscribe({next:t=>{e({result:{value:t.volumeInfo.ratingsCount}})},error:t=>{e({result:null,error:{type:t.status}})}})})})}ngOnDestroy(){this.outputsSubject.complete()}static{this.\u0275fac=function(t){return new(t||r)(l(s))}}static{this.\u0275prov=p({token:r,factory:r.\u0275fac})}}return r})(),ee={id:"widget1",type:"kpi",pizzagna:{[V.Configuration]:{[U]:{providers:{[f.Refresher]:{properties:{interval:60*10,enabled:!0}}}},header:{properties:{title:"Harry Potter and the Sorcerer's Stone",subtitle:"By J. K. Rowling"}},tiles:{properties:{nodes:["kpi1"]}},kpi1:{id:"kpi1",componentType:G.lateLoadKey,properties:{widgetData:{units:"out of 5 Stars",label:"Average Rating"}},providers:{[f.DataSource]:{providerId:m.providerId},[f.Adapter]:{providerId:F,properties:{componentId:"kpi1",propertyPath:"widgetData"}}}}}}};export{Q as a,Se as b,m as c,A as d};
