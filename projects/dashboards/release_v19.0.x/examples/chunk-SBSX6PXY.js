import{a as W}from"./chunk-ZKE5BQF3.js";import{Na as L,ca as A,ea as H,ja as G,s as R}from"./chunk-573U3PX6.js";import{Cd as j,Ec as U,h as Q,mb as F}from"./chunk-PMWUHOKA.js";import{d as K,f as N,j as z,k as Z}from"./chunk-YHLZAVJ5.js";import{Aa as S,Ac as m,Ba as C,Bc as h,Ca as w,Cc as x,Db as T,Dc as E,Ib as g,Jc as D,Sc as P,Ub as o,Vb as b,Wb as V,Xb as M,Xc as B,bc as u,cc as c,dc as $,ec as _,fc as f,gc as v,hc as k,nb as I,qc as y,rb as l,rc as p,xb as d}from"./chunk-MCPF2SEG.js";import{g as J}from"./chunk-VBFW7A5V.js";var q=J(Q());var X=i=>({"background-color":i}),Y=i=>({color:i});function tt(i,s){if(i&1&&(_(0),u(1,"a",5),v(2,6),c(),f()),i&2){let e=p(),n=m(4);l(),o("href",e.widgetData.link,I),l(),o("ngTemplateOutlet",n)}}function et(i,s){if(i&1){let e=k();_(0),u(1,"div",7),y("click",function(){C(e);let t=p();return w(t.onInteraction())}),v(2,6),c(),f()}if(i&2){p();let e=m(4);l(2),o("ngTemplateOutlet",e)}}function nt(i,s){}function it(i,s){if(i&1){let e=k();_(0,15,2),u(2,"div",16)(3,"span",17),g(4,nt,0,0,"ng-template",18),y("attached",function(t){C(e);let a=m(1);return w(a.attached(t))}),c()(),f()}if(i&2){let e,n,t,a=m(1),r=p(2);o("componentType",r.configuration==null||r.configuration.formatters==null||r.configuration.formatters.Value==null||r.configuration.formatters.Value.formatter==null?null:r.configuration.formatters.Value.formatter.componentType)("properties",r.formattersProperties.Value),l(3),o("ngClass",(r.configuration==null||r.configuration.formatters==null||r.configuration.formatters.Value==null||r.configuration.formatters.Value.formatter==null?null:r.configuration.formatters.Value.formatter.componentType)==="IconFormatterComponent"?"without-filter":"")("useZoom",!1)("margin",(e=r.widgetData==null?null:r.widgetData.margin)!==null&&e!==void 0?e:2)("scaleIN$",(n=r.getScaleBroker("value"))==null?null:n.out$)("scaleOUT$",(t=r.getScaleBroker("value"))==null?null:t.in$),l(),o("cdkPortalOutlet",a.portal)}}function ot(i,s){if(i&1&&(u(0,"div",19)(1,"span",20),h(2),c()()),i&2){let e,n,t=p(2);o("title",t.widgetData==null?null:t.widgetData.units),l(),o("useZoom",!1)("scaleIN$",(e=t.getScaleBroker("units"))==null?null:e.out$)("scaleOUT$",(n=t.getScaleBroker("units"))==null?null:n.in$)("minScale",.5),l(),x(t.widgetData==null?null:t.widgetData.units)}}function at(i,s){if(i&1&&($(0,"div",8),u(1,"div",9)(2,"div",10)(3,"div",11)(4,"span",12),h(5),c()(),g(6,it,5,8,"ng-container",13)(7,ot,3,6,"div",14),c()()),i&2){let e,n,t=p(),a=m(6);V("nui-kpi-indicator--interactive",t.interactive),o("ngStyle",D(13,X,t.backgroundColor||(t.widgetData==null?null:t.widgetData.backgroundColor))),l(),o("ngStyle",D(15,Y,(t.widgetData==null?null:t.widgetData.textColor)||t.backgroundColor||(t.widgetData==null?null:t.widgetData.backgroundColor)||t.defaultColor)),l(2),o("title",t.widgetData==null?null:t.widgetData.label),l(),o("useZoom",!1)("minScale",.5)("scaleIN$",(e=t.getScaleBroker("label"))==null?null:e.out$)("scaleOUT$",(n=t.getScaleBroker("label"))==null?null:n.in$),l(),x(t.widgetData==null?null:t.widgetData.label),l(),o("ngIf",t.configuration==null||t.configuration.formatters==null?null:t.configuration.formatters.Value)("ngIfElse",a),l(),o("ngIf",t.widgetData==null?null:t.widgetData.units)}}function rt(i,s){if(i&1&&(u(0,"div",21)(1,"span",22),h(2),c()()),i&2){let e,n,t,a=p();b("font-size",a.widgetData==null?null:a.widgetData.fontSize),o("title",a.widgetData==null?null:a.widgetData.value),l(),o("useZoom",!1)("margin",(e=a.widgetData==null?null:a.widgetData.margin)!==null&&e!==void 0?e:2)("scaleIN$",(n=a.getScaleBroker("value"))==null?null:n.out$)("scaleOUT$",(t=a.getScaleBroker("value"))==null?null:t.in$),l(),E(" ",a.widgetData==null?null:a.widgetData.value,"")}}var _t=(()=>{class i{static{this.lateLoadKey="KpiComponent"}get interactive(){return(this.configuration?.interactive||this.dataSource?.features?.getFeatureConfig(G.Interactivity)?.enabled)&&!(0,q.default)(this.widgetData?.value)||!1}constructor(e,n,t){this.changeDetector=e,this.dataSource=n,this.eventBus=t,this.busy=!1,this.elementClass="",this.defaultColor="var(--nui-color-bg-secondary)"}onInteraction(){this.interactive&&this.eventBus.getStream(R).next({payload:{data:this.widgetData}})}getScaleBroker(e){if(this.syncValuesBroker)return this.syncValuesBroker.find(n=>n.id===e)}ngOnChanges(e){if(e.configuration){let n=e.configuration.currentValue.formatters;n&&(this.formattersProperties=this.getFormatterProperties(n))}e.widgetData&&this.configuration?.formatters&&(this.formattersProperties=this.getFormatterProperties(this.configuration.formatters))}get showEmpty(){return typeof this.widgetData?.value=="boolean"?!1:Array.isArray(this.widgetData?.value)&&this.widgetData?.value.length===0?!0:!this.widgetData?.value&&this.widgetData?.value!==0}getFormatterProperties(e){return Object.keys(e).reduce((a,r)=>{let O=e[r]?.formatter;return O&&(a[r]={data:W(O,this.widgetData)}),a},{})}static{this.\u0275fac=function(n){return new(n||i)(d(B),d(H,8),d(A))}}static{this.\u0275cmp=T({type:i,selectors:[["nui-kpi"]],hostVars:2,hostBindings:function(n,t){n&2&&M(t.elementClass)},inputs:{widgetData:"widgetData",backgroundColor:"backgroundColor",syncValuesBroker:"syncValuesBroker",configuration:"configuration",busy:"busy"},standalone:!1,features:[S],decls:7,vars:3,consts:[["kpiContent",""],["kpiValueRaw",""],["componentPortal","nuiComponentPortal"],["nui-busy","",1,"w-100","h-100",3,"busy"],[4,"ngIf"],[1,"nui-kpi-indicator",3,"href"],[3,"ngTemplateOutlet"],[1,"nui-kpi-indicator",3,"click"],[1,"nui-kpi-indicator__background",3,"ngStyle"],[1,"nui-kpi-indicator__text",3,"ngStyle"],[1,"nui-kpi-indicator__zoom-container"],[1,"nui-kpi-indicator__description","nui-kpi-indicator__zoom-container__row",3,"title"],["nuiZoomContent","",3,"useZoom","minScale","scaleIN$","scaleOUT$"],["nuiComponentPortal","","componentId","KpiValueFormatter",3,"componentType","properties",4,"ngIf","ngIfElse"],["class","nui-kpi-indicator__units nui-kpi-indicator__zoom-container__row",3,"title",4,"ngIf"],["nuiComponentPortal","","componentId","KpiValueFormatter",3,"componentType","properties"],[1,"nui-kpi-indicator__value","nui-kpi-indicator__zoom-container__row"],["nuiZoomContent","",3,"ngClass","useZoom","margin","scaleIN$","scaleOUT$"],[3,"attached","cdkPortalOutlet"],[1,"nui-kpi-indicator__units","nui-kpi-indicator__zoom-container__row",3,"title"],["nuiZoomContent","",3,"useZoom","scaleIN$","scaleOUT$","minScale"],[1,"nui-kpi-indicator__value","nui-kpi-indicator__zoom-container__row",3,"title"],["nuiZoomContent","",3,"useZoom","margin","scaleIN$","scaleOUT$"]],template:function(n,t){n&1&&(u(0,"div",3),g(1,tt,3,2,"ng-container",4)(2,et,3,1,"ng-container",4),c(),g(3,at,8,17,"ng-template",null,0,P)(5,rt,3,8,"ng-template",null,1,P)),n&2&&(o("busy",t.busy),l(),o("ngIf",t.widgetData==null?null:t.widgetData.link),l(),o("ngIf",!(t.widgetData!=null&&t.widgetData.link)))},dependencies:[K,N,Z,z,j,F,L,U],styles:[".nui-kpi-indicator[_ngcontent-%COMP%]{position:relative;display:block;height:100%;width:100%}.nui-kpi-indicator__background[_ngcontent-%COMP%]{height:100%;width:100%;background-color:var(--nui-color-bg-secondary,#fafafa);color:var(--nui-color-text-default,#111)}.nui-kpi-indicator__text[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;pointer-events:none}.nui-kpi-indicator__text[_ngcontent-%COMP%]   *[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{filter:invert(1) grayscale(1) contrast(100)}.nui-kpi-indicator__value[_ngcontent-%COMP%]{font-size:54px;font-weight:600;margin:auto 0;min-width:100%;white-space:nowrap;display:flex;align-items:center;justify-content:center;height:100%;min-height:5px;max-height:200px}.nui-kpi-indicator__value[_ngcontent-%COMP%] > span.without-filter[_ngcontent-%COMP%]{filter:unset}.nui-kpi-indicator__units[_ngcontent-%COMP%]{font-size:16px;font-weight:600;min-width:0;margin-bottom:auto;display:flex;align-items:center;justify-content:center;height:100%;min-height:10px;max-height:45px}.nui-kpi-indicator__units[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;-ms-text-overflow:ellipsis;-o-text-overflow:ellipsis;text-overflow:ellipsis}.nui-kpi-indicator__description[_ngcontent-%COMP%]{font-size:16px;font-weight:600;min-width:0;margin-top:auto;display:flex;align-items:center;justify-content:center;height:100%;min-height:10px;max-height:45px}.nui-kpi-indicator__description[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;-ms-text-overflow:ellipsis;-o-text-overflow:ellipsis;text-overflow:ellipsis}.nui-kpi-indicator__zoom-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;width:100%;height:100%}.nui-kpi-indicator__zoom-container[_ngcontent-%COMP%]:has(.nui-kpi-indicator__zoom-container__row:nth-child(3)){grid-template-rows:30% 40% 30%}.nui-kpi-indicator__zoom-container[_ngcontent-%COMP%]:not(:has(.nui-kpi-indicator__zoom-container__row:nth-child(3))){grid-template-rows:30% 70%}.nui-kpi-indicator--interactive[_ngcontent-%COMP%]{cursor:pointer}.nui-kpi-indicator--interactive[_ngcontent-%COMP%]:hover{filter:brightness(90%)}.is-empty[_ngcontent-%COMP%]{display:grid;place-content:center;height:100%}"],changeDetection:0})}}return i})();export{_t as a};
