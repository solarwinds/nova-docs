import{a as C,h as oe,j as re}from"./chunk-PPQN6QZA.js";import{a as D}from"./chunk-MD6F45Z7.js";import{a as ne}from"./chunk-SBSX6PXY.js";import{A as te,Ja as ie,c as ee,ea as h,ha as f,ia as O,ka as R}from"./chunk-573U3PX6.js";import{Dc as J,Kd as Y,Xc as q,oc as V,vd as Z,we as M}from"./chunk-PMWUHOKA.js";import{C as c}from"./chunk-YHLZAVJ5.js";import{Ac as $,Ba as j,Bc as B,Ca as L,Cc as X,Db as y,Ec as E,Fc as m,Gc as W,Hc as H,Ib as z,La as x,O as P,Sc as Q,U as w,Ub as T,bc as a,cc as d,da as N,h as l,hc as U,i as _,ka as p,mc as b,pa as g,qc as I,rb as u,xb as s,xc as F,yc as G,zc as K}from"./chunk-MCPF2SEG.js";import{i as v}from"./chunk-VBFW7A5V.js";function pe(i,ce){if(i&1&&(a(0,"div",3)(1,"div",4),B(2),d()()),i&2){let t=ce.item;u(2),X(t.name)}}var ae=".dashboard[_ngcontent-%COMP%]{height:800px}.nui-widget-cloner__item[_ngcontent-%COMP%]{height:60px}",ue=(()=>{class i{constructor(t){this.widgetTypesService=t,this.widgetSelected=new x,this.widgetItems=[]}ngOnInit(){this.widgetItems=[{name:"Fully Configured KPI Widget",widget:this.widgetTypesService.mergeWithWidgetType(de)},{name:"Unconfigured Proportional Widget",widget:this.widgetTypesService.mergeWithWidgetType(ge)}]}onSelect(t){this.widgetSelected.emit(t[0].widget),this.widgetSelection=t}static{this.\u0275fac=function(e){return new(e||i)(s(D))}}static{this.\u0275cmp=y({type:i,selectors:[["widget-template-selection"]],outputs:{widgetSelected:"widgetSelected"},standalone:!1,decls:4,vars:3,consts:[["widgetClonerItem",""],[1,"nui-widget-cloner"],["selectionMode","singleWithRequiredSelection",3,"selectionChange","itemsSource","selection","repeatItemTemplateRef"],[1,"nui-widget-cloner__item","d-flex","pt-2","pb-2","align-items-center"],[1,"text-info","ml-3"]],template:function(e,n){if(e&1){let o=U();a(0,"div",1)(1,"nui-repeat",2),I("selectionChange",function(le){return j(o),L(n.onSelect(le))}),d()(),z(2,pe,3,1,"ng-template",null,0,Q)}if(e&2){let o=$(3);u(),T("itemsSource",n.widgetItems)("selection",n.widgetSelection)("repeatItemTemplateRef",o)}},dependencies:[Z],styles:[ae]})}}return i})(),se=(()=>{class i{constructor(t){this.toastService=t,this.persistenceSucceeded=!0,this.trySubmit=e=>{let n=new l;return e.id||(e.id=J()),setTimeout(()=>{if(this.persistenceSucceeded)n.next(e),this.toastService.success({title:$localize`Submit succeeded.`});else{let o=$localize`Submit failed.`;this.toastService.error({title:o}),n.error(o)}n.complete()},1e3),n.asObservable()},this.tryRemove=e=>{let n=new l;return setTimeout(()=>{if(this.persistenceSucceeded)n.next(e),this.toastService.success({title:$localize`Removal success`});else{let o=$localize`Removal failed.`;this.toastService.error({title:o}),n.error(o)}n.complete()},1e3),n.asObservable()},this.toastService.setConfig({timeOut:2e3})}static{this.\u0275fac=function(e){return new(e||i)(g(Y))}}static{this.\u0275prov=p({token:i,factory:i.\u0275fac})}}return i})(),Pe=(()=>{class i{constructor(t,e,n,o){this.widgetTypesService=t,this.providerRegistry=e,this.persistenceHandler=n,this.widgetClonerService=o,this.gridsterConfig={defaultItemCols:3,defaultItemRows:5},this.editMode=!1,this.destroy$=new l}ngOnInit(){let t=this.widgetTypesService.getWidgetType("kpi",1),e=this.widgetTypesService.getWidgetType("proportional",1);this.widgetTypesService.setNode(e,"configurator",O.DataSourceProviders,[A.providerId]),this.widgetTypesService.setNode(t,"configurator",O.DataSourceProviders,[S.providerId,k.providerId]),this.providerRegistry.setProviders({[S.providerId]:{provide:h,useClass:S,deps:[c]},[k.providerId]:{provide:h,useClass:k,deps:[c]},[A.providerId]:{provide:h,useClass:A,deps:[]}}),this.initializeDashboard()}onCreateWidget(){let t={dashboardComponent:this.dashboardComponent,trySubmit:this.persistenceHandler.trySubmit,widgetSelectionComponentType:ue};this.widgetClonerService.open(t).pipe(P(1),N(this.destroy$)).subscribe()}initializeDashboard(){let t=de,e={[t.id]:this.widgetTypesService.mergeWithWidgetType(t)},n={[t.id]:{cols:3,rows:5,y:0,x:0}};this.dashboard={positions:n,widgets:e}}static{this.\u0275fac=function(e){return new(e||i)(s(D),s(ie),s(se),s(oe))}}static{this.\u0275cmp=y({type:i,selectors:[["widget-creation"]],viewQuery:function(e,n){if(e&1&&F(C,7),e&2){let o;G(o=K())&&(n.dashboardComponent=o.first)}},standalone:!1,features:[H([se])],decls:7,vars:5,consts:()=>{let t;t=$localize`:␟8c375764db42f5d736fb56d01b8052c006ccc8e2␟6407712033679505505:Edit Mode`;let e;return e=$localize`:␟bd773f8bf007ab93f7e28768edbf74c97381dff0␟5534056112042972153: Create Widget `,[t,e,[1,"my-3","d-flex","align-items-center"],[1,"ml-3",3,"valueChange","value"],["type","button","nui-button","",1,"ml-4",3,"click"],[1,"w-100","dashboard"],[3,"dashboardChange","gridsterConfigChange","dashboard","gridsterConfig","editMode","nuiWidgetEditor"]]},template:function(e,n){e&1&&(a(0,"div",2)(1,"nui-switch",3),W("valueChange",function(r){return m(n.editMode,r)||(n.editMode=r),r}),b(2,0),d(),a(3,"button",4),I("click",function(){return n.onCreateWidget()}),b(4,1),d()(),a(5,"div",5)(6,"nui-dashboard",6),W("dashboardChange",function(r){return m(n.dashboard,r)||(n.dashboard=r),r})("gridsterConfigChange",function(r){return m(n.gridsterConfig,r)||(n.gridsterConfig=r),r}),d()()),e&2&&(u(),E("value",n.editMode),u(5),E("dashboard",n.dashboard)("gridsterConfig",n.gridsterConfig),T("editMode",n.editMode)("nuiWidgetEditor",n.persistenceHandler))},dependencies:[C,re,q,V],styles:[ae]})}}return i})(),A=(()=>{class i{constructor(){this.outputsSubject=new l}static{this.providerId="RandomCitiesProportionalDataSource"}applyFilters(){setTimeout(()=>{this.outputsSubject.next({result:this.getRandomProportionalWidgetData()})},1e3)}ngOnDestroy(){this.outputsSubject.complete()}getRandomProportionalWidgetData(){return[{id:"Down",name:"Down",data:[Math.round(Math.random()*100)],icon:"status_down",link:"https://en.wikipedia.org/wiki/Brno",value:"Brno"},{id:"Critical",name:"Critical",data:[Math.round(Math.random()*100)],icon:"status_critical",link:"https://en.wikipedia.org/wiki/Kyiv",value:"Kyiv"},{id:"Warning",name:"Warning",data:[Math.round(Math.random()*100)],icon:"status_warning",link:"https://en.wikipedia.org/wiki/Austin",value:"Austin"},{id:"Unknown",name:"Unknown",data:[Math.round(Math.random()*100)],icon:"status_unknown",link:"https://en.wikipedia.org/wiki/Lisbon",value:"Lisbon"},{id:"Up",name:"Up",data:[Math.round(Math.random()*100)],icon:"status_up",link:"https://en.wikipedia.org/wiki/Sydney",value:"Sydney"},{id:"Unmanaged",name:"Unmanaged",data:[Math.round(Math.random()*100)],icon:"status_unmanaged",link:"https://en.wikipedia.org/wiki/Nur-Sultan",value:"Nur-Sultan"}]}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275prov=p({token:i,factory:i.\u0275fac})}}return i})(),S=(()=>{class i extends M{static{this.providerId="AverageRatingKpiDataSource"}constructor(t){super(),this.http=t,this.busy=new _(!1)}getFilteredData(){return v(this,null,function*(){return this.busy.next(!0),new Promise(t=>{this.http.get("https://www.googleapis.com/books/v1/volumes/5MQFrgEACAAJ").pipe(w(()=>this.busy.next(!1))).subscribe({next:e=>{t({result:{value:e.volumeInfo.averageRating}})},error:e=>{t({result:null,error:{type:e.status}})}})})})}ngOnDestroy(){this.outputsSubject.complete()}static{this.\u0275fac=function(e){return new(e||i)(g(c))}}static{this.\u0275prov=p({token:i,factory:i.\u0275fac})}}return i})(),k=(()=>{class i extends M{static{this.providerId="RatingsCountKpiDataSource"}constructor(t){super(),this.http=t,this.busy=new _(!1)}getFilteredData(){return v(this,null,function*(){return this.busy.next(!0),new Promise(t=>{this.http.get("https://www.googleapis.com/books/v1/volumes/5MQFrgEACAAJ").pipe(w(()=>this.busy.next(!1))).subscribe({next:e=>{t({result:{value:e.volumeInfo.ratingsCount}})},error:e=>{t({result:null,error:{type:e.status}})}})})})}ngOnDestroy(){this.outputsSubject.complete()}static{this.\u0275fac=function(e){return new(e||i)(g(c))}}static{this.\u0275prov=p({token:i,factory:i.\u0275fac})}}return i})(),de={id:"widget1",type:"kpi",pizzagna:{[R.Configuration]:{[ee]:{providers:{[f.Refresher]:{properties:{interval:60*10,enabled:!0}}}},header:{properties:{title:"Harry Potter and the Sorcerer's Stone",subtitle:"By J. K. Rowling"}},tiles:{properties:{nodes:["kpi1"]}},kpi1:{id:"kpi1",componentType:ne.lateLoadKey,properties:{widgetData:{units:"out of 5 Stars",label:"Average Rating"}},providers:{[f.DataSource]:{providerId:S.providerId},[f.Adapter]:{providerId:te,properties:{componentId:"kpi1",propertyPath:"widgetData"}}}}}}},ge={id:"widget2",type:"proportional",metadata:{needsConfiguration:!0},pizzagna:{[R.Configuration]:{header:{properties:{title:"*New Proportional Widget*"}}}}};export{ue as a,se as b,Pe as c,A as d,S as e,k as f};
