import{d as O,h as oe,i as re,j as P,k as R,l as ae}from"./chunk-K6DXWVOP.js";import{a as ie}from"./chunk-ZKE5BQF3.js";import{Na as ne,c as I,ca as b,d as Q,ea as ee,ha as te,ka as L,m as W,w as x}from"./chunk-573U3PX6.js";import{Cc as Y,Oc as X,Td as J,mb as G,oc as H,vd as q}from"./chunk-PMWUHOKA.js";import{f as y}from"./chunk-YHLZAVJ5.js";import{Aa as B,Ac as w,Ba as c,Bc as K,Ca as p,Cc as U,Db as C,Ib as g,Ic as Z,La as N,M as V,Ma as F,Pa as k,Sc as z,Ub as o,Wb as A,Xb as M,Xc as D,bc as m,cc as d,da as T,dc as E,ec as j,fc as $,h as S,hc as v,qc as h,rb as u,rc as r,xb as s}from"./chunk-MCPF2SEG.js";import{a as l,b as _}from"./chunk-VBFW7A5V.js";function ue(i,f){if(i&1){let e=v();m(0,"div",1)(1,"button",2),h("click",function(){c(e);let n=r();return p(n.onBack())}),d(),m(2,"button",3),h("click",function(){c(e);let n=r();return p(n.onHome())}),d(),m(3,"div",4),K(4),d()()}if(i&2){let e=r();u(),o("isRepeat",!0)("disabled",!(!(e.navBarConfig==null||e.navBarConfig.buttons==null||e.navBarConfig.buttons.back==null)&&e.navBarConfig.buttons.back.disabled)),u(),o("isRepeat",!0),u(2),U(e.navBarConfig==null?null:e.navBarConfig.label)}}var le=(()=>{class i{static{this.lateLoadKey="ListNavigationBarComponent"}constructor(e,t){this.changeDetector=e,this.eventBus=t,this.navigated=new N}onBack(){this.navBarConfig&&this.eventBus.getStream(x).next({payload:{back:this.navBarConfig?.buttons?.back?.disabled}})}onHome(){this.eventBus.getStream(x).next({payload:{reset:!0}})}static{this.\u0275fac=function(t){return new(t||i)(s(D),s(b))}}static{this.\u0275cmp=C({type:i,selectors:[["nui-navigation-bar"]],inputs:{navBarConfig:"navBarConfig"},outputs:{navigated:"navigated"},standalone:!1,decls:1,vars:1,consts:[["class","list-nav-bar",4,"ngIf"],[1,"list-nav-bar"],["nui-button","","type","button","displayStyle","action","icon","arrow-left",3,"click","isRepeat","disabled"],["nui-button","","type","button","displayStyle","action","icon","overview",3,"click","isRepeat"],[1,"list-nav-bar__label"]],template:function(t,n){t&1&&g(0,ue,5,4,"div",0),t&2&&o("ngIf",n.navBarConfig&&!(n.navBarConfig!=null&&n.navBarConfig.isRoot))},dependencies:[y,H],styles:[".list-nav-bar[_ngcontent-%COMP%]{width:100%;margin:2px 0;padding:0 15px;display:flex;align-items:center}.list-nav-bar__label[_ngcontent-%COMP%]{padding-left:5px;color:#1119}"],changeDetection:0})}}return i})();var ge=()=>["navigated"];function he(i,f){if(i&1&&E(0,"nui-repeat",4),i&2){let e=r(),t=w(3);o("itemsSource",e.data)("repeatItemTemplateRef",t)}}function fe(i,f){i&1&&(m(0,"div",5),E(1,"nui-image",6),d())}function _e(i,f){i&1&&(m(0,"div",5),E(1,"nui-image",6),d())}function Ce(i,f){}function ve(i,f){if(i&1){let e=v();g(0,_e,2,0,"div",3),j(1,7,1),h("output",function(){let n=c(e).item,a=r();return p(a.onListItemEvent(n))}),g(3,Ce,0,0,"ng-template",8),h("attached",function(n){c(e);let a=w(2);return p(a.attached(n))}),$()}if(i&2){let e=f.item,t=w(2),n=r();o("ngIf",!e),u(),o("componentId",n.configuration.componentType)("componentType",n.configuration.componentType)("properties",n.getPropsFor(e))("outputs",Z(6,ge)),u(2),o("cdkPortalOutlet",t.portal)}}var ye=10,me=(()=>{class i{static{this.lateLoadKey="ListWidgetComponent"}constructor(e,t,n,a){this.changeDetector=e,this.zone=t,this.host=n,this.eventBus=a,this.itemFormatterProps=new Map,this.destroy$=new S}ngOnInit(){this.initResizeObserver()}ngOnChanges(e){e.data?.currentValue&&e.data.currentValue.forEach(t=>this.itemFormatterProps.set(t,this.calcItemProps(t)))}onListItemEvent(e){this.eventBus.getStream(x).next({payload:e})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.itemFormatterProps.clear()}getPropsFor(e){return _(l({},this.itemFormatterProps.get(e)),{widgetWidth:this.widgetWidth})}shouldDisplayRepeat(){return this.data?.length>0}calcItemProps(e){return this.configuration?l(l({},ie(this.configuration,e)),this.configuration.itemProperties):e}initResizeObserver(){let e=new Y(this.host,this.zone);e.debounceTime=ye,e.ngAfterViewInit(),e.containerResize.pipe(T(this.destroy$)).subscribe(()=>{this.widgetWidth=this.host.nativeElement.offsetWidth})}static{this.\u0275fac=function(t){return new(t||i)(s(D),s(F),s(k),s(b))}}static{this.\u0275cmp=C({type:i,selectors:[["nui-list-widget"]],hostVars:2,hostBindings:function(t,n){t&2&&M(n.elementClass)},inputs:{data:"data",configuration:"configuration",elementClass:"elementClass"},standalone:!1,features:[B],decls:4,vars:2,consts:[["repeatItemTemplate",""],["componentPortal","nuiComponentPortal"],[3,"itemsSource","repeatItemTemplateRef",4,"ngIf"],["class","empty",4,"ngIf"],[3,"itemsSource","repeatItemTemplateRef"],[1,"empty"],["image","no-data-to-show"],["nuiComponentPortal","",3,"output","componentId","componentType","properties","outputs"],[3,"attached","cdkPortalOutlet"]],template:function(t,n){t&1&&g(0,he,1,2,"nui-repeat",2)(1,fe,2,0,"div",3)(2,ve,4,7,"ng-template",null,0,z),t&2&&(o("ngIf",n.shouldDisplayRepeat()),u(),o("ngIf",!n.shouldDisplayRepeat()))},dependencies:[y,X,G,ne,q],styles:["[_nghost-%COMP%]{height:100%;overflow:auto}.empty[_ngcontent-%COMP%]{height:100%;display:grid;place-content:center}"]})}}return i})();function be(i,f){if(i&1){let e=v();m(0,"nui-search",1),h("inputChange",function(n){c(e);let a=r();return p(a.onSearchInputChanged(n))})("cancel",function(n){c(e);let a=r();return p(a.onSearch(n))})("search",function(n){c(e);let a=r();return p(a.onSearch(n))}),d()}if(i&2){let e=r();o("value",e.searchValue)}}var de=(()=>{class i{static{this.lateLoadKey="WidgetSearchComponent"}static{this.defaultSearchDebounce=500}constructor(e,t){this.dataSource=e,this.eventBus=t,this.enabled=!1,this.searchTerm$=new S,this.destroy$=new S}ngOnInit(){this.dataSource.features?.getSupportedFeatures()?.search?.enabled&&(this.enabled=!0),this.registerFilters(),this.handleSearchTermSubscription(this.configuration?.searchOnKeyUp)}ngOnChanges(e){if(e.configuration){let t=e.configuration.currentValue;this.handleSearchTermSubscription(t.searchOnKeyUp)}}onSearchInputChanged(e){this.configuration?.searchOnKeyUp?.enabled&&(this.searchValue=e,this.searchTerm$.next(e))}onSearch(e){this.searchValue=e,this.searchTerm$.next(e)}ngOnDestroy(){this.eventBus.getStream(W).next({payload:""}),this.destroy$.next(),this.destroy$.complete()}registerFilters(){this.dataSource?.registerComponent({search:{componentInstance:{getFilters:()=>({value:this.searchValue})}}})}handleSearchTermSubscription(e){this.searchTermSubscription?.unsubscribe(),this.searchTermSubscription=this.searchTerm$.pipe(T(this.destroy$),V(e?.debounceTime||i.defaultSearchDebounce)).subscribe(t=>{this.eventBus.getStream(Q).next({}),this.eventBus.getStream(W).next({payload:t})})}static{this.\u0275fac=function(t){return new(t||i)(s(ee,8),s(b))}}static{this.\u0275cmp=C({type:i,selectors:[["nui-widget-search"]],hostVars:4,hostBindings:function(t,n){t&2&&A("default",n.enabled)("invisible",!n.enabled)},inputs:{configuration:"configuration",searchValue:"searchValue"},standalone:!1,features:[B],decls:1,vars:1,consts:[["class","unlimited-width",3,"value","inputChange","cancel","search",4,"ngIf"],[1,"unlimited-width",3,"inputChange","cancel","search","value"]],template:function(t,n){t&1&&g(0,be,1,1,"nui-search",0),t&2&&o("ngIf",n.enabled)},dependencies:[y,J],styles:[".default[_nghost-%COMP%]{padding:5px 10px}.invisible[_nghost-%COMP%]{height:0}"],changeDetection:0})}}return i})();var nt={[L.Structure]:_(l(_(l({[I]:{id:I,componentType:O.lateLoadKey,properties:{nodes:["header","loading","search","body"]},providers:{[te.EventProxy]:ae}},header:oe,loading:re,body:_(l({},P),{properties:_(l({},P.properties),{elementClass:"overflow-auto"})})},R("listWidget")),{search:{id:"search",componentType:de.lateLoadKey}}),R("mainContent")),{mainContent:{id:"mainContent",componentType:O.lateLoadKey,properties:{nodes:["navigationBar","listWidget"]}},navigationBar:{id:"navigationBar",componentType:le.lateLoadKey},listWidget:{id:"listWidget",componentType:me.lateLoadKey,providers:{},properties:{elementClass:"w-100 p-3"}}}),[L.Configuration]:{[I]:{id:I},header:{properties:{title:$localize`Empty Custom Widget`}}}};export{le as a,me as b,de as c,nt as d};
