import{e as pe,f as ge,g as Se}from"./chunk-EU2T5UE6.js";import{N as fe,c as me,ha as ce,va as he}from"./chunk-573U3PX6.js";import{Ba as x,Id as D,Xc as se,_c as ae,hd as le,ja as te,kc as re,la as ie,ld as ue,ma as p,nc as oe,oa as b,pa as F,sd as de,ta as ne,va as M,ya as y}from"./chunk-PMWUHOKA.js";import{e as J,f as Y,l as ee}from"./chunk-YHLZAVJ5.js";import{Aa as P,Bc as c,Db as I,Dc as h,H as w,Hc as K,Ib as N,La as z,Oc as C,Pc as T,Qc as Z,Ub as a,Wb as G,Xc as _,b as V,bc as l,cc as d,da as S,dc as A,fa as H,h as E,ja as U,mc as O,oc as B,pc as W,qc as j,rb as s,rc as k,x as L,xb as m,xc as q,yc as X,zc as Q}from"./chunk-MCPF2SEG.js";var n=function(r){return r.Second="second",r.Minute="minute",r.Hour="hour",r}(n||{}),Ce={[n.Second]:1e3,[n.Minute]:6e4,[n.Hour]:36e5},_e={[n.Hour]:$localize`:hours unit (long):hours`,[n.Minute]:$localize`:minutes unit (long):minutes`,[n.Second]:$localize`:seconds unit (long):seconds`},v={[n.Hour]:$localize`:hours unit (short):h`,[n.Minute]:$localize`:minutes unit (short):min`,[n.Second]:$localize`:seconds unit (short):sec`};function f(r,R){return Ce[r]/Ce[R]}function Oe(r,R){if(r&1&&(l(0,"nui-select-v2-option",7),c(1),d()),r&2){let e=R.$implicit;a("value",e),s(),h(" ",e.label," ")}}var $=(()=>{class r{constructor(e,i){this.fb=e,this.cd=i,this.possibleUnits=[n.Second,n.Minute,n.Hour],this.unitItems=[],this.displayedUnitItems=[],this.currentUnit=null,this.valueChangeFix=V,this.destroy$=new E}ngOnInit(){this.generateUnitItems(),this.filterUnitItems(),this.createForm()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}getNumberMin(){if(!this.unitControl.value||this.minSeconds==null)return;let e=f(n.Second,this.unitControl.value.id);return Math.ceil(this.minSeconds*e)}getNumberMax(){if(!this.unitControl.value||this.maxSeconds==null)return;let e=f(n.Second,this.unitControl.value.id);return Math.floor(this.maxSeconds*e)}writeValue(e){if(isFinite(e)&&this.isRangeValid()&&this.unitControl.value){let i=f(n.Second,this.unitControl.value.id),t=e*i;this.numberControl.setValue(t)}else this.numberControl.setValue(null);this.cd.markForCheck()}registerOnChange(e){this.onChange=e}registerOnTouched(e){}setDisabledState(e){e?(this.numberControl.disable({emitEvent:!1}),this.unitControl.disable({emitEvent:!1})):(this.numberControl.enable({emitEvent:!1}),this.unitControl.enable({emitEvent:!1})),this.cd.markForCheck()}resetUnits(){this.unitControl.setValue(this.displayedUnitItems[0])}generateUnitItems(){this.possibleUnits.forEach((e,i)=>{this.unitItems[i]={id:e,label:_e[e]}})}filterUnitItems(){this.displayedUnitItems=this.unitItems.filter(e=>{let i=!1;if(this.maxSeconds!=null){let t=f(n.Second,e.id);i=Math.floor(this.maxSeconds*t)<=0}return!i})}createForm(){this.form=this.fb.group({number:[1,[p.required]],unit:this.displayedUnitItems[0]}),this.numberControl=this.form.get("number"),this.unitControl=this.form.get("unit"),this.unitControl.value&&(this.currentUnit=this.unitControl.value.id),this.form.valueChanges.pipe(S(this.destroy$)).subscribe(()=>{this.updateError(),this.emitValueChange()})}updateError(){this.isNumberValid()?this.numberControl.setErrors(null):this.numberControl.setErrors({invalidNumber:!0})}emitValueChange(){let e=this.numberControl.value,i=this.unitControl.value;if(e==null||i==null){this.onChange&&this.onChange(null);return}let t=f(i.id,n.Second),o=e*t;this.onChange&&this.onChange(o)}isRangeValid(){return this.minSeconds<=this.maxSeconds||this.maxSeconds==null}isNumberValid(){let e=this.numberControl.value,i=this.unitControl.value;if(e<this.minSeconds||e%1!==0)return!1;let t=f(i.id,n.Second);return e*t>this.maxSeconds?!1:this.isRangeValid()}getNumberValidationMessage(){let e={min:this.getNumberMin(),max:this.getNumberMax(),whole:!0};return this.getLocalizedNumberValidationMessage(e)}getLocalizedNumberValidationMessage(e){let{min:i,max:t,whole:o}=e,u=o?$localize`a whole number`:$localize`a number`;return i!=null&&t!=null?i===t?$localize`Must be ${u} equal to ${i}`:$localize`Must be ${u} between ${i} and ${t}`:i==null&&t!=null?$localize`Must be ${u} not larger than ${t}`:i!=null&&t==null?$localize`Must be ${u} not smaller than ${i}`:$localize`Must be ${u}`}validate(){return this.form.get("number")?.errors||null}static{this.\u0275fac=function(i){return new(i||r)(m(x),m(_))}}static{this.\u0275cmp=I({type:r,selectors:[["nui-refresh-rate-configurator"]],inputs:{minSeconds:"minSeconds",maxSeconds:"maxSeconds"},standalone:!1,features:[K([{provide:te,useExisting:U(()=>r),multi:!0},{provide:ie,useExisting:U(()=>r),multi:!0}])],decls:8,vars:6,consts:[[1,"d-flex","flex-column",3,"formGroup"],[1,"d-flex","flex-row"],["formControlName","number","customBoxWidth","90px",3,"valueChange","minValue","maxValue"],["formControlName","unit",1,"ml-3"],[3,"value",4,"ngFor","ngForOf"],[3,"control"],["for","invalidNumber"],[3,"value"]],template:function(i,t){i&1&&(l(0,"form",0)(1,"div",1)(2,"nui-textbox-number",2),j("valueChange",function(){return t.valueChangeFix()}),d(),l(3,"nui-select-v2",3),N(4,Oe,2,2,"nui-select-v2-option",4),d()(),l(5,"nui-form-field",5)(6,"nui-validation-message",6),c(7),d()()()),i&2&&(a("formGroup",t.form),s(2),a("minValue",t.minSeconds)("maxValue",t.maxSeconds),s(2),a("ngForOf",t.displayedUnitItems),s(),a("control",t.form.get("number")),s(2),h(" ",t.getNumberValidationMessage()," "))},dependencies:[J,ne,b,F,M,y,de,D,ue,ae,le],encapsulation:2,changeDetection:0})}}return r})();function be(r,R){if(r&1&&(l(0,"div",16),O(1,2),d()),r&2){let e=k();s(),B(e.getDurationLabel(e.refresherSettings.refreshRateSeconds)),W(1)}}var ve=(()=>{class r{static{this.lateLoadKey="RefresherConfigurationComponent"}constructor(e,i,t,o,u){this.changeDetector=e,this.formBuilder=i,this.logger=t,this.refresherSettings=o,this.cd=u,this.minSeconds=1,this.maxSeconds=86400,this.overrideDefaultSettingsCaption=$localize`Custom refresh rate`,this.overrideDefaultSettings=!0,this.formReady=new z,this.destroyed$=new E,this.resetInterval=()=>{this.refreshRateComp.resetUnits(),this.form.get("interval")?.setValue(this.interval||this.minSeconds)}}ngOnInit(){this.form=this.formBuilder.group({enabled:[!0,[p.required]],overrideDefaultSettings:[this.overrideDefaultSettings,[p.required]],interval:[this.interval??0,[p.required]]}),this.form.statusChanges.pipe(S(this.destroyed$)).subscribe(()=>{this.form.markAllAsTouched(),this.cd.detectChanges()}),L([this.form.controls.enabled.valueChanges,this.form.controls.overrideDefaultSettings.valueChanges]).pipe(w(e=>e.some(i=>!i)),H(this.resetInterval),S(this.destroyed$)).subscribe(),this.formReady.emit(this.form)}ngOnChanges(e){e.enabled&&this.form?.get("enabled")?.patchValue(this.enabled),e.interval&&this.form?.get("interval")?.patchValue(this.interval),e.overrideDefaultSettings&&this.form?.get("overrideDefaultSettings")?.patchValue(this.overrideDefaultSettings)}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}getHeaderSubtitle(){let e="";return this.form.get("enabled")?.value?(e+=$localize`Enabled`,e+=", ",this.form.get("overrideDefaultSettings")?.value?e+=this.getDurationLabel(this.form.get("interval")?.value):e+=$localize`Use default value`+" ("+this.getDurationLabel(this.refresherSettings.refreshRateSeconds)+")"):e+=$localize`Disabled`,e}getDurationLabel(e){let i=e,t="",o=Math.floor(i/3600);i%=3600;let u=Math.floor(i/60),g=i%60;return o>0&&(t+=o+" "+v[n.Hour]+" "),u>0&&(t+=u+" "+v[n.Minute]+" "),g>0&&(t+=g+" "+v[n.Second]+" "),t=t.trim(),t===""?"0 "+v[n.Second]:t}static{this.\u0275fac=function(i){return new(i||r)(m(_),m(x),m(re),m(he),m(_))}}static{this.\u0275cmp=I({type:r,selectors:[["nui-refresher-configuration"]],viewQuery:function(i,t){if(i&1&&q($,5),i&2){let o;X(o=Q())&&(t.refreshRateComp=o.first)}},inputs:{enabled:"enabled",interval:"interval",minSeconds:"minSeconds",maxSeconds:"maxSeconds",overrideDefaultSettingsCaption:"overrideDefaultSettingsCaption",overrideDefaultSettings:"overrideDefaultSettings"},outputs:{formReady:"formReady"},standalone:!1,features:[P],decls:26,vars:25,consts:()=>{let e;e=$localize`:␟c8d1785038d461ec66b5799db21864182b35900a␟1102717806459547726:Refresh`;let i;i=$localize`:␟913ac9d5354818a43028659e12bb79cc3a8d19e3␟2148212086281974142:Refresh widget periodically`;let t;return t=$localize`:␟094103d9c7a2be810d7fc6a1935e14695f19925f␟4443005292001830097: By default, the widget will refresh every ${"\uFFFD0\uFFFD"}:INTERPOLATION:. `,[e,i,t,[3,"formGroup","state"],["accordionHeader","",1,"d-flex","align-items-center","px-4","py-2"],["iconColor","gray",1,"align-self-start","pt-2",3,"icon"],[1,"d-flex","flex-column","ml-4","pt-1"],[1,"nui-text-label"],[1,"nui-text-secondary",3,"title"],[1,"d-flex","flex-column","nui-refresher-configuration__accordion-content"],[3,"control"],["formControlName","enabled"],[1,"mt-4"],["formControlName","overrideDefaultSettings"],["class","nui-help-hint",4,"ngIf"],["formControlName","interval",3,"minSeconds","maxSeconds"],[1,"nui-help-hint"]]},template:function(i,t){if(i&1&&(l(0,"nui-widget-editor-accordion",3),C(1,"nuiWidgetEditorAccordionFormState"),C(2,"async"),l(3,"div",4),A(4,"nui-icon",5),C(5,"nuiFormHeaderIconPipe"),C(6,"async"),l(7,"div",6)(8,"span",7),O(9,0),d(),l(10,"div",8),c(11),d()()(),l(12,"div",9)(13,"div")(14,"nui-form-field",10)(15,"nui-switch",11),O(16,1),d()()(),l(17,"div")(18,"div",12)(19,"nui-form-field",10)(20,"nui-switch",13),c(21),N(22,be,2,1,"div",14),d()()(),l(23,"div",12)(24,"nui-form-field",10),A(25,"nui-refresh-rate-configurator",15),d()()()()()),i&2){let o,u,g;a("formGroup",t.form)("state",T(2,18,T(1,16,t.form))),s(4),a("icon",T(6,23,Z(5,20,t.form,"reset"))),s(6),a("title",t.getHeaderSubtitle()),s(),h(" ",t.getHeaderSubtitle()," "),s(3),a("control",t.form.get("enabled")),s(3),G("hidden",!((o=t.form.get("enabled"))!=null&&o.value)),s(2),a("control",t.form.get("overrideDefaultSettings")),s(2),h("",t.overrideDefaultSettingsCaption," "),s(),a("ngIf",!((u=t.form.get("overrideDefaultSettings"))!=null&&u.value)),s(),G("hidden",!((g=t.form.get("overrideDefaultSettings"))!=null&&g.value)),s(),a("control",t.form.get("interval")),s(),a("minSeconds",t.minSeconds)("maxSeconds",t.maxSeconds)}},dependencies:[Y,b,F,M,y,oe,D,se,pe,$,ee,ge,Se],styles:[".nui-refresher-configuration__accordion-content[_ngcontent-%COMP%]{padding:15px 15px 15px 46px}"]})}}return r})();var at={id:"refresher",componentType:ve.lateLoadKey,providers:{[ce.Converter]:{providerId:fe,properties:{formParts:[{previewPath:`${me}.providers.refresher.properties`,keys:["enabled","interval","overrideDefaultSettings"]}]}}},properties:{overrideDefaultSettings:!1}};export{$ as a,ve as b,at as c};
