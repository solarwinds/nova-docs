!function(){var e,t,i,n,r,o,a,c,s,u,d,l;function f(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function b(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var i=[],n=!0,r=!1,o=void 0;try{for(var a,c=e[Symbol.iterator]();!(n=(a=c.next()).done)&&(i.push(a.value),!t||i.length!==t);n=!0);}catch(s){r=!0,o=s}finally{try{n||null==c.return||c.return()}finally{if(r)throw o}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return h(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function m(e,t,i){return t&&v(e.prototype,t),i&&v(e,i),e}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var i,n=I(e);if(t){var r=I(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return C(this,i)}}function C(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{kfUE:function(h,v,w){"use strict";w.r(v),w.d(v,"ManyWidgetsModule",function(){return be});var C,I=w("ofXK"),k=w("tk/3"),j=w("tyNb"),O=w("Rr1A"),R=w("gKry"),T=w("AgrY"),U=w("HNto"),D=w("A//S"),W=w("UJ+P"),P=w("U9RZ"),x=w("tghU"),z=w("k2eP"),V=w("rWRh"),A=w("mrSG"),L=w("2Vo4"),M=w("nYR2"),E=w("fXoL"),$=((C=function(e){y(i,e);var t=S(i);function i(e){var n;return p(this,i),(n=t.call(this)).http=e,n.busy=new L.a(!1),n}return m(i,[{key:"getFilteredData",value:function(){return Object(A.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.busy.next(!0),t=Math.floor(Math.random()*Math.floor(99))+1,e.abrupt("return",new Promise(function(e){i.http.get("https://jsonplaceholder.typicode.com/todos/".concat(t)).pipe(Object(M.a)(function(){return i.busy.next(!1)})).subscribe({next:function(t){e({result:{value:t.id,label:t.title}})},error:function(t){e({result:null,error:{type:t.status}})}})}));case 3:case"end":return e.stop()}},e,this)}))}},{key:"ngOnDestroy",value:function(){this.outputsSubject.complete()}}]),i}(O.g)).providerId="AcmeKpiDataSource",C.mockError=!1,C.\u0275fac=function(e){return new(e||C)(E.fc(k.b))},C.\u0275prov=E.Lb({token:C,factory:C.\u0275fac}),C),_=w("QVEU"),K=w.n(_),Z=w("XNiG"),N=w("IzEk"),B=w("1G5W"),H=w("BkRI"),J=w.n(H),Q=w("D1y2"),F=w.n(Q),X=function(e){var t;return{id:"".concat(e),type:"kpi",pizzagna:b({},R.Q.Configuration,{header:{properties:{title:"KPI Widget!",subtitle:"A bunch of number boxes",collapsible:!0}},tiles:{providers:{},properties:{nodes:["kpi1"]}},kpi1:{id:"kpi1",providers:(t={},b(t,R.kb.DataSource,{providerId:$.providerId}),b(t,R.kb.Adapter,{providerId:R.I,properties:{componentId:"kpi1",propertyPath:"widgetData"}}),t)}})}},G=g(function(e){for(var t=[],i={},n={cols:8,rows:6,y:0,x:0},r=0;r<=15;r++){var o="widget".concat(r.toString()),a=X(o),c=i["widget".concat((r-1).toString())],s=c?Object.assign(Object.assign({},c),{y:c.y+6}):n;t.push(a),i[o]=s}return[t,i]}(),2),Y=G[0],q=G[1];function ee(e,t){if(1&e&&(E.Vb(0,"div",3),E.Vb(1,"div",4),E.Oc(2),E.Ub(),E.Ub()),2&e){var i=t.item;E.Db(2),E.Qc(" ",i.title," ")}}var te,ie=((te=function(){function e(t){p(this,e),this.widgetTypesService=t,this.widgetSelected=new E.o,this.widgetItems=[]}return m(e,[{key:"ngOnInit",value:function(){var e=this,t=new I.x;this.widgetItems=Y.map(function(i){return{title:t.transform(i.type),widget:e.widgetTypesService.mergeWithWidgetType(i)}}),Y.forEach(function(t){e.addUnconfiguredWidgetWithConfigLayer(t)})}},{key:"addUnconfiguredWidget",value:function(e){var t=(new I.x).transform(e);this.widgetItems.push({title:"Unconfigured ".concat(t),widget:{id:"unconfigured".concat(t),type:e,metadata:{needsConfiguration:!0},pizzagna:J()(this.widgetTypesService.getWidgetType(e).widget)}}),F()(this.widgetItems[this.widgetItems.length-1].widget.pizzagna,"".concat(R.Q.Structure,".header.properties.title"),"Unconfigured ".concat(t))}},{key:"addUnconfiguredWidgetWithConfigLayer",value:function(e){var t=(new I.x).transform(e.type);this.widgetItems.push({title:"Unconfigured ".concat(t," With Config Layer"),widget:Object.assign(Object.assign({},J()(this.widgetTypesService.mergeWithWidgetType(e))),{id:"unconfiguredWithConfigLayer".concat(t),metadata:{needsConfiguration:!0}})}),F()(this.widgetItems[this.widgetItems.length-1].widget.pizzagna,"".concat(R.Q.Configuration,".header.properties.title"),"Unconfigured ".concat(t," With Config Layer"))}},{key:"onSelect",value:function(e){this.widgetSelected.emit(e[0].widget),this.widgetSelection=e}}]),e}()).lateLoadKey="AcmeCloneSelectionComponent",te.\u0275fac=function(e){return new(e||te)(E.Pb(R.nb))},te.\u0275cmp=E.Jb({type:te,selectors:[["acme-clone-selection"]],outputs:{widgetSelected:"widgetSelected"},decls:4,vars:3,consts:[[1,"nui-widget-cloner"],["selectionMode","singleWithRequiredSelection",3,"itemsSource","selection","repeatItemTemplateRef","selectionChange"],["widgetClonerItem",""],[1,"nui-widget-cloner__item","d-flex","pt-2","pb-2","align-items-center"],[1,"text-info","ml-3"]],template:function(e,t){if(1&e&&(E.Vb(0,"div",0),E.Vb(1,"nui-repeat",1),E.jc("selectionChange",function(e){return t.onSelect(e)}),E.Ub(),E.Ub(),E.Mc(2,ee,3,1,"ng-template",null,2,E.Nc)),2&e){var i=E.Dc(3);E.Db(1),E.uc("itemsSource",t.widgetItems)("selection",t.widgetSelection)("repeatItemTemplateRef",i)}},directives:[O.tb],styles:[".nui-widget-cloner__item[_ngcontent-%COMP%]{height:60px}"]}),te);function ne(e,t){if(1&e&&(E.Vb(0,"div",3),E.Vb(1,"div",4),E.Oc(2),E.Ub(),E.Ub()),2&e){var i=t.item;E.Db(2),E.Qc(" ",i.title," ")}}var re,oe,ae,ce,se=((oe=function(e){y(i,e);var t=S(i);function i(e){return p(this,i),t.call(this,e)}return m(i,[{key:"ngOnInit",value:function(){var e=this,t=new I.x;this.widgetItems=Y.map(function(i){return{title:t.transform(i.type),widget:e.widgetTypesService.mergeWithWidgetType(i)}})}}]),i}(ie)).lateLoadKey="AcmeCloneSelectionComponent",oe.\u0275fac=function(e){return new(e||oe)(E.Pb(R.nb))},oe.\u0275cmp=E.Jb({type:oe,selectors:[["acme-clone-selection"]],features:[E.Ab],decls:4,vars:3,consts:[[1,"nui-widget-cloner"],["selectionMode","singleWithRequiredSelection",3,"itemsSource","selection","repeatItemTemplateRef","selectionChange"],["widgetClonerItem",""],[1,"nui-widget-cloner__item","d-flex","pt-2","pb-2","align-items-center"],[1,"text-info","ml-3"]],template:function(e,t){if(1&e&&(E.Vb(0,"div",0),E.Vb(1,"nui-repeat",1),E.jc("selectionChange",function(e){return t.onSelect(e)}),E.Ub(),E.Ub(),E.Mc(2,ne,3,1,"ng-template",null,2,E.Nc)),2&e){var i=E.Dc(3);E.Db(1),E.uc("itemsSource",t.widgetItems)("selection",t.widgetSelection)("repeatItemTemplateRef",i)}},directives:[O.tb],styles:[".nui-widget-cloner__item[_ngcontent-%COMP%]{height:60px}"]}),oe),ue=((re=function i(n){var r=this;p(this,i),this.toastService=n,this.allowSubmit=!0,this.allowRemoval=!0,this.trySubmit=function(t,i){var n=new Z.a;return setTimeout(function(){if(r.allowSubmit)n.next(t);else{var i=$localize(e||(e=f(["Submit failed."])));r.toastService.error({title:i}),n.error(i)}},1e3),n.asObservable()},this.tryRemove=function(e){var i=new Z.a;return setTimeout(function(){if(r.allowRemoval)i.next(e);else{var n=$localize(t||(t=f(["Widget removal failed."])));r.toastService.error({title:n}),i.error(n)}},200),i.asObservable()},this.toastService.setConfig({timeOut:2e3})}).\u0275fac=function(e){return new(e||re)(E.fc(O.Yb))},re.\u0275prov=E.Lb({token:re,factory:re.\u0275fac}),re),de=w("sleA"),le=w("MJAs"),fe=[{path:"",component:(ae=function(){function e(t,i,n,r,o){p(this,e),this.providerRegistry=t,this.submitHandler=i,this.widgetTypesService=n,this.widgetClonerService=r,this.refreshSettings=o,this.dashboard={positions:{},widgets:{}},this.gridsterConfig={minCols:12,maxCols:12,minRows:12},this.editMode=!1,this.systemRefreshInterval=60,this.belowFoldLazyLoadingConfig={enabled:!0},this.destroy$=new Z.a,this.providerRegistry.setProviders(b({},$.providerId,{provide:R.b,useClass:$,deps:[k.b]}))}return m(e,[{key:"ngOnInit",value:function(){var e,t,i=this;null===(t=null===(e=this.widgetTypesService.getWidgetType("table").configurator)||void 0===e?void 0:e[R.Q.Structure].presentation.properties)||void 0===t||t.nodes.push("refresher"),this.refreshSettings.refreshRateSeconds=this.systemRefreshInterval;var n=Y.map(function(e){return i.widgetTypesService.mergeWithWidgetType(e)}),r=K()(n,function(e){return e.id});this.dashboard={positions:q,widgets:r}}},{key:"onDsErrorSwitch",value:function(e){$.mockError=e}},{key:"onShowButtonSwitch",value:function(e,t){for(var i=0,n=Object.keys(this.dashboard.widgets);i<n.length;i++){var r=n[i];this.dashboard=Object(O.fc)(this.dashboard,"widgets.".concat(r,".pizzagna.configuration.header.properties.").concat(t),e)}}},{key:"ngAfterViewInit",value:function(){var e=this;this.dashboardComponent.eventBus.subscribeUntil(R.fb,this.destroy$,function(t){e.widgetClonerService.open({widget:e.dashboard.widgets[t.widgetId],dashboardComponent:e.dashboardComponent,trySubmit:e.submitHandler.trySubmit,widgetSelectionComponentType:se}).pipe(Object(N.a)(1),Object(B.a)(e.destroy$)).subscribe()})}},{key:"onCloneWidget",value:function(){this.widgetClonerService.open({dashboardComponent:this.dashboardComponent,trySubmit:this.submitHandler.trySubmit,widgetSelectionComponentType:ie}).pipe(Object(N.a)(1),Object(B.a)(this.destroy$)).subscribe()}},{key:"onEditWithCloner",value:function(){this.dashboardComponent.eventBus.next(R.fb,{widgetId:Y[0].id})}},{key:"ngOnDestroy",value:function(){this.destroy$.next(),this.destroy$.complete()}},{key:"onSystemRefreshIntervalClick",value:function(){this.refreshSettings.refreshRateSeconds=this.systemRefreshInterval}}]),e}(),ae.\u0275fac=function(e){return new(e||ae)(E.Pb(R.V),E.Pb(ue),E.Pb(R.nb),E.Pb(R.lb),E.Pb(R.X))},ae.\u0275cmp=E.Jb({type:ae,selectors:[["many-widgets-dashboard-dashboard"]],viewQuery:function(e,t){var i;1&e&&E.Sc(R.k,3),2&e&&E.Cc(i=E.kc())&&(t.dashboardComponent=i.first)},features:[E.Cb([ue])],decls:25,vars:11,consts:function(){return[["type","button","nui-button","",1,"mb-3","ml-4",3,"click"],$localize(i||(i=f([":\u241f08a1b409eac8269dd4dce8a2b3bd976356ba40ee\u241f7260316479095556147:Create Widget Clone"]))),$localize(n||(n=f([":\u241f4e17d1961186f54a679f7623cd03e5c49c411f65\u241f639090956363340116:Simulate edit with cloner"]))),[1,"w-100",2,"height","725px"],[3,"nuiWidgetEditor","dashboard","gridsterConfig","editMode","belowFoldLazyLoadingConfig","dashboardChange","gridsterConfigChange"],[1,"my-3","d-flex","align-items-center"],[1,"ml-3",3,"value","valueChange"],$localize(r||(r=f([":\u241fc0390f914462a77b0ab8e053abf7c77af5b1da81\u241f6640158718767573444: Edit mode "]))),$localize(o||(o=f([":\u241fdb70aaa4da7a9f7c0fa3a218907f9fa354a19038\u241f5855643886473775120: Allow Submit "]))),$localize(a||(a=f([":\u241fd289dfdc6c4e23b49a96db083f95f1087ed1400a\u241f3687117978364204872: Allow Removal "]))),$localize(c||(c=f([":\u241f3299af3b186d7701f4c0626e41eba58af8382723\u241f4106211393112768148: Show Edit Button "]))),$localize(s||(s=f([":\u241f30251ad3dcd7facd3a222d48fb2ba02f8503c52c\u241f8096484277280346189: Show Remove Button "]))),[1,"ml-3",3,"valueChange"],$localize(u||(u=f([":\u241fc355f0feb3f72b3594e6e975456cd0a2dac1d929\u241f870224976565315483: Data Source Error "]))),[1,"d-flex","flex-row"],[2,"width","300px"],["caption",$localize(d||(d=f([":\u241f90504d9af68fb3aa81accb4bc3005526deb04093\u241f5488473345097746222:System refresh interval (seconds)"])))],[3,"value","valueChange"],["type","button","nui-button","",1,"ml-4",3,"click"],$localize(l||(l=f([":\u241f4de55e520d95a021a3b6dcb94b34b5b2364abef8\u241f1472280137824054907:Update system refresh interval "])))]},template:function(e,t){1&e&&(E.Vb(0,"button",0),E.jc("click",function(){return t.onCloneWidget()}),E.Zb(1,1),E.Ub(),E.Vb(2,"button",0),E.jc("click",function(){return t.onEditWithCloner()}),E.Zb(3,2),E.Ub(),E.Vb(4,"div",3),E.Vb(5,"nui-dashboard",4),E.jc("dashboardChange",function(e){return t.dashboard=e})("gridsterConfigChange",function(e){return t.gridsterConfig=e}),E.Ub(),E.Ub(),E.Vb(6,"div",5),E.Vb(7,"nui-switch",6),E.jc("valueChange",function(e){return t.editMode=e}),E.Zb(8,7),E.Ub(),E.Vb(9,"nui-switch",6),E.jc("valueChange",function(e){return t.submitHandler.allowSubmit=e}),E.Zb(10,8),E.Ub(),E.Vb(11,"nui-switch",6),E.jc("valueChange",function(e){return t.submitHandler.allowRemoval=e}),E.Zb(12,9),E.Ub(),E.Vb(13,"nui-switch",6),E.jc("valueChange",function(e){return t.onShowButtonSwitch(e,"editable")}),E.Zb(14,10),E.Ub(),E.Vb(15,"nui-switch",6),E.jc("valueChange",function(e){return t.onShowButtonSwitch(e,"removable")}),E.Zb(16,11),E.Ub(),E.Vb(17,"nui-switch",12),E.jc("valueChange",function(e){return t.onDsErrorSwitch(e)}),E.Zb(18,13),E.Ub(),E.Ub(),E.Vb(19,"div",14),E.Vb(20,"div",15),E.Vb(21,"nui-form-field",16),E.Vb(22,"nui-textbox-number",17),E.jc("valueChange",function(e){return t.systemRefreshInterval=e}),E.Ub(),E.Ub(),E.Ub(),E.Vb(23,"button",18),E.jc("click",function(){return t.onSystemRefreshIntervalClick()}),E.Zb(24,19),E.Ub(),E.Ub()),2&e&&(E.Db(5),E.uc("nuiWidgetEditor",t.submitHandler)("dashboard",t.dashboard)("gridsterConfig",t.gridsterConfig)("editMode",t.editMode)("belowFoldLazyLoadingConfig",t.belowFoldLazyLoadingConfig),E.Db(2),E.uc("value",t.editMode),E.Db(2),E.uc("value",t.submitHandler.allowSubmit),E.Db(2),E.uc("value",t.submitHandler.allowRemoval),E.Db(2),E.uc("value",!0),E.Db(2),E.uc("value",!0),E.Db(7),E.uc("value",t.systemRefreshInterval))},directives:[O.b,de.a,le.a,O.Fb,O.n,O.Sb],styles:[".nui-theme-switcher-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;padding:10px;background-color:var(--nui-color-bg-light,#fff)}"]}),ae),data:{srlc:{hideIndicator:!0},showThemeSwitcher:!0}}],be=((ce=function(){function e(t,i){p(this,e),this.widgetTypesService=t,this.componentRegistry=i,this.setupDataSourceProviders(),this.setupCustomProportionalWidgetDSConfig()}return m(e,[{key:"setupCustomProportionalWidgetDSConfig",value:function(){var e,t=this.widgetTypesService.getWidgetType("proportional",1);null===(e=t.widget.structure[R.g].providers)||void 0===e||delete e.refresher,this.widgetTypesService.setNode(t,"configurator",R.jb.DataSourceConfigComponentType,T.a.lateLoadKey),this.componentRegistry.registerByLateLoadKey(T.a)}},{key:"setupDataSourceProviders",value:function(){this.setDataSourceProviders("table",[D.a.providerId,W.a.providerId,P.a.providerId,z.a.providerId,x.a.providerId]);var e=this.widgetTypesService.getWidgetType("kpi",1);this.widgetTypesService.setNode(e,"configurator",R.jb.DataSourceConfigComponentType,R.l.lateLoadKey),this.setDataSourceProviders("kpi",[{providerId:$.providerId,label:"Acme KPI Data Source 1"}]),this.setDataSourceProviders("proportional",[U.a.providerId,U.b.providerId]),this.setDataSourceProviders("timeseries",[V.a.providerId,V.b.providerId])}},{key:"setDataSourceProviders",value:function(e,t){var i=this.widgetTypesService.getWidgetType(e,1);this.widgetTypesService.setNode(i,"configurator",R.jb.DataSourceProviders,t)}}]),e}()).\u0275mod=E.Nb({type:ce}),ce.\u0275inj=E.Mb({factory:function(e){return new(e||ce)(E.fc(R.nb),E.fc(R.a))},providers:[R.V],imports:[[I.c,k.c,R.N,O.z,O.A,O.F,O.Z,O.J,O.K,O.T,j.d.forChild(fe),O.I,O.bb]]}),ce)}}])}();