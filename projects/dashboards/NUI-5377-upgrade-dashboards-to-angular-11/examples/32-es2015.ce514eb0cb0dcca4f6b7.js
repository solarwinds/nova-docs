(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{"M+S4":function(e,t,i){"use strict";i.r(t),i.d(t,"WidgetCreationModule",function(){return W});var o=i("ofXK"),n=i("tk/3"),r=i("tyNb"),a=i("Rr1A"),s=i("gKry"),d=i("fXoL"),c=i("mrSG"),l=i("XNiG"),u=i("2Vo4"),b=i("IzEk"),p=i("1G5W"),h=i("nYR2"),g=i("sleA"),m=i("MJAs");function w(e,t){if(1&e&&(d.Vb(0,"div",3),d.Vb(1,"div",4),d.Oc(2),d.Ub(),d.Ub()),2&e){const e=t.item;d.Db(2),d.Pc(e.name)}}const f=".dashboard[_ngcontent-%COMP%]{height:800px}.nui-widget-cloner__item[_ngcontent-%COMP%]{height:60px}";let v=(()=>{class e{constructor(e){this.widgetTypesService=e,this.widgetSelected=new d.o,this.widgetItems=[]}ngOnInit(){this.widgetItems=[{name:"Fully Configured KPI Widget",widget:this.widgetTypesService.mergeWithWidgetType(k)},{name:"Unconfigured Proportional Widget",widget:this.widgetTypesService.mergeWithWidgetType(V)}]}onSelect(e){this.widgetSelected.emit(e[0].widget),this.widgetSelection=e}}return e.\u0275fac=function(t){return new(t||e)(d.Pb(s.nb))},e.\u0275cmp=d.Jb({type:e,selectors:[["widget-template-selection"]],outputs:{widgetSelected:"widgetSelected"},decls:4,vars:3,consts:[[1,"nui-widget-cloner"],["selectionMode","singleWithRequiredSelection",3,"itemsSource","selection","repeatItemTemplateRef","selectionChange"],["widgetClonerItem",""],[1,"nui-widget-cloner__item","d-flex","pt-2","pb-2","align-items-center"],[1,"text-info","ml-3"]],template:function(e,t){if(1&e&&(d.Vb(0,"div",0),d.Vb(1,"nui-repeat",1),d.jc("selectionChange",function(e){return t.onSelect(e)}),d.Ub(),d.Ub(),d.Mc(2,w,3,1,"ng-template",null,2,d.Nc)),2&e){const e=d.Dc(3);d.Db(1),d.uc("itemsSource",t.widgetItems)("selection",t.widgetSelection)("repeatItemTemplateRef",e)}},directives:[a.tb],styles:[f]}),e})(),y=(()=>{class e{constructor(e){this.toastService=e,this.persistenceSucceeded=!0,this.trySubmit=e=>{const t=new l.a;return e.id||(e.id=Object(a.ic)()),setTimeout(()=>{if(this.persistenceSucceeded)t.next(e),this.toastService.success({title:$localize`Submit succeeded.`});else{const e=$localize`Submit failed.`;this.toastService.error({title:e}),t.error(e)}t.complete()},1e3),t.asObservable()},this.tryRemove=e=>{const t=new l.a;return setTimeout(()=>{if(this.persistenceSucceeded)t.next(e),this.toastService.success({title:$localize`Removal success`});else{const e=$localize`Removal failed.`;this.toastService.error({title:e}),t.error(e)}t.complete()},1e3),t.asObservable()},this.toastService.setConfig({timeOut:2e3})}}return e.\u0275fac=function(t){return new(t||e)(d.fc(a.Yb))},e.\u0275prov=d.Lb({token:e,factory:e.\u0275fac}),e})(),S=(()=>{class e{constructor(e,t,i,o){this.widgetTypesService=e,this.providerRegistry=t,this.persistenceHandler=i,this.widgetClonerService=o,this.gridsterConfig={defaultItemCols:3,defaultItemRows:5},this.editMode=!1,this.destroy$=new l.a}ngOnInit(){const e=this.widgetTypesService.getWidgetType("kpi",1),t=this.widgetTypesService.getWidgetType("proportional",1);this.widgetTypesService.setNode(t,"configurator",s.jb.DataSourceProviders,[O.providerId]),this.widgetTypesService.setNode(e,"configurator",s.jb.DataSourceProviders,[C.providerId,U.providerId]),this.providerRegistry.setProviders({[C.providerId]:{provide:s.b,useClass:C,deps:[n.b]},[U.providerId]:{provide:s.b,useClass:U,deps:[n.b]},[O.providerId]:{provide:s.b,useClass:O,deps:[]}}),this.initializeDashboard()}onCreateWidget(){this.widgetClonerService.open({dashboardComponent:this.dashboardComponent,trySubmit:this.persistenceHandler.trySubmit,widgetSelectionComponentType:v}).pipe(Object(b.a)(1),Object(p.a)(this.destroy$)).subscribe()}initializeDashboard(){const e=k,t={[e.id]:this.widgetTypesService.mergeWithWidgetType(e)};this.dashboard={positions:{[e.id]:{cols:3,rows:5,y:0,x:0}},widgets:t}}}return e.\u0275fac=function(t){return new(t||e)(d.Pb(s.nb),d.Pb(s.V),d.Pb(y),d.Pb(s.lb))},e.\u0275cmp=d.Jb({type:e,selectors:[["widget-creation"]],viewQuery:function(e,t){if(1&e&&d.Sc(s.k,3),2&e){let e;d.Cc(e=d.kc())&&(t.dashboardComponent=e.first)}},features:[d.Cb([y])],decls:7,vars:5,consts:function(){let e,t;return e=$localize`:␟8c375764db42f5d736fb56d01b8052c006ccc8e2␟6407712033679505505:Edit Mode`,t=$localize`:␟1af9862ac515933a9a72e92970c3e92bda63f6e8␟8076137290276236439:Create Widget`,[[1,"my-3","d-flex","align-items-center"],[1,"ml-3",3,"value","valueChange"],e,["type","button","nui-button","",1,"ml-4",3,"click"],t,[1,"w-100","dashboard"],[3,"dashboard","gridsterConfig","editMode","nuiWidgetEditor","dashboardChange","gridsterConfigChange"]]},template:function(e,t){1&e&&(d.Vb(0,"div",0),d.Vb(1,"nui-switch",1),d.jc("valueChange",function(e){return t.editMode=e}),d.Zb(2,2),d.Ub(),d.Vb(3,"button",3),d.jc("click",function(){return t.onCreateWidget()}),d.Zb(4,4),d.Ub(),d.Ub(),d.Vb(5,"div",5),d.Vb(6,"nui-dashboard",6),d.jc("dashboardChange",function(e){return t.dashboard=e})("gridsterConfigChange",function(e){return t.gridsterConfig=e}),d.Ub(),d.Ub()),2&e&&(d.Db(1),d.uc("value",t.editMode),d.Db(5),d.uc("dashboard",t.dashboard)("gridsterConfig",t.gridsterConfig)("editMode",t.editMode)("nuiWidgetEditor",t.persistenceHandler))},directives:[a.Fb,a.b,g.a,m.a],styles:[f]}),e})(),O=(()=>{class e{constructor(){this.outputsSubject=new l.a}applyFilters(){setTimeout(()=>{this.outputsSubject.next({result:this.getRandomProportionalWidgetData()})},1e3)}ngOnDestroy(){this.outputsSubject.complete()}getRandomProportionalWidgetData(){return[{id:"Down",name:"Down",data:[Math.round(100*Math.random())],icon:"status_down",link:"https://en.wikipedia.org/wiki/Brno",value:"Brno"},{id:"Critical",name:"Critical",data:[Math.round(100*Math.random())],icon:"status_critical",link:"https://en.wikipedia.org/wiki/Kyiv",value:"Kyiv"},{id:"Warning",name:"Warning",data:[Math.round(100*Math.random())],icon:"status_warning",link:"https://en.wikipedia.org/wiki/Austin",value:"Austin"},{id:"Unknown",name:"Unknown",data:[Math.round(100*Math.random())],icon:"status_unknown",link:"https://en.wikipedia.org/wiki/Lisbon",value:"Lisbon"},{id:"Up",name:"Up",data:[Math.round(100*Math.random())],icon:"status_up",link:"https://en.wikipedia.org/wiki/Sydney",value:"Sydney"},{id:"Unmanaged",name:"Unmanaged",data:[Math.round(100*Math.random())],icon:"status_unmanaged",link:"https://en.wikipedia.org/wiki/Nur-Sultan",value:"Nur-Sultan"}]}}return e.providerId="RandomCitiesProportionalDataSource",e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=d.Lb({token:e,factory:e.\u0275fac}),e})(),C=(()=>{class e extends a.g{constructor(e){super(),this.http=e,this.busy=new u.a(!1)}getFilteredData(){return Object(c.a)(this,void 0,void 0,function*(){return this.busy.next(!0),new Promise(e=>{this.http.get("https://www.googleapis.com/books/v1/volumes/5MQFrgEACAAJ").pipe(Object(h.a)(()=>this.busy.next(!1))).subscribe({next:t=>{e({result:{value:t.volumeInfo.averageRating}})},error:t=>{e({result:null,error:{type:t.status}})}})})})}ngOnDestroy(){this.outputsSubject.complete()}}return e.providerId="AverageRatingKpiDataSource",e.\u0275fac=function(t){return new(t||e)(d.fc(n.b))},e.\u0275prov=d.Lb({token:e,factory:e.\u0275fac}),e})(),U=(()=>{class e extends a.g{constructor(e){super(),this.http=e,this.busy=new u.a(!1)}getFilteredData(){return Object(c.a)(this,void 0,void 0,function*(){return this.busy.next(!0),new Promise(e=>{this.http.get("https://www.googleapis.com/books/v1/volumes/5MQFrgEACAAJ").pipe(Object(h.a)(()=>this.busy.next(!1))).subscribe({next:t=>{e({result:{value:t.volumeInfo.ratingsCount}})},error:t=>{e({result:null,error:{type:t.status}})}})})})}ngOnDestroy(){this.outputsSubject.complete()}}return e.providerId="RatingsCountKpiDataSource",e.\u0275fac=function(t){return new(t||e)(d.fc(n.b))},e.\u0275prov=d.Lb({token:e,factory:e.\u0275fac}),e})();const k={id:"widget1",type:"kpi",pizzagna:{[s.Q.Configuration]:{[s.g]:{providers:{[s.kb.Refresher]:{properties:{interval:600,enabled:!0}}}},header:{properties:{title:"Harry Potter and the Sorcerer's Stone",subtitle:"By J. K. Rowling"}},tiles:{properties:{nodes:["kpi1"]}},kpi1:{id:"kpi1",componentType:s.z.lateLoadKey,properties:{widgetData:{units:"out of 5 Stars",label:"Average Rating"}},providers:{[s.kb.DataSource]:{providerId:C.providerId},[s.kb.Adapter]:{providerId:s.I,properties:{componentId:"kpi1",propertyPath:"widgetData"}}}}}}},V={id:"widget2",type:"proportional",metadata:{needsConfiguration:!0},pizzagna:{[s.Q.Configuration]:{header:{properties:{title:"*New Proportional Widget*"}}}}},I=[{path:"",component:(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=d.Jb({type:e,selectors:[["nui-dashboard-widget-creation-docs"]],decls:87,vars:3,consts:[["href","../injectables/ProviderRegistryService.html","target","_blank"],["href","../injectables/WidgetClonerService.html","target","_blank"],["href","../additional-documentation/getting-started.html","target","_parent"],["href","../interfaces/IWidgetTemplateSelector.html","target","_blank"],["href","../interfaces/IWidgetMetadata.html#needsConfiguration","target","_blank"],["type","info",3,"allowDismiss"],["href","../interfaces/IWidgetSelector.html","target","_blank"],["href","../injectables/WidgetClonerService.html#open","target","_blank"],["filenamePrefix","widget-creation.component","exampleTitle","Widget Creation"]],template:function(e,t){1&e&&(d.Vb(0,"h1"),d.Oc(1,"Widget Creation"),d.Ub(),d.Vb(2,"p"),d.Oc(3," In this tutorial we'll cover how to add a widget creation wizard which allows end-users to create new widget instances based on existing widget configurations. The wizard's first step, or page, will use a custom component that lets users choose a widget to create. In the example below we'll implement a sample widget selection component that provides a proportional widget and a kpi widget as options.\n"),d.Ub(),d.Vb(4,"h2"),d.Oc(5,"Fundamental Concepts"),d.Ub(),d.Vb(6,"ul"),d.Vb(7,"li"),d.Vb(8,"a",0),d.Vb(9,"code"),d.Oc(10,"ProviderRegistryService"),d.Ub(),d.Ub(),d.Ub(),d.Vb(11,"li"),d.Vb(12,"a",1),d.Vb(13,"code"),d.Oc(14,"WidgetClonerService"),d.Ub(),d.Ub(),d.Ub(),d.Vb(15,"li"),d.Oc(16,"Widget configurations"),d.Ub(),d.Vb(17,"li"),d.Oc(18,"Custom component for widget selection"),d.Ub(),d.Ub(),d.Vb(19,"h2"),d.Oc(20,"Basic Steps"),d.Ub(),d.Vb(21,"ol"),d.Vb(22,"li"),d.Oc(23," Follow the instructions "),d.Vb(24,"a",2),d.Oc(25,"here"),d.Ub(),d.Oc(26," to set up your environment for dashboard development. "),d.Ub(),d.Vb(27,"li"),d.Oc(28," Follow the instructions from previous tutorials to get a basic dashboard up and running. "),d.Ub(),d.Vb(29,"li"),d.Oc(30," Create a widget template selector component which will act as the first step in the wizard. The selector component should implement the "),d.Vb(31,"a",3),d.Vb(32,"code"),d.Oc(33,"IWidgetTemplateSelector"),d.Ub(),d.Ub(),d.Oc(34," interface which requires a widgetSelected output that should emit a widget to be cloned. For any widgets that require further configuration before they should be placed on the dashboard, set the widget's "),d.Vb(35,"code"),d.Vb(36,"a",4),d.Oc(37,"metadata.needsConfiguration"),d.Ub(),d.Ub(),d.Oc(38," property to "),d.Vb(39,"code"),d.Oc(40,"true"),d.Ub(),d.Oc(41,'. This will hide the "Create Widget" button whenever an unconfigured widget is selected. '),d.Vb(42,"nui-message",5),d.Vb(43,"strong"),d.Oc(44,"Note:"),d.Ub(),d.Oc(45," In the example below, the widget selector is implemented in the same file as the dashboard component, but it's recommended to define it in a separate file. Additionally, after implementing it, remember to add it to your module declarations. "),d.Ub(),d.Ub(),d.Vb(46,"li"),d.Oc(47," Ensure that "),d.Vb(48,"code"),d.Oc(49,"NuiRepeatModule"),d.Ub(),d.Oc(50," and "),d.Vb(51,"code"),d.Oc(52,"NuiImageModule"),d.Ub(),d.Oc(53," are included in the imports of the widget template selector component's parent module. "),d.Vb(54,"nui-message",5),d.Vb(55,"strong"),d.Oc(56,"Note:"),d.Ub(),d.Oc(57," Importing these modules is required in this example because, in this case, the widget template selector uses the Nova repeat component and a couple of images from the Nova image repository. "),d.Ub(),d.Ub(),d.Vb(58,"li"),d.Oc(59," Invoke the "),d.Vb(60,"code"),d.Oc(61,"open"),d.Ub(),d.Oc(62," method on the "),d.Vb(63,"a",1),d.Vb(64,"code"),d.Oc(65,"WidgetClonerService"),d.Ub(),d.Ub(),d.Oc(66," with an argument of type "),d.Vb(67,"a",6),d.Vb(68,"code"),d.Oc(69,"IWidgetSelector"),d.Ub(),d.Ub(),d.Oc(70,". Only two things are required in that object: a reference to the dashboardComponent instance and the typename of the widget selector created in the previous step. Optionally, the argument object may also contain a "),d.Vb(71,"code"),d.Oc(72,"trySubmit"),d.Ub(),d.Oc(73," function with logic for persisting the new widget on a backend. "),d.Ub(),d.Vb(74,"li"),d.Oc(75," Subscribe to the "),d.Vb(76,"code"),d.Oc(77,"Observable"),d.Ub(),d.Oc(78," returned by the "),d.Vb(79,"a",7),d.Vb(80,"code"),d.Oc(81,"widgetClonerService.open"),d.Ub(),d.Ub(),d.Oc(82," method in order to activate the handling of form submission and the subsequent updating of the dashboard with a newly created widget. "),d.Ub(),d.Ub(),d.Vb(83,"nui-message",5),d.Oc(84," For more detailed information about widget creation, take a look at the inline comments under the source expander of the following example.\n"),d.Ub(),d.Vb(85,"nui-example-wrapper",8),d.Qb(86,"widget-creation"),d.Ub()),2&e&&(d.Db(42),d.uc("allowDismiss",!1),d.Db(12),d.uc("allowDismiss",!1),d.Db(29),d.uc("allowDismiss",!1))},directives:[a.y,a.l,S],encapsulation:2}),e})(),data:{srlc:{hideIndicator:!0},showThemeSwitcher:!0}},{path:"example",component:S,data:{srlc:{hideIndicator:!0}}}];let W=(()=>{class e{}return e.\u0275mod=d.Nb({type:e}),e.\u0275inj=d.Mb({factory:function(t){return new(t||e)},imports:[[o.c,n.c,s.N,a.F,a.M,a.Z,a.eb,a.A,a.T,a.K,r.d.forChild(I)]]}),e})()}}]);