(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{"o0g+":function(e,t,i){"use strict";i.r(t),i.d(t,"ConfiguratorTestModule",function(){return L});var r=i("tyNb"),o=i("Rr1A"),s=i("gKry"),d=i("4uQc"),a=i("bTxs"),n=i("FupF"),c=i("M+5T"),l=i("WqJa"),p=i("QVEU"),g=i.n(p),b=i("XNiG"),u=i("IzEk"),h=i("1G5W"),m=i("ofXK"),v=i("fXoL"),w=i("BkRI"),f=i.n(w),y=i("D1y2"),C=i.n(y),I=i("bPcI");const S={widget1:{cols:6,rows:6,y:0,x:0},widget2:{cols:6,rows:6,y:0,x:6},widget3:{cols:7,rows:6,y:6,x:0},widget4:{cols:5,rows:6,y:6,x:7}},T=[{id:"widget1",type:"kpi",pizzagna:{[s.Q.Configuration]:{header:{properties:{title:"KPI Widget!",subtitle:"A bunch of number boxes"}},tiles:{properties:{nodes:["kpi1","kpi2"]}},kpi1:{id:"kpi1",componentType:s.z.lateLoadKey,providers:{[s.kb.DataSource]:{providerId:a.a.providerId},[s.kb.Adapter]:{providerId:s.I,properties:{componentId:"kpi1",propertyPath:"widgetData",thresholds:{showThresholds:!0,warningThresholdValue:5,criticalThresholdValue:8}}}},properties:{elementClass:"flex-grow-1",widgetData:{id:"totalStorage",value:0,label:"Total storage"}}},kpi2:{id:"kpi2",componentType:s.z.lateLoadKey,providers:{[s.kb.DataSource]:{providerId:a.b.providerId},[s.kb.Adapter]:{providerId:s.I,properties:{componentId:"kpi2",propertyPath:"widgetData",thresholds:{warningThresholdValue:120,criticalThresholdValue:150}}}},properties:{elementClass:"flex-grow-1",widgetData:{id:"downloadSpeed",value:0,label:"Download speed"}}}}}},{id:"widget2",type:"proportional",pizzagna:{[s.Q.Configuration]:{header:{properties:{title:"Proportional Widget!",subtitle:"Proportional widget with legend formatters"}},chart:{providers:{[s.kb.DataSource]:{providerId:n.b.providerId}},properties:{configuration:{chartOptions:{type:s.U.PieChart,legendPlacement:s.B.Right,legendFormatter:{componentType:s.C.lateLoadKey}}}}}}}},{id:"widget3",type:"timeseries",pizzagna:{[s.Q.Configuration]:{[s.g]:{providers:{[s.kb.DataSource]:{providerId:l.a.providerId}}},header:{properties:{title:"Timeseries Widget!",subtitle:"Basic timeseries widget"}},chart:{providers:{[s.kb.Adapter]:{properties:{series:[{id:"series-1",label:"Average CPU Load",selectedSeriesId:"series-1"},{id:"series-2",label:"Average CPU Load",selectedSeriesId:"series-2"},{id:"series-3",label:"Average CPU Load",selectedSeriesId:"series-3"}]}}},properties:{configuration:{legendPlacement:s.B.Right,enableZoom:!0,leftAxisLabel:"Utilization (%)"}}},timeframeSelection:{properties:{timeframe:{startDatetime:Object(I.e)().subtract(7,"day").format(),endDatetime:Object(I.e)().format(),selectedPresetId:null}}}}}},{id:"widget4",type:"table",pizzagna:{[s.Q.Configuration]:{header:{properties:{title:"Table Widget!",subtitle:"Basic table widget"}},table:{providers:{[s.kb.DataSource]:{providerId:c.a.providerId}},properties:{configuration:{columns:[{id:"column1",label:"No",isActive:!0,formatter:{componentType:s.W.lateLoadKey,properties:{dataFieldIds:{value:"position"}}}},{id:"column2",label:"Name",isActive:!0,formatter:{componentType:s.W.lateLoadKey,properties:{dataFieldIds:{value:"name"}}}},{id:"column3",label:"Location",isActive:!0,formatter:{componentType:s.C.lateLoadKey,properties:{dataFieldIds:{value:"firstUrlLabel",link:"firstUrl"}}}}],sorterConfiguration:{descendantSorting:!0,sortBy:"column1"},hasVirtualScroll:!0}}}}}}];function k(e,t){if(1&e&&(v.Vb(0,"div",3),v.Vb(1,"div",4),v.Oc(2),v.Ub(),v.Ub()),2&e){const e=t.item;v.Db(2),v.Qc(" ",e.title," ")}}let W=(()=>{class e{constructor(e){this.widgetTypesService=e,this.widgetSelected=new v.o,this.widgetItems=[]}ngOnInit(){const e=new m.x;this.widgetItems=T.map(t=>(console.log(t),{title:e.transform(t.type),widget:this.widgetTypesService.mergeWithWidgetType(t)})),this.onSelect([this.widgetItems[0]]),T.forEach(e=>{this.addUnconfiguredWidgetWithConfigLayer(e)})}addUnconfiguredWidgetWithConfigLayer(e){const t=(new m.x).transform(e.type);this.widgetItems.push({title:`Unconfigured ${t} With Config Layer`,widget:Object.assign(Object.assign({},f()(this.widgetTypesService.mergeWithWidgetType(e))),{id:`unconfiguredWithConfigLayer${t}`,metadata:{needsConfiguration:!0}})}),C()(this.widgetItems[this.widgetItems.length-1].widget.pizzagna,`${s.Q.Configuration}.header.properties.title`,`Unconfigured ${t} With Config Layer`)}onSelect(e){this.widgetSelected.emit(e[0].widget),this.widgetSelection=e}}return e.lateLoadKey="AcmeCloneSelectionComponent",e.\u0275fac=function(t){return new(t||e)(v.Pb(s.nb))},e.\u0275cmp=v.Jb({type:e,selectors:[["acme-clone-selection"]],outputs:{widgetSelected:"widgetSelected"},decls:4,vars:3,consts:[[1,"nui-widget-cloner"],["selectionMode","singleWithRequiredSelection",3,"itemsSource","selection","repeatItemTemplateRef","selectionChange"],["widgetClonerItem",""],[1,"nui-widget-cloner__item","d-flex","pt-2","pb-2","align-items-center"],[1,"text-info","ml-3"]],template:function(e,t){if(1&e&&(v.Vb(0,"div",0),v.Vb(1,"nui-repeat",1),v.jc("selectionChange",function(e){return t.onSelect(e)}),v.Ub(),v.Ub(),v.Mc(2,k,3,1,"ng-template",null,2,v.Nc)),2&e){const e=v.Dc(3);v.Db(1),v.uc("itemsSource",t.widgetItems)("selection",t.widgetSelection)("repeatItemTemplateRef",e)}},directives:[o.tb],styles:[".nui-widget-cloner__item[_ngcontent-%COMP%]{height:60px}"]}),e})(),P=(()=>{class e{constructor(e){this.toastService=e,this.allowSubmit=!0,this.allowRemoval=!0,this.trySubmit=e=>{const t=new b.a;return setTimeout(()=>{if(this.allowSubmit)t.next(e);else{const e=$localize`Submit failed.`;this.toastService.error({title:e}),t.error(e)}},1e3),t.asObservable()},this.tryRemove=e=>{const t=new b.a;return setTimeout(()=>{if(this.allowRemoval)t.next(e);else{const e=$localize`Widget removal failed.`;this.toastService.error({title:e}),t.error(e)}},200),t.asObservable()},this.toastService.setConfig({timeOut:2e3})}}return e.\u0275fac=function(t){return new(t||e)(v.fc(o.Yb))},e.\u0275prov=v.Lb({token:e,factory:e.\u0275fac}),e})();var D=i("BJxG"),z=i("sleA"),O=i("MJAs");const x=[{path:"",component:(()=>{class e{constructor(e,t,i,r,d){this.providerRegistry=e,this.submitHandler=t,this.themeSwitcherService=i,this.widgetTypesService=r,this.widgetClonerService=d,this.destroy$=new b.a,this.dashboard={positions:{},widgets:{}},this.gridsterConfig={minCols:12,maxCols:12,minRows:12},this.editMode=!1,this.dsError=!1,this.providerRegistry.setProviders({[a.a.providerId]:{provide:s.b,useClass:a.a,deps:[]},[a.b.providerId]:{provide:s.b,useClass:a.b,deps:[]},[n.a.providerId]:{provide:s.b,useClass:n.a,deps:[]},[n.b.providerId]:{provide:s.b,useClass:n.b,deps:[]},[n.c.providerId]:{provide:s.b,useClass:n.c,deps:[]},[c.a.providerId]:{provide:s.b,useClass:c.a,deps:[o.wb,s.O]},[c.b.providerId]:{provide:s.b,useClass:c.b,deps:[o.wb,s.O]},[l.a.providerId]:{provide:s.b,useClass:l.a,deps:[]},[l.b.providerId]:{provide:s.b,useClass:l.b,deps:[]}})}ngOnInit(){const e=T.map(e=>Object.assign(Object.assign({},e),{pizzagna:Object.assign(Object.assign({},this.widgetTypesService.getWidgetType(e.type,e.version).widget),e.pizzagna)})),t=g()(e,e=>e.id);this.dashboard={positions:S,widgets:t}}onDsErrorChange(e){a.a.mockError=e,l.a.mockError=e,c.a.mockError=e,n.b.mockError=e}onCloneWidget(){this.widgetClonerService.open({dashboardComponent:this.dashboardComponent,trySubmit:this.submitHandler.trySubmit,widgetSelectionComponentType:W}).pipe(Object(u.a)(1),Object(h.a)(this.destroy$)).subscribe()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return e.\u0275fac=function(t){return new(t||e)(v.Pb(s.V),v.Pb(P),v.Pb(o.Tb),v.Pb(s.nb),v.Pb(s.lb))},e.\u0275cmp=v.Jb({type:e,selectors:[["acme-dashboard"]],viewQuery:function(e,t){if(1&e&&v.Sc(s.k,3),2&e){let e;v.Cc(e=v.kc())&&(t.dashboardComponent=e.first)}},features:[v.Cb([P])],decls:5,vars:6,consts:function(){let e;return e=$localize`:␟08a1b409eac8269dd4dce8a2b3bd976356ba40ee␟7260316479095556147:Create Widget Clone`,[["type","button","nui-button","",1,"mb-3","ml-4","nui-widget-cloner-test-button",3,"click"],e,[3,"editMode","dsError","editModeChange","dsErrorChange"],[1,"dashboard"],[3,"nuiWidgetEditor","dashboard","gridsterConfig","editMode","dashboardChange","gridsterConfigChange"]]},template:function(e,t){1&e&&(v.Vb(0,"button",0),v.jc("click",function(){return t.onCloneWidget()}),v.Zb(1,1),v.Ub(),v.Vb(2,"dashboard-test-harness",2),v.jc("editModeChange",function(e){return t.editMode=e})("dsErrorChange",function(e){return t.onDsErrorChange(e)}),v.Vb(3,"div",3),v.Vb(4,"nui-dashboard",4),v.jc("dashboardChange",function(e){return t.dashboard=e})("gridsterConfigChange",function(e){return t.gridsterConfig=e}),v.Ub(),v.Ub(),v.Ub()),2&e&&(v.Db(2),v.uc("editMode",t.editMode)("dsError",t.dsError),v.Db(2),v.uc("nuiWidgetEditor",t.submitHandler)("dashboard",t.dashboard)("gridsterConfig",t.gridsterConfig)("editMode",t.editMode))},directives:[o.b,D.a,z.a,O.a],styles:[".dashboard[_ngcontent-%COMP%]{height:725px;width:1000px}"]}),e})(),data:{srlc:{hideIndicator:!0}}}];let L=(()=>{class e{constructor(e){var t;this.widgetTypesService=e,null===(t=this.widgetTypesService.getWidgetType("proportional",1).widget.structure[s.g].providers)||void 0===t||delete t.refresher,this.setDataSourceProviders("table",[c.a.providerId,c.b.providerId]),this.setDataSourceProviders("kpi",[a.a.providerId,a.b.providerId]),this.setDataSourceProviders("proportional",[n.a.providerId,n.b.providerId,n.c.providerId]),this.setDataSourceProviders("timeseries",[l.a.providerId,l.b.providerId])}setDataSourceProviders(e,t){const i=this.widgetTypesService.getWidgetType(e,1);this.widgetTypesService.setNode(i,"configurator",s.jb.DataSourceProviders,t)}}return e.\u0275mod=v.Nb({type:e}),e.\u0275inj=v.Mb({factory:function(t){return new(t||e)(v.fc(s.nb))},providers:[s.V],imports:[[d.a,s.N,o.z,o.A,o.F,o.Z,o.J,o.T,r.d.forChild(x)]]}),e})()}}]);