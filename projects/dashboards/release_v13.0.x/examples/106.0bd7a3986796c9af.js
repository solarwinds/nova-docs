"use strict";(self.webpackChunkexamples=self.webpackChunkexamples||[]).push([[106],{19106:(F,v,l)=>{l.r(v),l.d(v,{WidgetCreationModule:()=>x});var Z=l(69808),c=l(40520),I=l(11420),d=l(30652),s=l(91366),e=l(5e3),g=l(77579),T=l(61135),M=l(95698),U=l(82722),S=l(28746),D=l(34575),N=l(44994),_=function(i,n,t,o){return new(t||(t=Promise))(function(a,h){function P(u){try{C(o.next(u))}catch(w){h(w)}}function q(u){try{C(o.throw(u))}catch(w){h(w)}}function C(u){u.done?a(u.value):function r(a){return a instanceof t?a:new t(function(h){h(a)})}(u.value).then(P,q)}C((o=o.apply(i,n||[])).next())})};function R(i,n){if(1&i&&(e.TgZ(0,"div",3)(1,"div",4),e._uU(2),e.qZA()()),2&i){const t=n.item;e.xp6(2),e.Oqu(t.name)}}const b=".dashboard[_ngcontent-%COMP%]{height:800px}.nui-widget-cloner__item[_ngcontent-%COMP%]{height:60px}";let k=(()=>{class i{constructor(t){this.widgetTypesService=t,this.widgetSelected=new e.vpe,this.widgetItems=[]}ngOnInit(){this.widgetItems=[{name:"Fully Configured KPI Widget",widget:this.widgetTypesService.mergeWithWidgetType(W)},{name:"Unconfigured Proportional Widget",widget:this.widgetTypesService.mergeWithWidgetType(E)}]}onSelect(t){this.widgetSelected.emit(t[0].widget),this.widgetSelection=t}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(s.xTe))},i.\u0275cmp=e.Xpm({type:i,selectors:[["widget-template-selection"]],outputs:{widgetSelected:"widgetSelected"},decls:4,vars:3,consts:[[1,"nui-widget-cloner"],["selectionMode","singleWithRequiredSelection",3,"itemsSource","selection","repeatItemTemplateRef","selectionChange"],["widgetClonerItem",""],[1,"nui-widget-cloner__item","d-flex","pt-2","pb-2","align-items-center"],[1,"text-info","ml-3"]],template:function(t,o){if(1&t&&(e.TgZ(0,"div",0)(1,"nui-repeat",1),e.NdJ("selectionChange",function(a){return o.onSelect(a)}),e.qZA()(),e.YNc(2,R,3,1,"ng-template",null,2,e.W1O)),2&t){const r=e.MAs(3);e.xp6(1),e.Q6J("itemsSource",o.widgetItems)("selection",o.widgetSelection)("repeatItemTemplateRef",r)}},directives:[d.$N6],styles:[b]}),i})(),y=(()=>{class i{constructor(t){this.toastService=t,this.persistenceSucceeded=!0,this.trySubmit=o=>{const r=new g.x;return o.id||(o.id=(0,d.VjN)()),setTimeout(()=>{if(this.persistenceSucceeded)r.next(o),this.toastService.success({title:$localize`Submit succeeded.`});else{const a=$localize`Submit failed.`;this.toastService.error({title:a}),r.error(a)}r.complete()},1e3),r.asObservable()},this.tryRemove=o=>{const r=new g.x;return setTimeout(()=>{if(this.persistenceSucceeded)r.next(o),this.toastService.success({title:$localize`Removal success`});else{const a=$localize`Removal failed.`;this.toastService.error({title:a}),r.error(a)}r.complete()},1e3),r.asObservable()},this.toastService.setConfig({timeOut:2e3})}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(d.klp))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})(),A=(()=>{class i{constructor(t,o,r,a){this.widgetTypesService=t,this.providerRegistry=o,this.persistenceHandler=r,this.widgetClonerService=a,this.gridsterConfig={defaultItemCols:3,defaultItemRows:5},this.editMode=!1,this.destroy$=new g.x}ngOnInit(){const t=this.widgetTypesService.getWidgetType("kpi",1),o=this.widgetTypesService.getWidgetType("proportional",1);this.widgetTypesService.setNode(o,"configurator",s.ACc.DataSourceProviders,[m.providerId]),this.widgetTypesService.setNode(t,"configurator",s.ACc.DataSourceProviders,[p.providerId,f.providerId]),this.providerRegistry.setProviders({[p.providerId]:{provide:s.Fk3,useClass:p,deps:[c.eN]},[f.providerId]:{provide:s.Fk3,useClass:f,deps:[c.eN]},[m.providerId]:{provide:s.Fk3,useClass:m,deps:[]}}),this.initializeDashboard()}onCreateWidget(){this.widgetClonerService.open({dashboardComponent:this.dashboardComponent,trySubmit:this.persistenceHandler.trySubmit,widgetSelectionComponentType:k}).pipe((0,M.q)(1),(0,U.R)(this.destroy$)).subscribe()}initializeDashboard(){const t=W,o={[t.id]:this.widgetTypesService.mergeWithWidgetType(t)};this.dashboard={positions:{[t.id]:{cols:3,rows:5,y:0,x:0}},widgets:o}}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(s.xTe),e.Y36(s.CNH),e.Y36(y),e.Y36(s.$Ie))},i.\u0275cmp=e.Xpm({type:i,selectors:[["widget-creation"]],viewQuery:function(t,o){if(1&t&&e.Gf(s.MXM,7),2&t){let r;e.iGM(r=e.CRH())&&(o.dashboardComponent=r.first)}},features:[e._Bn([y])],decls:7,vars:5,consts:function(){let n,t;return n=$localize`:␟8c375764db42f5d736fb56d01b8052c006ccc8e2␟6407712033679505505:Edit Mode`,t=$localize`:␟bd773f8bf007ab93f7e28768edbf74c97381dff0␟5534056112042972153: Create Widget `,[[1,"my-3","d-flex","align-items-center"],[1,"ml-3",3,"value","valueChange"],n,["type","button","nui-button","",1,"ml-4",3,"click"],t,[1,"w-100","dashboard"],[3,"dashboard","gridsterConfig","editMode","nuiWidgetEditor","dashboardChange","gridsterConfigChange"]]},template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"nui-switch",1),e.NdJ("valueChange",function(a){return o.editMode=a}),e.SDv(2,2),e.qZA(),e.TgZ(3,"button",3),e.NdJ("click",function(){return o.onCreateWidget()}),e.SDv(4,4),e.qZA()(),e.TgZ(5,"div",5)(6,"nui-dashboard",6),e.NdJ("dashboardChange",function(a){return o.dashboard=a})("gridsterConfigChange",function(a){return o.gridsterConfig=a}),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("value",o.editMode),e.xp6(5),e.Q6J("dashboard",o.dashboard)("gridsterConfig",o.gridsterConfig)("editMode",o.editMode)("nuiWidgetEditor",o.persistenceHandler))},directives:[d.qUD,d.r0F,D.M,N.t],styles:[b]}),i})(),m=(()=>{class i{constructor(){this.outputsSubject=new g.x}applyFilters(){setTimeout(()=>{this.outputsSubject.next({result:this.getRandomProportionalWidgetData()})},1e3)}ngOnDestroy(){this.outputsSubject.complete()}getRandomProportionalWidgetData(){return[{id:"Down",name:"Down",data:[Math.round(100*Math.random())],icon:"status_down",link:"https://en.wikipedia.org/wiki/Brno",value:"Brno"},{id:"Critical",name:"Critical",data:[Math.round(100*Math.random())],icon:"status_critical",link:"https://en.wikipedia.org/wiki/Kyiv",value:"Kyiv"},{id:"Warning",name:"Warning",data:[Math.round(100*Math.random())],icon:"status_warning",link:"https://en.wikipedia.org/wiki/Austin",value:"Austin"},{id:"Unknown",name:"Unknown",data:[Math.round(100*Math.random())],icon:"status_unknown",link:"https://en.wikipedia.org/wiki/Lisbon",value:"Lisbon"},{id:"Up",name:"Up",data:[Math.round(100*Math.random())],icon:"status_up",link:"https://en.wikipedia.org/wiki/Sydney",value:"Sydney"},{id:"Unmanaged",name:"Unmanaged",data:[Math.round(100*Math.random())],icon:"status_unmanaged",link:"https://en.wikipedia.org/wiki/Nur-Sultan",value:"Nur-Sultan"}]}}return i.providerId="RandomCitiesProportionalDataSource",i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})(),p=(()=>{class i extends d.LvN{constructor(t){super(),this.http=t,this.busy=new T.X(!1)}getFilteredData(){return _(this,void 0,void 0,function*(){return this.busy.next(!0),new Promise(t=>{this.http.get("https://www.googleapis.com/books/v1/volumes/5MQFrgEACAAJ").pipe((0,S.x)(()=>this.busy.next(!1))).subscribe({next:o=>{t({result:{value:o.volumeInfo.averageRating}})},error:o=>{t({result:null,error:{type:o.status}})}})})})}ngOnDestroy(){this.outputsSubject.complete()}}return i.providerId="AverageRatingKpiDataSource",i.\u0275fac=function(t){return new(t||i)(e.LFG(c.eN))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})(),f=(()=>{class i extends d.LvN{constructor(t){super(),this.http=t,this.busy=new T.X(!1)}getFilteredData(){return _(this,void 0,void 0,function*(){return this.busy.next(!0),new Promise(t=>{this.http.get("https://www.googleapis.com/books/v1/volumes/5MQFrgEACAAJ").pipe((0,S.x)(()=>this.busy.next(!1))).subscribe({next:o=>{t({result:{value:o.volumeInfo.ratingsCount}})},error:o=>{t({result:null,error:{type:o.status}})}})})})}ngOnDestroy(){this.outputsSubject.complete()}}return i.providerId="RatingsCountKpiDataSource",i.\u0275fac=function(t){return new(t||i)(e.LFG(c.eN))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})();const W={id:"widget1",type:"kpi",pizzagna:{[s.xW5.Configuration]:{[s.XMI]:{providers:{[s.Muk.Refresher]:{properties:{interval:600,enabled:!0}}}},header:{properties:{title:"Harry Potter and the Sorcerer's Stone",subtitle:"By J. K. Rowling"}},tiles:{properties:{nodes:["kpi1"]}},kpi1:{id:"kpi1",componentType:s.ufE.lateLoadKey,properties:{widgetData:{units:"out of 5 Stars",label:"Average Rating"}},providers:{[s.Muk.DataSource]:{providerId:p.providerId},[s.Muk.Adapter]:{providerId:s.u1$,properties:{componentId:"kpi1",propertyPath:"widgetData"}}}}}}},E={id:"widget2",type:"proportional",metadata:{needsConfiguration:!0},pizzagna:{[s.xW5.Configuration]:{header:{properties:{title:"*New Proportional Widget*"}}}}},O=[{path:"",component:(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["nui-dashboard-widget-creation-docs"]],decls:87,vars:3,consts:[["href","../injectables/ProviderRegistryService.html","target","_blank"],["href","../injectables/WidgetClonerService.html","target","_blank"],["href","../additional-documentation/getting-started.html","target","_parent"],["href","../interfaces/IWidgetTemplateSelector.html","target","_blank"],["href","../interfaces/IWidgetMetadata.html#needsConfiguration","target","_blank"],["type","info",3,"allowDismiss"],["href","../interfaces/IWidgetSelector.html","target","_blank"],["href","../injectables/WidgetClonerService.html#open","target","_blank"],["filenamePrefix","widget-creation.component","exampleTitle","Widget Creation"]],template:function(t,o){1&t&&(e.TgZ(0,"h1"),e._uU(1,"Widget Creation"),e.qZA(),e.TgZ(2,"p"),e._uU(3," In this tutorial we'll cover how to add a widget creation wizard which allows end-users to create new widget instances based on existing widget configurations. The wizard's first step, or page, will use a custom component that lets users choose a widget to create. In the example below we'll implement a sample widget selection component that provides a proportional widget and a kpi widget as options.\n"),e.qZA(),e.TgZ(4,"h2"),e._uU(5,"Fundamental Concepts"),e.qZA(),e.TgZ(6,"ul")(7,"li")(8,"a",0)(9,"code"),e._uU(10,"ProviderRegistryService"),e.qZA()()(),e.TgZ(11,"li")(12,"a",1)(13,"code"),e._uU(14,"WidgetClonerService"),e.qZA()()(),e.TgZ(15,"li"),e._uU(16,"Widget configurations"),e.qZA(),e.TgZ(17,"li"),e._uU(18,"Custom component for widget selection"),e.qZA()(),e.TgZ(19,"h2"),e._uU(20,"Basic Steps"),e.qZA(),e.TgZ(21,"ol")(22,"li"),e._uU(23," Follow the instructions "),e.TgZ(24,"a",2),e._uU(25,"here"),e.qZA(),e._uU(26," to set up your environment for dashboard development. "),e.qZA(),e.TgZ(27,"li"),e._uU(28," Follow the instructions from previous tutorials to get a basic dashboard up and running. "),e.qZA(),e.TgZ(29,"li"),e._uU(30," Create a widget template selector component which will act as the first step in the wizard. The selector component should implement the "),e.TgZ(31,"a",3)(32,"code"),e._uU(33,"IWidgetTemplateSelector"),e.qZA()(),e._uU(34," interface which requires a widgetSelected output that should emit a widget to be cloned. For any widgets that require further configuration before they should be placed on the dashboard, set the widget's "),e.TgZ(35,"code")(36,"a",4),e._uU(37,"metadata.needsConfiguration"),e.qZA()(),e._uU(38," property to "),e.TgZ(39,"code"),e._uU(40,"true"),e.qZA(),e._uU(41,'. This will hide the "Create Widget" button whenever an unconfigured widget is selected. '),e.TgZ(42,"nui-message",5)(43,"strong"),e._uU(44,"Note:"),e.qZA(),e._uU(45," In the example below, the widget selector is implemented in the same file as the dashboard component, but it's recommended to define it in a separate file. Additionally, after implementing it, remember to add it to your module declarations. "),e.qZA()(),e.TgZ(46,"li"),e._uU(47," Ensure that "),e.TgZ(48,"code"),e._uU(49,"NuiRepeatModule"),e.qZA(),e._uU(50," and "),e.TgZ(51,"code"),e._uU(52,"NuiImageModule"),e.qZA(),e._uU(53," are included in the imports of the widget template selector component's parent module. "),e.TgZ(54,"nui-message",5)(55,"strong"),e._uU(56,"Note:"),e.qZA(),e._uU(57," Importing these modules is required in this example because, in this case, the widget template selector uses the Nova repeat component and a couple of images from the Nova image repository. "),e.qZA()(),e.TgZ(58,"li"),e._uU(59," Invoke the "),e.TgZ(60,"code"),e._uU(61,"open"),e.qZA(),e._uU(62," method on the "),e.TgZ(63,"a",1)(64,"code"),e._uU(65,"WidgetClonerService"),e.qZA()(),e._uU(66," with an argument of type "),e.TgZ(67,"a",6)(68,"code"),e._uU(69,"IWidgetSelector"),e.qZA()(),e._uU(70,". Only two things are required in that object: a reference to the dashboardComponent instance and the typename of the widget selector created in the previous step. Optionally, the argument object may also contain a "),e.TgZ(71,"code"),e._uU(72,"trySubmit"),e.qZA(),e._uU(73," function with logic for persisting the new widget on a backend. "),e.qZA(),e.TgZ(74,"li"),e._uU(75," Subscribe to the "),e.TgZ(76,"code"),e._uU(77,"Observable"),e.qZA(),e._uU(78," returned by the "),e.TgZ(79,"a",7)(80,"code"),e._uU(81,"widgetClonerService.open"),e.qZA()(),e._uU(82," method in order to activate the handling of form submission and the subsequent updating of the dashboard with a newly created widget. "),e.qZA()(),e.TgZ(83,"nui-message",5),e._uU(84," For more detailed information about widget creation, take a look at the inline comments under the source expander of the following example.\n"),e.qZA(),e.TgZ(85,"nui-example-wrapper",8),e._UZ(86,"widget-creation"),e.qZA()),2&t&&(e.xp6(42),e.Q6J("allowDismiss",!1),e.xp6(12),e.Q6J("allowDismiss",!1),e.xp6(29),e.Q6J("allowDismiss",!1))},directives:[d.qqZ,d.hD2,A],encapsulation:2}),i})(),data:{srlc:{hideIndicator:!0},showThemeSwitcher:!0}},{path:"example",component:A,data:{srlc:{hideIndicator:!0}}}];let x=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[Z.ez,c.JF,s.Pi,d.vvu,d.gkT,d.cJ5,d.tez,d.Az_,d.ZuS,d.sF0,I.Bz.forChild(O)]]}),i})()}}]);