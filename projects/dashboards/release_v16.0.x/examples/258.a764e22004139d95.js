"use strict";(self.webpackChunkexamples=self.webpackChunkexamples||[]).push([[258],{98258:(te,T,a)=>{a.r(T),a.d(T,{ManyWidgetsModule:()=>ee});var h=a(54739),m=a(48900),R=a(49432),l=a(85907),d=a(8599),C=a(74067),E=a(30720),A=a(54384),D=a(29242),$=a(85005),G=a(15536),Y=a(25335),M=a(96878),L=a(80216),X=a(60142),z=a(36006),e=a(99019);let S=(()=>{class n extends l.n_V{static{this.providerId="AcmeKpiDataSource"}static{this.mockError=!1}constructor(t){super(),this.http=t,this.busy=new X.t(!1)}getFilteredData(){var t=this;return(0,L.A)(function*(){t.busy.next(!0);const i=Math.floor(Math.random()*Math.floor(99))+1;return new Promise(o=>{t.http.get(`https://jsonplaceholder.typicode.com/todos/${i}`).pipe((0,z.j)(()=>t.busy.next(!1))).subscribe({next:s=>{o({result:{value:s.id,label:s.title}})},error:s=>{o({result:null,error:{type:s.status}})}})})})()}ngOnDestroy(){this.outputsSubject.complete()}static{this.\u0275fac=function(i){return new(i||n)(e.KVO(m.Qq))}}static{this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac})}}return n})();var j=a(97861),B=a.n(j),f=a(52667),v=a(31451),y=a(76211),U=a(70716),N=a.n(U),k=a(6447),b=a.n(k);const F=n=>({id:`${n}`,type:"kpi",pizzagna:{[d.K8R.Configuration]:{header:{properties:{title:"KPI Widget!",subtitle:"A bunch of number boxes",collapsible:!0}},tiles:{providers:{},properties:{nodes:["kpi1"]}},kpi1:{id:"kpi1",providers:{[d.ShF.DataSource]:{providerId:S.providerId},[d.ShF.Adapter]:{providerId:d.YcW,properties:{componentId:"kpi1",propertyPath:"widgetData"}}}}}}}),[p,V]=function K(n){const g=[],t={},i={cols:8,rows:6,y:0,x:0};for(let o=0;o<=n;o++){const s=`widget${o.toString()}`,r=F(s),u=t[`widget${(o-1).toString()}`],_=u?{...u,y:u.y+6}:i;g.push(r),t[s]=_}return[g,t]}(15);function H(n,g){if(1&n&&(e.j41(0,"div",3)(1,"div",4),e.EFF(2),e.k0s()()),2&n){const t=g.item;e.R7$(2),e.SpI(" ",t.title," ")}}let O=(()=>{class n{static{this.lateLoadKey="AcmeCloneSelectionComponent"}constructor(t){this.widgetTypesService=t,this.widgetSelected=new e.bkB,this.widgetItems=[]}ngOnInit(){const t=new h.PV;this.widgetItems=p.map(i=>({title:t.transform(i.type),widget:this.widgetTypesService.mergeWithWidgetType(i)})),p.forEach(i=>{this.addUnconfiguredWidgetWithConfigLayer(i)})}addUnconfiguredWidget(t){const i=(new h.PV).transform(t);this.widgetItems.push({title:`Unconfigured ${i}`,widget:{id:`unconfigured${i}`,type:t,metadata:{needsConfiguration:!0},pizzagna:N()(this.widgetTypesService.getWidgetType(t).widget)}}),b()(this.widgetItems[this.widgetItems.length-1].widget.pizzagna,`${d.K8R.Structure}.header.properties.title`,`Unconfigured ${i}`)}addUnconfiguredWidgetWithConfigLayer(t){const i=(new h.PV).transform(t.type);this.widgetItems.push({title:`Unconfigured ${i} With Config Layer`,widget:{...N()(this.widgetTypesService.mergeWithWidgetType(t)),id:`unconfiguredWithConfigLayer${i}`,metadata:{needsConfiguration:!0}}}),b()(this.widgetItems[this.widgetItems.length-1].widget.pizzagna,`${d.K8R.Configuration}.header.properties.title`,`Unconfigured ${i} With Config Layer`)}onSelect(t){this.widgetSelected.emit(t[0].widget),this.widgetSelection=t}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(d.Dz_))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["acme-clone-selection"]],outputs:{widgetSelected:"widgetSelected"},decls:4,vars:3,consts:[[1,"nui-widget-cloner"],["selectionMode","singleWithRequiredSelection",3,"itemsSource","selection","repeatItemTemplateRef","selectionChange"],["widgetClonerItem",""],[1,"nui-widget-cloner__item","d-flex","pt-2","pb-2","align-items-center"],[1,"text-info","ml-3"]],template:function(i,o){if(1&i&&(e.j41(0,"div",0)(1,"nui-repeat",1),e.bIt("selectionChange",function(r){return o.onSelect(r)}),e.k0s()(),e.DNE(2,H,3,1,"ng-template",null,2,e.C5r)),2&i){const s=e.sdS(3);e.R7$(1),e.Y8G("itemsSource",o.widgetItems)("selection",o.widgetSelection)("repeatItemTemplateRef",s)}},dependencies:[l.BWW],styles:[".nui-widget-cloner__item[_ngcontent-%COMP%]{height:60px}"]})}}return n})();function Q(n,g){if(1&n&&(e.j41(0,"div",3)(1,"div",4),e.EFF(2),e.k0s()()),2&n){const t=g.item;e.R7$(2),e.SpI(" ",t.title," ")}}let x=(()=>{class n extends O{static{this.lateLoadKey="AcmeCloneSelectionComponent"}constructor(t){super(t)}ngOnInit(){const t=new h.PV;this.widgetItems=p.map(i=>({title:t.transform(i.type),widget:this.widgetTypesService.mergeWithWidgetType(i)}))}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(d.Dz_))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["acme-clone-selection"]],features:[e.Vt3],decls:4,vars:3,consts:[[1,"nui-widget-cloner"],["selectionMode","singleWithRequiredSelection",3,"itemsSource","selection","repeatItemTemplateRef","selectionChange"],["widgetClonerItem",""],[1,"nui-widget-cloner__item","d-flex","pt-2","pb-2","align-items-center"],[1,"text-info","ml-3"]],template:function(i,o){if(1&i&&(e.j41(0,"div",0)(1,"nui-repeat",1),e.bIt("selectionChange",function(r){return o.onSelect(r)}),e.k0s()(),e.DNE(2,Q,3,1,"ng-template",null,2,e.C5r)),2&i){const s=e.sdS(3);e.R7$(1),e.Y8G("itemsSource",o.widgetItems)("selection",o.widgetSelection)("repeatItemTemplateRef",s)}},dependencies:[l.BWW],styles:[".nui-widget-cloner__item[_ngcontent-%COMP%]{height:60px}"]})}}return n})(),I=(()=>{class n{constructor(t){this.toastService=t,this.allowSubmit=!0,this.allowRemoval=!0,this.trySubmit=(i,o)=>{const s=new f.B;return setTimeout(()=>{if(this.allowSubmit)s.next(i);else{const r=$localize`Submit failed.`;this.toastService.error({title:r}),s.error(r)}},1e3),s.asObservable()},this.tryRemove=i=>{const o=new f.B;return setTimeout(()=>{if(this.allowRemoval)o.next(i);else{const s=$localize`Widget removal failed.`;this.toastService.error({title:s}),o.error(s)}},200),o.asObservable()},this.toastService.setConfig({timeOut:2e3})}static{this.\u0275fac=function(i){return new(i||n)(e.KVO(l.fwc))}}static{this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac})}}return n})();var Z=a(17955),J=a(67432);const q=[{path:"",component:(()=>{class n{constructor(t,i,o,s,r){this.providerRegistry=t,this.submitHandler=i,this.widgetTypesService=o,this.widgetClonerService=s,this.refreshSettings=r,this.dashboard={positions:{},widgets:{}},this.gridsterConfig={minCols:12,maxCols:12,minRows:12},this.editMode=!1,this.systemRefreshInterval=60,this.belowFoldLazyLoadingConfig={enabled:!0},this.destroy$=new f.B,this.providerRegistry.setProviders({[S.providerId]:{provide:d.R9t,useClass:S,deps:[m.Qq]}})}ngOnInit(){this.widgetTypesService.getWidgetType("table").configurator?.[d.K8R.Structure].presentation.properties?.nodes.push("refresher"),this.refreshSettings.refreshRateSeconds=this.systemRefreshInterval;const t=p.map(o=>this.widgetTypesService.mergeWithWidgetType(o)),i=B()(t,o=>o.id);this.dashboard={positions:V,widgets:i}}onDsErrorSwitch(t){S.mockError=t}onShowButtonSwitch(t,i){for(const o of Object.keys(this.dashboard.widgets))this.dashboard=(0,l.lwv)(this.dashboard,`widgets.${o}.pizzagna.configuration.header.properties.${i}`,t)}ngAfterViewInit(){this.dashboardComponent.eventBus.subscribeUntil(d.mZ_,this.destroy$,t=>{this.widgetClonerService.open({widget:this.dashboard.widgets[t.widgetId],dashboardComponent:this.dashboardComponent,trySubmit:this.submitHandler.trySubmit,widgetSelectionComponentType:x}).pipe((0,v.s)(1),(0,y.Q)(this.destroy$)).subscribe()})}onCloneWidget(){this.widgetClonerService.open({dashboardComponent:this.dashboardComponent,trySubmit:this.submitHandler.trySubmit,widgetSelectionComponentType:O}).pipe((0,v.s)(1),(0,y.Q)(this.destroy$)).subscribe()}onEditWithCloner(){this.dashboardComponent.eventBus.next(d.mZ_,{widgetId:p[0].id})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}onSystemRefreshIntervalClick(){this.refreshSettings.refreshRateSeconds=this.systemRefreshInterval}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(d.g_3),e.rXU(I),e.rXU(d.Dz_),e.rXU(d.jaz),e.rXU(d.D7Y))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["many-widgets-dashboard-dashboard"]],viewQuery:function(i,o){if(1&i&&e.GBs(d.S5f,7),2&i){let s;e.mGM(s=e.lsd())&&(o.dashboardComponent=s.first)}},features:[e.Jv_([I])],decls:25,vars:11,consts:function(){let t,i,o,s,r,u,_,P,w,W;return t=$localize`:␟489801ff09de9b4a6ca8b6e05a475fa1ca00d98e␟5813529530812520031: Create Widget Clone
`,i=$localize`:␟d8e9c9957a5d6ebe7749aab0e18dcb5d944b2ef9␟7916291516675251750: Simulate edit with cloner
`,o=$localize`:␟5cab2718f1d3c09ccb1fca4886710430f59bf7c0␟81810662047948365: Edit mode `,s=$localize`:␟db70aaa4da7a9f7c0fa3a218907f9fa354a19038␟5855643886473775120: Allow Submit `,r=$localize`:␟d289dfdc6c4e23b49a96db083f95f1087ed1400a␟3687117978364204872: Allow Removal `,u=$localize`:␟3299af3b186d7701f4c0626e41eba58af8382723␟4106211393112768148: Show Edit Button `,_=$localize`:␟30251ad3dcd7facd3a222d48fb2ba02f8503c52c␟8096484277280346189: Show Remove Button `,P=$localize`:␟c355f0feb3f72b3594e6e975456cd0a2dac1d929␟870224976565315483: Data Source Error `,w=$localize`:␟90504d9af68fb3aa81accb4bc3005526deb04093␟5488473345097746222:System refresh interval (seconds)`,W=$localize`:␟559db359e3dcc0820499a4e58208fb22273e0d55␟5928813357836950616: Update system refresh interval `,[["type","button","nui-button","",1,"mb-3","ml-4",3,"click"],t,i,[1,"w-100",2,"height","725px"],[3,"nuiWidgetEditor","dashboard","gridsterConfig","editMode","belowFoldLazyLoadingConfig","dashboardChange","gridsterConfigChange"],[1,"my-3","d-flex","align-items-center"],[1,"ml-3",3,"value","valueChange"],o,s,r,u,_,[1,"ml-3",3,"valueChange"],P,[1,"d-flex","flex-row"],[2,"width","300px"],["caption",w],[3,"value","valueChange"],["type","button","nui-button","",1,"ml-4",3,"click"],W]},template:function(i,o){1&i&&(e.j41(0,"button",0),e.bIt("click",function(){return o.onCloneWidget()}),e.pXf(1,1),e.k0s(),e.j41(2,"button",0),e.bIt("click",function(){return o.onEditWithCloner()}),e.pXf(3,2),e.k0s(),e.j41(4,"div",3)(5,"nui-dashboard",4),e.bIt("dashboardChange",function(r){return o.dashboard=r})("gridsterConfigChange",function(r){return o.gridsterConfig=r}),e.k0s()(),e.j41(6,"div",5)(7,"nui-switch",6),e.bIt("valueChange",function(r){return o.editMode=r}),e.pXf(8,7),e.k0s(),e.j41(9,"nui-switch",6),e.bIt("valueChange",function(r){return o.submitHandler.allowSubmit=r}),e.pXf(10,8),e.k0s(),e.j41(11,"nui-switch",6),e.bIt("valueChange",function(r){return o.submitHandler.allowRemoval=r}),e.pXf(12,9),e.k0s(),e.j41(13,"nui-switch",6),e.bIt("valueChange",function(r){return o.onShowButtonSwitch(r,"editable")}),e.pXf(14,10),e.k0s(),e.j41(15,"nui-switch",6),e.bIt("valueChange",function(r){return o.onShowButtonSwitch(r,"removable")}),e.pXf(16,11),e.k0s(),e.j41(17,"nui-switch",12),e.bIt("valueChange",function(r){return o.onDsErrorSwitch(r)}),e.pXf(18,13),e.k0s()(),e.j41(19,"div",14)(20,"div",15)(21,"nui-form-field",16)(22,"nui-textbox-number",17),e.bIt("valueChange",function(r){return o.systemRefreshInterval=r}),e.k0s()()(),e.j41(23,"button",18),e.bIt("click",function(){return o.onSystemRefreshIntervalClick()}),e.pXf(24,19),e.k0s()()),2&i&&(e.R7$(5),e.Y8G("nuiWidgetEditor",o.submitHandler)("dashboard",o.dashboard)("gridsterConfig",o.gridsterConfig)("editMode",o.editMode)("belowFoldLazyLoadingConfig",o.belowFoldLazyLoadingConfig),e.R7$(2),e.Y8G("value",o.editMode),e.R7$(2),e.Y8G("value",o.submitHandler.allowSubmit),e.R7$(2),e.Y8G("value",o.submitHandler.allowRemoval),e.R7$(2),e.Y8G("value",!0),e.R7$(2),e.Y8G("value",!0),e.R7$(7),e.Y8G("value",o.systemRefreshInterval))},dependencies:[Z.S,J.Z,l.Qpp,l.clF,l.KSf,l.VkH],styles:[".nui-theme-switcher-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;padding:10px;background-color:var(--nui-color-bg-light,#fff)}"]})}}return n})(),data:{srlc:{hideIndicator:!0},showThemeSwitcher:!0}}];let ee=(()=>{class n{constructor(t,i){this.widgetTypesService=t,this.componentRegistry=i,this.setupDataSourceProviders(),this.setupCustomProportionalWidgetDSConfig()}setupCustomProportionalWidgetDSConfig(){const t=this.widgetTypesService.getWidgetType("proportional",1);delete t.widget.structure[d.ocI].providers?.refresher,this.widgetTypesService.setNode(t,"configurator",d.Eov.DataSourceConfigComponentType,C.Q.lateLoadKey),this.componentRegistry.registerByLateLoadKey(C.Q)}setupDataSourceProviders(){this.setDataSourceProviders("table",[A.M.providerId,D.A.providerId,$.D.providerId,Y.U.providerId,G.F.providerId]);const t=this.widgetTypesService.getWidgetType("kpi",1);this.widgetTypesService.setNode(t,"configurator",d.Eov.DataSourceConfigComponentType,d.vLY.lateLoadKey),this.setDataSourceProviders("kpi",[{providerId:S.providerId,label:"Acme KPI Data Source 1"}]),this.setDataSourceProviders("proportional",[E.R.providerId,E.j.providerId]),this.setDataSourceProviders("timeseries",[M.eF.providerId,M.Q9.providerId])}setDataSourceProviders(t,i){const o=this.widgetTypesService.getWidgetType(t,1);this.widgetTypesService.setNode(o,"configurator",d.Eov.DataSourceProviders,i)}static{this.\u0275fac=function(i){return new(i||n)(e.KVO(d.Dz_),e.KVO(d.oWA))}}static{this.\u0275mod=e.$C({type:n})}static{this.\u0275inj=e.G2t({providers:[d.g_3],imports:[h.MD,m.q1,d.Ua7,l.cec,l.dfW,l.a4p,l.dDW,l.s6u,l.IRr,l.U76,R.iI.forChild(q),l.tXB,l.vrM]})}}return n})()}}]);