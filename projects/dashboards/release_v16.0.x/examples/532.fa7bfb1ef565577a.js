"use strict";(self.webpackChunkexamples=self.webpackChunkexamples||[]).push([[532],{98532:(A,m,r)=>{r.r(m),r.d(m,{default:()=>N});var y=r(54739),c=r(48900),E=r(49432),a=r(85907),s=r(8599),T=r(23929),e=r(99019),f=r(80216),u=r(52667),w=r(60142),k=r(31451),I=r(76211),v=r(36006),W=r(17955),j=r(67432);function R(i,_){if(1&i&&(e.j41(0,"div",3)(1,"div",4),e.EFF(2),e.k0s()()),2&i){const o=_.item;e.R7$(2),e.JRh(o.name)}}const C=".dashboard[_ngcontent-%COMP%]{height:800px}.nui-widget-cloner__item[_ngcontent-%COMP%]{height:60px}";let M=(()=>{class i{constructor(o){this.widgetTypesService=o,this.widgetSelected=new e.bkB,this.widgetItems=[]}ngOnInit(){this.widgetItems=[{name:"Fully Configured KPI Widget",widget:this.widgetTypesService.mergeWithWidgetType(b)},{name:"Unconfigured Proportional Widget",widget:this.widgetTypesService.mergeWithWidgetType(D)}]}onSelect(o){this.widgetSelected.emit(o[0].widget),this.widgetSelection=o}static{this.\u0275fac=function(t){return new(t||i)(e.rXU(s.Dz_))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["widget-template-selection"]],outputs:{widgetSelected:"widgetSelected"},decls:4,vars:3,consts:[[1,"nui-widget-cloner"],["selectionMode","singleWithRequiredSelection",3,"itemsSource","selection","repeatItemTemplateRef","selectionChange"],["widgetClonerItem",""],[1,"nui-widget-cloner__item","d-flex","pt-2","pb-2","align-items-center"],[1,"text-info","ml-3"]],template:function(t,n){if(1&t&&(e.j41(0,"div",0)(1,"nui-repeat",1),e.bIt("selectionChange",function(l){return n.onSelect(l)}),e.k0s()(),e.DNE(2,R,3,1,"ng-template",null,2,e.C5r)),2&t){const d=e.sdS(3);e.R7$(1),e.Y8G("itemsSource",n.widgetItems)("selection",n.widgetSelection)("repeatItemTemplateRef",d)}},dependencies:[a.BWW],styles:[C]})}}return i})(),S=(()=>{class i{constructor(o){this.toastService=o,this.persistenceSucceeded=!0,this.trySubmit=t=>{const n=new u.B;return t.id||(t.id=(0,a.uRe)()),setTimeout(()=>{if(this.persistenceSucceeded)n.next(t),this.toastService.success({title:$localize`Submit succeeded.`});else{const d=$localize`Submit failed.`;this.toastService.error({title:d}),n.error(d)}n.complete()},1e3),n.asObservable()},this.tryRemove=t=>{const n=new u.B;return setTimeout(()=>{if(this.persistenceSucceeded)n.next(t),this.toastService.success({title:$localize`Removal success`});else{const d=$localize`Removal failed.`;this.toastService.error({title:d}),n.error(d)}n.complete()},1e3),n.asObservable()},this.toastService.setConfig({timeOut:2e3})}static{this.\u0275fac=function(t){return new(t||i)(e.KVO(a.fwc))}}static{this.\u0275prov=e.jDH({token:i,factory:i.\u0275fac})}}return i})(),F=(()=>{class i{constructor(o,t,n,d){this.widgetTypesService=o,this.providerRegistry=t,this.persistenceHandler=n,this.widgetClonerService=d,this.gridsterConfig={defaultItemCols:3,defaultItemRows:5},this.editMode=!1,this.destroy$=new u.B}ngOnInit(){const o=this.widgetTypesService.getWidgetType("kpi",1),t=this.widgetTypesService.getWidgetType("proportional",1);this.widgetTypesService.setNode(t,"configurator",s.Eov.DataSourceProviders,[g.providerId]),this.widgetTypesService.setNode(o,"configurator",s.Eov.DataSourceProviders,[p.providerId,h.providerId]),this.providerRegistry.setProviders({[p.providerId]:{provide:s.R9t,useClass:p,deps:[c.Qq]},[h.providerId]:{provide:s.R9t,useClass:h,deps:[c.Qq]},[g.providerId]:{provide:s.R9t,useClass:g,deps:[]}}),this.initializeDashboard()}onCreateWidget(){this.widgetClonerService.open({dashboardComponent:this.dashboardComponent,trySubmit:this.persistenceHandler.trySubmit,widgetSelectionComponentType:M}).pipe((0,k.s)(1),(0,I.Q)(this.destroy$)).subscribe()}initializeDashboard(){const o=b,t={[o.id]:this.widgetTypesService.mergeWithWidgetType(o)};this.dashboard={positions:{[o.id]:{cols:3,rows:5,y:0,x:0}},widgets:t}}static{this.\u0275fac=function(t){return new(t||i)(e.rXU(s.Dz_),e.rXU(s.g_3),e.rXU(S),e.rXU(s.jaz))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["widget-creation"]],viewQuery:function(t,n){if(1&t&&e.GBs(s.S5f,7),2&t){let d;e.mGM(d=e.lsd())&&(n.dashboardComponent=d.first)}},features:[e.Jv_([S])],decls:7,vars:5,consts:function(){let o,t;return o=$localize`:␟8c375764db42f5d736fb56d01b8052c006ccc8e2␟6407712033679505505:Edit Mode`,t=$localize`:␟bd773f8bf007ab93f7e28768edbf74c97381dff0␟5534056112042972153: Create Widget `,[[1,"my-3","d-flex","align-items-center"],[1,"ml-3",3,"value","valueChange"],o,["type","button","nui-button","",1,"ml-4",3,"click"],t,[1,"w-100","dashboard"],[3,"dashboard","gridsterConfig","editMode","nuiWidgetEditor","dashboardChange","gridsterConfigChange"]]},template:function(t,n){1&t&&(e.j41(0,"div",0)(1,"nui-switch",1),e.bIt("valueChange",function(l){return n.editMode=l}),e.pXf(2,2),e.k0s(),e.j41(3,"button",3),e.bIt("click",function(){return n.onCreateWidget()}),e.pXf(4,4),e.k0s()(),e.j41(5,"div",5)(6,"nui-dashboard",6),e.bIt("dashboardChange",function(l){return n.dashboard=l})("gridsterConfigChange",function(l){return n.gridsterConfig=l}),e.k0s()()),2&t&&(e.R7$(1),e.Y8G("value",n.editMode),e.R7$(5),e.Y8G("dashboard",n.dashboard)("gridsterConfig",n.gridsterConfig)("editMode",n.editMode)("nuiWidgetEditor",n.persistenceHandler))},dependencies:[W.S,j.Z,a.clF,a.Qpp],styles:[C]})}}return i})(),g=(()=>{class i{constructor(){this.outputsSubject=new u.B}static{this.providerId="RandomCitiesProportionalDataSource"}applyFilters(){setTimeout(()=>{this.outputsSubject.next({result:this.getRandomProportionalWidgetData()})},1e3)}ngOnDestroy(){this.outputsSubject.complete()}getRandomProportionalWidgetData(){return[{id:"Down",name:"Down",data:[Math.round(100*Math.random())],icon:"status_down",link:"https://en.wikipedia.org/wiki/Brno",value:"Brno"},{id:"Critical",name:"Critical",data:[Math.round(100*Math.random())],icon:"status_critical",link:"https://en.wikipedia.org/wiki/Kyiv",value:"Kyiv"},{id:"Warning",name:"Warning",data:[Math.round(100*Math.random())],icon:"status_warning",link:"https://en.wikipedia.org/wiki/Austin",value:"Austin"},{id:"Unknown",name:"Unknown",data:[Math.round(100*Math.random())],icon:"status_unknown",link:"https://en.wikipedia.org/wiki/Lisbon",value:"Lisbon"},{id:"Up",name:"Up",data:[Math.round(100*Math.random())],icon:"status_up",link:"https://en.wikipedia.org/wiki/Sydney",value:"Sydney"},{id:"Unmanaged",name:"Unmanaged",data:[Math.round(100*Math.random())],icon:"status_unmanaged",link:"https://en.wikipedia.org/wiki/Nur-Sultan",value:"Nur-Sultan"}]}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275prov=e.jDH({token:i,factory:i.\u0275fac})}}return i})(),p=(()=>{class i extends a.n_V{static{this.providerId="AverageRatingKpiDataSource"}constructor(o){super(),this.http=o,this.busy=new w.t(!1)}getFilteredData(){var o=this;return(0,f.A)(function*(){return o.busy.next(!0),new Promise(t=>{o.http.get("https://www.googleapis.com/books/v1/volumes/5MQFrgEACAAJ").pipe((0,v.j)(()=>o.busy.next(!1))).subscribe({next:n=>{t({result:{value:n.volumeInfo.averageRating}})},error:n=>{t({result:null,error:{type:n.status}})}})})})()}ngOnDestroy(){this.outputsSubject.complete()}static{this.\u0275fac=function(t){return new(t||i)(e.KVO(c.Qq))}}static{this.\u0275prov=e.jDH({token:i,factory:i.\u0275fac})}}return i})(),h=(()=>{class i extends a.n_V{static{this.providerId="RatingsCountKpiDataSource"}constructor(o){super(),this.http=o,this.busy=new w.t(!1)}getFilteredData(){var o=this;return(0,f.A)(function*(){return o.busy.next(!0),new Promise(t=>{o.http.get("https://www.googleapis.com/books/v1/volumes/5MQFrgEACAAJ").pipe((0,v.j)(()=>o.busy.next(!1))).subscribe({next:n=>{t({result:{value:n.volumeInfo.ratingsCount}})},error:n=>{t({result:null,error:{type:n.status}})}})})})()}ngOnDestroy(){this.outputsSubject.complete()}static{this.\u0275fac=function(t){return new(t||i)(e.KVO(c.Qq))}}static{this.\u0275prov=e.jDH({token:i,factory:i.\u0275fac})}}return i})();const b={id:"widget1",type:"kpi",pizzagna:{[s.K8R.Configuration]:{[s.ocI]:{providers:{[s.ShF.Refresher]:{properties:{interval:600,enabled:!0}}}},header:{properties:{title:"Harry Potter and the Sorcerer's Stone",subtitle:"By J. K. Rowling"}},tiles:{properties:{nodes:["kpi1"]}},kpi1:{id:"kpi1",componentType:s.kPo.lateLoadKey,properties:{widgetData:{units:"out of 5 Stars",label:"Average Rating"}},providers:{[s.ShF.DataSource]:{providerId:p.providerId},[s.ShF.Adapter]:{providerId:s.YcW,properties:{componentId:"kpi1",propertyPath:"widgetData"}}}}}}},D={id:"widget2",type:"proportional",metadata:{needsConfiguration:!0},pizzagna:{[s.K8R.Configuration]:{header:{properties:{title:"*New Proportional Widget*"}}}}},O=[{path:"",component:(()=>{class i{static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["nui-dashboard-widget-creation-docs"]],decls:87,vars:3,consts:[["href","../injectables/ProviderRegistryService.html","target","_blank"],["href","../injectables/WidgetClonerService.html","target","_blank"],["href","../additional-documentation/getting-started.html","target","_parent"],["href","../interfaces/IWidgetTemplateSelector.html","target","_blank"],["href","../interfaces/IWidgetMetadata.html#needsConfiguration","target","_blank"],["type","info",3,"allowDismiss"],["href","../interfaces/IWidgetSelector.html","target","_blank"],["href","../injectables/WidgetClonerService.html#open","target","_blank"],["filenamePrefix","widget-creation.component","exampleTitle","Widget Creation"]],template:function(t,n){1&t&&(e.j41(0,"h1"),e.EFF(1,"Widget Creation"),e.k0s(),e.j41(2,"p"),e.EFF(3," In this tutorial we'll cover how to add a widget creation wizard which allows end-users to create new widget instances based on existing widget configurations. The wizard's first step, or page, will use a custom component that lets users choose a widget to create. In the example below we'll implement a sample widget selection component that provides a proportional widget and a kpi widget as options.\n"),e.k0s(),e.j41(4,"h2"),e.EFF(5,"Fundamental Concepts"),e.k0s(),e.j41(6,"ul")(7,"li")(8,"a",0)(9,"code"),e.EFF(10,"ProviderRegistryService"),e.k0s()()(),e.j41(11,"li")(12,"a",1)(13,"code"),e.EFF(14,"WidgetClonerService"),e.k0s()()(),e.j41(15,"li"),e.EFF(16,"Widget configurations"),e.k0s(),e.j41(17,"li"),e.EFF(18,"Custom component for widget selection"),e.k0s()(),e.j41(19,"h2"),e.EFF(20,"Basic Steps"),e.k0s(),e.j41(21,"ol")(22,"li"),e.EFF(23," Follow the instructions "),e.j41(24,"a",2),e.EFF(25,"here"),e.k0s(),e.EFF(26," to set up your environment for dashboard development. "),e.k0s(),e.j41(27,"li"),e.EFF(28," Follow the instructions from previous tutorials to get a basic dashboard up and running. "),e.k0s(),e.j41(29,"li"),e.EFF(30," Create a widget template selector component which will act as the first step in the wizard. The selector component should implement the "),e.j41(31,"a",3)(32,"code"),e.EFF(33,"IWidgetTemplateSelector"),e.k0s()(),e.EFF(34," interface which requires a widgetSelected output that should emit a widget to be cloned. For any widgets that require further configuration before they should be placed on the dashboard, set the widget's "),e.j41(35,"code")(36,"a",4),e.EFF(37,"metadata.needsConfiguration"),e.k0s()(),e.EFF(38," property to "),e.j41(39,"code"),e.EFF(40,"true"),e.k0s(),e.EFF(41,'. This will hide the "Create Widget" button whenever an unconfigured widget is selected. '),e.j41(42,"nui-message",5)(43,"strong"),e.EFF(44,"Note:"),e.k0s(),e.EFF(45," In the example below, the widget selector is implemented in the same file as the dashboard component, but it's recommended to define it in a separate file. Additionally, after implementing it, remember to add it to your module declarations. "),e.k0s()(),e.j41(46,"li"),e.EFF(47," Ensure that "),e.j41(48,"code"),e.EFF(49,"NuiRepeatModule"),e.k0s(),e.EFF(50," and "),e.j41(51,"code"),e.EFF(52,"NuiImageModule"),e.k0s(),e.EFF(53," are included in the imports of the widget template selector component's parent module. "),e.j41(54,"nui-message",5)(55,"strong"),e.EFF(56,"Note:"),e.k0s(),e.EFF(57," Importing these modules is required in this example because, in this case, the widget template selector uses the Nova repeat component and a couple of images from the Nova image repository. "),e.k0s()(),e.j41(58,"li"),e.EFF(59," Invoke the "),e.j41(60,"code"),e.EFF(61,"open"),e.k0s(),e.EFF(62," method on the "),e.j41(63,"a",1)(64,"code"),e.EFF(65,"WidgetClonerService"),e.k0s()(),e.EFF(66," with an argument of type "),e.j41(67,"a",6)(68,"code"),e.EFF(69,"IWidgetSelector"),e.k0s()(),e.EFF(70,". Only two things are required in that object: a reference to the dashboardComponent instance and the typename of the widget selector created in the previous step. Optionally, the argument object may also contain a "),e.j41(71,"code"),e.EFF(72,"trySubmit"),e.k0s(),e.EFF(73," function with logic for persisting the new widget on a backend. "),e.k0s(),e.j41(74,"li"),e.EFF(75," Subscribe to the "),e.j41(76,"code"),e.EFF(77,"Observable"),e.k0s(),e.EFF(78," returned by the "),e.j41(79,"a",7)(80,"code"),e.EFF(81,"widgetClonerService.open"),e.k0s()(),e.EFF(82," method in order to activate the handling of form submission and the subsequent updating of the dashboard with a newly created widget. "),e.k0s()(),e.j41(83,"nui-message",5),e.EFF(84," For more detailed information about widget creation, take a look at the inline comments under the source expander of the following example.\n"),e.k0s(),e.j41(85,"nui-example-wrapper",8),e.nrm(86,"widget-creation"),e.k0s()),2&t&&(e.R7$(42),e.Y8G("allowDismiss",!1),e.R7$(12),e.Y8G("allowDismiss",!1),e.R7$(29),e.Y8G("allowDismiss",!1))},dependencies:[a.tZW,a.VxJ,F],encapsulation:2})}}return i})(),data:{srlc:{hideIndicator:!0},showThemeSwitcher:!0}},{path:"example",component:F,data:{srlc:{hideIndicator:!0}}}];let N=(()=>{class i{static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275mod=e.$C({type:i})}static{this.\u0275inj=e.G2t({providers:[{provide:a.uzs,useValue:(0,T.R)("widget-creation")}],imports:[y.MD,c.q1,s.Ua7,a.a4p,a.GDi,a.dDW,a.ga_,a.dfW,a.U76,a.IRr,E.iI.forChild(O)]})}}return i})()}}]);