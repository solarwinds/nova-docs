"use strict";(self.webpackChunkexamples=self.webpackChunkexamples||[]).push([[878],{38878:(ee,M,r)=>{r.r(M),r.d(M,{ManyWidgetsModule:()=>q});var h=r(36895),C=r(80529),I=r(75883),l=r(72536),d=r(16084),E=r(27790),v=r(47794),W=r(68052),D=r(51454),R=r(37990),$=r(51933),Y=r(18631),N=r(22767),G=r(61135),L=r(28746),e=r(94650);let m=(()=>{class n extends l.LvN{constructor(t){super(),this.http=t,this.busy=new G.X(!1)}getFilteredData(){return function(n,a,t,i){return new(t||(t=Promise))(function(s,c){function S(u){try{p(i.next(u))}catch(g){c(g)}}function _(u){try{p(i.throw(u))}catch(g){c(g)}}function p(u){u.done?s(u.value):function o(s){return s instanceof t?s:new t(function(c){c(s)})}(u.value).then(S,_)}p((i=i.apply(n,a||[])).next())})}(this,void 0,void 0,function*(){this.busy.next(!0);const t=Math.floor(Math.random()*Math.floor(99))+1;return new Promise(i=>{this.http.get(`https://jsonplaceholder.typicode.com/todos/${t}`).pipe((0,L.x)(()=>this.busy.next(!1))).subscribe({next:o=>{i({result:{value:o.id,label:o.title}})},error:o=>{i({result:null,error:{type:o.status}})}})})})}ngOnDestroy(){this.outputsSubject.complete()}}return n.providerId="AcmeKpiDataSource",n.mockError=!1,n.\u0275fac=function(t){return new(t||n)(e.LFG(C.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();var x=r(12498),z=r.n(x),f=r(77579),y=r(95698),O=r(82722),Z=r(90733),b=r.n(Z),J=r(34793),A=r.n(J);const F=n=>({id:`${n}`,type:"kpi",pizzagna:{[d.xW5.Configuration]:{header:{properties:{title:"KPI Widget!",subtitle:"A bunch of number boxes",collapsible:!0}},tiles:{providers:{},properties:{nodes:["kpi1"]}},kpi1:{id:"kpi1",providers:{[d.Muk.DataSource]:{providerId:m.providerId},[d.Muk.Adapter]:{providerId:d.u1$,properties:{componentId:"kpi1",propertyPath:"widgetData"}}}}}}}),[T,B]=function j(n){const a=[],t={},i={cols:8,rows:6,y:0,x:0};for(let o=0;o<=n;o++){const s=`widget${o.toString()}`,c=F(s),S=t[`widget${(o-1).toString()}`],_=S?Object.assign(Object.assign({},S),{y:S.y+6}):i;a.push(c),t[s]=_}return[a,t]}(15);function H(n,a){if(1&n&&(e.TgZ(0,"div",3)(1,"div",4),e._uU(2),e.qZA()()),2&n){const t=a.item;e.xp6(2),e.hij(" ",t.title," ")}}let w=(()=>{class n{constructor(t){this.widgetTypesService=t,this.widgetSelected=new e.vpe,this.widgetItems=[]}ngOnInit(){const t=new h.rS;this.widgetItems=T.map(i=>({title:t.transform(i.type),widget:this.widgetTypesService.mergeWithWidgetType(i)})),T.forEach(i=>{this.addUnconfiguredWidgetWithConfigLayer(i)})}addUnconfiguredWidget(t){const i=(new h.rS).transform(t);this.widgetItems.push({title:`Unconfigured ${i}`,widget:{id:`unconfigured${i}`,type:t,metadata:{needsConfiguration:!0},pizzagna:b()(this.widgetTypesService.getWidgetType(t).widget)}}),A()(this.widgetItems[this.widgetItems.length-1].widget.pizzagna,`${d.xW5.Structure}.header.properties.title`,`Unconfigured ${i}`)}addUnconfiguredWidgetWithConfigLayer(t){const i=(new h.rS).transform(t.type);this.widgetItems.push({title:`Unconfigured ${i} With Config Layer`,widget:Object.assign(Object.assign({},b()(this.widgetTypesService.mergeWithWidgetType(t))),{id:`unconfiguredWithConfigLayer${i}`,metadata:{needsConfiguration:!0}})}),A()(this.widgetItems[this.widgetItems.length-1].widget.pizzagna,`${d.xW5.Configuration}.header.properties.title`,`Unconfigured ${i} With Config Layer`)}onSelect(t){this.widgetSelected.emit(t[0].widget),this.widgetSelection=t}}return n.lateLoadKey="AcmeCloneSelectionComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(d.xTe))},n.\u0275cmp=e.Xpm({type:n,selectors:[["acme-clone-selection"]],outputs:{widgetSelected:"widgetSelected"},decls:4,vars:3,consts:[[1,"nui-widget-cloner"],["selectionMode","singleWithRequiredSelection",3,"itemsSource","selection","repeatItemTemplateRef","selectionChange"],["widgetClonerItem",""],[1,"nui-widget-cloner__item","d-flex","pt-2","pb-2","align-items-center"],[1,"text-info","ml-3"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"nui-repeat",1),e.NdJ("selectionChange",function(s){return i.onSelect(s)}),e.qZA()(),e.YNc(2,H,3,1,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(3);e.xp6(1),e.Q6J("itemsSource",i.widgetItems)("selection",i.widgetSelection)("repeatItemTemplateRef",o)}},dependencies:[l.$N6],styles:[".nui-widget-cloner__item[_ngcontent-%COMP%]{height:60px}"]}),n})();function K(n,a){if(1&n&&(e.TgZ(0,"div",3)(1,"div",4),e._uU(2),e.qZA()()),2&n){const t=a.item;e.xp6(2),e.hij(" ",t.title," ")}}let U=(()=>{class n extends w{constructor(t){super(t)}ngOnInit(){const t=new h.rS;this.widgetItems=T.map(i=>({title:t.transform(i.type),widget:this.widgetTypesService.mergeWithWidgetType(i)}))}}return n.lateLoadKey="AcmeCloneSelectionComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(d.xTe))},n.\u0275cmp=e.Xpm({type:n,selectors:[["acme-clone-selection"]],features:[e.qOj],decls:4,vars:3,consts:[[1,"nui-widget-cloner"],["selectionMode","singleWithRequiredSelection",3,"itemsSource","selection","repeatItemTemplateRef","selectionChange"],["widgetClonerItem",""],[1,"nui-widget-cloner__item","d-flex","pt-2","pb-2","align-items-center"],[1,"text-info","ml-3"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"nui-repeat",1),e.NdJ("selectionChange",function(s){return i.onSelect(s)}),e.qZA()(),e.YNc(2,K,3,1,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(3);e.xp6(1),e.Q6J("itemsSource",i.widgetItems)("selection",i.widgetSelection)("repeatItemTemplateRef",o)}},dependencies:[l.$N6],styles:[".nui-widget-cloner__item[_ngcontent-%COMP%]{height:60px}"]}),n})(),P=(()=>{class n{constructor(t){this.toastService=t,this.allowSubmit=!0,this.allowRemoval=!0,this.trySubmit=(i,o)=>{const s=new f.x;return setTimeout(()=>{if(this.allowSubmit)s.next(i);else{const c=$localize`Submit failed.`;this.toastService.error({title:c}),s.error(c)}},1e3),s.asObservable()},this.tryRemove=i=>{const o=new f.x;return setTimeout(()=>{if(this.allowRemoval)o.next(i);else{const s=$localize`Widget removal failed.`;this.toastService.error({title:s}),o.error(s)}},200),o.asObservable()},this.toastService.setConfig({timeOut:2e3})}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(l.klp))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();var Q=r(34575),k=r(44994);const V=[{path:"",component:(()=>{class n{constructor(t,i,o,s,c){this.providerRegistry=t,this.submitHandler=i,this.widgetTypesService=o,this.widgetClonerService=s,this.refreshSettings=c,this.dashboard={positions:{},widgets:{}},this.gridsterConfig={minCols:12,maxCols:12,minRows:12},this.editMode=!1,this.systemRefreshInterval=60,this.belowFoldLazyLoadingConfig={enabled:!0},this.destroy$=new f.x,this.providerRegistry.setProviders({[m.providerId]:{provide:d.Fk3,useClass:m,deps:[C.eN]}})}ngOnInit(){var t,i;null===(i=null===(t=this.widgetTypesService.getWidgetType("table").configurator)||void 0===t?void 0:t[d.xW5.Structure].presentation.properties)||void 0===i||i.nodes.push("refresher"),this.refreshSettings.refreshRateSeconds=this.systemRefreshInterval;const o=T.map(c=>this.widgetTypesService.mergeWithWidgetType(c)),s=z()(o,c=>c.id);this.dashboard={positions:B,widgets:s}}onDsErrorSwitch(t){m.mockError=t}onShowButtonSwitch(t,i){for(const o of Object.keys(this.dashboard.widgets))this.dashboard=(0,l.zdu)(this.dashboard,`widgets.${o}.pizzagna.configuration.header.properties.${i}`,t)}ngAfterViewInit(){this.dashboardComponent.eventBus.subscribeUntil(d.MOJ,this.destroy$,t=>{this.widgetClonerService.open({widget:this.dashboard.widgets[t.widgetId],dashboardComponent:this.dashboardComponent,trySubmit:this.submitHandler.trySubmit,widgetSelectionComponentType:U}).pipe((0,y.q)(1),(0,O.R)(this.destroy$)).subscribe()})}onCloneWidget(){this.widgetClonerService.open({dashboardComponent:this.dashboardComponent,trySubmit:this.submitHandler.trySubmit,widgetSelectionComponentType:w}).pipe((0,y.q)(1),(0,O.R)(this.destroy$)).subscribe()}onEditWithCloner(){this.dashboardComponent.eventBus.next(d.MOJ,{widgetId:T[0].id})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}onSystemRefreshIntervalClick(){this.refreshSettings.refreshRateSeconds=this.systemRefreshInterval}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(d.CNH),e.Y36(P),e.Y36(d.xTe),e.Y36(d.$Ie),e.Y36(d.g4s))},n.\u0275cmp=e.Xpm({type:n,selectors:[["many-widgets-dashboard-dashboard"]],viewQuery:function(t,i){if(1&t&&e.Gf(d.MXM,7),2&t){let o;e.iGM(o=e.CRH())&&(i.dashboardComponent=o.first)}},features:[e._Bn([P])],decls:25,vars:11,consts:function(){let a,t,i,o,s,c,S,_,p,u;return a=$localize`:␟489801ff09de9b4a6ca8b6e05a475fa1ca00d98e␟5813529530812520031: Create Widget Clone
`,t=$localize`:␟d8e9c9957a5d6ebe7749aab0e18dcb5d944b2ef9␟7916291516675251750: Simulate edit with cloner
`,i=$localize`:␟5cab2718f1d3c09ccb1fca4886710430f59bf7c0␟81810662047948365: Edit mode `,o=$localize`:␟db70aaa4da7a9f7c0fa3a218907f9fa354a19038␟5855643886473775120: Allow Submit `,s=$localize`:␟d289dfdc6c4e23b49a96db083f95f1087ed1400a␟3687117978364204872: Allow Removal `,c=$localize`:␟3299af3b186d7701f4c0626e41eba58af8382723␟4106211393112768148: Show Edit Button `,S=$localize`:␟30251ad3dcd7facd3a222d48fb2ba02f8503c52c␟8096484277280346189: Show Remove Button `,_=$localize`:␟c355f0feb3f72b3594e6e975456cd0a2dac1d929␟870224976565315483: Data Source Error `,p=$localize`:␟90504d9af68fb3aa81accb4bc3005526deb04093␟5488473345097746222:System refresh interval (seconds)`,u=$localize`:␟559db359e3dcc0820499a4e58208fb22273e0d55␟5928813357836950616: Update system refresh interval `,[["type","button","nui-button","",1,"mb-3","ml-4",3,"click"],a,t,[1,"w-100",2,"height","725px"],[3,"nuiWidgetEditor","dashboard","gridsterConfig","editMode","belowFoldLazyLoadingConfig","dashboardChange","gridsterConfigChange"],[1,"my-3","d-flex","align-items-center"],[1,"ml-3",3,"value","valueChange"],i,o,s,c,S,[1,"ml-3",3,"valueChange"],_,[1,"d-flex","flex-row"],[2,"width","300px"],["caption",p],[3,"value","valueChange"],["type","button","nui-button","",1,"ml-4",3,"click"],u]},template:function(t,i){1&t&&(e.TgZ(0,"button",0),e.NdJ("click",function(){return i.onCloneWidget()}),e.SDv(1,1),e.qZA(),e.TgZ(2,"button",0),e.NdJ("click",function(){return i.onEditWithCloner()}),e.SDv(3,2),e.qZA(),e.TgZ(4,"div",3)(5,"nui-dashboard",4),e.NdJ("dashboardChange",function(s){return i.dashboard=s})("gridsterConfigChange",function(s){return i.gridsterConfig=s}),e.qZA()(),e.TgZ(6,"div",5)(7,"nui-switch",6),e.NdJ("valueChange",function(s){return i.editMode=s}),e.SDv(8,7),e.qZA(),e.TgZ(9,"nui-switch",6),e.NdJ("valueChange",function(s){return i.submitHandler.allowSubmit=s}),e.SDv(10,8),e.qZA(),e.TgZ(11,"nui-switch",6),e.NdJ("valueChange",function(s){return i.submitHandler.allowRemoval=s}),e.SDv(12,9),e.qZA(),e.TgZ(13,"nui-switch",6),e.NdJ("valueChange",function(s){return i.onShowButtonSwitch(s,"editable")}),e.SDv(14,10),e.qZA(),e.TgZ(15,"nui-switch",6),e.NdJ("valueChange",function(s){return i.onShowButtonSwitch(s,"removable")}),e.SDv(16,11),e.qZA(),e.TgZ(17,"nui-switch",12),e.NdJ("valueChange",function(s){return i.onDsErrorSwitch(s)}),e.SDv(18,13),e.qZA()(),e.TgZ(19,"div",14)(20,"div",15)(21,"nui-form-field",16)(22,"nui-textbox-number",17),e.NdJ("valueChange",function(s){return i.systemRefreshInterval=s}),e.qZA()()(),e.TgZ(23,"button",18),e.NdJ("click",function(){return i.onSystemRefreshIntervalClick()}),e.SDv(24,19),e.qZA()()),2&t&&(e.xp6(5),e.Q6J("nuiWidgetEditor",i.submitHandler)("dashboard",i.dashboard)("gridsterConfig",i.gridsterConfig)("editMode",i.editMode)("belowFoldLazyLoadingConfig",i.belowFoldLazyLoadingConfig),e.xp6(2),e.Q6J("value",i.editMode),e.xp6(2),e.Q6J("value",i.submitHandler.allowSubmit),e.xp6(2),e.Q6J("value",i.submitHandler.allowRemoval),e.xp6(2),e.Q6J("value",!0),e.xp6(2),e.Q6J("value",!0),e.xp6(7),e.Q6J("value",i.systemRefreshInterval))},dependencies:[Q.M,k.t,l.r0F,l.qUD,l.hgI,l.I5I],styles:[".nui-theme-switcher-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;padding:10px;background-color:var(--nui-color-bg-light,#fff)}"]}),n})(),data:{srlc:{hideIndicator:!0},showThemeSwitcher:!0}}];let q=(()=>{class n{constructor(t,i){this.widgetTypesService=t,this.componentRegistry=i,this.setupDataSourceProviders(),this.setupCustomProportionalWidgetDSConfig()}setupCustomProportionalWidgetDSConfig(){var t;const i=this.widgetTypesService.getWidgetType("proportional",1);null===(t=i.widget.structure[d.XMI].providers)||void 0===t||delete t.refresher,this.widgetTypesService.setNode(i,"configurator",d.ACc.DataSourceConfigComponentType,E.b.lateLoadKey),this.componentRegistry.registerByLateLoadKey(E.b)}setupDataSourceProviders(){this.setDataSourceProviders("table",[W.g.providerId,D.W.providerId,R.t.providerId,Y.n.providerId,$.a.providerId]);const t=this.widgetTypesService.getWidgetType("kpi",1);this.widgetTypesService.setNode(t,"configurator",d.ACc.DataSourceConfigComponentType,d.cY_.lateLoadKey),this.setDataSourceProviders("kpi",[{providerId:m.providerId,label:"Acme KPI Data Source 1"}]),this.setDataSourceProviders("proportional",[v.Q.providerId,v.s.providerId]),this.setDataSourceProviders("timeseries",[N.wi.providerId,N.u2.providerId])}setDataSourceProviders(t,i){const o=this.widgetTypesService.getWidgetType(t,1);this.widgetTypesService.setNode(o,"configurator",d.ACc.DataSourceProviders,i)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(d.xTe),e.LFG(d.hiK))},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[d.CNH],imports:[h.ez,C.JF,d.Pi,l.Gsl,l.Az_,l.vvu,l.cJ5,l.Ts3,l.sF0,l.ZuS,I.Bz.forChild(V),l.C6o,l.YMY]}),n})()}}]);