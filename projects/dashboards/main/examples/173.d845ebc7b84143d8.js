(self.webpackChunkexamples=self.webpackChunkexamples||[]).push([[173],{92120:(oe,W,l)=>{"use strict";l.d(W,{b:()=>d});var s=l(5e3);let d=(()=>{class O{}return O.lateLoadKey="PreviewOverlayComponent",O.\u0275fac=function(R){return new(R||O)},O.\u0275cmp=s.Xpm({type:O,selectors:[["nui-preview-overlay"]],decls:2,vars:0,consts:function(){let e;return e=$localize`:␟5c3a86dc3add2a84bd6fe948cb6fe0c451fcce21␟7864955898524965693: This is a non-interactive widget preview `,[[1,"nui-text-label","content"],e]},template:function(R,N){1&R&&(s.TgZ(0,"div",0),s.SDv(1,1),s.qZA())},styles:["[_nghost-%COMP%]{opacity:0;transition-property:opacity;transition-duration:.5s;position:absolute;z-index:1060;background-color:var(--nui-color-bg-content_popover,#fff);height:100%;width:100%}[_nghost-%COMP%]:hover{opacity:.96}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{padding:10px;display:flex;justify-content:center;align-items:center;position:absolute;top:0;right:2px;bottom:2px;left:2px;cursor:not-allowed}"]}),O})()},34575:(oe,W,l)=>{"use strict";l.d(W,{M:()=>x});var s=l(5e3),d=l(33748),O=l(69754),e=l.n(O),R=l(30652),N=l(53450),A=l(25878);const C={displayGrid:d.KY.None,gridType:d.tQ.VerticalFixed,compactType:d.RU.CompactUp,margin:15,outerMargin:!0,outerMarginTop:null,outerMarginRight:null,outerMarginBottom:null,outerMarginLeft:null,mobileBreakpoint:640,minCols:12,maxCols:12,minRows:12,fixedRowHeight:44,minItemArea:1,defaultItemCols:6,defaultItemRows:6,keepFixedHeightInMobile:!1,keepFixedWidthInMobile:!1,scrollSensitivity:10,scrollSpeed:20,enableEmptyCellClick:!1,enableEmptyCellContextMenu:!1,enableEmptyCellDrop:!1,enableEmptyCellDrag:!1,emptyCellDragMaxCols:50,emptyCellDragMaxRows:50,ignoreMarginInRow:!1,draggable:{enabled:!1,ignoreContent:!0,dragHandleClass:"nui-dashboard__widget--drag-handle"},resizable:{enabled:!1,handles:{s:!0,e:!0,n:!0,w:!0,se:!0,ne:!0,sw:!0,nw:!0}},swap:!1,pushItems:!0,pushResizeItems:!0,disablePushOnDrag:!1,disablePushOnResize:!1,pushDirections:{north:!0,east:!0,south:!0,west:!0},disableWindowResize:!1,disableWarnings:!1,scrollToNewItems:!1};var p=l(69808),v=l(16041),h=l(43046),w=l(92474);function M(y,k){if(1&y){const b=s.EpF();s.TgZ(0,"nui-widget",5),s.NdJ("widgetChange",function(m){return s.CHM(b),s.oxw(2).onWidgetChange(m)}),s.qZA()}if(2&y){const b=s.oxw().$implicit;s.Q6J("widget",b.value),s.uIk("widget-id",b.key)("widget-type",b.value.type)}}function F(y,k){if(1&y&&(s.TgZ(0,"gridster-item",3),s.YNc(1,M,1,3,"nui-widget",4),s.qZA()),2&y){const b=k.$implicit,T=s.oxw(),m=s.MAs(4);s.Q6J("item",T.dashboard.positions[b.key])("nuiGridsterItemWidgetId",b.key),s.xp6(1),s.Q6J("ngIf",T.shouldWidgetRender(b.key))("ngIfElse",m)}}function G(y,k){1&y&&(s.TgZ(0,"div",6),s._UZ(1,"nui-loading",7),s.qZA()),2&y&&(s.xp6(1),s.Q6J("active",!0))}let x=(()=>{class y{constructor(b){this.eventBus=b,this.editMode=!1,this.gridsterConfigChange=new s.vpe,this.dashboardChange=new s.vpe,this.gridsterItemsVisibilityMap={},this.orderWidgets=(T,m)=>{const L=this.dashboard.positions[T.key],z=this.dashboard.positions[m.key];return L.y-z.y||L.x-z.x},this.trackByFn=(T,m)=>m.key,this.updateWidgetPosition=(T,m)=>{const L=String(m.widgetId),z=(0,R.zdu)(this.dashboard,"positions."+L,T);this.dashboardChange.emit(z),this.eventBus.getStream(N.Xi).next({widgetId:L,payload:T})},this.emitWidgetResize=(T,m)=>{const L=m.widgetId;this.eventBus.getStream(N.pV).next({widgetId:L,payload:{widgetId:L,height:m.height,width:m.width}})}}get dashboard(){return this.dashboardBuffer||this._dashboard}set dashboard(b){this._dashboard=b,this.dashboardBuffer=null}get hostClass(){return!0}ngAfterViewInit(){setTimeout(()=>this.calculateWidgetsVisibility())}onGridsterScroll(){this.calculateWidgetsVisibility()}ngOnChanges(b){var T,m,L;if(b.gridsterConfig){if(b.gridsterConfig.isFirstChange()){const z=e()(this.gridsterConfig||{},C);this.hookEvent(z,"itemChangeCallback",this.updateWidgetPosition),this.hookEvent(z,"itemResizeCallback",this.emitWidgetResize),this.gridsterConfigChange.emit(z)}(null===(T=this.gridsterConfig)||void 0===T?void 0:T.api)&&(null===(L=(m=this.gridsterConfig.api).optionsChanged)||void 0===L||L.call(m))}if(b.editMode){if(!this.gridsterConfig.resizable)throw new Error("Gridster's resizable prop is undefined");if(this.gridsterConfig.resizable.enabled=this.editMode,!this.gridsterConfig.draggable)throw new Error("Gridster's draggable prop is undefined");this.gridsterConfig.draggable.enabled=this.editMode,this.gridsterConfigChange.emit(Object.assign({},this.gridsterConfig)),this.eventBus.getStream(N.N9).next({payload:this.editMode})}}onWidgetChange(b){!this.dashboard.widgets[b.id]||this.updateWidget(b)}updateWidget(b){var T,m,L,z,X;let q=this.dashboard;if(!this.dashboard.positions[b.id]&&(null===(T=this.gridsterConfig)||void 0===T?void 0:T.api)){const re=null===(L=(m=this.gridsterConfig.api).getFirstPossiblePosition)||void 0===L?void 0:L.call(m,{x:0,y:0,rows:null===(z=this.gridsterConfig)||void 0===z?void 0:z.defaultItemRows,cols:null===(X=this.gridsterConfig)||void 0===X?void 0:X.defaultItemCols});q=(0,R.zdu)(q,`positions.${b.id}`,re)}q=(0,R.zdu)(q,`widgets.${b.id}`,b),this.dashboardBuffer=q,this.dashboardChange.emit(q)}removeWidget(b,T=!0){let m=this.dashboard;if(!m.widgets[b])return;const L=Object.assign({},m.widgets);if(delete L[b],m=(0,R.zdu)(m,"widgets",L),T){const z=Object.assign({},m.positions);delete z[b],m=(0,R.zdu)(m,"positions",z)}this.dashboardChange.emit(m)}shouldWidgetRender(b){var T;return!(null===(T=this.belowFoldLazyLoadingConfig)||void 0===T?void 0:T.enabled)||this.gridsterItemsVisibilityMap[b]}hookEvent(b,T,m){const L=b[T];b[T]=(z,X)=>{m(z,X),L&&L(z,X)}}calculateWidgetsVisibility(){var b;if(!(null===(b=this.belowFoldLazyLoadingConfig)||void 0===b?void 0:b.enabled))return;const T=this.gridster.el.getBoundingClientRect();this.gridsterItemsVisibilityMap=this.gridsterItems.reduce((m,L)=>{var z;const{el:X}=L,q=L.widgetId;if(!(null===(z=this.belowFoldLazyLoadingConfig.configuration)||void 0===z?void 0:z.reloadWidgetsOnScroll)&&m[q])return m;const re=X.getBoundingClientRect();return m[q]=(re.top>T.top&&re.top<T.bottom||re.bottom>T.top&&re.bottom<T.bottom)&&(re.left>T.left&&re.left<T.right||re.right>T.left&&re.right<T.right),m},this.gridsterItemsVisibilityMap)}}return y.\u0275fac=function(b){return new(b||y)(s.Y36(A.Bc))},y.\u0275cmp=s.Xpm({type:y,selectors:[["nui-dashboard"]],viewQuery:function(b,T){if(1&b&&(s.Gf(d.sm,5),s.Gf(d.IM,5)),2&b){let m;s.iGM(m=s.CRH())&&(T.gridster=m.first),s.iGM(m=s.CRH())&&(T.gridsterItems=m)}},hostVars:2,hostBindings:function(b,T){2&b&&s.ekj("nui-dashboard",T.hostClass)},inputs:{gridsterConfig:"gridsterConfig",dashboard:"dashboard",editMode:"editMode",belowFoldLazyLoadingConfig:"belowFoldLazyLoadingConfig"},outputs:{gridsterConfigChange:"gridsterConfigChange",dashboardChange:"dashboardChange"},features:[s._Bn([{provide:A.Bc,useClass:R.Ndp}]),s.TTD],decls:5,vars:6,consts:[[1,"nui-dashboard__gridster",3,"options","scroll"],["class","nui-dashboard__gridster-item",3,"item","nuiGridsterItemWidgetId",4,"ngFor","ngForOf","ngForTrackBy"],["emptyWidgetTpl",""],[1,"nui-dashboard__gridster-item",3,"item","nuiGridsterItemWidgetId"],["class","w-100 h-100 d-block",3,"widget","widgetChange",4,"ngIf","ngIfElse"],[1,"w-100","h-100","d-block",3,"widget","widgetChange"],[1,"w-100","h-100","d-block"],[3,"active"]],template:function(b,T){1&b&&(s.TgZ(0,"gridster",0),s.NdJ("scroll",function(){return T.onGridsterScroll()}),s.YNc(1,F,2,4,"gridster-item",1),s.ALo(2,"keyvalue"),s.qZA(),s.YNc(3,G,2,1,"ng-template",null,2,s.W1O)),2&b&&(s.Q6J("options",T.gridsterConfig),s.xp6(1),s.Q6J("ngForOf",s.xi3(2,3,T.dashboard.widgets,T.orderWidgets))("ngForTrackBy",T.trackByFn))},directives:[d.sm,p.sg,d.IM,v.K,p.O5,h.B,w.N],pipes:[p.Nd],styles:['.nui-dashboard__gridster{background-color:var(--nui-color-bg-workspace,#f0f0f0)}.nui-dashboard__gridster .gridster-preview{border-width:4px;border-style:solid;border-color:var(--nui-color-selected-contrast,#00c4d2);background-color:var(--nui-color-selected,rgba(0, 196, 210, .1))}.nui-dashboard__gridster .gridster-preview:before{background-color:var(--nui-color-selected-contrast,#00c4d2);border-radius:50%;content:"";display:block;height:40px;left:50%;position:absolute;top:50%;transform:translate(-50%,-50%);width:40px;z-index:1}.nui-dashboard__gridster .gridster-preview:after{color:var(--nui-color-icon-light,#fff);content:"+";display:block;font-size:19px;font-weight:700;left:50%;position:absolute;top:50%;transform:translate(-50%,-50%);z-index:2}.nui-dashboard__gridster-item{box-shadow:0 0 5px #999;box-shadow:0 0 var(--nui-space-xs, 5px) var(--nui-color-line-dark, #999999);background-color:var(--nui-color-bg-light,#fff)}.nui-dashboard__gridster-item:hover .gridster-item-resizable-handler{border-bottom-color:#00c4d2;border-bottom-color:var(--nui-color-selected-contrast,#00c4d2);margin:0;z-index:2000}.nui-dashboard__gridster-item:hover .gridster-item-resizable-handler.handle-se{border-bottom-color:var(--nui-color-selected-contrast,#00c4d2);right:2px;bottom:2px}.mobile .nui-dashboard__gridster-item.nui-dashboard__gridster-item{height:auto!important}\n'],encapsulation:2}),y})()},92474:(oe,W,l)=>{"use strict";l.d(W,{N:()=>e});var s=l(41777),d=l(5e3),O=l(30652);let e=(()=>{class R{constructor(A){this.changeDetector=A,this.active=!1}}return R.lateLoadKey="LoadingComponent",R.\u0275fac=function(A){return new(A||R)(d.Y36(d.sBO))},R.\u0275cmp=d.Xpm({type:R,selectors:[["nui-loading"]],inputs:{active:"active"},decls:1,vars:2,consts:[["compactMode","true",3,"show"]],template:function(A,C){1&A&&(d.TgZ(0,"nui-progress",0),d.NdJ("@animate.start",function(v){return v.element.style.display="block"})("@animate.done",function(v){return v.element.style.display=v.toState?"block":"none"}),d.qZA()),2&A&&d.Q6J("@animate",C.active)("show",!0)},directives:[O.t15],styles:["[_nghost-%COMP%]{height:5px;flex-shrink:0}"],data:{animation:[(0,s.X$)("animate",[(0,s.SB)("true",(0,s.oB)({opacity:1})),(0,s.SB)("false",(0,s.oB)({opacity:0})),(0,s.eR)("false <=> true",(0,s.jt)(500))])]}}),R})()},26365:(oe,W,l)=>{"use strict";l.d(W,{i:()=>v});var s=l(34235),d=l.n(s),O=l(77579),e=l(82722),R=l(81466),N=l(42339),A=l(53450),C=l(25878),p=l(5e3);let v=(()=>{class h{constructor(M,F,G){this.eventBus=M,this.dataSource=F,this.pizzagnaService=G,this.destroy$=new O.x,this.dataSource&&(this.setupRefreshListener(),this.dataSource.outputsSubject.pipe((0,e.R)(this.destroy$)).subscribe(x=>this.handleDataSourceUpdate(x)),this.dataSource.busy&&this.dataSource.busy.pipe((0,e.R)(this.destroy$)).subscribe(x=>{this.eventBus.getStream(A.QD).next({payload:{componentId:this.componentId,busy:x}})}))}setupRefreshListener(){this.eventBus.getStream(A.RG).pipe((0,e.R)(this.destroy$)).subscribe(()=>this.handleRefresh())}handleRefresh(){this.eventBus.getStream(A.R1).next({}),this.dataSource.applyFilters()}handleDataSourceUpdate(M){this.lastValue=d()(null==M?void 0:M.result)?M:null==M?void 0:M.result,this.updateOutput(this.lastValue),this.eventBus.getStream(R.PF).next({payload:Object.assign({componentId:this.componentId},M)})}ngOnDestroy(){this.updateOutput(void 0);const M={payload:{componentId:this.componentId}};this.eventBus.getStream(R.yX).next(M);const F={payload:{componentId:this.componentId,busy:!1}};this.eventBus.getStream(A.QD).next(F),this.destroy$.next(),this.destroy$.complete()}updateConfiguration(M){M.componentId&&(this.componentId=M.componentId),this.updateAdapterProperties(M),this.updateDataSourceProperties(M),void 0!==this.lastValue&&this.updateOutput(this.lastValue)}updateAdapterProperties(M){this.propertyPath=M.propertyPath}updateDataSourceProperties(M){var F,G;const x=null===(F=null==M?void 0:M.dataSource)||void 0===F?void 0:F.properties;if(this.dataSourceConfiguration!==x){this.dataSourceConfiguration=x;const y=this.dataSource;(null==y?void 0:y.updateConfiguration)&&y.updateConfiguration(null===(G=M.dataSource)||void 0===G?void 0:G.properties),this.eventBus.getStream(A.RG).next({})}void 0===this.dataSourceConfiguration&&void 0===x&&setTimeout(()=>this.eventBus.getStream(A.RG).next({}))}updateOutput(M){this.pizzagnaService.setProperty({pizzagnaKey:C.xW.Data,componentId:this.componentId,propertyPath:[this.propertyPath]},this.processOutput(M))}processOutput(M){return M}}return h.\u0275fac=function(M){return new(M||h)(p.LFG(C.nY),p.LFG(C.Fk,8),p.LFG(N.p))},h.\u0275prov=p.Yz7({token:h,factory:h.\u0275fac}),h})()},50271:(oe,W,l)=>{"use strict";l.d(W,{I:()=>e});var s=l(53450),d=l(25878),O=l(5e3);let e=(()=>{class R{constructor(A){this.eventBus=A,this.initializeSubscriptions()}updateConfiguration(A){this.properties=A}initializeSubscriptions(){this.eventBus.getStream(s.b1).subscribe(A=>{var C,p,v;(!(null===(C=this.properties)||void 0===C?void 0:C.interactionType)||(null===(p=this.properties)||void 0===p?void 0:p.interactionType)===(null===(v=A.payload)||void 0===v?void 0:v.interactionType))&&this.handleInteraction(A.payload)})}}return R.\u0275fac=function(A){return new(A||R)(O.LFG(d.nY))},R.\u0275prov=O.Yz7({token:R,factory:R.\u0275fac}),R})()},38046:(oe,W,l)=>{"use strict";l.d(W,{O:()=>A});var s=l(25878),d=l(50271),O=l(5e3),e=l(30652),R=l(99567);Window;let A=(()=>{class C extends d.I{constructor(v,h,w,M){super(v),this.window=h,this.logger=w,this.urlInteractionService=M}handleInteraction(v){var h;if(!(null===(h=this.properties)||void 0===h?void 0:h.url))return void this.logger.warn("The target url has not been defined.");const w=this.urlInteractionService.template(this.properties.url,{data:v.data});!w||(this.properties.newWindow?this.window.open(w):this.window.location.href=w)}}return C.\u0275fac=function(v){return new(v||C)(O.LFG(s.nY),O.LFG("windowObject"),O.LFG(e.mQy),O.LFG(R.v))},C.\u0275prov=O.Yz7({token:C,factory:C.\u0275fac}),C})()},61455:(oe,W,l)=>{"use strict";l.d(W,{g:()=>e});var s=l(61135),d=l(92221),O=l(5e3);let e=(()=>{class R{constructor(){this._refreshRateSeconds=d.Q,this.refreshRateSeconds$=new s.X(this.refreshRateSeconds)}get refreshRateSeconds(){return this._refreshRateSeconds}set refreshRateSeconds(A){this._refreshRateSeconds=A,this.refreshRateSeconds$.next(this._refreshRateSeconds)}}return R.\u0275fac=function(A){return new(A||R)},R.\u0275prov=O.Yz7({token:R,factory:R.\u0275fac,providedIn:"root"}),R})()},97674:(oe,W,l)=>{"use strict";l.d(W,{q:()=>C});var s=l(77579),d=l(82722),O=l(53450),e=l(25878),R=l(92221),N=l(5e3),A=l(61455);let C=(()=>{class p{constructor(h,w,M){this.eventBus=h,this.ngZone=w,this.refresherSettings=M,this.enabled=!0,this.overrideDefaultSettings=!0,this.interval=R.Q,this.eventDef=O.RG,this.destroy$=new s.x,this.refresherSettings.refreshRateSeconds$.pipe((0,d.R)(this.destroy$)).subscribe(F=>{this.overrideDefaultSettings||this.initializeInterval()})}updateConfiguration(h){var w,M,F,G;this.interval=null!==(w=h.interval)&&void 0!==w?w:R.Q,this.enabled=null===(M=h.enabled)||void 0===M||M,this.overrideDefaultSettings=null===(F=h.overrideDefaultSettings)||void 0===F||F,this.eventDef=null!==(G=h.event)&&void 0!==G?G:O.RG,this.initializeInterval()}ngOnDestroy(){this.clearInterval(),this.destroy$.next(),this.destroy$.complete()}initializeInterval(){this.clearInterval(),!(void 0===this.interval||this.getInterval()<=0||!1===this.enabled)&&this.ngZone.runOutsideAngular(()=>{this.intervalRef=setInterval(()=>{this.ngZone.run(()=>{this.performAction()})},1e3*this.getInterval())})}performAction(){this.eventBus.getStream(this.eventDef).next({})}getInterval(){return this.overrideDefaultSettings?this.interval:this.refresherSettings.refreshRateSeconds}clearInterval(){void 0!==this.intervalRef&&(clearInterval(this.intervalRef),this.intervalRef=void 0)}}return p.\u0275fac=function(h){return new(h||p)(N.LFG(e.nY),N.LFG(N.R0b),N.LFG(A.g))},p.\u0275prov=N.Yz7({token:p,factory:p.\u0275fac}),p})()},42296:(oe,W,l)=>{"use strict";l.d(W,{Y:()=>q});var s=l(5e3),d=l(68306),O=l(38421);const{isArray:e}=Array;var N=l(60515),A=l(25403),C=l(63269);var v=l(56451),h=l(63900),w=l(68675),M=l(18505),F=l(54004),G=l(78372),x=l(82722),y=l(30652),k=l(42339),b=l(53450),T=l(25878),m=l(26365),X=function(re,de){return function(pe,te){de(pe,te,re)}};let q=class extends m.i{constructor(de,pe,te,ae){super(de,pe,te),this.virtualViewport=ae}setupRefreshListener(){const de=function p(...re){const de=(0,C.jO)(re),pe=function R(re){return 1===re.length&&e(re[0])?re[0]:re}(re);return pe.length?new d.y(te=>{let ae=pe.map(()=>[]),Y=pe.map(()=>!1);te.add(()=>{ae=Y=null});for(let j=0;!te.closed&&j<pe.length;j++)(0,O.Xf)(pe[j]).subscribe((0,A.x)(te,ce=>{if(ae[j].push(ce),ae.every(ie=>ie.length)){const ie=ae.map(Te=>Te.shift());te.next(de?de(...ie):ie),ae.some((Te,Ee)=>!Te.length&&Y[Ee])&&te.complete()}},()=>{Y[j]=!0,!ae[j].length&&te.complete()}));return()=>{ae=Y=null}}):N.E}(this.eventBus.getStream(b.j7),this.eventBus.getStream(b.RG)).pipe((0,h.w)(()=>this.eventBus.getStream(b.RG).pipe((0,w.O)(void 0))),(0,M.b)(()=>this.virtualViewport.reset({emitFirstPage:!1})),(0,F.U)(()=>{}));(0,v.T)(de,this.eventBus.getStream(b.df)).pipe((0,G.b)(10),(0,M.b)(()=>this.handleRefresh()),(0,x.R)(this.destroy$)).subscribe()}updateAdapterProperties(de){this.dataPath=de.dataPath,this.dataFieldsPath=de.dataFieldsPath,this.totalItemsPath=de.totalItemsPath}updateOutput(de){var pe,te;const ae=null===(pe=null==de?void 0:de.paginator)||void 0===pe?void 0:pe.total,Y=null===(te=null==de?void 0:de.repeat)||void 0===te?void 0:te.itemsSource,j=null==de?void 0:de.dataFields;this.pizzagnaService.setProperty({pizzagnaKey:T.xW.Data,componentId:this.componentId,propertyPath:[this.totalItemsPath]},ae),this.pizzagnaService.setProperty({pizzagnaKey:T.xW.Data,componentId:this.componentId,propertyPath:[this.dataPath]},Y),this.pizzagnaService.setProperty({pizzagnaKey:T.xW.Data,componentId:this.componentId,propertyPath:[this.dataFieldsPath]},j)}};q=function(re,de,pe,te){var j,ae=arguments.length,Y=ae<3?de:null===te?te=Object.getOwnPropertyDescriptor(de,pe):te;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)Y=Reflect.decorate(re,de,pe,te);else for(var ce=re.length-1;ce>=0;ce--)(j=re[ce])&&(Y=(ae<3?j(Y):ae>3?j(de,pe,Y):j(de,pe))||Y);return ae>3&&Y&&Object.defineProperty(de,pe,Y),Y}([X(0,(0,s.tBr)(T.nY)),X(1,(0,s.tBr)(T.Fk)),X(3,(0,s.FiY)()),function(re,de){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:paramtypes",de)}(0,[y.Ndp,Object,k.p,y.zCP])],q)},10948:(oe,W,l)=>{"use strict";l.d(W,{f:()=>h});var s=l(5e3),d=l(11094),O=l.n(d),e=l(30652),R=l(42339),N=l(25878),A=l(26365),v=function(w,M){return function(F,G){M(F,G,w)}};let h=class extends A.i{constructor(M,F,G){super(M,F,G),this.seriesIndex=[]}updateConfiguration(M){this.seriesIndex=O()(M.series),super.updateConfiguration(M)}processOutput(M){return M&&Object.assign(Object.assign({},M),{series:this.buildSeriesSet(null==M?void 0:M.series)})}buildSeriesSet(M){return M?M.filter(F=>this.seriesIndex.find(G=>G.selectedSeriesId===F.id)).map(F=>{var G;return{id:F.id,data:F.data,link:F.link,secondaryLink:F.secondaryLink,legendDescriptionPrimary:null===(G=this.seriesIndex.find(x=>x.selectedSeriesId===F.id))||void 0===G?void 0:G.label,legendDescriptionSecondary:F.description}}):[]}};h=function(w,M,F,G){var k,x=arguments.length,y=x<3?M:null===G?G=Object.getOwnPropertyDescriptor(M,F):G;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)y=Reflect.decorate(w,M,F,G);else for(var b=w.length-1;b>=0;b--)(k=w[b])&&(y=(x<3?k(y):x>3?k(M,F,y):k(M,F))||y);return x>3&&y&&Object.defineProperty(M,F,y),y}([v(0,(0,s.tBr)(N.nY)),v(1,(0,s.tBr)(N.Fk)),function(w,M){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:paramtypes",M)}(0,[e.Ndp,Object,R.p])],h)},92221:(oe,W,l)=>{"use strict";l.d(W,{Q:()=>s});const s=300},69769:(oe,W,l)=>{"use strict";l.d(W,{q:()=>d});var s=l(5e3);let d=(()=>{class O{}return O.lateLoadKey="TemplateLoadErrorComponent",O.\u0275fac=function(R){return new(R||O)},O.\u0275cmp=s.Xpm({type:O,selectors:[["ng-component"]],decls:3,vars:0,template:function(R,N){1&R&&(s.TgZ(0,"code")(1,"pre"),s._uU(2,"Template load error!"),s.qZA()())},encapsulation:2}),O})()},43046:(oe,W,l)=>{"use strict";l.d(W,{B:()=>N});var s=l(5e3),d=l(53450),O=l(63776),e=l(32656),R=l(87686);let N=(()=>{class A{constructor(p,v){this.widgetConfigurationService=p,this.widgetTypesService=v,this.widgetChange=new s.vpe,this.rootNode=d.XM}ngOnChanges(p){var v,h;if(p.widget){const w=this.widget.type;if((p.widget.previousValue&&p.widget.previousValue.type)!==w){const F=this.widgetTypesService.getWidgetType(w,this.widget.version);this.rootNode=(null===(h=null===(v=null==F?void 0:F.paths)||void 0===v?void 0:v.widget)||void 0===h?void 0:h.root)||d.XM}this.widgetConfigurationService.updateWidget(this.widget)}}onPizzagnaChange(p){this.widgetChange.emit(Object.assign(Object.assign({},this.widget),{pizzagna:p}))}}return A.\u0275fac=function(p){return new(p||A)(s.Y36(O.I),s.Y36(e.x))},A.\u0275cmp=s.Xpm({type:A,selectors:[["nui-widget"]],hostAttrs:[1,"nui-widget"],inputs:{widget:"widget"},outputs:{widgetChange:"widgetChange"},features:[s._Bn([O.I]),s.TTD],decls:1,vars:2,consts:[[3,"rootNode","pizzagna","pizzagnaChange"]],template:function(p,v){1&p&&(s.TgZ(0,"nui-pizzagna",0),s.NdJ("pizzagnaChange",function(w){return v.onPizzagnaChange(w)}),s.qZA()),2&p&&s.Q6J("rootNode",v.rootNode)("pizzagna",v.widget.pizzagna)},directives:[R.R],styles:[""]}),A})()},69155:(oe,W,l)=>{"use strict";l.d(W,{n:()=>M});var s=l(5e3),d=l(77579),O=l(30652),e=l(87686),R=l(32656),N=l(45122),A=l(92120),C=l(69808),p=l(47429),v=l(73193);const h=["previewPizzagnaComponent"];function w(F,G){if(1&F){const x=s.EpF();s.TgZ(0,"nui-pizzagna",8,9),s.NdJ("pizzagnaChange",function(k){return s.CHM(x),s.oxw().onPizzagnaChange(k)}),s.ALo(2,"nuiPizzagnaRoot"),s.qZA()}if(2&F){const x=s.oxw();s.Q6J("rootNode",s.xi3(2,2,x.previewWidget,"widget"))("pizzagna",null==x.previewWidget?null:x.previewWidget.pizzagna)}}let M=(()=>{class F{constructor(x,y){this.widgetTypesService=x,this.changeDetector=y,this.result=new s.vpe,this.formPortalAttached=new s.vpe,this.submitError=new d.x,this.destroy$=new d.x}ngOnInit(){this.previewWidget||(this.previewWidget={id:null,type:"previewPlaceholder",pizzagna:this.widgetTypesService.getWidgetType("previewPlaceholder").widget})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}handleSubmitError(){this.submitError.next()}onFormPortalAttached(x){this.formPortalAttached.emit(x)}updateWidget(x){this.previewWidget=x,this.changeDetector.markForCheck()}formCancel(){this.result.next(null)}formSubmit(){this.result.next(this.previewWidget)}onPizzagnaChange(x){this.previewWidget&&(this.previewWidget.pizzagna=x)}}return F.lateLoadKey="ConfiguratorComponent",F.\u0275fac=function(x){return new(x||F)(s.Y36(R.x),s.Y36(s.sBO))},F.\u0275cmp=s.Xpm({type:F,selectors:[["nui-configurator"]],viewQuery:function(x,y){if(1&x&&s.Gf(h,7),2&x){let k;s.iGM(k=s.CRH())&&(y.previewPizzagnaComponent=k.first)}},hostAttrs:[1,"nui-configurator"],inputs:{formPortal:"formPortal",previewWidget:"previewWidget"},outputs:{result:"result",formPortalAttached:"formPortalAttached"},features:[s._Bn([N.m,{provide:O.nse,useValue:".nui-dashwiz-step--active .configurator-scrollable"}])],decls:9,vars:4,consts:[[1,"nui-configurator__backdrop"],[1,"nui-configurator__content"],["orientation","right","paneSize","30vw","paneMinSize","20vw","paneMaxSize","80vw","isResizable","true",1,"h-100",3,"headerPadding","sidePaneBodyPadding"],[1,"nui-configurator__preview","d-flex","align-items-center","justify-content-center"],[1,"nui-configurator__preview-area"],["class","flex-grow-1 w-100",3,"rootNode","pizzagna","pizzagnaChange",4,"ngIf"],["nuiPanelEmbeddedBody","",1,"nui-configurator__body"],[3,"cdkPortalOutlet","attached"],[1,"flex-grow-1","w-100",3,"rootNode","pizzagna","pizzagnaChange"],["previewPizzagnaComponent",""]],template:function(x,y){1&x&&(s._UZ(0,"div",0),s.TgZ(1,"div",1)(2,"nui-panel",2)(3,"div",3)(4,"div",4),s._UZ(5,"nui-preview-overlay"),s.YNc(6,w,3,5,"nui-pizzagna",5),s.qZA()(),s.TgZ(7,"div",6),s.ynx(8,7),s.NdJ("attached",function(b){return y.onFormPortalAttached(b)}),s.BQk(),s.qZA()()()),2&x&&(s.xp6(2),s.Q6J("headerPadding",!1)("sidePaneBodyPadding",!1),s.xp6(4),s.Q6J("ngIf",null==y.previewWidget?null:y.previewWidget.pizzagna),s.xp6(2),s.Q6J("cdkPortalOutlet",y.formPortal))},directives:[O.yXm,A.b,C.O5,e.R,p.Pl],pipes:[v.l],styles:[".nui-configurator__backdrop[_ngcontent-%COMP%]{position:fixed;top:0;right:0;bottom:0;left:0;z-index:1040;background-color:var(--nui-color-overlay-modal,rgba(17, 17, 17, .5));opacity:.5;filter:alpha(opacity=50)}.nui-configurator__content[_ngcontent-%COMP%]{position:fixed;top:0;right:0;bottom:0;left:0;z-index:1040}.nui-configurator__heading[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-between;align-items:center;padding:15px;border-bottom:1px solid #d9d9d9}.nui-configurator__body[_ngcontent-%COMP%]{overflow-anchor:none;height:100vh}.nui-configurator__preview[_ngcontent-%COMP%]{height:100vh}.nui-configurator__preview-area[_ngcontent-%COMP%]{display:flex;width:80%;position:relative;background-color:var(--nui-color-bg-content_popover,#fff);border:1px solid;border-color:var(--nui-color-line-default,#d9d9d9);margin:auto;min-height:40vh;max-height:80vh;overflow:hidden}"]}),F})()},16134:(oe,W,l)=>{"use strict";l.d(W,{C:()=>A});var s=l(5e3),d=l(30652),O=l(69808);function e(C,p){if(1&C&&s._UZ(0,"nui-icon",4),2&C){const v=s.oxw(2);s.Q6J("icon",null==v.data?null:v.data.value)}}function R(C,p){if(1&C&&(s.TgZ(0,"div",2),s.YNc(1,e,1,1,"nui-icon",3),s.qZA()),2&C){const v=s.oxw(),h=s.MAs(2);s.xp6(1),s.Q6J("ngIf",v.iconFound)("ngIfElse",h)}}function N(C,p){1&C&&s._UZ(0,"nui-icon",5)}let A=(()=>{class C{constructor(v,h){this.changeDetector=v,this.iconService=h,this.isValid=!1,this.iconFound=!0}ngOnChanges(){var v,h;this.isValid=!!(null===(v=this.data)||void 0===v?void 0:v.value),this.iconFound=!!this.iconService.getIconData(null===(h=this.data)||void 0===h?void 0:h.value)}}return C.lateLoadKey="IconFormatterComponent",C.\u0275fac=function(v){return new(v||C)(s.Y36(s.sBO),s.Y36(d.C6t))},C.\u0275cmp=s.Xpm({type:C,selectors:[["ng-component"]],inputs:{data:"data"},features:[s.TTD],decls:3,vars:1,consts:function(){let p;return p=$localize`:␟8cf3dbb8fe1e2fa079d4c2167cd4c81cdcfe89c2␟7731831112083433420:Unknown icon`,[["class","d-flex align-items-center justify-content-center",4,"ngIf"],["iconNotFound",""],[1,"d-flex","align-items-center","justify-content-center"],[3,"icon",4,"ngIf","ngIfElse"],[3,"icon"],["title",p,"iconColor","disabled-gray","icon","help"]]},template:function(v,h){1&v&&(s.YNc(0,R,2,2,"div",0),s.YNc(1,N,1,0,"ng-template",null,1,s.W1O)),2&v&&s.Q6J("ngIf",h.isValid)},directives:[O.O5,d.oJW],encapsulation:2}),C})()},61621:(oe,W,l)=>{"use strict";l.d(W,{s:()=>e});var s=l(5e3),d=l(69808);function O(R,N){if(1&R&&(s.TgZ(0,"a",2),s._uU(1),s.qZA()),2&R){const A=s.oxw();s.Q6J("href",null==A.data?null:A.data.link,s.LSH)("target",A.targetSelf?"_self":"_blank"),s.xp6(1),s.hij(" ",null==A.data?null:A.data.value," ")}}let e=(()=>{class R{constructor(A){this.changeDetector=A,this.isValid=!1}ngOnChanges(A){this.isValid=Boolean(this.data&&this.data.value&&this.data.link)}}return R.lateLoadKey="LinkFormatterComponent",R.\u0275fac=function(A){return new(A||R)(s.Y36(s.sBO))},R.\u0275cmp=s.Xpm({type:R,selectors:[["ng-component"]],inputs:{data:"data",targetSelf:"targetSelf"},features:[s.TTD],decls:2,vars:1,consts:[[1,"link-formatter-container"],["class","nui-text-ellipsis",3,"href","target",4,"ngIf"],[1,"nui-text-ellipsis",3,"href","target"]],template:function(A,C){1&A&&(s.TgZ(0,"div",0),s.YNc(1,O,2,3,"a",1),s.qZA()),2&A&&(s.xp6(1),s.Q6J("ngIf",C.isValid))},directives:[d.O5],styles:[".link-formatter-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr}"]}),R})()},14366:(oe,W,l)=>{"use strict";l.d(W,{a:()=>d});var s=l(5e3);let d=(()=>{class O{constructor(R){this.changeDetector=R}}return O.lateLoadKey="RawFormatterComponent",O.\u0275fac=function(R){return new(R||O)(s.Y36(s.sBO))},O.\u0275cmp=s.Xpm({type:O,selectors:[["ng-component"]],hostVars:2,hostBindings:function(R,N){2&R&&s.Tol(N.elementClass)},inputs:{data:"data",elementClass:"elementClass"},decls:2,vars:1,template:function(R,N){1&R&&(s.ynx(0),s._uU(1),s.BQk()),2&R&&(s.xp6(1),s.Oqu(null==N.data?null:N.data.value))},encapsulation:2}),O})()},85822:(oe,W,l)=>{"use strict";l.d(W,{Q:()=>e});var s=l(5e3),d=l(32148),O=l(30652);let e=(()=>{class R{constructor(A,C){this.el=A,this.heading=C,this.disableCloseButton=!1,this.close=new s.vpe}ngOnChanges(){this.heading.height$.next(+getComputedStyle(this.el.nativeElement).height.slice(0,-2))}}return R.\u0275fac=function(A){return new(A||R)(s.Y36(s.SBq),s.Y36(d.p))},R.\u0275cmp=s.Xpm({type:R,selectors:[["nui-configurator-heading"]],inputs:{configuratorTitle:"configuratorTitle",disableCloseButton:"disableCloseButton"},outputs:{close:"close"},features:[s.TTD],decls:4,vars:3,consts:[[1,"configurator-heading","d-flex","justify-content-between","align-items-center","p-4"],[1,"nui-text-panel","nui-text-ellipsis",3,"title"],["nui-button","","type","button","displayStyle","action","icon","close",3,"disabled","click"]],template:function(A,C){1&A&&(s.TgZ(0,"div",0)(1,"span",1),s._uU(2),s.qZA(),s.TgZ(3,"button",2),s.NdJ("click",function(){return C.close.emit()}),s.qZA()()),2&A&&(s.xp6(1),s.Q6J("title",C.configuratorTitle),s.xp6(1),s.hij(" ",C.configuratorTitle," "),s.xp6(1),s.Q6J("disabled",C.disableCloseButton))},directives:[O.r0F],styles:["[_nghost-%COMP%]{z-index:1080;background-color:var(--nui-color-bg-content,#fff)}[_nghost-%COMP%]   .configurator-heading[_ngcontent-%COMP%]{border-bottom:1px solid;border-bottom-color:var(--nui-color-line-default,#d9d9d9)}"]}),R})()},71536:(oe,W,l)=>{"use strict";l.d(W,{e:()=>O});var s=l(95698),d=l(5e3);let O=(()=>{class e{constructor(){this.accordions=[]}registerAccordion(N){this.accordions.push({instance:N,openSubscription:N.openSubject.subscribe(()=>{this.closeAllAccordions(),N.open=!0}),destroySubscription:N.destroySubject.pipe((0,s.q)(1)).subscribe(()=>{this.removeAccordion(N)})})}closeAllAccordions(){this.accordions.forEach(N=>{N.instance.closeAccordion()})}removeAccordion(N){const A=this.accordions.findIndex(C=>C.instance===N);this.accordions[A].openSubscription.unsubscribe(),this.accordions.splice(A,1)}}return e.\u0275fac=function(N){return new(N||e)},e.\u0275prov=d.Yz7({token:e,factory:e.\u0275fac}),e})()},19837:(oe,W,l)=>{"use strict";l.d(W,{J:()=>v});var s=l(77579),d=l(25878),O=l(5e3),e=l(71536),R=l(30652),N=l(69808);function A(h,w){if(1&h&&O._UZ(0,"nui-icon",4),2&h){const M=O.oxw();O.Q6J("icon",M.open?"triangle-down":"triangle-left")}}const C=[[["","accordionHeader",""]],"*"],p=["[accordionHeader]","*"];let v=(()=>{class h{constructor(M,F){this.accordionCoordinator=M,this.cd=F,this.showOpenStateIcon=!0,this.state=d.Nc.DEFAULT,this.open=!1,this.openSubject=new s.x,this.destroySubject=new s.x}ngOnInit(){this.accordionCoordinator.registerAccordion(this)}openChange(M){M?this.openSubject.next():this.closeAccordion()}closeAccordion(){this.cd.markForCheck(),this.open=!1}ngOnDestroy(){this.destroySubject.next(),this.destroySubject.complete()}}return h.\u0275fac=function(M){return new(M||h)(O.Y36(e.e),O.Y36(O.sBO))},h.\u0275cmp=O.Xpm({type:h,selectors:[["nui-widget-editor-accordion"]],inputs:{showOpenStateIcon:"showOpenStateIcon",state:"state"},ngContentSelectors:p,decls:6,vars:6,consts:[[1,"nui-widget-editor-accordion"],[3,"open","openChange"],["nuiExpanderHeader","",1,"d-flex","align-items-start"],["class","nui-widget-editor-accordion__edit-icon",3,"icon",4,"ngIf"],[1,"nui-widget-editor-accordion__edit-icon",3,"icon"]],template:function(M,F){1&M&&(O.F$t(C),O.TgZ(0,"div",0)(1,"nui-expander",1),O.NdJ("openChange",function(x){return F.openChange(x)}),O.TgZ(2,"div",2),O.Hsn(3),O.YNc(4,A,1,1,"nui-icon",3),O.qZA(),O.Hsn(5,1),O.qZA()()),2&M&&(O.xp6(1),O.Q6J("open",F.open),O.xp6(1),O.ekj("error-state","critical"===F.state)("warning-state","warning"===F.state),O.xp6(2),O.Q6J("ngIf",F.showOpenStateIcon))},directives:[R.Fxv,N.O5,R.oJW],styles:[".nui-widget-editor-accordion nui-form-field:last-child .nui-form-field{margin-bottom:0}.nui-widget-editor-accordion__edit-icon{padding:10px;margin-left:auto;margin-right:5px}.nui-widget-editor-accordion .nui-expander--expanded{padding-bottom:0}.nui-widget-editor-accordion .nui-expander__header-icon{display:none}.nui-widget-editor-accordion .nui-expander__header .error-state{background-color:var(--nui-color-semantic-critical-bg,#fceae6)}.nui-widget-editor-accordion .nui-expander__header .warning-state{background-color:var(--nui-color-semantic-warning-bg,#fff9e6)}.nui-widget-editor-accordion .nui-expander__header [nuiexpanderheader]{border-top:1px solid;border-top-color:var(--nui-color-line-default,#d9d9d9);min-height:50px}.nui-widget-editor-accordion .nui-expander__header [nuiexpanderheader] [accordionheader]{overflow:hidden}.nui-widget-editor-accordion .nui-expander__header [nuiexpanderheader] [accordionheader]>div{overflow-x:hidden}.nui-widget-editor-accordion .nui-expander__header [nuiexpanderheader] [accordionheader]>div .nui-text-secondary{white-space:nowrap;overflow:hidden;-ms-text-overflow:ellipsis;text-overflow:ellipsis}.nui-widget-editor-accordion .nui-expander__body{margin:0;padding:0;border-left:none}\n"],encapsulation:2,changeDetection:0}),h})()},64406:(oe,W,l)=>{"use strict";l.d(W,{b:()=>T});var s=l(8817),d=l.n(s),O=l(61135),e=l(77579),R=l(82722),N=l(87686),A=l(53450),C=l(25878),p=l(69155),v=l(5e3),h=l(52382),w=l(45122),M=l(85822),F=l(61842),G=l(10628),x=l(69808);const y=["formPizzagnaComponent"];function k(m,L){if(1&m){const z=v.EpF();v.TgZ(0,"nui-pizzagna",6,7),v.NdJ("pizzagnaChange",function(q){return v.CHM(z),v.oxw(2).formPizzagna=q}),v.qZA()}if(2&m){const z=v.oxw(2);v.Q6J("rootNode",z.formRoot)("pizzagna",z.formPizzagna)}}function b(m,L){if(1&m&&(v.TgZ(0,"div",4),v.YNc(1,k,2,2,"nui-pizzagna",5),v.qZA()),2&m){const z=v.oxw();v.Q6J("formGroup",z.form),v.xp6(1),v.Q6J("ngIf",z.formPizzagna)}}let T=(()=>{class m{constructor(z,X,q,re){this.changeDetector=z,this.formBuilder=X,this.previewService=q,this.configurator=re,this.navigationControl=new O.X({busyState:{busy:!1},allowStepChange:!0}),this.busy=!1,this.destroy$=new e.x,this.form=this.formBuilder.group({})}set formPizzagnaComponent(z){var X;null===(X=null==z?void 0:z.eventBus)||void 0===X||X.getStream(A.xZ).pipe((0,R.R)(this.destroy$)).subscribe(q=>{var re,de,pe;const te=q.payload;te&&te.id&&(null===(pe=null===(de=null===(re=this.configurator)||void 0===re?void 0:re.previewPizzagnaComponent)||void 0===de?void 0:de.eventBus)||void 0===pe||pe.getStream(te.id).next(te.payload))}),this._formPizzagnaComponent=z}ngOnInit(){var z;this.previewService.preview=null===(z=this.configurator.previewWidget)||void 0===z?void 0:z.pizzagna[C.xW.Configuration],this.previewService.previewChanged.pipe((0,R.R)(this.destroy$)).subscribe(X=>{this.onPreviewPizzagnaUpdate(X),this.changeDetector.detectChanges()}),this.configurator.submitError.pipe((0,R.R)(this.destroy$)).subscribe(()=>{this.toggleBusy()}),this.changeDetector.detectChanges()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}onPreviewPizzagnaUpdate(z){var X;const q=Object.assign(Object.assign({},this.configurator.previewWidget),{pizzagna:Object.assign(Object.assign({},null===(X=this.configurator.previewWidget)||void 0===X?void 0:X.pizzagna),{[C.xW.Configuration]:z})});this.configurator.updateWidget(q);const re=d()(z,m.TITLE_PATH,"");this.configuratorTitle=$localize`Editing ${re}`}onFinish(){if(this.form.invalid)return this.form.markAllAsTouched(),this.form.patchValue(this.form.value),void this.form.updateValueAndValidity({onlySelf:!1,emitEvent:!0});this.toggleBusy(),this.configurator.formSubmit()}onCancel(){this.configurator.formCancel()}toggleBusy(){this.busy=!this.busy,this.navigationControl.next({busyState:{busy:this.busy},allowStepChange:!this.busy})}}return m.lateLoadKey="WidgetEditorComponent",m.TITLE_PATH="header.properties.title",m.\u0275fac=function(z){return new(z||m)(v.Y36(v.sBO),v.Y36(h.qu),v.Y36(w.m),v.Y36(p.n))},m.\u0275cmp=v.Xpm({type:m,selectors:[["nui-widget-editor"]],viewQuery:function(z,X){if(1&z&&v.Gf(y,5),2&z){let q;v.iGM(q=v.CRH())&&(X.formPizzagnaComponent=q.first)}},hostAttrs:[1,"d-flex","flex-column","h-100"],inputs:{formPizzagna:"formPizzagna",formRoot:"formRoot"},decls:5,vars:5,consts:function(){let L;return L=$localize`:␟afa960379d26eb20fd22e6e10537c1c5ec74c5d1␟4319441956121197474:Save Changes`,[[3,"configuratorTitle","disableCloseButton","close"],["finishText",L,3,"hideHeader","navigationControl","finish","cancel"],[3,"stepTemplate"],["step1",""],[3,"formGroup"],[3,"rootNode","pizzagna","pizzagnaChange",4,"ngIf"],[3,"rootNode","pizzagna","pizzagnaChange"],["formPizzagnaComponent",""]]},template:function(z,X){if(1&z&&(v.TgZ(0,"nui-configurator-heading",0),v.NdJ("close",function(){return X.onCancel()}),v.qZA(),v.TgZ(1,"nui-dashwiz",1),v.NdJ("finish",function(){return X.onFinish()})("cancel",function(){return X.onCancel()}),v._UZ(2,"nui-dashwiz-step",2),v.qZA(),v.YNc(3,b,2,2,"ng-template",null,3,v.W1O)),2&z){const q=v.MAs(4);v.Q6J("configuratorTitle",X.configuratorTitle)("disableCloseButton",X.busy),v.xp6(1),v.Q6J("hideHeader",!0)("navigationControl",X.navigationControl),v.xp6(1),v.Q6J("stepTemplate",q)}},directives:[M.Q,F.i,G.u,h.JL,h.sg,x.O5,N.R],encapsulation:2,changeDetection:0}),m})()},10628:(oe,W,l)=>{"use strict";l.d(W,{u:()=>A});var s=l(5e3),d=l(30652),O=l(69808),e=l(8083);function R(C,p){1&C&&s.GkF(0)}const N=function(C){return{"nui-dashwiz-step--active":C}};let A=(()=>{class C{constructor(){this.hidden=!1,this.spinnerSize=d.Eye.Large,this.enter=new s.vpe,this.valid=new s.vpe,this.exit=new s.vpe,this.next=new s.vpe,this.busyConfig={busy:!1},this.visited=!1,this.active=!1,this.complete=!1,this.icon="step",this.iconColor="",this.enterStep=v=>{this.enter.emit(v)},this.exitStep=v=>{this.exit.emit(v)},this.nextStep=v=>{this.next.emit(v)},this.applyEnteringStep=()=>{this.active=!0,this.icon="step-active",this.iconColor="black"},this.applyExitingStep=()=>{this.active=!1,this.visited=!0,this.icon="step-complete",this.iconColor=""}}ngOnInit(){this.nextText=this.nextText||$localize`Next`}ngOnChanges(v){v.stepControl&&this.valid.emit(this.stepControl)}}return C.\u0275fac=function(v){return new(v||C)},C.\u0275cmp=s.Xpm({type:C,selectors:[["nui-dashwiz-step"]],inputs:{stepTemplate:"stepTemplate",stepControl:"stepControl",title:"title",nextText:"nextText",hidden:"hidden",disabled:"disabled",spinnerSize:"spinnerSize"},outputs:{enter:"enter",valid:"valid",exit:"exit",next:"next"},features:[s.TTD],decls:4,vars:9,consts:[["nui-busy","",1,"nui-dashwiz-step","animated","h-100",3,"ngClass","busy"],["cdkScrollable","",1,"h-100","overflow-auto","nui-scroll-shadows","configurator-scrollable"],[4,"ngTemplateOutlet"],[3,"percent","allowCancel","message","size"]],template:function(v,h){1&v&&(s.TgZ(0,"div",0)(1,"div",1),s.YNc(2,R,1,0,"ng-container",2),s.qZA(),s._UZ(3,"nui-spinner",3),s.qZA()),2&v&&(s.Q6J("ngClass",s.VKq(7,N,h.active))("busy",h.busyConfig.busy),s.xp6(2),s.Q6J("ngTemplateOutlet",h.stepTemplate),s.xp6(1),s.Q6J("percent",h.busyConfig.percent)("allowCancel",h.busyConfig.allowCancel)("message",h.busyConfig.message)("size",h.spinnerSize))},directives:[d.ERI,O.mk,e.PQ,O.tP,d.ORR],styles:[".nui-dashwiz-step[_ngcontent-%COMP%]{display:none}.nui-dashwiz-step--active[_ngcontent-%COMP%]{display:block}"]}),C})()},4235:(oe,W,l)=>{"use strict";l.d(W,{P:()=>A});var s=l(5e3),d=l(30652),O=l(69808);function e(C,p){if(1&C){const v=s.EpF();s.TgZ(0,"button",6),s.NdJ("click",function(){return s.CHM(v),s.oxw().onBack()}),s.TgZ(1,"span"),s.SDv(2,7),s.qZA()()}if(2&C){const v=s.oxw();s.Q6J("disabled",v.busy)}}function R(C,p){if(1&C){const v=s.EpF();s.TgZ(0,"button",8),s.NdJ("click",function(){return s.CHM(v),s.oxw().onNext()}),s.TgZ(1,"span"),s._uU(2),s.qZA()()}if(2&C){const v=s.oxw();s.Q6J("displayStyle",v.canFinish?"default":"primary")("disabled",v.busy),s.xp6(2),s.Oqu(v.nextText)}}function N(C,p){if(1&C){const v=s.EpF();s.TgZ(0,"button",9),s.NdJ("click",function(){return s.CHM(v),s.oxw().onFinish()}),s.TgZ(1,"span"),s._uU(2),s.qZA()()}if(2&C){const v=s.oxw();s.Q6J("isBusy",v.busy)("disabled",v.busy),s.xp6(2),s.Oqu(v.finishText)}}let A=(()=>{class C{constructor(v){this.changeDetector=v,this.busy=!1,this.canFinish=!1,this.canProceed=!1,this.isFirstStepActive=!1,this.isLastStepActive=!1,this.cancel=new s.vpe,this.next=new s.vpe,this.back=new s.vpe,this.finish=new s.vpe}onCancel(){this.cancel.emit()}onNext(){this.next.emit()}onBack(){this.back.emit()}onFinish(){this.finish.emit()}}return C.lateLoadKey="DashwizButtonsComponent",C.\u0275fac=function(v){return new(v||C)(s.Y36(s.sBO))},C.\u0275cmp=s.Xpm({type:C,selectors:[["nui-dashwiz-buttons"]],inputs:{busy:"busy",canFinish:"canFinish",canProceed:"canProceed",isFirstStepActive:"isFirstStepActive",isLastStepActive:"isLastStepActive",nextText:"nextText",finishText:"finishText"},outputs:{cancel:"cancel",next:"next",back:"back",finish:"finish"},decls:7,vars:4,consts:function(){let p,v;return p=$localize`:␟d7b35c384aecd25a516200d6921836374613dfe7␟2159130950882492111:Cancel`,v=$localize`:␟cda31dbd724cf5f4fa7a4274d9120651490c8a8c␟8890553633144307762:Back`,[[1,"d-flex","justify-content-end","p-4"],["nui-button","","type","button",1,"nui-dashwiz-buttons__cancel-button",3,"disabled","click"],p,["class","ml-3 nui-dashwiz-buttons__back-button","nui-button","","icon","caret-left","type","button",3,"disabled","click",4,"ngIf"],["class","ml-3 nui-dashwiz-buttons__next-button","nui-button","","type","button",3,"displayStyle","disabled","click",4,"ngIf"],["class","ml-3 nui-dashwiz-buttons__finish-button","nui-button","","type","button","displayStyle","primary",3,"isBusy","disabled","click",4,"ngIf"],["nui-button","","icon","caret-left","type","button",1,"ml-3","nui-dashwiz-buttons__back-button",3,"disabled","click"],v,["nui-button","","type","button",1,"ml-3","nui-dashwiz-buttons__next-button",3,"displayStyle","disabled","click"],["nui-button","","type","button","displayStyle","primary",1,"ml-3","nui-dashwiz-buttons__finish-button",3,"isBusy","disabled","click"]]},template:function(v,h){1&v&&(s.TgZ(0,"div",0)(1,"button",1),s.NdJ("click",function(){return h.onCancel()}),s.TgZ(2,"span"),s.SDv(3,2),s.qZA()(),s.YNc(4,e,3,1,"button",3),s.YNc(5,R,3,3,"button",4),s.YNc(6,N,3,3,"button",5),s.qZA()),2&v&&(s.xp6(1),s.Q6J("disabled",h.busy),s.xp6(3),s.Q6J("ngIf",!h.isFirstStepActive),s.xp6(1),s.Q6J("ngIf",!h.isLastStepActive&&h.canProceed),s.xp6(1),s.Q6J("ngIf",h.canFinish||h.isLastStepActive))},directives:[d.r0F,O.O5],encapsulation:2}),C})()},61842:(oe,W,l)=>{"use strict";l.d(W,{i:()=>pe});var s=l(5e3),d=l(62516),O=l.n(d),e=l(36397),R=l.n(e),N=l(34235),A=l.n(N),C=l(61135),p=l(10628),v=l(4235),h=l(30652),w=l(59551),M=l(69808),F=l(47969),G=l(47429);const x=["container"],y=["stepTitle"],k=function(te){return{"min-width.px":te}};function b(te,ae){if(1&te&&(s.TgZ(0,"div",14)(1,"div",15)(2,"div",16)(3,"div",17)(4,"span",18)(5,"span",19,20),s._uU(7),s.qZA(),s.TgZ(8,"div",21)(9,"div",22),s._UZ(10,"div",23),s.qZA(),s._UZ(11,"nui-icon",24),s.TgZ(12,"div",25),s._UZ(13,"div",23),s.qZA()()()()()()()),2&te){const Y=s.oxw().$implicit,j=s.oxw(3);s.xp6(7),s.hij(" ",Y.title,""),s.xp6(3),s.Q6J("ngStyle",s.VKq(5,k,j.stepLineWidth)),s.xp6(1),s.Q6J("icon",Y.icon)("iconColor",Y.iconColor),s.xp6(2),s.Q6J("ngStyle",s.VKq(7,k,j.stepLineWidth))}}const T=function(te,ae,Y,j,ce,ie){return{"nui-dashwiz__header-step--first":te,"nui-dashwiz__header-step--last":ae,"nui-dashwiz__header-step--visited":Y,"nui-dashwiz__header-step--disabled":j,"nui-dashwiz__header-step--active":ce,"nui-dashwiz__header-step--complete":ie}};function m(te,ae){if(1&te){const Y=s.EpF();s.TgZ(0,"li",12),s.NdJ("click",function(){const ie=s.CHM(Y).$implicit;return s.oxw(3).selectStep(ie)}),s.YNc(1,b,14,9,"div",13),s.qZA()}if(2&te){const Y=ae.$implicit,j=ae.first,ce=ae.last,ie=s.oxw(3);s.Q6J("ngClass",s.HTZ(2,T,j,ce,Y.visited,Y.disabled||!Y.visited||ie.currentStep.busyConfig.busy,Y.active,Y.complete)),s.xp6(1),s.Q6J("ngIf",!Y.hidden)}}function L(te,ae){if(1&te&&(s.TgZ(0,"ul",10),s.YNc(1,m,2,9,"li",11),s.qZA()),2&te){const Y=s.oxw(2);s.xp6(1),s.Q6J("ngForOf",Y.steps)}}function z(te,ae){if(1&te&&(s.TgZ(0,"div",8),s.YNc(1,L,2,1,"ul",9),s.qZA()),2&te){const Y=s.oxw();s.ekj("nui-dashwiz__header--lines-stretched",Y.stretchStepLines),s.xp6(1),s.Q6J("ngIf",Y.steps)}}function X(te,ae){}function q(te,ae){}const re=function(){return["cancel","next","back","finish"]},de=["*"];let pe=(()=>{class te{constructor(Y,j,ce,ie){this.changeDetector=Y,this.componentFactoryResolver=j,this.logger=ce,this.dashwizService=ie,this.hideHeader=!1,this.canProceed=!1,this.canFinish=!1,this.finishText=te.placeholderFinishText,this.stretchStepLines=!1,this.stepNavigated=new s.vpe,this.cancel=new s.vpe,this.finish=new s.vpe,this.next=new s.vpe,this.back=new s.vpe,this.navigationControl=new C.X({busyState:{busy:!1},allowStepChange:!0}),this.stepLineWidth=65,this.previousStepIndex=0,this.onBack=()=>{if(!A()(this.stepIndex)){let Te=this.arraySteps[this.stepIndex-1];(Te.hidden||Te.disabled)&&(Te=O()(this.arraySteps.slice(0).reverse(),Ee=>!Ee.hidden,R()(this.arraySteps.slice(0).reverse(),this.arraySteps[this.stepIndex])+1)),this.selectStep(Te),this.back.emit()}},this.onNext=()=>{let Te=this.arraySteps[this.stepIndex+1];this.handleStepControl(this.currentStep),this.currentStep.nextStep({currentStepIndex:this.stepIndex,currentStep:this.currentStep,previousStep:this.currentStep,previousStepIndex:this.stepIndex}),(Te.hidden||Te.disabled&&!A()(Te.stepControl))&&(Te=O()(this.arraySteps,Ee=>!Ee.hidden,this.stepIndex+1)),(A()(this.currentStep.stepControl)||this.currentStep.stepControl)&&(this.currentStep.complete=!0),Te.disabled&&!Te.visited&&(this.currentStep.complete=!1),this.selectStep(Te),this.next.emit()},this.onFinish=()=>{this.finish.emit()},this.onCancel=()=>{this.cancel.emit(0!==this.steps.toArray().filter(Te=>Te.complete).length)},this.buttonPortalActionMap={cancel:this.onCancel,next:this.onNext,back:this.onBack,finish:this.onFinish},ie&&(ie.component=this)}ngOnInit(){this.buttonComponentTypes=this.buttonComponentTypes||[v.P.lateLoadKey],this.finishText===te.placeholderFinishText&&this.logger.warn(`DashwizComponent input "finishText" is using placeholder text\n"${te.placeholderFinishText}". A value should be specified.`)}ngDoCheck(){this.currentStep&&(this.buttonProperties={busy:this.currentStep.busyConfig.busy,canProceed:this.canProceed,canFinish:this.canFinish,isLastStepActive:this.steps.last.active,isFirstStepActive:this.steps.first.active,nextText:this.currentStep.nextText,finishText:this.finishText})}ngAfterContentInit(){const Y=this.steps.filter(j=>j.active);this.arraySteps=this.steps.toArray(),0===Y.length&&(this.currentStep=this.steps.first,this.selectStep(this.currentStep),this.changeDetector.detectChanges()),this.steps.toArray().forEach(j=>{j.valid.subscribe(ce=>{A()(ce)||this.handleStepControl(j)})}),this.navigationControl.subscribe(j=>{this.currentStep.busyConfig=j.busyState,j.allowStepChange&&!A()(this.futureStep)&&this.currentStep!==this.futureStep&&(this.enterAnotherStep(),this.futureStep=void 0)})}ngAfterViewChecked(){this.stretchStepLines&&(this.stepLineWidth=Math.round(this.getLargestLabelWidth()/2),this.changeDetector.detectChanges())}ngOnDestroy(){this.steps.toArray().forEach(Y=>Y.valid.unsubscribe()),this.navigationControl.unsubscribe(),this.dashwizService.component=void 0}addStepDynamic(Y,j){const ce=this.componentFactoryResolver.resolveComponentFactory(p.u),ie=this.dynamicStep.createComponent(ce);return ie.instance.stepTemplate=Y.stepTemplate,this.arraySteps.splice(j,0,ie.instance),this.steps.reset(this.arraySteps),ie.instance}disableStep(Y){const j=this.arraySteps.indexOf(Y);this.arraySteps[j].disabled=!0,this.changeDetector.detectChanges()}enableStep(Y){const j=this.arraySteps.indexOf(Y);this.arraySteps[j].disabled=!1,this.changeDetector.detectChanges()}hideStep(Y){const j=this.arraySteps.indexOf(Y);this.arraySteps[j].hidden=!0}showStep(Y){const j=this.arraySteps.indexOf(Y);this.arraySteps[j].hidden=!1}goToStep(Y){this.selectStep(this.arraySteps[Y])}selectStep(Y){Y.disabled||(this.futureStep=Y,this.currentStep.exitStep({currentStepIndex:this.arraySteps.indexOf(this.futureStep),currentStep:this.futureStep,previousStep:this.arraySteps[this.stepIndex],previousStepIndex:this.stepIndex}),this.navigationControl.value.allowStepChange&&this.enterAnotherStep())}enterAnotherStep(){var Y;this.currentStep.applyExitingStep(),null===(Y=this.futureStep)||void 0===Y||Y.enterStep(),this.futureStep&&(this.currentStep=this.futureStep),this.currentStep.applyEnteringStep(),this.stepIndex=this.arraySteps.indexOf(this.currentStep),this.stepNavigatedEvent={currentStepIndex:this.stepIndex,currentStep:this.currentStep,previousStep:this.arraySteps[this.previousStepIndex],previousStepIndex:this.previousStepIndex},this.stepNavigated.emit(this.stepNavigatedEvent),this.previousStepIndex=this.stepIndex}onButtonPortalOutput(Y){var j,ce;null===(ce=(j=this.buttonPortalActionMap)[Y.id])||void 0===ce||ce.call(j)}disableFollowingSteps(){this.arraySteps.slice(this.stepIndex+1).map(Y=>{Y.disabled=!0})}enableFollowingSteps(){this.arraySteps.slice(this.stepIndex+1).map(Y=>{Y.disabled=!1})}handleStepControl(Y){A()(Y.stepControl)||(Y.stepControl?this.enableFollowingSteps():this.disableFollowingSteps())}getLargestLabelWidth(){const Y=this.stepTitles.map(j=>j.nativeElement.offsetWidth);return Math.round(Math.max(...Y))}}return te.placeholderFinishText="Action",te.\u0275fac=function(Y){return new(Y||te)(s.Y36(s.sBO),s.Y36(s._Vd),s.Y36(h.mQy),s.Y36(w.e))},te.\u0275cmp=s.Xpm({type:te,selectors:[["nui-dashwiz"]],contentQueries:function(Y,j,ce){if(1&Y&&s.Suo(ce,p.u,4),2&Y){let ie;s.iGM(ie=s.CRH())&&(j.steps=ie)}},viewQuery:function(Y,j){if(1&Y&&(s.Gf(x,5,s.s_b),s.Gf(y,5)),2&Y){let ce;s.iGM(ce=s.CRH())&&(j.dynamicStep=ce.first),s.iGM(ce=s.CRH())&&(j.stepTitles=ce)}},hostAttrs:[1,"flex-grow-1","overflow-auto"],inputs:{hideHeader:"hideHeader",canProceed:"canProceed",canFinish:"canFinish",finishText:"finishText",stretchStepLines:"stretchStepLines",buttonComponentTypes:"buttonComponentTypes",navigationControl:"navigationControl"},outputs:{stepNavigated:"stepNavigated",cancel:"cancel",finish:"finish",next:"next",back:"back"},ngContentSelectors:de,decls:10,vars:6,consts:[[1,"nui-dashwiz","d-flex","flex-column","h-100"],["class","nui-dashwiz__header",3,"nui-dashwiz__header--lines-stretched",4,"ngIf"],[1,"nui-scroll-shadows","flex-grow-1","overflow-auto"],["container",""],[1,"nui-dashwiz__footer"],["nuiComponentPortal","","componentId","dashwizButtons",3,"componentType","properties","outputs","output"],["componentPortal","nuiComponentPortal"],[3,"cdkPortalOutlet","attached"],[1,"nui-dashwiz__header"],["class","nui-dashwiz__header-steps",4,"ngIf"],[1,"nui-dashwiz__header-steps"],["class","nui-dashwiz__header-step",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"nui-dashwiz__header-step",3,"ngClass","click"],["class","nui-dashwiz__header-step-container",4,"ngIf"],[1,"nui-dashwiz__header-step-container"],[1,"nui-dashwiz__header-step-row"],[1,"nui-dashwiz__header-step-col"],[1,"nui-dashwiz__header-step-content"],[1,"nui-dashwiz__header-step-link"],[1,"nui-dashwiz__header-step-title"],["stepTitle",""],[1,"nui-dashwiz__header-step-link-container"],[1,"nui-dashwiz__header-step-col","nui-dashwiz__header-step-col-right"],[1,"nui-dashwiz__header-step-line",3,"ngStyle"],[3,"icon","iconColor"],[1,"nui-dashwiz__header-step-col","nui-dashwiz__header-step-col-left"]],template:function(Y,j){if(1&Y){const ce=s.EpF();s.F$t(),s.TgZ(0,"div",0),s.YNc(1,z,2,3,"div",1),s.TgZ(2,"div",2),s.Hsn(3),s.YNc(4,X,0,0,"ng-template",null,3,s.W1O),s.qZA(),s.TgZ(6,"div",4),s.ynx(7,5,6),s.NdJ("output",function(Te){return j.onButtonPortalOutput(Te)}),s.YNc(9,q,0,0,"ng-template",7),s.NdJ("attached",function(Te){return s.CHM(ce),s.MAs(8).attached(Te)}),s.BQk(),s.qZA()()}if(2&Y){const ce=s.MAs(8);s.xp6(1),s.Q6J("ngIf",!j.hideHeader),s.xp6(6),s.Q6J("componentType",1===j.buttonComponentTypes.length?j.buttonComponentTypes[0]:j.buttonComponentTypes[j.stepIndex])("properties",j.buttonProperties)("outputs",s.DdM(5,re)),s.xp6(2),s.Q6J("cdkPortalOutlet",ce.portal)}},directives:[M.O5,M.sg,M.mk,M.PC,h.oJW,F.$,G.Pl],styles:[".nui-dashwiz__header[_ngcontent-%COMP%]{padding:10px 15px;background-color:var(--nui-color-bg-secondary,#fafafa);border-bottom:1px solid #d9d9d9;border-bottom:1px solid var(--nui-color-line-default, #d9d9d9);overflow:hidden;text-align:center;display:flex;justify-content:center;-webkit-user-select:none;-o-user-select:none;user-select:none}.nui-dashwiz__header-steps[_ngcontent-%COMP%]{margin-bottom:0;white-space:nowrap;display:inline-flex}.nui-dashwiz__header-step[_ngcontent-%COMP%]{line-height:normal;display:inline-flex;cursor:pointer}.nui-dashwiz__header-step--disabled[_ngcontent-%COMP%]{pointer-events:none;cursor:default}.nui-dashwiz__header-step--visited[_ngcontent-%COMP%]   .nui-dashwiz__header-step-link[_ngcontent-%COMP%]{color:var(--nui-color-text-link,#0079aa)}.nui-dashwiz__header-step--visited[_ngcontent-%COMP%]   .nui-dashwiz__header-step-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.nui-dashwiz__header-step--visited[_ngcontent-%COMP%]   .nui-dashwiz__header-step-col-right[_ngcontent-%COMP%] > .nui-dashwiz__header-step-line[_ngcontent-%COMP%]{border-color:var(--nui-color-line-active,#0079aa)}.nui-dashwiz__header-step--first[_ngcontent-%COMP%]   .nui-dashwiz__header-step-col-right[_ngcontent-%COMP%], .nui-dashwiz__header-step--last[_ngcontent-%COMP%]   .nui-dashwiz__header-step-col-left[_ngcontent-%COMP%]{border-color:transparent;opacity:0}.nui-dashwiz__header-step--active[_ngcontent-%COMP%]{cursor:default}.nui-dashwiz__header-step--active[_ngcontent-%COMP%]   .nui-dashwiz__header-step-link[_ngcontent-%COMP%]{color:var(--nui-color-bg-dark,#111)}.nui-dashwiz__header-step--active[_ngcontent-%COMP%]   .nui-dashwiz__header-step-link[_ngcontent-%COMP%]:hover   .nui-dashwiz__header-step-title[_ngcontent-%COMP%]{text-decoration:none}.nui-dashwiz__header-step--active[_ngcontent-%COMP%]   .nui-dashwiz__header-step-link[_ngcontent-%COMP%]   .nui-dashwiz__header-step-col-right[_ngcontent-%COMP%] > .nui-dashwiz__header-step-line[_ngcontent-%COMP%]{border-color:var(--nui-color-line-active,#0079aa)}.nui-dashwiz__header-step--complete[_ngcontent-%COMP%]   .nui-dashwiz__header-step-link[_ngcontent-%COMP%]   .nui-dashwiz__header-step-col-left[_ngcontent-%COMP%] > .nui-dashwiz__header-step-line[_ngcontent-%COMP%]{border-color:var(--nui-color-line-active,#0079aa)}.nui-dashwiz__header-step--complete[_ngcontent-%COMP%]   .nui-dashwiz__header-step-link[_ngcontent-%COMP%]   .nui-dashwiz__header-step-col-right[_ngcontent-%COMP%] > .nui-dashwiz__header-step-line[_ngcontent-%COMP%]{border-color:var(--nui-color-line-active,#0079aa)}.nui-dashwiz__header-step-container[_ngcontent-%COMP%]{display:inline-table;width:100%}.nui-dashwiz__header-step-container-bottom[_ngcontent-%COMP%]{display:none}.nui-dashwiz__header-step-container-bottom[_ngcontent-%COMP%]   .nui-dashwiz__header-step-title[_ngcontent-%COMP%]{width:100%;max-width:100%;margin:0}.nui-dashwiz__header-step-row[_ngcontent-%COMP%]{display:table-row}.nui-dashwiz__header-step-col[_ngcontent-%COMP%]{display:table-cell;vertical-align:middle}.nui-dashwiz__header-step-col[_ngcontent-%COMP%]   .nui-dashwiz__header-step-line[_ngcontent-%COMP%]{border-color:var(--nui-color-line-default,#d9d9d9)}.nui-dashwiz__header-step-col-right[_ngcontent-%COMP%]   .nui-dashwiz__header-step-line[_ngcontent-%COMP%]{margin-right:-1px}.nui-dashwiz__header-step-line[_ngcontent-%COMP%]{border-bottom:solid 2px;height:2px}.nui-dashwiz__header-step-link[_ngcontent-%COMP%]{color:var(--nui-color-text-secondary,rgba(17, 17, 17, .6));transition:color .3s}.nui-dashwiz__header-step-link-container[_ngcontent-%COMP%]{display:flex;align-content:baseline;justify-content:center;align-items:center}.nui-dashwiz__header-step-title[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;-ms-text-overflow:ellipsis;text-overflow:ellipsis;vertical-align:middle;display:inline-block;max-width:140px;margin:0 0 5px;text-decoration:inherit}.nui-dashwiz__header.nui-dashwiz__header--lines-stretched[_ngcontent-%COMP%]   .nui-dashwiz__header-step-title[_ngcontent-%COMP%]{max-width:unset}.nui-dashwiz__footer[_ngcontent-%COMP%]{z-index:1080;background-color:var(--nui-color-bg-content,#fff);border-top:solid 1px var(--nui-color-line-default, #d9d9d9)}"]}),te})()},59551:(oe,W,l)=>{"use strict";l.d(W,{e:()=>d});var s=l(5e3);let d=(()=>{class O{constructor(){}}return O.\u0275fac=function(R){return new(R||O)},O.\u0275prov=s.Yz7({token:O,factory:O.\u0275fac,providedIn:"root"}),O})()},37716:(oe,W,l)=>{"use strict";l.d(W,{F:()=>d});var s=l(52382);function d(O){if(O.valid||O.untouched)return!1;if(O instanceof s.cw)for(const e of Object.keys(O.controls))if(d(O.controls[e]))return!0;if(O instanceof s.Oe)for(let e=0;e<O.length;e++)if(d(O.at(e)))return!0;return(O.touched||O.dirty)&&!!O.errors}},73193:(oe,W,l)=>{"use strict";l.d(W,{l:()=>O});var s=l(32656),d=l(5e3);let O=(()=>{class e{constructor(N){this.widgetTypesService=N}transform(N,A="widget"){var C,p;return(null==N?void 0:N.type)?null===(p=null===(C=this.widgetTypesService.getWidgetType(N.type,N.version).paths)||void 0===C?void 0:C[A])||void 0===p?void 0:p.root:null}}return e.\u0275fac=function(N){return new(N||e)(d.Y36(s.x,16))},e.\u0275pipe=d.Yjl({name:"nuiPizzagnaRoot",type:e,pure:!0}),e})()},16193:(oe,W,l)=>{"use strict";l.d(W,{F:()=>h});var s=l(39841),d=l(54482),O=l(25403),e=l(25032),N=l(68675),A=l(54004),C=l(25878),p=l(37716),v=l(5e3);let h=(()=>{class w{transform(F){if(!F)throw new Error("Provided form is undefined");return(0,s.a)([F.statusChanges,F.valueChanges]).pipe((0,N.O)(null),(0,A.U)(()=>(0,p.F)(F)?C.Nc.CRITICAL:C.Nc.DEFAULT),function R(w,M){return(0,d.e)((F,G)=>{const x=new Set;F.subscribe((0,O.x)(G,y=>{const k=w?w(y):y;x.has(k)||(x.add(k),G.next(y))})),null==M||M.subscribe((0,O.x)(G,()=>x.clear(),e.Z))})}())}}return w.\u0275fac=function(F){return new(F||w)},w.\u0275pipe=v.Yjl({name:"nuiWidgetEditorAccordionFormState",type:w,pure:!1}),w})()},15838:(oe,W,l)=>{"use strict";l.d(W,{d:()=>N});var s=l(39841),d=l(68675),O=l(54004),e=l(37716),R=l(5e3);let N=(()=>{class A{transform(p,v,h=A.ERROR_ICON_DEFAULT){if(!p)throw new Error("Provided form is undefined");return(0,s.a)([p.statusChanges,p.valueChanges]).pipe((0,d.O)(null),(0,O.U)(()=>(0,e.F)(p)?h:v))}}return A.ERROR_ICON_DEFAULT="status_critical",A.\u0275fac=function(p){return new(p||A)},A.\u0275pipe=R.Yjl({name:"nuiFormHeaderIconPipe",type:A,pure:!1}),A})()},61874:(oe,W,l)=>{"use strict";l.d(W,{q:()=>v});var s=l(34235),d=l.n(s),O=l(77579),e=l(61135),R=l(82722),N=l(25878),A=l(81466),C=l(5e3),p=l(59551);let v=(()=>{class h{constructor(M,F){this.eventBus=M,this.dashwizService=F,this.onDestroy$=new O.x,this.dataSourceCreated$=new O.x,this.error$=new O.x,this.busy$=new e.X(!1),this.dataSourceFields$=new e.X([]),this.eventBus.subscribeUntil(A.gg,this.onDestroy$,G=>{!G.payload||this.onDataSourceCreated(G.payload)}),this.eventBus.subscribeUntil(A.PF,this.onDestroy$,G=>{var x;if(null===(x=G.payload)||void 0===x?void 0:x.error)this.error$.next(G.payload.error);else{this.error$.next(null);const y=d()(G.payload.result)?G.payload:G.payload.result||{};(null==y?void 0:y.dataFields)&&this.dataSourceFields$.next(y.dataFields)}})}onDataSourceCreated(M){var F;this.dataSource=M,this.dataSourceCreated$.next(),null===(F=this.dataSource.busy)||void 0===F||F.pipe((0,R.R)(this.dataSourceCreated$)).subscribe(G=>{var x,y;null===(y=null===(x=this.dashwizService)||void 0===x?void 0:x.component)||void 0===y||y.navigationControl.next({busyState:{busy:G},allowStepChange:!G}),this.busy$.next(G)})}ngOnDestroy(){this.onDestroy$.next(),this.onDestroy$.complete()}}return h.\u0275fac=function(M){return new(M||h)(C.LFG(N.nY),C.LFG(p.e))},h.\u0275prov=C.Yz7({token:h,factory:h.\u0275fac}),h})()},32148:(oe,W,l)=>{"use strict";l.d(W,{p:()=>O});var s=l(61135),d=l(5e3);let O=(()=>{class e{constructor(){this.height$=new s.X(0)}}return e.\u0275fac=function(N){return new(N||e)},e.\u0275prov=d.Yz7({token:e,factory:e.\u0275fac}),e})()},42971:(oe,W,l)=>{"use strict";l.d(W,{J:()=>k});var s=l(11420),d=l(90733),O=l.n(d),e=l(75946),R=l.n(e),N=l(77579),A=l(60515),C=l(39646),p=l(68306),v=l(63900),h=l(70262),w=l(82722),M=l(39300),F=l(30652),G=l(32656),x=l(69155),y=l(5e3);let k=(()=>{class b{constructor(m,L,z,X,q,re,de){this.componentFactoryResolver=m,this.widgetTypesService=L,this.injector=z,this.appRef=X,this.logger=q,this.router=de,this.close$=new N.x,this.handleSubmit=(pe,te)=>ae=>ae.pipe(this.trySubmit(te,pe),this.updateDashboard(pe.dashboardComponent)),this.trySubmit=(pe,te)=>ae=>ae.pipe((0,v.w)(Y=>Y&&R()(pe)?pe(Y,te).pipe((0,h.K)(j=>(this.logger.error(j),this.componentRef.instance.handleSubmitError(),A.E))):(0,C.of)(Y))),this.updateDashboard=pe=>te=>new p.y(ae=>te.subscribe(Y=>{if(Y){let j;Y.id=Y.id||(0,F.VjN)(),j=pe.dashboard.widgets[Y.id]?Object.assign(Object.assign({},Y),{pizzagna:Object.assign(Object.assign({},this.widgetTypesService.getWidgetType(Y.type,Y.version).widget),{configuration:Y.pizzagna.configuration})}):Y,pe.removeWidget(j.id,!1),setTimeout(()=>{pe.updateWidget(j)})}this.close(),ae.next()})),this.renderer=re.createRenderer(null,null)}open(m){var L;const z={dashboardComponent:m.dashboardComponent,widget:O()(m.widget)};this.componentRef=this.appendComponentToBody();const X=this.componentRef.instance;return X.formPortal=m.portalBundle.portal,X.previewWidget=O()(m.widget),(null===(L=m.portalBundle)||void 0===L?void 0:L.attached)&&X.formPortalAttached.pipe((0,w.R)(this.close$)).subscribe(m.portalBundle.attached),X.changeDetector.detectChanges(),X.result.asObservable().pipe(this.handleSubmit(z,m.trySubmit))}close(){!this.renderer||(this.close$.next(),this.renderer.removeChild(document.body,this.componentRef.hostView.rootNodes[0]),this.appRef.detachView(this.componentRef.hostView),this.componentRef.destroy(),this.renderer.removeStyle(document.body,"overflow"))}appendComponentToBody(){const L=this.componentFactoryResolver.resolveComponentFactory(x.n).create(this.injector);return this.appRef.attachView(L.hostView),this.renderer.appendChild(document.body,L.hostView.rootNodes[0]),this.renderer.setStyle(document.body,"overflow","hidden"),this.router&&this.router.events.pipe((0,M.h)(z=>z instanceof s.m2),(0,w.R)(this.close$)).subscribe(()=>this.close()),L}}return b.\u0275fac=function(m){return new(m||b)(y.LFG(y._Vd),y.LFG(G.x),y.LFG(y.zs3),y.LFG(y.z2F),y.LFG(F.mQy),y.LFG(y.FYo),y.LFG(s.F0,8))},b.\u0275prov=y.Yz7({token:b,factory:b.\u0275fac}),b})()},36216:(oe,W,l)=>{"use strict";l.d(W,{a:()=>A});var s=l(77579),d=l(42339),O=l(53450),e=l(25878),R=l(5e3),N=l(45122);let A=(()=>{class C{constructor(v,h,w){this.eventBus=v,this.previewService=h,this.pizzagnaService=w,this.destroy$=new s.x}ngAfterViewInit(){this.buildForm(),this.toPreview(this.component.form)}setComponent(v,h){this.component=v,this.componentId=h}getPreview(){return this.previewService.preview}updatePreview(v){this.previewService.preview=v}updateFormPizzagna(v){this.pizzagnaService.updatePizzagna(v),this.eventBus.getStream(O.M).next({payload:{path:"",value:v}})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return C.\u0275fac=function(v){return new(v||C)(R.LFG(e.nY),R.LFG(N.m),R.LFG(d.p))},C.\u0275prov=R.Yz7({token:C,factory:C.\u0275fac}),C})()},75675:(oe,W,l)=>{"use strict";l.d(W,{l:()=>F});var s=l(18680),d=l.n(s),O=l(12498),e=l.n(O),R=l(95835),N=l.n(R),A=l(82722),C=l(30652),p=l(42339),v=l(25878),h=l(36216),w=l(5e3),M=l(45122);let F=(()=>{class G extends h.a{constructor(y,k,b){super(y,k,b),this.shouldReadForm=!1}ngAfterViewInit(){super.ngAfterViewInit()}buildForm(){var y,k,b;const T=this.getPreview(),m=(null===(b=null===(k=null===(y=null==T?void 0:T.tiles)||void 0===y?void 0:y.properties)||void 0===k?void 0:k.nodes)||void 0===b?void 0:b.map(X=>({id:X,componentType:T[X].componentType})))||[],L=null==m?void 0:m.map(X=>X.id);this.pizzagnaService.createComponentsFromTemplate("tiles",L);let z=this.pizzagnaService.pizzagna;z=(0,C.zdu)(z,`${v.xW.Data}.tiles.properties.tiles`,m),setTimeout(()=>this.shouldReadForm=!0),this.updateFormPizzagna(z)}toPreview(y){var k;null===(k=y.get("tiles"))||void 0===k||k.valueChanges.pipe((0,A.R)(this.destroy$)).subscribe(b=>{var T,m;if(!this.shouldReadForm)return;let L=this.getPreview();const z=(b||[]).map(re=>re.id),X=d()(null===(m=null===(T=null==L?void 0:L.tiles)||void 0===T?void 0:T.properties)||void 0===m?void 0:m.nodes,z);X.length&&(L=N()(L,X));const q=e()(b,re=>re.id);L=(0,C.zdu)(L,"tiles.properties.nodes",z);for(const re of z){const de=q[re];if(de&&!L[de.id]){const pe=this.getTileConfiguration(de.id,de.componentType);L=(0,C.zdu)(L,de.id,pe)}}this.updatePreview(L)})}getTileConfiguration(y,k){return{id:y,providers:{dataSource:{providerId:void 0}}}}}return G.\u0275fac=function(y){return new(y||G)(w.LFG(v.nY),w.LFG(M.m),w.LFG(p.p))},G.\u0275prov=w.Yz7({token:G,factory:G.\u0275fac}),G})()},60167:(oe,W,l)=>{"use strict";l.d(W,{M:()=>p});var s=l(82722),d=l(30652),O=l(42339),e=l(25878),R=l(55413),N=l(36216),A=l(5e3),C=l(45122);let p=(()=>{class v extends N.a{constructor(w,M,F){super(w,M,F),this.PROPERTIES_PATH=`${e.xW.Configuration}.chartOptionsEditor.properties`}ngAfterViewInit(){super.ngAfterViewInit()}buildForm(){var w,M,F,G,x,y,k,b,T,m,L;const z=null===(F=null===(M=null===(w=this.getPreview().chart)||void 0===w?void 0:w.properties)||void 0===M?void 0:M.configuration)||void 0===F?void 0:F.chartOptions;let X=this.pizzagnaService.pizzagna;X=(0,d.zdu)(X,`${this.PROPERTIES_PATH}.chartType`,null!==(G=null==z?void 0:z.type)&&void 0!==G?G:void 0),X=(0,d.zdu)(X,`${this.PROPERTIES_PATH}.legendPlacement`,null!==(x=null==z?void 0:z.legendPlacement)&&void 0!==x?x:R.w.None),X=(0,d.zdu)(X,`${this.PROPERTIES_PATH}.legendFormatterComponentType`,null!==(k=null===(y=null==z?void 0:z.legendFormatter)||void 0===y?void 0:y.componentType)&&void 0!==k?k:""),X=(0,d.zdu)(X,`${this.PROPERTIES_PATH}.contentFormatterComponentType`,null!==(T=null===(b=null==z?void 0:z.contentFormatter)||void 0===b?void 0:b.componentType)&&void 0!==T?T:"DonutContentRawFormatterComponent"),X=(0,d.zdu)(X,`${this.PROPERTIES_PATH}.contentFormatterProperties`,null!==(L=null===(m=null==z?void 0:z.contentFormatter)||void 0===m?void 0:m.properties)&&void 0!==L?L:""),this.updateFormPizzagna(X)}toPreview(w){w.valueChanges.pipe((0,s.R)(this.destroy$)).subscribe(M=>{const F=(0,d.zdu)(this.getPreview(),"chart.properties.configuration.chartOptions",M);this.updatePreview(F)})}}return v.\u0275fac=function(w){return new(w||v)(A.LFG(e.nY),A.LFG(C.m),A.LFG(O.p))},v.\u0275prov=A.Yz7({token:v,factory:v.\u0275fac}),v})()},42911:(oe,W,l)=>{"use strict";l.d(W,{c:()=>C});var s=l(82722),d=l(30652),O=l(42339),e=l(25878),R=l(36216),N=l(5e3),A=l(45122);class C extends R.a{constructor(v,h,w){super(v,h,w)}ngAfterViewInit(){super.ngAfterViewInit()}buildForm(){var v,h;let w=this.pizzagnaService.pizzagna;const M=null===(h=null===(v=this.getPreview())||void 0===v?void 0:v.header)||void 0===h?void 0:h.properties;w=(0,d.zdu)(w,`${C.PROPERTIES_PATH}.title`,null==M?void 0:M.title),w=(0,d.zdu)(w,`${C.PROPERTIES_PATH}.subtitle`,null==M?void 0:M.subtitle),w=(0,d.zdu)(w,`${C.PROPERTIES_PATH}.url`,null==M?void 0:M.url),w=(0,d.zdu)(w,`${C.PROPERTIES_PATH}.description`,null==M?void 0:M.description),w=(0,d.zdu)(w,`${C.PROPERTIES_PATH}.collapsible`,null==M?void 0:M.collapsible),this.updateFormPizzagna(w)}toPreview(v){v.valueChanges.pipe((0,s.R)(this.destroy$)).subscribe(h=>{const w=(0,d.zdu)(this.getPreview(),"header.properties",h);this.updatePreview(w)})}}C.PROPERTIES_PATH=`${e.xW.Configuration}.titleAndDescription.properties`,C.\u0275fac=function(v){return new(v||C)(N.LFG(e.nY),N.LFG(A.m),N.LFG(O.p))},C.\u0275prov=N.Yz7({token:C,factory:C.\u0275fac})},41294:(oe,W,l)=>{"use strict";l.d(W,{w:()=>m});var s=l(8817),d=l.n(s),O=l(71973),e=l.n(O),R=l(64509),N=l.n(R),A=l(34235),C=l.n(A),p=l(77579),v=l(39841),h=l(82722),w=l(54004),M=l(71884),F=l(30652),G=l(42339),x=l(25878),y=l(81466),k=l(36216),b=l(5e3),T=l(45122);let m=(()=>{class L extends k.a{constructor(X,q,re){super(X,q,re),this.indicatorDataKey="indicatorData",this.previewSeriesPath=`providers.${x.Mu.Adapter}.properties.series`,this.formSeriesComponentPath=`${x.xW.Data}.series.properties`,this.dataSourceSeries$=new p.x,this.selectedSeriesIds$=new p.x,this.shouldReadForm=!1,this.subscribeToAvailableDataFieldsChange(),this.eventBus.subscribeUntil(y.ay,this.destroy$,de=>{const pe=`${x.xW.Structure}.series.properties.nodes`,te=d()(this.pizzagnaService.pizzagna,pe);this.pizzagnaService.removeComponents(te);let ae=this.pizzagnaService.pizzagna;ae=(0,F.zdu)(ae,pe,[]),ae=(0,F.zdu)(ae,`${this.formSeriesComponentPath}.series`,[]),this.updateFormPizzagna(ae)}),this.eventBus.subscribeUntil(y.PF,this.destroy$,de=>{var pe;const{series:te}=C()(de.payload.result)?de.payload:de.payload.result||{};if(te){this.dataSourceSeries$.next(te);let ae=this.pizzagnaService.pizzagna;ae=(0,F.zdu)(ae,`${this.formSeriesComponentPath}.allSeries`,te);const j=(null===(pe=this.pizzagnaService.pizzagna[x.xW.Structure][this.component.componentId].properties)||void 0===pe?void 0:pe.template).findIndex(ze=>ze.id===this.indicatorDataKey);ae=(0,F.zdu)(ae,`${x.xW.Structure}.series.properties.template[${j}].properties.allSeries`,te),ae=d()(this.getPreview(),`chart.${this.previewSeriesPath}`,[]).reduce((ze,Ve)=>(0,F.zdu)(ze,`${x.xW.Data}.${Ve.id}/${this.indicatorDataKey}.properties.allSeries`,te),ae),this.updateFormPizzagna(ae);const Te=`${this.formSeriesComponentPath}.series`,Ee=d()(this.pizzagnaService.pizzagna,Te);if(e()(Ee)){this.shouldReadForm=!1;const ze=te.map(Re=>({id:Re.id,selectedSeriesId:Re.id,label:Re.name})),Ve=(0,F.zdu)(this.getPreview(),`chart.${this.previewSeriesPath}`,ze);this.updatePreview(Ve),this.buildForm(),setTimeout(()=>{this.updateAvailableSeries([]),this.shouldReadForm=!0})}}})}buildForm(){const X=this.getPreview(),q=d()(X,`chart.${this.previewSeriesPath}`,[]),re=q.map(ae=>({id:ae.id,selectedSeriesId:ae.selectedSeriesId})),de=q.map(ae=>ae.id);this.pizzagnaService.createComponentsFromTemplate("series",de);const te=(0,F.zdu)(this.pizzagnaService.pizzagna,`${this.formSeriesComponentPath}.series`,re);this.updateFormPizzagna(te),this.selectedSeriesIds$.next(re.map(ae=>ae.selectedSeriesId)),setTimeout(()=>this.shouldReadForm=!0)}toPreview(X){X.valueChanges.pipe((0,h.R)(this.destroy$)).subscribe(q=>{if(!this.shouldReadForm)return;const re=this.getPreview(),{chart:de}=re,pe=d()(de,this.previewSeriesPath,[]),te=q.map(j=>Object.assign({id:j.id,selectedSeriesId:j.selectedSeriesId},pe.find(ce=>ce.id===j.id))),ae=(0,F.zdu)(re,`chart.${this.previewSeriesPath}`,te);this.updatePreview(ae);const Y=q.map(j=>d()(j,`properties[${j.id}/indicatorData].id`)).filter(j=>!e()(j));this.selectedSeriesIds$.next(Y)})}ngOnDestroy(){this.dataSourceSeries$.complete(),this.selectedSeriesIds$.complete(),super.ngOnDestroy()}updateAvailableSeries(X){var q;if(!this.pizzagnaService.pizzagna)return;let re=this.pizzagnaService.pizzagna;re=(0,F.zdu)(re,`${this.formSeriesComponentPath}.availableSeries`,X);const pe=(null===(q=this.pizzagnaService.pizzagna[x.xW.Structure][this.component.componentId].properties)||void 0===q?void 0:q.template).findIndex(Y=>Y.id===this.indicatorDataKey);re=(0,F.zdu)(re,`${x.xW.Structure}.series.properties.template[${pe}].properties.availableSeries`,X),re=d()(this.pizzagnaService.pizzagna,`${x.xW.Structure}.series.properties.nodes`).reduce((Y,j)=>(0,F.zdu)(Y,`${x.xW.Data}.${j}/${this.indicatorDataKey}.properties.availableSeries`,X),re),this.updateFormPizzagna(re)}subscribeToAvailableDataFieldsChange(){(0,v.a)([this.dataSourceSeries$,this.selectedSeriesIds$]).pipe((0,h.R)(this.destroy$),(0,w.U)(([X,q])=>X.filter(re=>!q.find(de=>de===re.id))),(0,M.x)(N())).subscribe(this.updateAvailableSeries.bind(this))}}return L.\u0275fac=function(X){return new(X||L)(b.LFG(x.nY),b.LFG(T.m),b.LFG(G.p))},L.\u0275prov=b.Yz7({token:L,factory:L.\u0275fac}),L})()},27463:(oe,W,l)=>{"use strict";l.d(W,{l:()=>d});const d=new(l(5e3).OlP)("CONFIGURATOR_CONVERTER")},45122:(oe,W,l)=>{"use strict";l.d(W,{m:()=>O});var s=l(77579),d=l(5e3);let O=(()=>{class e{constructor(){this.previewChanged=new s.x}get preview(){return this._preview}set preview(N){this._preview=N,this.previewChanged.next(N)}}return e.\u0275fac=function(N){return new(N||e)},e.\u0275prov=d.Yz7({token:e,factory:e.\u0275fac}),e})()},67517:(oe,W,l)=>{"use strict";l.d(W,{s:()=>C});var s=l(90733),d=l.n(s),O=l(25878),e=l(64406),R=l(42971),N=l(5e3),A=l(94526);let C=(()=>{class p{constructor(h,w){this.configuratorService=h,this.componentPortalService=w}open(h){if(!h.portalBundle){const M={portal:this.componentPortalService.createComponentPortal(e.b,null),attached:F=>{var G;const x=F.instance;x.formPizzagna=h.formPizzagna,x.formRoot=null===(G=h.paths)||void 0===G?void 0:G.root,x.changeDetector.markForCheck()}};h.portalBundle=M}const w=d()(h.widget);return delete w.pizzagna[O.xW.Data],h.widget=w,this.configuratorService.open(h)}}return p.\u0275fac=function(h){return new(h||p)(N.LFG(R.J),N.LFG(A.$))},p.\u0275prov=N.Yz7({token:p,factory:p.\u0275fac}),p})()},81466:(oe,W,l)=>{"use strict";l.d(W,{PF:()=>e,ay:()=>N,gg:()=>A,yX:()=>R});var s=l(4707),d=l(61135),O=l(30652);const e=new O.JRy("DATA_SOURCE_OUTPUT",()=>new s.t(1)),R=new O.JRy("DATA_SOURCE_DESTROYED"),N=new O.JRy("DATA_SOURCE_CHANGE"),A=new O.JRy("DATA_SOURCE_CREATED",()=>new d.X({payload:void 0}))},16041:(oe,W,l)=>{"use strict";l.d(W,{K:()=>O});var s=l(5e3),d=l(33748);let O=(()=>{class e{constructor(N){this.gridsterItem=N}ngOnChanges(N){N.nuiGridsterItemWidgetId&&(this.gridsterItem.widgetId=this.nuiGridsterItemWidgetId)}}return e.\u0275fac=function(N){return new(N||e)(s.Y36(d.IM,3))},e.\u0275dir=s.lG2({type:e,selectors:[["","nuiGridsterItemWidgetId",""]],inputs:{nuiGridsterItemWidgetId:"nuiGridsterItemWidgetId"},features:[s.TTD]}),e})()},44994:(oe,W,l)=>{"use strict";l.d(W,{t:()=>b});var s=l(90733),d=l.n(s),O=l(77579),e=l(63900),R=l(82722),N=l(34575),A=l(67517),C=l(53450),p=l(75946),v=l.n(p),h=l(68306),w=l(60515),M=l(39646),F=l(70262),G=l(5e3),x=l(30652);let y=(()=>{class T{constructor(L){this.logger=L,this.updateDashboard=z=>X=>new h.y(q=>X.subscribe(re=>{re&&z.removeWidget(re),q.next()}))}handleRemove(L,z,X,q){return this.tryRemove(q,z,X).pipe(this.updateDashboard(L))}tryRemove(L,z,X){return v()(L)?L(z,X).pipe((0,F.K)(q=>(this.logger.error(q),w.E))):(0,M.of)(z)}}return T.\u0275fac=function(L){return new(L||T)(G.LFG(x.mQy))},T.\u0275prov=G.Yz7({token:T,factory:T.\u0275fac,providedIn:"root"}),T})();var k=l(32656);let b=(()=>{class T{constructor(L,z,X,q){this.dashboardComponent=L,this.widgetEditorService=z,this.widgetRemovalService=X,this.widgetTypesService=q,this.destroy$=new O.x}ngOnInit(){this.dashboardComponent.eventBus.getStream(C.Ef).pipe((0,e.w)(L=>{const z=this.dashboardComponent.dashboard.widgets[L.widgetId],X=this.widgetTypesService.getWidgetType(z.type,z.version);return this.widgetEditorService.open({dashboardComponent:this.dashboardComponent,formPizzagna:X.configurator,paths:X.paths.configurator,widget:z,trySubmit:this.dashboardPersistenceHandler&&this.dashboardPersistenceHandler.trySubmit})}),(0,R.R)(this.destroy$)).subscribe(),this.dashboardComponent.eventBus.getStream(C.y4).pipe((0,e.w)(L=>{if(!L.widgetId)throw new Error("event has to have widgetId");const z=L.widgetId,X=this.dashboardPersistenceHandler&&this.dashboardPersistenceHandler.tryRemove,q={dashboardComponent:this.dashboardComponent,widget:d()(this.dashboardComponent.dashboard.widgets[z])};return this.widgetRemovalService.handleRemove(this.dashboardComponent,z,q,X)}),(0,R.R)(this.destroy$)).subscribe()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return T.\u0275fac=function(L){return new(L||T)(G.Y36(N.M,3),G.Y36(A.s),G.Y36(y),G.Y36(k.x))},T.\u0275dir=G.lG2({type:T,selectors:[["","nuiWidgetEditor",""]],inputs:{dashboardPersistenceHandler:["nuiWidgetEditor","dashboardPersistenceHandler"]}}),T})()},22783:(oe,W,l)=>{"use strict";l.d(W,{n:()=>A});var s=l(21503),d=l.n(s),O=l(50772),e=l.n(O),R=l(68921),N=l.n(R);function A(v,...h){const w=h.filter(x=>void 0!==x.previousValue||void 0!==x.currentValue);if(!e()(w,x=>x.currentValue!==x.previousValue))return v;if(1===w.length)return w[0].currentValue;const M=function p(v){for(const h of v){const w=typeof h.currentValue;if("undefined"!==w&&null!=h.currentValue)return d()(h.currentValue)?"object"==typeof h.currentValue[0]?"object[]":"array":h.currentValue.constructor!==Object?"advanced":w}return"undefined"}(w);return["object","object[]"].includes(M)?N()(...w.map(x=>"object"==typeof x.currentValue?Object.keys(x.currentValue||{}):[])).reduce((x,y)=>{const k=null==v||void 0===v[y]?void 0:v[y],b=w.map(T=>({previousValue:void 0===T.previousValue||null==T.previousValue?void 0:T.previousValue[y],currentValue:void 0===T.currentValue||null==T.currentValue?void 0:T.currentValue[y]}));return x[y]=A(k,...b),x},"object[]"===M?[]:{}):function C(v){for(let h=v.length-1;h>=0;h--){const w=v[h].currentValue;if(void 0!==w)return w}}(w)}},87686:(oe,W,l)=>{"use strict";l.d(W,{R:()=>M});var s=l(5e3),d=l(30652),O=l(22783),e=l(53450),R=l(25878),N=l(1892),A=l(42339),C=l(69808),p=l(47969),v=l(47429);function h(F,G){}function w(F,G){if(1&F){const x=s.EpF();s.ynx(0)(1,1,2),s.NdJ("output",function(k){return s.CHM(x),s.oxw().onOutput(k)}),s.YNc(3,h,0,0,"ng-template",3),s.NdJ("attached",function(k){return s.CHM(x),s.MAs(2).attached(k)}),s.BQk()()}if(2&F){const x=s.MAs(2),y=s.oxw();s.xp6(1),s.Q6J("componentId",y.rootNode)("componentType",null==y.pizza[y.rootNode]?null:y.pizza[y.rootNode].componentType)("properties",null==y.pizza[y.rootNode]?null:y.pizza[y.rootNode].properties)("providers",null==y.pizza[y.rootNode]?null:y.pizza[y.rootNode].providers)("outputs",y.outputs),s.xp6(2),s.Q6J("cdkPortalOutlet",x.portal)}}let M=(()=>{class F{constructor(x,y,k){this.pizzagnaService=x,this.logger=y,this.eventBus=k,this.rootNode=e.XM,this.pizzagnaChange=new s.vpe,this.output=new s.vpe,k.getStream(e.M).subscribe(b=>{const T=(0,d.zdu)(this.pizzagna,b.payload.path,b.payload.value);this._pizzagnaBuffer=T,this.pizzagnaChange.emit(T)})}get pizzagna(){return this._pizzagnaBuffer||this._pizzagna}set pizzagna(x){this._pizzagna=x,this._pizzagnaBuffer=null}ngOnChanges(x){if(x.pizzagna){const y=x.pizzagna.previousValue;this.pizzagnaService.updatePizzagna(this.pizzagna),this.pizza=this.mergePizzagnaIntoPizza(this.pizza,y,this.pizzagna),this.pizza&&!this.pizza[this.rootNode]&&this.logger.warn("Pizzagna doesn't contain root node '"+this.rootNode+"'. Pizzagna = ",this.pizzagna),this.pizzagnaService.updateComponents(this.pizza)}}onOutput(x){this.output.emit(x)}mergePizzagnaIntoPizza(x,y,k){return(0,O.n)(x,this.getLayerChanges(y,k,R.xW.Structure),this.getLayerChanges(y,k,R.xW.Configuration),this.getLayerChanges(y,k,R.xW.Data))}getLayerChanges(x,y,k){return{previousValue:this.getLayerSafe(x,k),currentValue:this.getLayerSafe(y,k)}}getLayerSafe(x,y){return x&&x[y]}}return F.\u0275fac=function(x){return new(x||F)(s.Y36(A.p),s.Y36(d.mQy),s.Y36(R.nY))},F.\u0275cmp=s.Xpm({type:F,selectors:[["nui-pizzagna"]],inputs:{rootNode:"rootNode",pizzagna:"pizzagna",outputs:"outputs"},outputs:{pizzagnaChange:"pizzagnaChange",output:"output"},features:[s._Bn([A.p,N.v,{provide:R.nY,useClass:d.Ndp}]),s.TTD],decls:1,vars:1,consts:[[4,"ngIf"],["nuiComponentPortal","",3,"componentId","componentType","properties","providers","outputs","output"],["componentPortal","nuiComponentPortal"],[3,"cdkPortalOutlet","attached"]],template:function(x,y){1&x&&s.YNc(0,w,4,6,"ng-container",0),2&x&&s.Q6J("ngIf",y.pizza&&y.pizza[y.rootNode])},directives:[C.O5,p.$,v.Pl],encapsulation:2}),F})()},47969:(oe,W,l)=>{"use strict";l.d(W,{$:()=>F});var s=l(5e3),d=l(21503),O=l.n(d),e=l(90377),R=l.n(e),N=l(19574),A=l.n(N),C=l(4707),p=l(77579),v=l(82722),h=l(98864),w=l(30652),M=l(94526);let F=(()=>{class G{constructor(y,k,b,T,m){this.injector=y,this.logger=k,this.portalService=b,this.renderer=T,this.providerRegistry=m,this.output=new s.vpe,this.propertiesChanges=new C.t,this.providerInstances={},this.destroy$=new p.x}ngOnInit(){this.logger.debug("Portal created:",this.componentId),this.recreatePortal()}ngAfterViewInit(){Object.keys(this.providerInstances).forEach(y=>{const k=this.providerInstances[y];k.ngAfterViewInit&&k.ngAfterViewInit()})}ngOnChanges(y){let k=!1;const b=y.providers;b&&!b.isFirstChange()&&(this.checkForProviderChanges(b)?(this.logger.debug("Portal recreated (provider change):",this.componentId),this.recreatePortal(),k=!0):this.updateProviderConfigurations(b)),y.componentType&&!y.componentType.isFirstChange()&&!k&&(this.logger.debug("Portal recreated (component change):",this.componentId),this.recreatePortal()),y.properties&&this.propertiesChanges.next(y.properties)}ngOnDestroy(){this.logger.debug("Portal destroyed:",this.componentId),this.destroyProviders(),this.destroy$.next(),this.destroy$.complete()}attached(y){this.component=y.instance,this.renderer.listen(y.location.nativeElement,"click",k=>{(k.ctrlKey||k.metaKey)&&k.shiftKey&&0===k.button&&(console.log("==================== PIZZAGNA DUMP ========================="),console.log("componentId:",this.componentId),console.log("component:",this.component),console.log("componentType:",this.componentType),console.log("properties:",this.properties),console.log("providers:",this.providers),console.log("providerInstances:",this.providerInstances),console.log("============================================================"))});for(const k of Object.keys(this.providerInstances)){const b=this.providerInstances[k];b.setComponent&&b.setComponent(this.component,this.componentId),b.setProviders&&b.setProviders(this.providerInstances,this.componentId)}this.subscribeToOutputs(),this.changesSubscription=this.propertiesChanges.pipe((0,v.R)(this.destroy$)).subscribe(k=>this.applyPropertiesChange(k))}recreatePortal(){this.changesSubscription&&(this.changesSubscription.unsubscribe(),this.changesSubscription=void 0,this.propertiesChanges=new C.t);let y=this.injector;if(this.destroyProviders(),this.providers&&(y=this.updateProviders(y)),this.portal=this.portalService.createComponentPortal(this.componentType,y),this.properties)for(const k of Object.keys(this.properties))this.propertiesChanges.next(new s.WD2(void 0,this.properties,!0))}updateProviders(y){const k=Object.keys(this.providers),b=k.reduce((m,L)=>(this.providers[L].providerId&&(m[L]=this.providerRegistry.getProvider(this.providers[L].providerId)),m),{}),T=this.portalService.createInjector({injector:y,providers:R()(b)});this.providerInstances=k.reduce((m,L)=>{const z=b[L],X=this.providers[L];if(z){const q=T.get(z.provide,null,null),re=O()(q)?q.find(de=>de instanceof z.useClass):q;if(!re)throw new Error("Provider '"+L+"' does not exist.");re.updateConfiguration&&X.properties&&re.updateConfiguration(Object.assign({providerKey:L},X.properties||{})),re.providerKey=L,m[L]=re}else X.providerId&&this.logger.error("There's no registered provider for id",L);return m},this.providerInstances);for(const m of Object.keys(this.providerInstances)){const L=this.providerInstances[m];L.ngOnInit&&L.ngOnInit()}return T}updateProviderConfigurations(y){for(const k of Object.keys(this.providers)){if(!this.providers[k].providerId)return;const b=this.providerInstances[k];if(!b)throw new Error("Provider '"+k+"' does not exist.");const T=y.previousValue[k],m=y.currentValue[k],z=m&&m.properties;(T&&T.properties)!==z&&b.updateConfiguration&&b.updateConfiguration(Object.assign({providerKey:k},z))}}subscribeToOutputs(){if(this.outputs)for(const y of this.outputs.filter(k=>this.component[k]instanceof s.vpe))this.component[y].pipe((0,v.R)(this.destroy$)).subscribe(k=>{this.output.emit({id:y,payload:k})})}checkForProviderChanges(y){const k=y.previousValue?Object.keys(y.previousValue):[],b=y.currentValue?Object.keys(y.currentValue):[];if(k.length!==b.length||A()(k,b).length>0)return!0;const T=Object.keys(y.previousValue).map(L=>y.previousValue[L].providerId),m=Object.keys(y.currentValue).map(L=>y.currentValue[L].providerId);return A()(T,m).length>0}destroyProviders(){if(this.providerInstances)for(const y of Object.keys(this.providerInstances)){const k=this.providerInstances[y];k.ngOnDestroy&&k.ngOnDestroy(),delete this.providerInstances[y]}}applyPropertiesChange(y){let k=y.currentValue;if(!k)return;k=Object.assign(Object.assign({},k),{componentId:this.componentId});const b={};let T=!1;for(const m of Object.keys(k)){const L=this.component[m];k[m]!==L&&(T=!0,this.component[m]=k[m],this.component.ngOnChanges&&(b[m]=new s.WD2(L,k[m],y.isFirstChange())))}if(T){this.component.ngOnChanges&&this.component.ngOnChanges(b);const m=this.component.changeDetector;m?m.markForCheck():this.logger.warn(`Property 'changeDetector' is missing on component '${this.componentType}', so dynamic refresh of given component might not work.`)}}}return G.\u0275fac=function(y){return new(y||G)(s.Y36(s.zs3),s.Y36(w.mQy),s.Y36(M.$),s.Y36(s.Qsj),s.Y36(h.C))},G.\u0275dir=s.lG2({type:G,selectors:[["","nuiComponentPortal",""]],inputs:{componentId:"componentId",componentType:"componentType",properties:"properties",providers:"providers",outputs:"outputs"},outputs:{output:"output"},exportAs:["nuiComponentPortal"],features:[s.TTD]}),G})()},29614:(oe,W,l)=>{"use strict";l.d(W,{Z:()=>d});var s=l(25878);function d(O){return O.providerKey?[O.pizzagnaKey||s.xW.Data,O.componentId,"providers",O.providerKey,"properties",...O.propertyPath].join("."):[O.pizzagnaKey||s.xW.Data,O.componentId,"properties",...O.propertyPath].join(".")}},94526:(oe,W,l)=>{"use strict";l.d(W,{$:()=>N});var s=l(47429),d=l(5e3),O=l(69769),e=l(40801),R=l(30652);let N=(()=>{class A{constructor(p,v){this.componentRegistry=p,this.logger=v}createComponentPortal(p,v){let h;return h="string"==typeof p?this.componentRegistry.getComponentType(p):p,h||(this.logger.error(`Cannot Find Component Type ${p}`),h=O.q),new s.C5(h,null,v)}createInjector(p){return d.zs3.create({providers:p.providers||[],parent:p.injector,name:"Component Injector"})}}return A.\u0275fac=function(p){return new(p||A)(d.LFG(e.h),d.LFG(R.mQy))},A.\u0275prov=d.Yz7({token:A,factory:A.\u0275fac,providedIn:"root"}),A})()},40801:(oe,W,l)=>{"use strict";l.d(W,{h:()=>O});var s=l(5e3),d=l(30652);let O=(()=>{class e{constructor(N){this.logger=N,this.components={}}registerByLateLoadKey(N){this.registerComponentType(N.lateLoadKey,N)}registerComponentType(N,A){this.components[N]=A}getComponentType(N){const A=this.components[N];return A||this.logger.warn("Component '"+N+"' not defined. Available components: "+JSON.stringify(Object.keys(this.components))),A}}return e.\u0275fac=function(N){return new(N||e)(s.LFG(d.mQy))},e.\u0275prov=s.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},1892:(oe,W,l)=>{"use strict";l.d(W,{v:()=>R});var s=l(30652),d=l(25878),O=l(5e3);let R=(()=>{class N{getPizzagnaUpdatedWithComponents(C,p,v){var h;const M=null===(h=C[d.xW.Structure][p].properties)||void 0===h?void 0:h.template;return this.getPizzagnaWithChildren(C,v,M,p)}getPizzagnaWithChildren(C,p,v,h){let M=p.map(F=>({id:F,componentType:"WidgetConfiguratorSectionComponent"})).reduce((F,G)=>this.updateChildPizzagna(F,v,G),C);return M=this.getPizzagnaWithNodesSet(M,h,p),M}updateChildPizzagna(C,p,v){let h=(0,s.zdu)(C,`${d.xW.Structure}.${v.id}`,v);const w=p.map(F=>Object.assign(Object.assign({},F),{id:`${v.id}/${F.id}`}));h=w.reduce((F,G)=>(0,s.zdu)(F,`${d.xW.Structure}.${G.id}`,G),h);const M=w.map(F=>F.id);return h=this.getPizzagnaWithNodesSet(h,v.id,M),h}getPizzagnaWithNodesSet(C,p,v){return(0,s.zdu)(C,`${d.xW.Structure}.${p}.properties.nodes`,v)}}return N.\u0275fac=function(C){return new(C||N)},N.\u0275prov=O.Yz7({token:N,factory:N.\u0275fac}),N})()},42339:(oe,W,l)=>{"use strict";l.d(W,{p:()=>w});var s=l(21503),d=l.n(s),O=l(95835),e=l.n(O),R=l(4707),N=l(30652),A=l(53450),C=l(25878),p=l(29614),v=l(1892),h=l(5e3);let w=(()=>{class M{constructor(G,x){this.eventBus=G,this.dynamicComponentCreator=x,this.pizzaChanged=new R.t(1)}updatePizzagna(G){this.pizzagna=G}updateComponents(G){this.components=G,this.pizzaChanged.next(G)}getComponent(G){const x=this.components[G];if(!x)throw new Error("Component '"+G+"' is not defined!");return x}setProperty(G,x){const y="string"==typeof G?G:(0,p.Z)(G);this.eventBus.getStream(A.M).next({payload:{path:y,value:x}})}createComponentsFromTemplateWithProperties(G,x){const y=x.map(b=>b.id);let k=this.dynamicComponentCreator.getPizzagnaUpdatedWithComponents(this.pizzagna,G,y);for(const b of x)for(const T of Object.keys(b.children))k=(0,N.zdu)(k,`${C.xW.Data}.${T}.properties`,b.children[T]);this.updatePizzagna(k),this.eventBus.getStream(A.M).next({payload:{path:"",value:k}})}createComponentsFromTemplate(G,x){const y=this.dynamicComponentCreator.getPizzagnaUpdatedWithComponents(this.pizzagna,G,x);this.updatePizzagna(y),this.eventBus.getStream(A.M).next({payload:{path:"",value:y}})}removeComponents(G){d()(G)?G.forEach(x=>this.removeComponent(x)):this.removeComponent(G)}removeComponent(G){var x;const y=Object.assign({},this.pizzagna),b=[G,...null===(x=this.pizzagna[C.xW.Structure][G].properties)||void 0===x?void 0:x.nodes],T=[C.xW.Structure,C.xW.Configuration,C.xW.Data];for(const m of T)if(y[m])for(const L of b)y[m]=e()(y[m],L);this.eventBus.getStream(A.M).next({payload:{path:"",value:y}}),this.updatePizzagna(y)}}return M.\u0275fac=function(G){return new(G||M)(h.LFG(C.nY),h.LFG(v.v))},M.\u0275prov=h.Yz7({token:M,factory:M.\u0275fac}),M})()},29242:(oe,W,l)=>{"use strict";l.d(W,{o:()=>d});var s=l(5e3);let d=(()=>{class O{constructor(){this.events={}}registerEvent(R){this.events[R.id]=R}getEvent(R){const N=this.events[R];if(!N)throw new Error("Event with id '"+R+"' is not registered. Registered events are: "+JSON.stringify(Object.keys(this.events)));return N}}return O.\u0275fac=function(R){return new(R||O)},O.\u0275prov=s.Yz7({token:O,factory:O.\u0275fac,providedIn:"root"}),O})()},60343:(oe,W,l)=>{"use strict";l.d(W,{Z:()=>O});var s=l(5e3);const d={">":{comparatorFn:(e,R)=>e>R,label:"Value is greater than"},"<":{comparatorFn:(e,R)=>e<R,label:"Value is less than"},">=":{comparatorFn:(e,R)=>e>=R,label:"Value is greater, or equal to"},"<=":{comparatorFn:(e,R)=>e<=R,label:"Value is less than, or equal to"},"==":{comparatorFn:(e,R)=>e==R,label:"Value is exactly"}};let O=(()=>{class e{constructor(){this.comparators=Object.assign({},d)}registerComparators(N){this.comparators=Object.assign(Object.assign({},this.comparators),N)}clearComparators(){this.comparators={}}getComparators(){return this.comparators}}return e.\u0275fac=function(N){return new(N||e)},e.\u0275prov=s.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},98864:(oe,W,l)=>{"use strict";l.d(W,{C:()=>_i});var s=l(69808),d=l(5e3),O=l(30652),e=l(26365),R=l(82722),N=l(42339),A=l(53450),C=l(25878),h=function(B,J){return function(I,D){J(I,D,B)}};let w=class extends e.i{constructor(J,I,D){super(J,I,D),this.dataSource=I,this.drillstate=[],this.eventBus.getStream(A.EC).pipe((0,R.R)(this.destroy$)).subscribe($=>{var Q;(null===(Q=this.dataSource.busy)||void 0===Q?void 0:Q.value)||this.onDrilldown($)}),this.registerFilters()}updateAdapterProperties(J){this.dataPath=J.dataPath,this.drillstate=J.drillstate||this.drillstate,this.groupBy=J.groupBy,this.componentsConfig=J.componentsConfig,this.navigationBarId=J.navigationBarId}updateOutput(J){const I=this.getWidgetInput(J,this.drillstate.length!==this.groupBy.length);if(this.pizzagnaService.setProperty(`${C.xW.Data}.${this.componentId}.properties`,I),this.navigationBarId){const Q=`${C.xW.Data}.${this.navigationBarId}.properties.navBarConfig.isRoot`,ee=`${C.xW.Data}.${this.navigationBarId}.properties.navBarConfig.buttons.back.disabled`;this.pizzagnaService.setProperty(`${C.xW.Data}.${this.navigationBarId}.properties.navBarConfig.label`,this.drillstate[this.drillstate.length-1]),this.pizzagnaService.setProperty(ee,!!this.drillstate.length),this.pizzagnaService.setProperty(Q,!this.drillstate.length)}}getWidgetInput(J,I){return{[this.dataPath]:J,configuration:this.componentsConfig[I?"group":"leaf"]}}onDrilldown(J){const{payload:I}=J;return I.reset?(this.drillstate=[],void this.eventBus.next(A.RG,{})):I.back?(this.drillstate.length=this.drillstate.length-1,void this.eventBus.next(A.RG,{})):(this.drillstate.push(I.id),void this.eventBus.next(A.RG,{}))}registerFilters(){this.dataSource.registerComponent({group:{componentInstance:{getFilters:()=>({value:this.groupBy})}},drillstate:{componentInstance:{getFilters:()=>({value:this.drillstate})}}})}};w=function(B,J,I,D){var ee,$=arguments.length,Q=$<3?J:null===D?D=Object.getOwnPropertyDescriptor(J,I):D;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)Q=Reflect.decorate(B,J,I,D);else for(var se=B.length-1;se>=0;se--)(ee=B[se])&&(Q=($<3?ee(Q):$>3?ee(J,I,Q):ee(J,I))||Q);return $>3&&Q&&Object.defineProperty(J,I,Q),Q}([h(0,(0,d.tBr)(C.nY)),h(1,(0,d.tBr)(C.Fk)),function(B,J){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:paramtypes",J)}(0,[O.Ndp,Object,N.p])],w);var M=l(77579);let F=(()=>{class B{constructor(I){this.eventBus=I,this.destroy$=new M.x,I.streamAdded.pipe((0,R.R)(this.destroy$)).subscribe(D=>{I.getStream({id:D}).pipe((0,R.R)(this.destroy$)).subscribe($=>{console.log(`${$.id}: `,$.payload)})})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return B.\u0275fac=function(I){return new(I||B)(d.LFG(C.nY))},B.\u0275prov=d.Yz7({token:B,factory:B.\u0275fac}),B})();var G=l(38046),x=l(60343);let y=(()=>{class B{constructor(I,D,$){this.dataSource=I,this.pizzagnaService=D,this.destroy$=new M.x,this.propertyPath="backgroundColor",this.comparators=$.getComparators()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}updateConfiguration(I){(null==I?void 0:I.rules)&&(this.rules=null==I?void 0:I.rules,this.subscribeToDataChanges(),this.checkColorConditions())}setComponent(I,D){this.subscribeToDataChanges(),this.componentId=D}subscribeToDataChanges(){var I;!this.dataSource||(null===(I=this.dsSubscription$)||void 0===I||I.unsubscribe(),this.dsSubscription$=this.dataSource.outputsSubject.pipe((0,R.R)(this.destroy$)).subscribe(D=>{var $;this.latestValueFromDS=(null===($=D.result)||void 0===$?void 0:$.value)||this.latestValueFromDS,this.checkColorConditions()}))}checkColorConditions(){var I,D;if(!this.rules)return;if(0===this.rules.length)return this.setColor(void 0),void(null===(I=this.dsSubscription$)||void 0===I||I.unsubscribe());let $;const Q=this.rules&&[...this.rules].reverse();for(const ee of Q)if(null===(D=this.comparators[ee.comparisonType])||void 0===D?void 0:D.comparatorFn(this.latestValueFromDS,ee.value)){$=ee.color;break}this.setColor($)}setColor(I){this.pizzagnaService.setProperty({componentId:this.componentId,propertyPath:[this.propertyPath]},I)}}return B.\u0275fac=function(I){return new(I||B)(d.LFG(C.Fk,8),d.LFG(N.p),d.LFG(x.Z))},B.\u0275prov=d.Yz7({token:B,factory:B.\u0275fac}),B})();var k=l(33816),b=l.n(k),T=(()=>{return(B=T||(T={})).Warning="var(--nui-color-semantic-warning)",B.Critical="var(--nui-color-semantic-critical)",T;var B})(),X=function(B,J){return function(I,D){J(I,D,B)}};let q=class extends e.i{constructor(J,I,D,$){super(J,I,D),this.numberPipe=$}updateConfiguration(J){this.thresholds=J.thresholds,super.updateConfiguration(J)}processOutput(J){const I=this.processThresholds(J);return this.processNumberFormat(I)}setComponent(J,I){I&&(this.componentId=I)}getThresholdColor(J,I,D){const $=this.getThresholdChecks(J,I,J.reversedThresholds);return $.warningCheck?T.Warning:$.criticalCheck?T.Critical:D}getThresholdChecks(J,I,D){const $=J.warningThresholdValue,Q=J.criticalThresholdValue,ee=!b()($)&&I.value<=$&&I.value>Q,se=I.value<=Q,me=!b()($)&&I.value>=$&&I.value<Q;return{warningCheck:D?ee:me,criticalCheck:D?se:I.value>=Q}}processThresholds(J){var I;if(!J||!(null===(I=this.thresholds)||void 0===I?void 0:I.showThresholds)||"number"!=typeof J.value)return J;const D=this.getThresholdColor(this.thresholds,J,J.backgroundColor);return Object.assign(Object.assign({},J),{backgroundColor:D})}processNumberFormat(J){if("number"!=typeof(null==J?void 0:J.value)||!(null==J?void 0:J.numberFormat))return J;const I=this.numberPipe.transform(J.value,J.numberFormat);return Object.assign(Object.assign({},J),{value:I})}};q=function(B,J,I,D){var ee,$=arguments.length,Q=$<3?J:null===D?D=Object.getOwnPropertyDescriptor(J,I):D;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)Q=Reflect.decorate(B,J,I,D);else for(var se=B.length-1;se>=0;se--)(ee=B[se])&&(Q=($<3?ee(Q):$>3?ee(J,I,Q):ee(J,I))||Q);return $>3&&Q&&Object.defineProperty(J,I,Q),Q}([X(0,(0,d.tBr)(C.nY)),X(1,(0,d.FiY)()),X(1,(0,d.tBr)(C.Fk)),function(B,J){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:paramtypes",J)}(0,[O.Ndp,Object,N.p,s.JJ])],q);var re=l(21503),de=l.n(re),pe=l(61135),te=l(39300),ae=l(71884),Y=l(18505);let j=(()=>{class B{constructor(I,D){this.eventBus=I,this.pizzagnaService=D,this.brokers=[],this.builder=new ce(this.brokers),this.destroySubscriptions$=new M.x,this.getMin=$=>Math.min(...$),this.getMax=$=>Math.max(...$),this.valuesObject=this.builder.valuesObject}updateConfiguration(I){this.properties=I,this.componentId&&this.createPropertiesAndSubscribeToBrokers()}configure(){return this.builder}getBrokers(){return this.brokers}subscribeToBrokers(){this.destroy(),this.brokers.forEach(I=>{I.in$.pipe((0,te.h)(D=>!!I.in$.observers.length),(0,ae.x)(),(0,Y.b)(D=>this.configureValueModel(D)),(0,Y.b)(D=>this.processAndEmitSyncedValue(D,I)),(0,R.R)(this.destroySubscriptions$)).subscribe()})}setComponent(I,D){this.componentId=D,this.updateConfiguration(this.properties)}destroy(){this.destroySubscriptions$.next(),this.destroySubscriptions$.complete()}processAndEmitSyncedValue(I,D){let $=this.getMin;(null==D?void 0:D.type)&&($="min"===D.type?this.getMin:this.getMax);const Q=this.valuesObject[D.id].filter(ee=>ee.targetID&&ee.targetValue).map(ee=>ee.targetValue);D.out$.next(Object.assign(Object.assign({},I),{targetValue:$([...Q])}))}configureValueModel(I){const D=this.valuesObject[I.id].filter($=>$.targetID===I.targetID);D.length?D[0].targetValue=I.targetValue:this.valuesObject[I.id].push({targetID:I.targetID,targetValue:I.targetValue})}createPropertiesAndSubscribeToBrokers(){var I,D;this.tileNodes=null===(I=this.pizzagnaService.getComponent(this.componentId).properties)||void 0===I?void 0:I.nodes;const{scaleSyncConfig:$}=this.properties;(null===(D=this.tileNodes)||void 0===D?void 0:D.length)&&(this.tileNodes.forEach((Q,ee)=>{this.pizzagnaService.setProperty({componentId:Q,pizzagnaKey:C.xW.Data,propertyPath:["syncValuesBroker"]},this.getBrokers())}),$&&de()($)&&($.forEach(Q=>this.configure().addBroker({id:Q.id,type:null==Q?void 0:Q.type})),this.subscribeToBrokers()))}}return B.\u0275fac=function(I){return new(I||B)(d.LFG(C.nY),d.LFG(N.p))},B.\u0275prov=d.Yz7({token:B,factory:B.\u0275fac}),B})();class ce{constructor(J){this.brokers=J,this.valuesObject={}}addBroker(J){const I={id:J.id,targetID:"",targetValue:1};return this.valuesObject[J.id]=new Array,this.brokers.push(Object.assign(Object.assign({},J),this.getDefaultBrokerObject(I,I))),this}getDefaultBrokerObject(J,I){return{in$:new pe.X(J),out$:new pe.X(I)}}}var ie=l(71973),Te=l.n(ie),Ee=l(30836),ze=l.n(Ee),Ve=l(81466);let Re=(()=>{class B{constructor(I,D){this.eventBus=I,this.pizzagnaService=D,this.destroy$=new M.x,this.eventBus.getStream(Ve.PF).pipe((0,R.R)(this.destroy$)).subscribe($=>{this.handleDataSourceOutput($)})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}setComponent(I,D){this.componentId=D}handleDataSourceOutput(I){var D,$,Q,ee;this.pizzagnaService.setProperty({componentId:this.componentId,propertyPath:["fallbackKey"],pizzagnaKey:C.xW.Data},void 0!==(null===($=null===(D=I.payload)||void 0===D?void 0:D.error)||void 0===$?void 0:$.type)?null===(ee=null===(Q=I.payload)||void 0===Q?void 0:Q.error)||void 0===ee?void 0:ee.type.toString():void 0)}}return B.\u0275fac=function(I){return new(I||B)(d.LFG(C.nY),d.LFG(N.p))},B.\u0275prov=d.Yz7({token:B,factory:B.\u0275fac}),B})(),ot=(()=>{class B extends Re{constructor(I,D){super(I,D),this.multipleErrorFallbackKey=C.WE.Unknown,this.errorMap={},this.eventBus.getStream(Ve.yX).pipe((0,R.R)(this.destroy$)).subscribe($=>{this.handleDataSourceDestroyed($)})}updateConfiguration(I){I.multipleErrorFallbackKey&&(this.multipleErrorFallbackKey=I.multipleErrorFallbackKey)}handleDataSourceOutput(I){this.errorMap=this.updateErrorMap(I),this.setFallbackKeyProperty()}handleDataSourceDestroyed(I){var D;(null===(D=I.payload)||void 0===D?void 0:D.componentId)&&delete this.errorMap[I.payload.componentId],this.setFallbackKeyProperty()}setFallbackKeyProperty(){this.pizzagnaService.setProperty({componentId:this.componentId,propertyPath:["fallbackKey"],pizzagnaKey:C.xW.Data},this.getFallbackKey())}getFallbackKey(){if(Te()(this.errorMap))return;const I=ze()(Object.values(this.errorMap));return 1===I.length?I[0]:this.multipleErrorFallbackKey}updateErrorMap(I){var D,$,Q,ee;const se=this.errorMap,me=void 0!==(null===($=null===(D=I.payload)||void 0===D?void 0:D.error)||void 0===$?void 0:$.type)?null===(ee=null===(Q=I.payload)||void 0===Q?void 0:Q.error)||void 0===ee?void 0:ee.type.toString():void 0;return me?me&&(se[I.payload.componentId]=me):delete se[I.payload.componentId],se}}return B.\u0275fac=function(I){return new(I||B)(d.LFG(C.nY),d.LFG(N.p))},B.\u0275prov=d.Yz7({token:B,factory:B.\u0275fac}),B})(),mt=(()=>{class B{constructor(I,D){this.eventBus=I,this.pizzagnaService=D,this.loadingMap={},this.destroy$=new M.x,this.eventBus.getStream(A.QD).pipe((0,R.R)(this.destroy$)).subscribe(({payload:$})=>{(null==$?void 0:$.componentId)&&((null==$?void 0:$.busy)?this.loadingMap[$.componentId]=!0:delete this.loadingMap[$.componentId]),this.pizzagnaService.setProperty({componentId:this.componentId,propertyPath:["active"],pizzagnaKey:C.xW.Data},!Te()(this.loadingMap))})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}setComponent(I,D){this.componentId=D}}return B.\u0275fac=function(I){return new(I||B)(d.LFG(C.nY),d.LFG(N.p))},B.\u0275prov=d.Yz7({token:B,factory:B.\u0275fac}),B})();var ft=l(8817),Ae=l.n(ft),it=l(54004);const ut=/\{.*?\}/g,Tt=/\{|\}/g;function Ct(B,J){const I=B.match(ut);if(!I)return B;let D=B;for(const $ of I){const Q=Ot($);J[Q]?D=D.replace($,J[Q]):console.warn(`There's no ${$} key found in the data: ${J}`)}return D}const Ot=B=>B.replace(Tt,"");let pt=(()=>{class B{constructor(I){this.pizzagnaService=I,this.defaultTrackOn="pizzagna",this.subscriptions=[]}setComponent(I,D){this.component=I,this.componentId=D,this.parentComponentId=function _t(B){const J=B.split("/");return(null==J?void 0:J.length)>1?J[J.length-2]:B}(D),this.initChangeSubscriptions()}updateConfiguration(I){this.configs=null==I?void 0:I.configs}initChangeSubscriptions(){for(const I of this.configs){const D=this.getObservableFor(I);if(!D)return void console.warn("no observable found on 'PizzagnaBroadcasterService', for part: ",I);const $=D.subscribe(Q=>{for(const ee of I.paths){const se=Ct(ee,this);this.pizzagnaService.setProperty(se,Q)}});this.subscriptions.push($)}}getObservableFor(I){return"component"===(I.trackOn||this.defaultTrackOn)?this.getComponentObservableFor(I):this.getPizzagnaObservableFor(I)}getPizzagnaObservableFor(I){return this.pizzagnaService.pizzaChanged.pipe((0,it.U)(D=>Ae()(D,I.key)),(0,ae.x)())}getComponentObservableFor(I){const D=Ae()(this.component,I.key);return null==D?void 0:D.pipe((0,ae.x)())}ngOnDestroy(){for(const I of this.subscriptions)I.unsubscribe()}}return B.\u0275fac=function(I){return new(I||B)(d.LFG(N.p))},B.\u0275prov=d.Yz7({token:B,factory:B.\u0275fac}),B})();var gt=l(97674),_e=l(61455),be=l(42296),yt=l(10948),Jt=l(59551),Mt=l(61874),Yt=l(16372),ht=l.n(Yt),at=l(36216),Me=l(45122);let K=(()=>{class B extends at.a{constructor(I,D,$){super(I,D,$)}get previewComponentId(){return this.componentId.split("/")[0]}updateConfiguration(I){I&&I.formParts&&(this.formParts=I.formParts)}buildForm(){const I=this.getPreview(),D=this.formParts.reduce(($,Q)=>{const ee=`${this.previewComponentId}.${Q.previewPath}`,se=Ae()(I,ee);if(se)for(const me of Q.keys)void 0!==se[me]&&($=(0,O.zdu)($,`${C.xW.Data}.${this.componentId}.properties.${me}`,se[me]));return $},this.pizzagnaService.pizzagna);this.updateFormPizzagna(D)}toPreview(I){I.valueChanges.pipe((0,R.R)(this.destroy$)).subscribe(D=>{const $=this.formParts.reduce((Q,ee)=>{let se=ee.previewOutputPath||ee.previewPath;se=`${this.previewComponentId}.${se}`;const me=Ae()(Q,se),ve=ht()(D,ee.keys),Xe=Object.assign(Object.assign({},me),ve);return(0,O.zdu)(Q,`${se}`,Xe)},this.getPreview());this.updatePreview($)})}}return B.\u0275fac=function(I){return new(I||B)(d.LFG(C.nY),d.LFG(Me.m),d.LFG(N.p))},B.\u0275prov=d.Yz7({token:B,factory:B.\u0275fac}),B})();var u=l(75675),_=l(60167);let f=(()=>{class B extends at.a{constructor(I,D,$){super(I,D,$)}get previewComponentId(){return this.componentId.split("/")[0]}updateConfiguration(I){I&&I.formParts&&(this.formParts=I.formParts)}buildForm(){const I=this.getPreview(),D=this.formParts.reduce(($,Q)=>{const ee=Ae()(I,Q.previewPath),se=null==ee?void 0:ee.find(ve=>ve.id===this.previewComponentId),me=ht()(se,Q.keys);return(0,O.zdu)($,`${C.xW.Data}.${this.componentId}.properties`,me)},this.pizzagnaService.pizzagna);this.updateFormPizzagna(D)}toPreview(I){I.valueChanges.pipe((0,R.R)(this.destroy$)).subscribe(D=>{const $=this.formParts.reduce((Q,ee)=>{const se=ee.previewOutputPath||ee.previewPath,me=Ae()(Q,se),ve=me.findIndex(pi=>pi.id===this.previewComponentId),Xe=me[ve],Pt=ht()(D,ee.keys),ui=Object.assign(Object.assign({},Xe),Pt);return(0,O.zdu)(Q,`${se}[${ve}]`,ui)},this.getPreview());this.updatePreview($)})}}return B.\u0275fac=function(I){return new(I||B)(d.LFG(C.nY),d.LFG(Me.m),d.LFG(N.p))},B.\u0275prov=d.Yz7({token:B,factory:B.\u0275fac}),B})(),S=(()=>{class B extends at.a{constructor(I,D,$){super(I,D,$)}updateConfiguration(I){I&&I.formParts&&(this.formParts=I.formParts)}buildForm(){const I=this.getPreview(),D=this.formParts.reduce(($,Q)=>{const ee=Ae()(I,Q.previewPath);if(ee)for(const se of Q.keys)void 0!==ee[se]&&($=(0,O.zdu)($,`${C.xW.Data}.${this.componentId}.properties.${se}`,ee[se]));return $},this.pizzagnaService.pizzagna);this.updateFormPizzagna(D)}toPreview(I){I.valueChanges.pipe((0,R.R)(this.destroy$)).subscribe(D=>{const $=this.formParts.reduce((Q,ee)=>{const se=ee.previewOutputPath||ee.previewPath,me=Ae()(Q,se),ve=ht()(D,ee.keys),Xe=Object.assign(Object.assign({},me),ve);return(0,O.zdu)(Q,se,Xe)},this.getPreview());this.updatePreview($)})}}return B.\u0275fac=function(I){return new(I||B)(d.LFG(C.nY),d.LFG(Me.m),d.LFG(N.p))},B.\u0275prov=d.Yz7({token:B,factory:B.\u0275fac}),B})();var V=l(42911),H=l(52382),ge=l(64509),Ce=l.n(ge),fe=l(68675),xe=l(94813);let Ke=(()=>{class B extends at.a{constructor(I,D,$){super(I,D,$)}ngAfterViewInit(){super.ngAfterViewInit()}buildForm(){var I,D,$,Q;const ee=null===(I=this.getPreview())||void 0===I?void 0:I.table,se=null===(D=null==ee?void 0:ee.properties)||void 0===D?void 0:D.dataFields,me=null===(Q=null===($=null==ee?void 0:ee.properties)||void 0===$?void 0:$.configuration)||void 0===Q?void 0:Q.columns;let ve=this.pizzagnaService.pizzagna;ve=(0,O.zdu)(ve,`${C.xW.Data}.columns.properties.columns`,null!=me?me:[]),ve=(0,O.zdu)(ve,`${C.xW.Data}.columns.properties.dataFields`,se),this.updateFormPizzagna(ve)}toPreview(I){const D=I.contains("columnsOutput")?I.get("columnsOutput"):I.get("columns");if(!D)throw new Error("FormControl is not defined!");D.valueChanges.pipe((0,R.R)(this.destroy$),(0,ae.x)(Ce())).subscribe($=>{setTimeout(()=>{const se=this.getPreview();this.updatePreview((0,O.zdu)(se,"table.properties.configuration.columns",$))});let ee=this.pizzagnaService.pizzagna;setTimeout(()=>{var se,me,ve,Xe,Pt;ee=(0,O.zdu)(ee,`${C.xW.Structure}.columns.properties.template`,null===(se=this.pizzagnaService.pizzagna[C.xW.Structure].columns.properties)||void 0===se?void 0:se.template),ee=(0,O.zdu)(ee,`${C.xW.Data}.filters.properties.columns`,$),ee=(0,O.zdu)(ee,`${C.xW.Structure}.presentation.properties.nodes`,[...null!==(Pt=null===(Xe=null===(ve=null===(me=null==ee?void 0:ee.structure)||void 0===me?void 0:me.presentation)||void 0===ve?void 0:ve.properties)||void 0===Xe?void 0:Xe.nodes)&&void 0!==Pt?Pt:[]]),this.updateFormPizzagna(ee)})}),this.subscribeToColumnsValueChange()}subscribeToColumnsValueChange(){var I;null===(I=this.component.form.get("columnsOutput"))||void 0===I||I.valueChanges.pipe((0,fe.O)(this.component.form.get("columnsOutput").value),(0,te.h)(D=>D.length>0),(0,Y.b)(()=>this.handleWidthValidation()),(0,it.U)(D=>this.filterColumnsWithoutSpecifiedWidth(D)),(0,it.U)(D=>this.handleColumnsWithoutSpecifiedWidth(D)),function Ie(B,J){return(0,ae.x)((I,D)=>J?J(I[B],D[B]):I[B]===D[B])}("id"),(0,xe.j)("id"),(0,R.R)(this.destroy$)).subscribe(D=>this.setWidthMessages(D))}filterColumnsWithoutSpecifiedWidth(I){return I.filter(D=>D.isActive&&!D.width)}handleColumnsWithoutSpecifiedWidth(I){switch(I.length){case 0:{const D=this.component.form.get("columns").controls.filter(Q=>Ae()(Q,`value.properties[${Q.value.id}/description].isActive`));if(Te()(D))return{id:void 0,label:void 0};const $=D[D.length-1];return console.warn(`Cannot set width for all columns. Resetting "${$.value.label}" width.`),$.patchValue({width:null},{emitEvent:!1}),$.value}case 1:return I[0];default:return{id:void 0,label:void 0}}}handleWidthValidation(){this.component.form.get("columns").controls.forEach(I=>{var D;const Q=I.get(`properties.${I.value.id}/description`);if(!Q)return;const ee=null===(D=Q.get("isActive"))||void 0===D?void 0:D.value,se=Q.get("width");ee?(null==se||se.setValidators([H.kI.min(62)]),null==se||se.markAllAsTouched(),null==se||se.updateValueAndValidity({emitEvent:!1})):(null==se||se.clearValidators(),null==se||se.updateValueAndValidity({emitEvent:!1}))})}setWidthMessages(I){var D;if(!this.pizzagnaService.pizzagna)return;const $="isWidthMessageDisplayed",{pizzagna:Q}=this.pizzagnaService;(null===(D=Q.data.columns.properties)||void 0===D?void 0:D.columns).forEach(se=>this.pizzagnaService.setProperty(`${C.xW.Data}.${se.id}/description.properties.${$}`,!1)),I&&this.pizzagnaService.setProperty(`${C.xW.Data}.${I}/description.properties.${$}`,!0)}}return B.\u0275fac=function(I){return new(I||B)(d.LFG(C.nY),d.LFG(Me.m),d.LFG(N.p))},B.\u0275prov=d.Yz7({token:B,factory:B.\u0275fac}),B})(),Je=(()=>{class B extends at.a{constructor(I,D,$){super(I,D,$)}ngAfterViewInit(){super.ngAfterViewInit()}buildForm(){var I,D,$,Q,ee;let se=this.pizzagnaService.pizzagna;const me=null===(I=this.getPreview())||void 0===I?void 0:I.table,ve=null===($=null===(D=null==me?void 0:me.properties)||void 0===D?void 0:D.configuration)||void 0===$?void 0:$.columns,Xe=null===(ee=null===(Q=null==me?void 0:me.properties)||void 0===Q?void 0:Q.configuration)||void 0===ee?void 0:ee.sorterConfiguration;se=(0,O.zdu)(se,`${C.xW.Data}.filters.properties.columns`,ve),se=(0,O.zdu)(se,`${C.xW.Data}.filters.properties.sorterConfiguration`,Xe),this.updateFormPizzagna(se)}toPreview(I){I.valueChanges.pipe((0,R.R)(this.destroy$)).subscribe(D=>{let $=this.getPreview();$=(0,O.zdu)($,"table.properties.configuration.sorterConfiguration",D.sorterConfiguration),this.updatePreview($),this.buildForm()})}}return B.\u0275fac=function(I){return new(I||B)(d.LFG(C.nY),d.LFG(Me.m),d.LFG(N.p))},B.\u0275prov=d.Yz7({token:B,factory:B.\u0275fac}),B})(),$e=(()=>{class B extends at.a{constructor(I,D,$,Q){super(I,D,$),this.timeframeService=Q}ngAfterViewInit(){super.ngAfterViewInit()}buildForm(){let I=this.pizzagnaService.pizzagna;const D=this.getPreview(),$=Object.keys(this.timeframeService.currentPresets).map(ve=>({id:ve,name:this.timeframeService.currentPresets[ve].name})),Q=`${C.xW.Data}.timeseriesMetadata.properties`;I=(0,O.zdu)(I,`${Q}.timeSpans`,$);const ee=Ae()(D,"timeframeSelection.properties.timeframe.selectedPresetId","last7Days"),se=$.find(ve=>ve.id===ee);se&&(I=(0,O.zdu)(I,`${Q}.startingTimespan`,se));const me=Ae()(D,"chart.properties.configuration");me&&(I=(0,O.zdu)(I,`${Q}.legendPlacement`,me.legendPlacement),I=(0,O.zdu)(I,`${Q}.leftAxisLabel`,me.leftAxisLabel),I=(0,O.zdu)(I,`${Q}.preset`,me.preset)),this.updateFormPizzagna(I)}toPreview(I){I.valueChanges.pipe((0,R.R)(this.destroy$)).subscribe(D=>{let $=this.getPreview();const Q=Ae()(D,"startingTimespan.id");Q&&($=(0,O.zdu)($,"timeframeSelection.properties.timeframe.selectedPresetId",Q));const ee="chart.properties.configuration";$=(0,O.zdu)($,`${ee}.legendPlacement`,Ae()(D,"legendPlacement","")),$=(0,O.zdu)($,`${ee}.leftAxisLabel`,Ae()(D,"leftAxisLabel","")),$=(0,O.zdu)($,`${ee}.preset`,Ae()(D,"preset","")),this.updatePreview($)})}}return B.\u0275fac=function(I){return new(I||B)(d.LFG(C.nY),d.LFG(Me.m),d.LFG(N.p),d.LFG(O.hYR))},B.\u0275prov=d.Yz7({token:B,factory:B.\u0275fac}),B})();var Ye=l(41294);let rt=(()=>{class B extends at.a{constructor(I,D,$){super(I,D,$),this.previewSeriesPath=`chart.providers.${C.Mu.Adapter}.properties.series`}get previewComponentId(){return this.componentId.split("/")[0]}buildForm(){const D=Ae()(this.getPreview(),this.previewSeriesPath,[]).find(ee=>ee.id===this.previewComponentId),Q=(0,O.zdu)(this.pizzagnaService.pizzagna,`${C.xW.Data}.${this.componentId}.properties`,{selectedSeriesId:D&&D.selectedSeriesId});this.updateFormPizzagna(Q)}toPreview(I){I.valueChanges.pipe((0,R.R)(this.destroy$)).subscribe(D=>{const $=D.id,Q=this.getPreview(),ee=Ae()(Q,this.previewSeriesPath,[]),se=ee.findIndex(me=>me.id===this.previewComponentId);if(se>-1){const me=[...ee];me[se]=Object.assign(Object.assign({},me[se]),{selectedSeriesId:$});const ve=(0,O.zdu)(Q,`${this.previewSeriesPath}`,me);this.updatePreview(ve)}})}}return B.\u0275fac=function(I){return new(I||B)(d.LFG(C.nY),d.LFG(Me.m),d.LFG(N.p))},B.\u0275prov=d.Yz7({token:B,factory:B.\u0275fac}),B})();var Be=l(27463),Gt=l(29242),lt=l(47243),Le=l(99567),Qt=l(63776),we=l(294);let _i=(()=>{class B{constructor(I){this.logger=I,this.staticProviders={},this.setProviders({[A.tc]:{provide:gt.q,deps:[C.nY,d.R0b,_e.g]},[A.GN]:{provide:we.q,deps:[C.nY,[new d.FiY,C.Bc],[new d.FiY,Qt.I],Gt.o,N.p]},[A.bZ]:{provide:e.i,deps:[C.nY,[new d.FiY,C.Fk],N.p]},[A.l5]:{provide:be.Y,deps:[C.nY,[new d.FiY,C.Fk],N.p,O.zCP]},[A.R9]:{provide:yt.f,deps:[C.nY,[new d.FiY,C.Fk],N.p]},[A.u1]:{provide:q,deps:[C.nY,[new d.FiY,C.Fk],N.p,s.JJ]},[A.mf]:{provide:w,deps:[C.nY,[new d.FiY,C.Fk],N.p]},[A.tS]:{provide:y,deps:[[new d.FiY,C.Fk],N.p,x.Z]},[A.j4]:{provide:Be.l,useClass:V.c,deps:[C.nY,Me.m,N.p]},[A.dz]:{provide:Be.l,useClass:_.M,deps:[C.nY,Me.m,N.p]},[A.ns]:{provide:Be.l,useClass:u.l,deps:[C.nY,Me.m,N.p]},[A.YN]:{provide:Be.l,useClass:K,deps:[C.nY,Me.m,N.p]},[A.VX]:{provide:Be.l,useClass:S,deps:[C.nY,Me.m,N.p]},[A.Es]:{provide:Be.l,useClass:f,deps:[C.nY,Me.m,N.p]},[A.Gq]:{provide:Be.l,useClass:rt,deps:[C.nY,Me.m,N.p,O.hYR]},[A.dZ]:{provide:Be.l,useClass:$e,deps:[C.nY,Me.m,N.p,O.hYR]},[A.Ip]:{provide:Be.l,useClass:Ye.w,deps:[C.nY,Me.m,N.p]},[A.n5]:{provide:Be.l,useClass:Ke,deps:[C.nY,Me.m,N.p]},[A.LU]:{provide:Be.l,useClass:Je,deps:[C.nY,Me.m,N.p]},[A.IG]:{provide:mt,deps:[C.nY,N.p]},[A.Cz]:{provide:Re,deps:[C.nY,N.p]},[A.C]:{provide:ot,deps:[C.nY,N.p]},[A.$u]:{provide:j,deps:[C.nY,N.p]},[A.DJ]:{provide:G.O,deps:[C.nY,"windowObject",O.mQy,Le.v]},[A.F]:{provide:F,deps:[C.nY]},[A.Vx]:{provide:O.zCP,deps:[]},[A.m_]:{provide:pt,deps:[N.p]},[A.Hp]:{provide:C.m4,useExisting:lt.C,deps:[N.p]},[A.s6]:{provide:C.m4,useExisting:lt.YX,deps:[N.p]},[A.rf]:{provide:C.m4,useExisting:lt.UA,deps:[N.p]},[A.Xh]:{provide:Mt.q,deps:[C.nY,[new d.FiY,Jt.e]]}})}setProviders(I){this.staticProviders=Object.assign({},this.staticProviders,I)}getProvider(I){const D=this.staticProviders[I];return D||(this.logger.warn("No provider registered for id",I),this.logger.warn("Known providers:",Object.keys(this.staticProviders).join(", "))),D}getProviderInstance(I,D){return d.zs3.create({providers:[I],parent:D}).get(C.Fk)}}return B.\u0275fac=function(I){return new(I||B)(d.LFG(O.mQy))},B.\u0275prov=d.Yz7({token:B,factory:B.\u0275fac,providedIn:"root"}),B})()},21366:(oe,W,l)=>{"use strict";l.d(W,{k:()=>R});var s=l(61135),d=l(54004),O=l(30652),e=l(5e3);let R=(()=>{class N{constructor(C,p){this.logger=C,this.className=p,this.state$=new s.X({}),this.stateChanged$=this.state$.asObservable().pipe((0,d.U)(()=>this.getItems())),this._isEmpty=!0}get stateVersion(){return this._stateVersion}get isEmpty(){return this._isEmpty}addItems(C,p={overrideExisting:!0}){const v=this.state$.value;C.forEach(h=>{!v[this.getItemKey(h)]||p.overrideExisting?v[this.getItemKey(h)]=Object.assign({},h):this.logger.warn(`Logger - ${this.className}: item with ${this.getItemKey(h)}\n                    is already registered. Skipping.`)}),this.state$.next(v),C.length>0&&this.updateStateFlags(!1)}getItem(C){return this.state$.value[C]}getItems(){return Object.values(this.state$.value)}reset(){this.state$.next({}),this.updateStateFlags(!0)}ngOnDestroy(){this.state$.complete()}updateStateFlags(C){this._isEmpty=C,this._stateVersion=(0,O.VjN)()}}return N.\u0275fac=function(C){e.$Z()},N.\u0275dir=e.lG2({type:N}),N})()},47243:(oe,W,l)=>{"use strict";l.d(W,{C:()=>R,UA:()=>A,YX:()=>N,qy:()=>C});var s=l(21366),d=l(5e3),O=l(30652);class e extends s.k{constructor(){super(...arguments),this.formattersStateChanged$=this.stateChanged$}addFormatters(v,h={overrideExisting:!0}){super.addItems(v,h)}getFormatters(){return super.getItems()}getItemKey(v){return v.componentType}}let R=(()=>{class p extends e{constructor(h){super(h,"TableFormatterRegistryService")}}return p.\u0275fac=function(h){return new(h||p)(d.LFG(O.mQy))},p.\u0275prov=d.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})(),N=(()=>{class p extends e{constructor(h){super(h,"KpiFormattersRegistryService")}}return p.\u0275fac=function(h){return new(h||p)(d.LFG(O.mQy))},p.\u0275prov=d.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})(),A=(()=>{class p extends e{constructor(h){super(h,"ProportionalDonutContentFormattersRegistryService")}}return p.\u0275fac=function(h){return new(h||p)(d.LFG(O.mQy))},p.\u0275prov=d.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})(),C=(()=>{class p extends e{constructor(h){super(h,"ProportionalLegendFormattersRegistryService")}}return p.\u0275fac=function(h){return new(h||p)(d.LFG(O.mQy))},p.\u0275prov=d.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})()},53450:(oe,W,l)=>{"use strict";l.d(W,{$d:()=>yt,$u:()=>it,C:()=>Ae,Cz:()=>ft,DJ:()=>_t,EC:()=>m,Ef:()=>C,Es:()=>Ve,F:()=>ut,GN:()=>ce,Gq:()=>ot,Hp:()=>Ot,IG:()=>mt,Ip:()=>j,LU:()=>Te,M:()=>F,MO:()=>p,N9:()=>k,QD:()=>y,R1:()=>T,R9:()=>X,RG:()=>R,VX:()=>ze,Vx:()=>Ct,XM:()=>e,Xh:()=>be,Xi:()=>w,YN:()=>Re,b1:()=>b,bZ:()=>z,dZ:()=>Y,df:()=>N,dz:()=>te,j4:()=>pe,j7:()=>v,kV:()=>M,l5:()=>Ee,m_:()=>Tt,mf:()=>re,n5:()=>ie,ns:()=>ae,pV:()=>h,re:()=>G,rf:()=>gt,s6:()=>pt,tS:()=>de,tc:()=>L,u1:()=>q,xZ:()=>x,y4:()=>A});var s=l(61135),d=l(4707),O=l(30652);const e="/",R=new O.JRy("REFRESH"),N=new O.JRy("SCROLL_NEXT_PAGE"),A=new O.JRy("WIDGET_REMOVE"),C=new O.JRy("WIDGET_EDIT"),p=new O.JRy("WIDGET_CREATE"),v=new O.JRy("WIDGET_READY"),h=new O.JRy("WIDGET_RESIZE"),w=new O.JRy("WIDGET_POSITION_CHANGE"),M=new O.JRy("WIDGET_SEARCH",()=>new s.X({payload:""})),F=new O.JRy("SET_PROPERTY_VALUE"),G=new O.JRy("SET_TIMEFRAME"),x=new O.JRy("PREVIEW_EVENT"),y=new O.JRy("DATA_SOURCE_BUSY"),k=new O.JRy("DASHBOARD_EDIT_MODE",()=>new d.t(1)),b=new O.JRy("INTERACTION"),T=new O.JRy("DATA_SOURCE_INVOKED"),m=new O.JRy("DRILLDOWN"),L="NOVA_DATASOURCE_INTERVAL_REFRESHER",z="NOVA_DATASOURCE_ADAPTER",X="NOVA_TIMESERIES_DATASOURCE_ADAPTER",q="NOVA_KPI_DATASOURCE_ADAPTER",re="NOVA_DRILLDOWN_DATASOURCE_ADAPTER",de="NOVA_KPI_COLOR_PRIORITIZER",pe="NOVA_TITLE_AND_DESCRIPTION_CONVERTER",te="NOVA_PROPORTIONAL_WIDGET_CHART_OPTIONS_CONVERTER",ae="NOVA_KPI_TILES_CONVERTER",Y="NOVA_TIMESERIES_METADATA_CONVERTER",j="NOVA_TIMESERIES_SERIES_CONVERTER",ce="NOVA_DASHBOARD_EVENT_PROXY",ie="NOVA_TABLE_COLUMNS_CONVERTER",Te="NOVA_TABLE_FILTERS_CONVERTER",Ee="NOVA_TABLE_DATASOURCE_ADAPTER",ze="NOVA_GENERIC_CONVERTER",Ve="NOVA_GENERIC_ARRAY_CONVERTER",Re="NOVA_KPI_SECTION_CONVERTER",ot="NOVA_TIMESERIES_TILE_INDICATOR_DATA_CONVERTER",mt="NOVA_LOADING_ADAPTER",ft="NOVA_STATUS_CONTENT_FALLBACK_ADAPTER",Ae="NOVA_KPI_STATUS_CONTENT_FALLBACK_ADAPTER",it="NOVA_KPI_SCALE_SYNC_BROKER",_t="NOVA_URL_INTERACTION_HANDLER",ut="NOVA_EVENT_BUS_DEBUGGER",Tt="NOVA_PIZZAGNA_BROADCASTER",Ct="NOVA_VIRTUAL_VIEWPORT_MANAGER",Ot="NOVA_TABLE_FORMATTERS_REGISTRY",pt="NOVA_KPI_FORMATTERS_REGISTRY",gt="NOVA_PROPORTIONAL_CONTENT_FORMATTERS_REGISTRY",be="NOVA_CONFIGURATOR_DATA_SOURCE_MANAGER",yt={id:"CHART_METRIC_REMOVE"}},99567:(oe,W,l)=>{"use strict";l.d(W,{v:()=>O});var s=l(5e3),d=l(30652);let O=(()=>{class e{constructor(N){this.logger=N}template(N,A){const C=new RegExp(/\$\{([a-zA-Z0-9.]*)\}/g);return N.replace(C,(p,v)=>{var h;try{return null!==(h=this.evaluate(v.split("."),A))&&void 0!==h?h:""}catch(w){return this.logger.error(w),""}})}evaluate(N,A){return N.reduce((C,p)=>C[p],A)}}return e.\u0275fac=function(N){return new(N||e)(s.LFG(d.mQy))},e.\u0275prov=s.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},63776:(oe,W,l)=>{"use strict";l.d(W,{I:()=>d});var s=l(5e3);let d=(()=>{class O{updateWidget(R){this.widget=R}getWidget(){return this.widget}}return O.\u0275fac=function(R){return new(R||O)},O.\u0275prov=s.Yz7({token:O,factory:O.\u0275fac}),O})()},294:(oe,W,l)=>{"use strict";l.d(W,{q:()=>w});var s=l(12498),d=l.n(s),O=l(30836),e=l.n(O),R=l(77579),N=l(82722),A=l(42339),C=l(25878),p=l(5e3),v=l(63776),h=l(29242);let w=(()=>{class M{constructor(G,x,y,k,b){this.pizzagnaBus=G,this.dashboardBus=x,this.widgetConfigurationService=y,this.eventRegistry=k,this.pizzagnaService=b,this.upstreamSubscriptions={},this.downstreamSubscriptions={},this.destroy$=new R.x}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}setComponent(G){this.component=G}updateConfiguration(G){this.providerKey=G.providerKey,this.upstreams=G.upstreams,this.downstreams=G.downstreams,this.upstreams&&this.registerUpstreamSubscriptions(...this.upstreams),this.downstreams&&this.registerDownstreamSubscriptions(...this.downstreams)}addUpstream(G){this.addStream(G,"upstreams")}addDownstream(G){this.addStream(G,"downstreams")}addStream(G,x){const y=e()((this[x]||[]).concat(G.id));this[x]=y,this.component&&this.pizzagnaService.setProperty({componentId:this.component.componentId,pizzagnaKey:C.xW.Data,providerKey:this.providerKey,propertyPath:[x]},y)}registerUpstreamSubscriptions(...G){!this.dashboardBus||this.registerSubscriptions(G,this.upstreamSubscriptions,this.pizzagnaBus,(x,y)=>{const k=this.widgetConfigurationService.getWidget().id;this.dashboardBus.getStream(x).next(Object.assign({},y,{widgetId:k}))})}registerDownstreamSubscriptions(...G){!this.dashboardBus||this.registerSubscriptions(G,this.downstreamSubscriptions,this.dashboardBus,(x,y)=>{const k=this.widgetConfigurationService.getWidget().id;(void 0===y.widgetId||k===y.widgetId)&&this.pizzagnaBus.getStream(x).next(y)})}registerSubscriptions(G=[],x,y,k){const b=G?d()(G,T=>T):null;for(const T of Object.keys(x))(!b||!b[T])&&(x[T].unsubscribe(),delete x[T]);for(const T of Object.keys(null!=b?b:{}).filter(m=>!x[m])){const m=this.eventRegistry.getEvent(T);x[T]=y.getStream(m).pipe((0,N.R)(this.destroy$)).subscribe(L=>{k(m,L)})}}}return M.\u0275fac=function(G){return new(G||M)(p.LFG(C.nY),p.LFG(C.Bc,8),p.LFG(v.I,8),p.LFG(h.o),p.LFG(A.p))},M.\u0275prov=p.Yz7({token:M,factory:M.\u0275fac}),M})()},32656:(oe,W,l)=>{"use strict";l.d(W,{x:()=>A});var s=l(69754),d=l.n(s),O=l(34793),e=l.n(O),R=l(25878),N=l(5e3);let A=(()=>{class C{constructor(){this.widgetTypes={}}registerWidgetType(v,h,w){let M=this.widgetTypes[v];M||(M=[],this.widgetTypes[v]=M),M.length<h&&(M.length=h),M[h-1]=w}getWidgetType(v,h){const w=this.widgetTypes[v];if(!w||0===w.length)throw new Error("Type '"+v+"' not found in the registry. Available types: "+Object.keys(this.widgetTypes).join(", "));if(void 0!==h&&(h<=0||w.length<h))throw new Error("Version "+h+" for widget type '"+v+"' not registered. Max available version is "+w.length);return w[(void 0===h?w.length:h)-1]}mergeWithWidgetType(v){const h=this.getWidgetType(v.type,v.version);return Object.assign(Object.assign({},v),{pizzagna:d()(v.pizzagna,h.widget)})}setNode(v,h,w,M){var F,G;const k=`${h}.${R.xW.Structure}.${(null===(G=null===(F=v.paths)||void 0===F?void 0:F[h])||void 0===G?void 0:G[w])||w}`;e()(v,k,M)}}return C.\u0275fac=function(v){return new(v||C)},C.\u0275prov=N.Yz7({token:C,factory:C.\u0275fac}),C})()},25878:(oe,W,l)=>{"use strict";l.d(W,{AC:()=>p,B5:()=>A,Bc:()=>O,Fk:()=>e,Mu:()=>C,Nc:()=>w,WE:()=>M,m4:()=>R,nY:()=>d,ni:()=>v,xW:()=>h});var s=l(5e3);const d=new s.OlP("PIZZAGNA_EVENT_BUS"),O=new s.OlP("DASHBOARD_EVENT_BUS"),e=new s.OlP("DATA_SOURCE"),R=new s.OlP("FORMATTERS_REGISTRY"),A=(new s.OlP("TEST_REGISTRY"),new s.OlP("HEADER_LINK_PROVIDER"));var C=(()=>{return(F=C||(C={})).DataSource="dataSource",F.Adapter="adapter",F.Converter="converter",F.Broadcaster="broadcaster",F.Refresher="refresher",F.EventProxy="eventProxy",F.LoadingAdapter="loadingAdapter",F.ContentFallbackAdapter="contentFallbackAdapter",F.InteractionHandler="interactionHandler",F.EventBusDebugger="eventBusDebugger",F.KpiColorPrioritizer="kpiColorPrioritizer",F.FormattersRegistry="formattersRegistry",F.DataSourceManager="dataSourceManager",C;var F})(),p=(()=>{return(F=p||(p={})).Root="root",F.DataSourceConfigComponentType="dataSourceConfigComponentType",F.TileDescriptionConfigComponentType="tileDescriptionConfigComponentType",F.DataSourceProviders="dataSourceProviders",F.Formatters="formatters",F.TileDescriptionBackgroundColors="tileDescriptionBackgroundColors",F.TileBackgroundColorRulesBackgroundColors="tileBackgroundColorRulesBackgroundColors",p;var F})(),v=(()=>{return(F=v||(v={})).Interactivity="interactivity",F.DisableTableColumnGeneration="disableTableColumnGeneration",v;var F})(),h=(()=>{return(F=h||(h={})).Structure="structure",F.Configuration="configuration",F.Data="data",h;var F})(),w=(()=>{return(F=w||(w={})).CRITICAL="critical",F.WARNING="warning",F.DEFAULT="default",w;var F})(),M=(()=>{return(F=M||(M={})).Unknown="0",F.Ok="200",F.Forbidden="403",F.NotFound="404",M;var F})()},55413:(oe,W,l)=>{"use strict";l.d(W,{w:()=>s});var s=(()=>{return(d=s||(s={})).None="None",d.Right="Right",d.Bottom="Bottom",s;var d})()},50793:(oe,W,l)=>{"use strict";l.d(W,{X:()=>e});var s=l(16134),d=l(61621);const e=[{componentType:l(14366).a.lateLoadKey,label:$localize`No Formatter`,dataTypes:{value:null}},{componentType:d.s.lateLoadKey,label:$localize`Link`,configurationComponent:"LinkConfiguratorComponent",dataTypes:{value:"label",link:"link"}},{componentType:s.C.lateLoadKey,label:$localize`Icon`,dataTypes:{value:"string"}}]},30179:(oe,W,l)=>{"use strict";l.d(W,{hiK:()=>xi.h,p3D:()=>Qe.p,Fk3:()=>m.Fk,ay7:()=>ke.ay,PFv:()=>ke.PF,vXf:()=>Vi,tFi:()=>oc,XMI:()=>T.XM,wz0:()=>sc,NlZ:()=>rc,pPd:()=>Oc,MXM:()=>w.M,cY_:()=>An,dsi:()=>hn,vHB:()=>mn,O5k:()=>wi,TAb:()=>Gi,gIB:()=>Zt,B:()=>x,lc0:()=>Ji,Ksf:()=>M,PIV:()=>St,AOA:()=>Ki,B5u:()=>m.B5,WEY:()=>m.WE,Cg1:()=>$i.C,ZhR:()=>Ce.Z,ufE:()=>j,Klf:()=>di,woB:()=>we.w,s9y:()=>ei.s,vB5:()=>gt,fp5:()=>Mt,mf:()=>T.mf,VXI:()=>T.VX,tSO:()=>T.tS,u1$:()=>T.u1,$uq:()=>T.$u,j4g:()=>T.j4,DJm:()=>T.DJ,Qpk:()=>so,Pi:()=>Tc,nYw:()=>m.nY,ntI:()=>Ui,xW5:()=>m.xW,khc:()=>Ie,UAh:()=>ge.UA,qy4:()=>ge.qy,EMX:()=>Le,CNH:()=>S.C,aDR:()=>Bt.a,g4s:()=>hi.g,PEA:()=>ti,aAT:()=>Re,Car:()=>ge.C,CKZ:()=>Pe,D9N:()=>nt,L9g:()=>vt,Usc:()=>Rt,Q$d:()=>tt,MOJ:()=>T.MO,zer:()=>Nt,CyH:()=>xt,niB:()=>m.ni,ACc:()=>m.AC,Muk:()=>m.Mu,$Ie:()=>oo,jFY:()=>He,xTe:()=>H.x,GE5:()=>Cc,Amp:()=>ai,j5E:()=>ct,LtV:()=>li,O9d:()=>At});var s=l(69808),d=l(30652),O=l(92120),e=l(5e3);let R=(()=>{class n{constructor(t){this.changeDetector=t,this.defaultClasses="d-flex flex-column justify-content-center w-100 p-3",this.elementClass=""}ngOnInit(){this.classNames=`${this.defaultClasses} ${this.elementClass}`}}return n.lateLoadKey="WidgetErrorComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-widget-error"]],hostVars:2,hostBindings:function(t,i){2&t&&e.Tol(i.classNames)},inputs:{image:"image",title:"title",description:"description",elementClass:"elementClass"},decls:6,vars:3,consts:[[3,"image"],[1,"widget-error__title"],[1,"d-flex","justify-content-center","text-center"]],template:function(t,i){1&t&&(e._UZ(0,"nui-image",0),e.TgZ(1,"div",1)(2,"strong"),e._uU(3),e.qZA()(),e.TgZ(4,"div",2),e._uU(5),e.qZA()),2&t&&(e.Q6J("image",i.image),e.xp6(3),e.Oqu(i.title),e.xp6(2),e.Oqu(i.description))},directives:[d.cuP],styles:[".widget-error__title[_ngcontent-%COMP%]{display:flex;justify-content:center;text-align:center;margin-top:20px;margin-bottom:10px}"]}),n})(),A=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[s.ez,d.sF0],s.ez]}),n})();var C=l(8083),p=l(52382),v=l(33748),h=l(85279),w=l(34575),M=(()=>{return(n=M||(M={}))[n.URL=0]="URL",n[n.HTML=1]="HTML",M;var n})(),F=l(22313);const G=["anchor"];let x=(()=>{class n{constructor(t,i,o){this.changeDetector=t,this.document=i,this.domSanitizer=o,this.sanitized=!0,this.elementClass=""}ngOnInit(){this.validateAndApplyEmbeddedContent()}ngOnChanges(t){t.customEmbeddedContent&&!t.customEmbeddedContent.firstChange&&this.validateAndApplyEmbeddedContent()}validateAndApplyEmbeddedContent(){const t=this.sanitized&&this.sanitizeContext(this.mode===M.URL?e.q3G.URL:e.q3G.HTML);if(this.anchor.nativeElement.innerHTML="",this.mode===M.URL){const i=this.document.createElement("iframe");i.src=this.sanitized?t:this.customEmbeddedContent,i.width="100%",i.height="100%",this.anchor.nativeElement.appendChild(i)}else this.anchor.nativeElement.innerHTML=this.sanitized?t:this.customEmbeddedContent}sanitizeContext(t){var i;return this.domSanitizer.sanitize(t,null===(i=this.customEmbeddedContent)||void 0===i?void 0:i.trim())}}return n.lateLoadKey="EmbeddedContentComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(s.K0),e.Y36(F.H7))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-embedded-content"]],viewQuery:function(t,i){if(1&t&&e.Gf(G,7),2&t){let o;e.iGM(o=e.CRH())&&(i.anchor=o.first)}},hostVars:2,hostBindings:function(t,i){2&t&&e.Tol(i.elementClass)},inputs:{mode:"mode",customEmbeddedContent:"customEmbeddedContent",sanitized:"sanitized",elementClass:"elementClass"},features:[e.TTD],decls:2,vars:0,consts:[[2,"width","100%","height","100%"],["anchor",""]],template:function(t,i){1&t&&e._UZ(0,"div",0,1)},encapsulation:2,changeDetection:0}),n})();var y=l(33816),k=l.n(y);function b(n,a){const{dataFieldIds:t}=n.properties||{};let i;return i=t?Object.keys(t).reduce((o,r)=>(o[r]=a[t[r]],o),{}):{value:a.value},i}var T=l(53450),m=l(25878),L=l(47969),z=l(47429);function X(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"a",4),e.GkF(2,5),e.qZA(),e.BQk()),2&n){const t=e.oxw(),i=e.MAs(4);e.xp6(1),e.Q6J("href",t.widgetData.link,e.LSH),e.xp6(1),e.Q6J("ngTemplateOutlet",i)}}function q(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",6),e.NdJ("click",function(){return e.CHM(t),e.oxw().onInteraction()}),e.GkF(2,5),e.qZA(),e.BQk()}if(2&n){e.oxw();const t=e.MAs(4);e.xp6(2),e.Q6J("ngTemplateOutlet",t)}}function re(n,a){}function de(n,a){if(1&n){const t=e.EpF();e.ynx(0,15,16),e.TgZ(2,"div",17)(3,"span",18),e.YNc(4,re,0,0,"ng-template",19),e.NdJ("attached",function(o){return e.CHM(t),e.MAs(1).attached(o)}),e.qZA()(),e.BQk()}if(2&n){const t=e.MAs(1),i=e.oxw(2);let o,r;e.Q6J("componentType",null==i.configuration||null==i.configuration.formatters||null==i.configuration.formatters.Value||null==i.configuration.formatters.Value.formatter?null:i.configuration.formatters.Value.formatter.componentType)("properties",i.formattersProperties.Value),e.xp6(3),e.Q6J("ngClass","IconFormatterComponent"===(null==i.configuration||null==i.configuration.formatters||null==i.configuration.formatters.Value||null==i.configuration.formatters.Value.formatter?null:i.configuration.formatters.Value.formatter.componentType)?"without-filter":"")("useZoom",!1)("scaleIN$",null==(o=i.getScaleBroker("value"))?null:o.out$)("scaleOUT$",null==(r=i.getScaleBroker("value"))?null:r.in$),e.xp6(1),e.Q6J("cdkPortalOutlet",t.portal)}}const pe=function(n){return{"background-color":n}},te=function(n){return{color:n}};function ae(n,a){if(1&n&&(e._UZ(0,"div",7),e.TgZ(1,"div",8)(2,"div",9)(3,"div",10)(4,"span",11),e._uU(5),e.qZA()(),e.YNc(6,de,5,7,"ng-container",12),e.TgZ(7,"div",13)(8,"span",14),e._uU(9),e.qZA()()()()),2&n){const t=e.oxw(),i=e.MAs(6);let o,r,c,g;e.ekj("nui-kpi-indicator--interactive",t.interactive),e.Q6J("ngStyle",e.VKq(18,pe,t.backgroundColor||(null==t.widgetData?null:t.widgetData.backgroundColor))),e.xp6(1),e.Q6J("ngStyle",e.VKq(20,te,(null==t.widgetData?null:t.widgetData.textColor)||t.backgroundColor||(null==t.widgetData?null:t.widgetData.backgroundColor)||t.defaultColor)),e.xp6(2),e.Q6J("title",null==t.widgetData?null:t.widgetData.label),e.xp6(1),e.Q6J("useZoom",!1)("minScale",.5)("scaleIN$",null==(o=t.getScaleBroker("label"))?null:o.out$)("scaleOUT$",null==(r=t.getScaleBroker("label"))?null:r.in$),e.xp6(1),e.Oqu(null==t.widgetData?null:t.widgetData.label),e.xp6(1),e.Q6J("ngIf",null==t.configuration||null==t.configuration.formatters?null:t.configuration.formatters.Value)("ngIfElse",i),e.xp6(1),e.Q6J("title",null==t.widgetData?null:t.widgetData.units),e.xp6(1),e.Q6J("useZoom",!1)("scaleIN$",null==(c=t.getScaleBroker("units"))?null:c.out$)("scaleOUT$",null==(g=t.getScaleBroker("units"))?null:g.in$)("minScale",.5),e.xp6(1),e.Oqu(null==t.widgetData?null:t.widgetData.units)}}function Y(n,a){if(1&n&&(e.TgZ(0,"div",20)(1,"span",21),e._uU(2),e.qZA()()),2&n){const t=e.oxw();let i,o;e.Udp("font-size",null==t.widgetData?null:t.widgetData.fontSize),e.Q6J("title",null==t.widgetData?null:t.widgetData.value),e.xp6(1),e.Q6J("useZoom",!1)("scaleIN$",null==(i=t.getScaleBroker("value"))?null:i.out$)("scaleOUT$",null==(o=t.getScaleBroker("value"))?null:o.in$),e.xp6(1),e.hij(" ",null==t.widgetData?null:t.widgetData.value,"")}}let j=(()=>{class n{constructor(t,i,o){this.changeDetector=t,this.dataSource=i,this.eventBus=o,this.busy=!1,this.elementClass="",this.defaultColor="var(--nui-color-bg-secondary)"}get interactive(){var t,i,o,r,c;return((null===(t=this.configuration)||void 0===t?void 0:t.interactive)||(null===(r=null===(o=null===(i=this.dataSource)||void 0===i?void 0:i.features)||void 0===o?void 0:o.getFeatureConfig(m.ni.Interactivity))||void 0===r?void 0:r.enabled))&&!k()(null===(c=this.widgetData)||void 0===c?void 0:c.value)||!1}onInteraction(){!this.interactive||this.eventBus.getStream(T.b1).next({payload:{data:this.widgetData}})}getScaleBroker(t){if(this.syncValuesBroker)return this.syncValuesBroker.find(i=>i.id===t)}ngOnChanges(t){var i;if(t.configuration){const o=t.configuration.currentValue.formatters;o&&(this.formattersProperties=this.getFormatterProperties(o))}t.widgetData&&(null===(i=this.configuration)||void 0===i?void 0:i.formatters)&&(this.formattersProperties=this.getFormatterProperties(this.configuration.formatters))}getFormatterProperties(t){return Object.keys(t).reduce((r,c)=>{var g;const E=null===(g=t[c])||void 0===g?void 0:g.formatter;return E&&(r[c]={data:b(E,this.widgetData)}),r},{})}}return n.lateLoadKey="KpiComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(m.Fk,8),e.Y36(m.nY))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-kpi"]],hostVars:2,hostBindings:function(t,i){2&t&&e.Tol(i.elementClass)},inputs:{widgetData:"widgetData",backgroundColor:"backgroundColor",syncValuesBroker:"syncValuesBroker",configuration:"configuration",busy:"busy"},features:[e.TTD],decls:7,vars:3,consts:[["nui-busy","",1,"w-100","h-100",3,"busy"],[4,"ngIf"],["kpiContent",""],["kpiValueRaw",""],[1,"nui-kpi-indicator",3,"href"],[3,"ngTemplateOutlet"],[1,"nui-kpi-indicator",3,"click"],[1,"nui-kpi-indicator__background",3,"ngStyle"],[1,"nui-kpi-indicator__text",3,"ngStyle"],[1,"nui-kpi-indicator__zoom-container"],[1,"nui-kpi-indicator__description",3,"title"],["nuiZoomContent","",3,"useZoom","minScale","scaleIN$","scaleOUT$"],["nuiComponentPortal","","componentId","KpiValueFormatter",3,"componentType","properties",4,"ngIf","ngIfElse"],[1,"nui-kpi-indicator__units",3,"title"],["nuiZoomContent","",3,"useZoom","scaleIN$","scaleOUT$","minScale"],["nuiComponentPortal","","componentId","KpiValueFormatter",3,"componentType","properties"],["componentPortal","nuiComponentPortal"],[1,"nui-kpi-indicator__value"],["nuiZoomContent","",3,"ngClass","useZoom","scaleIN$","scaleOUT$"],[3,"cdkPortalOutlet","attached"],[1,"nui-kpi-indicator__value",3,"title"],["nuiZoomContent","",3,"useZoom","scaleIN$","scaleOUT$"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,X,3,2,"ng-container",1),e.YNc(2,q,3,1,"ng-container",1),e.qZA(),e.YNc(3,ae,10,22,"ng-template",null,2,e.W1O),e.YNc(5,Y,3,7,"ng-template",null,3,e.W1O)),2&t&&(e.Q6J("busy",i.busy),e.xp6(1),e.Q6J("ngIf",null==i.widgetData?null:i.widgetData.link),e.xp6(1),e.Q6J("ngIf",!(null!=i.widgetData&&i.widgetData.link)))},directives:[d.ERI,s.O5,s.tP,s.PC,d.mEK,L.$,s.mk,z.Pl],styles:[".nui-kpi-indicator[_ngcontent-%COMP%]{position:relative;display:block;height:100%;width:100%}.nui-kpi-indicator__background[_ngcontent-%COMP%]{height:100%;width:100%;background-color:var(--nui-color-bg-secondary,#fafafa);color:var(--nui-color-text-default,#111)}.nui-kpi-indicator__text[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;pointer-events:none}.nui-kpi-indicator__text[_ngcontent-%COMP%]   *[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{filter:invert(1) grayscale(1) contrast(100)}.nui-kpi-indicator__value[_ngcontent-%COMP%]{font-size:54px;font-weight:600;margin:auto 0;min-width:100%;white-space:nowrap;display:flex;align-items:center;justify-content:center;height:100%;min-height:5px;max-height:200px}.nui-kpi-indicator__value[_ngcontent-%COMP%] > span.without-filter[_ngcontent-%COMP%]{filter:unset}.nui-kpi-indicator__units[_ngcontent-%COMP%]{font-size:16px;font-weight:600;min-width:0;margin-bottom:auto;display:flex;align-items:center;justify-content:center;height:100%;min-height:10px;max-height:45px}.nui-kpi-indicator__units[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;-ms-text-overflow:ellipsis;text-overflow:ellipsis}.nui-kpi-indicator__description[_ngcontent-%COMP%]{font-size:16px;font-weight:600;min-width:0;margin-top:auto;display:flex;align-items:center;justify-content:center;height:100%;min-height:10px;max-height:45px}.nui-kpi-indicator__description[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;-ms-text-overflow:ellipsis;text-overflow:ellipsis}.nui-kpi-indicator__zoom-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;grid-template-rows:30% 40% 30%;width:100%;height:100%}.nui-kpi-indicator--interactive[_ngcontent-%COMP%]{cursor:pointer}.nui-kpi-indicator--interactive[_ngcontent-%COMP%]:hover{filter:brightness(90%)}"],changeDetection:0}),n})();var ce=l(42339),ie=l(77579),Te=l(22783);let Ee=(()=>{class n{constructor(t,i,o){this.changeDetector=t,this.pizzagnaService=i,this.logger=o,this.destroyed$=new ie.x}ngOnChanges(t){(t.nodes||t.template)&&this.updateNodeConfigs({changesNodes:t.nodes,changesTemplate:t.template})}ngDoCheck(){this.checkNodeConfigs()&&(this.updateNodeConfigs(),this.changeDetector.detectChanges())}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}trackByFn(t,i){return i.id}checkNodeConfigs(){const t=this.getNodes();if(!this.nodeComponentsConfigs||t.length!==this.nodeComponentsConfigs.length)return!0;for(let i=0;i<t.length;i++)if(this.pizzagnaService.getComponent(t[i])!==this.nodeComponentsConfigs[i])return!0;return!1}updateNodeComponentConfigs(){const t=this.getNodes();this.nodeComponentsConfigs=t&&t.map(i=>{const o=this.pizzagnaService.getComponent(i);if(void 0===o)throw new Error("No component with id '"+i+"' was defined in the configuration.");return o})}updateNodeConfigs(t){this.nodeConfigs=(0,Te.n)(this.nodeConfigs,this.getTemplateChangeForNodes(t),this.getNodeComponentsConfigs())}getNodeComponentsConfigs(){const t={currentValue:void 0,previousValue:this.nodeComponentsConfigs?[...this.nodeComponentsConfigs]:void 0};return this.updateNodeComponentConfigs(),t.currentValue=this.nodeComponentsConfigs,t}getTemplateChangeForNodes(t){const{changesNodes:i,changesTemplate:o}=t||{},r=c=>{var g;return c&&(null===(g=this.getNodes())||void 0===g?void 0:g.map(()=>c))};return{currentValue:r(o?o.currentValue:this.template),previousValue:i?this.template:r(o?o.previousValue:this.template)}}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(e.sBO),e.LFG(ce.p),e.LFG(d.mQy))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();function ze(n,a){}function Ve(n,a){if(1&n){const t=e.EpF();e.ynx(0)(1,1,2),e.YNc(3,ze,0,0,"ng-template",3),e.NdJ("attached",function(o){return e.CHM(t),e.MAs(2).attached(o)}),e.BQk()()}if(2&n){const t=a.$implicit,i=e.MAs(2);e.xp6(1),e.Q6J("componentId",t.id)("componentType",t.componentType)("providers",t.providers)("properties",t.properties),e.xp6(2),e.Q6J("cdkPortalOutlet",i.portal)}}let Re=(()=>{class n extends Ee{constructor(t,i,o){super(t,i,o),this.nodes=[],this.direction="column",this.elementClass="",this.defaultClassNames="h-100 w-100 d-flex"}ngOnInit(){this.classNames=`${this.defaultClassNames} flex-${this.direction} ${this.elementClass}`}ngOnDestroy(){super.ngOnDestroy()}getNodes(){return this.nodes}}return n.lateLoadKey="StackComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(ce.p),e.Y36(d.mQy))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-stack"]],hostVars:2,hostBindings:function(t,i){2&t&&e.Tol(i.classNames)},inputs:{nodes:"nodes",direction:"direction",elementClass:"elementClass"},features:[e.qOj],decls:1,vars:2,consts:[[4,"ngFor","ngForOf","ngForTrackBy"],["nuiComponentPortal","",3,"componentId","componentType","providers","properties"],["componentPortal","nuiComponentPortal"],[3,"cdkPortalOutlet","attached"]],template:function(t,i){1&t&&e.YNc(0,Ve,4,5,"ng-container",0),2&t&&e.Q6J("ngForOf",i.nodeConfigs)("ngForTrackBy",i.trackByFn)},directives:[s.sg,L.$,z.Pl],encapsulation:2}),n})();const ot=["gridItemsContainer"];function mt(n,a){}function ft(n,a){if(1&n){const t=e.EpF();e.ynx(0)(1,3,4),e.YNc(3,mt,0,0,"ng-template",5),e.NdJ("attached",function(o){return e.CHM(t),e.MAs(2).attached(o)}),e.BQk()()}if(2&n){const t=a.$implicit,i=e.MAs(2);e.xp6(1),e.Q6J("componentId",t.id)("componentType",t.componentType)("properties",t.properties)("providers",t.providers),e.xp6(2),e.Q6J("cdkPortalOutlet",i.portal)}}const Ae=function(n){return{"prioritize-rows":n}};let it=(()=>{class n extends Ee{constructor(t,i,o,r){super(t,i,o),this.ngZone=r,this.nodes=[],this.direction="column",this.prioritizeGridRows=!1}ngAfterViewInit(){this.handleGridFlowOnResize()}ngOnDestroy(){var t;null===(t=this.tilesResizeObserver)||void 0===t||t.disconnect(),super.ngOnDestroy()}getNodes(){return this.nodes}handleGridFlowOnResize(){this.tilesResizeObserver=new ResizeObserver(()=>this.onResize()),this.ngZone.runOutsideAngular(()=>{this.tilesResizeObserver.observe(this.gridItemsContainer.nativeElement)})}onResize(){var t;if((null===(t=this.nodes)||void 0===t?void 0:t.length)<2)return;const i=this.gridItemsContainer.nativeElement.getBoundingClientRect(),{height:o,width:r}=i,c=o/r,g=_t(this.nodes.length);return c-.05>g&&!this.prioritizeGridRows?(this.prioritizeGridRows=!0,void this.changeDetector.detectChanges()):c+.05<g&&this.prioritizeGridRows?(this.prioritizeGridRows=!1,void this.changeDetector.detectChanges()):void 0}}return n.lateLoadKey="TilesComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(ce.p),e.Y36(d.mQy),e.Y36(e.R0b))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-tiles"]],viewQuery:function(t,i){if(1&t&&e.Gf(ot,7),2&t){let o;e.iGM(o=e.CRH())&&(i.gridItemsContainer=o.first)}},hostVars:2,hostBindings:function(t,i){2&t&&e.Tol(i.elementClass)},inputs:{nodes:"nodes",direction:"direction"},features:[e.qOj],decls:3,vars:5,consts:[[1,"nui-grid-layout",3,"ngClass"],["gridItemsContainer",""],[4,"ngFor","ngForOf","ngForTrackBy"],["nuiComponentPortal","",3,"componentId","componentType","properties","providers"],["componentPortal","nuiComponentPortal"],[3,"cdkPortalOutlet","attached"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0,1),e.YNc(2,ft,4,5,"ng-container",2),e.qZA()),2&t&&(e.Q6J("ngClass",e.VKq(3,Ae,i.prioritizeGridRows)),e.xp6(2),e.Q6J("ngForOf",i.nodeConfigs)("ngForTrackBy",i.trackByFn))},directives:[s.mk,s.sg,L.$,z.Pl],styles:[".nui-grid-layout[_ngcontent-%COMP%]{display:grid;height:100%;grid-gap:10px;gap:10px;grid-template-columns:repeat(auto-fit,minmax(94.8px,1fr));grid-template-rows:repeat(auto-fit,minmax(15px,1fr));line-height:1.2}.nui-grid-layout.prioritize-rows[_ngcontent-%COMP%]{grid-auto-flow:column;grid-template-columns:minmax(1px,1fr)}.mobile[_nghost-%COMP%], .mobile   [_nghost-%COMP%]{min-height:160px}"]}),n})();const _t=n=>.25*n+.7;function ut(n,a){if(1&n&&(e.TgZ(0,"div",6),e._UZ(1,"nui-icon",7),e.TgZ(2,"span",8),e._uU(3),e.qZA()()),2&n){const t=a.$implicit;e.xp6(1),e.Q6J("icon",t.key),e.xp6(1),e.Q6J("title",t.value),e.xp6(1),e.Oqu(t.value)}}function Tt(n,a){1&n&&e._UZ(0,"nui-icon",9)}const Ct=function(n,a){return{"widget-medium":n,"widget-small":a}};let gt=(()=>{class n{constructor(t){this.changeDetector=t,this.navigated=new e.vpe}set widgetWidth(t){this.isMedium=t<=600&&t>480,this.isSmall=t<=480}onButtonClick(){this.canNavigate&&this.navigated.emit(this)}}return n.lateLoadKey="ListGroupItemComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-list-group-item"]],hostAttrs:[1,"w-100"],inputs:{id:"id",label:"label",statuses:"statuses",canNavigate:"canNavigate",widgetWidth:"widgetWidth"},outputs:{navigated:"navigated"},decls:7,vars:8,consts:[[1,"list-group-item",3,"ngClass","click"],[1,"list-group-item__label",3,"title"],[1,"list-group-item__statuses"],[1,"statuses"],["class","status-column",4,"ngFor","ngForOf"],["icon","caret-right",4,"ngIf"],[1,"status-column"],[1,"mr-2",3,"icon"],[1,"status-column__label",3,"title"],["icon","caret-right"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.NdJ("click",function(){return i.onButtonClick()}),e.TgZ(1,"div",1),e._uU(2),e.qZA(),e.TgZ(3,"div",2)(4,"div",3),e.YNc(5,ut,4,3,"div",4),e.qZA(),e.YNc(6,Tt,1,0,"nui-icon",5),e.qZA()()),2&t&&(e.Q6J("ngClass",e.WLB(5,Ct,i.isMedium,i.isSmall)),e.xp6(1),e.Q6J("title",i.label),e.xp6(1),e.Oqu(i.label),e.xp6(3),e.Q6J("ngForOf",i.statuses),e.xp6(1),e.Q6J("ngIf",i.canNavigate))},directives:[s.mk,s.sg,d.oJW,s.O5],styles:[".list-group-item[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;align-items:center;flex-wrap:wrap}.list-group-item__label[_ngcontent-%COMP%]{width:25%;max-width:100%;white-space:nowrap;overflow:hidden;-ms-text-overflow:ellipsis;text-overflow:ellipsis}.list-group-item__statuses[_ngcontent-%COMP%]{width:75%;display:flex;align-items:center}.list-group-item[_ngcontent-%COMP%]   .status-column[_ngcontent-%COMP%]{display:flex;width:75px;min-width:75px;max-width:100%;justify-content:flex-start;align-items:center;padding-right:10px}.list-group-item[_ngcontent-%COMP%]   .status-column__label[_ngcontent-%COMP%]{margin-left:5px;white-space:nowrap;overflow:hidden;-ms-text-overflow:ellipsis;text-overflow:ellipsis}.list-group-item[_ngcontent-%COMP%]   .statuses[_ngcontent-%COMP%]{display:flex;flex-grow:1;justify-content:flex-end}.widget-medium[_ngcontent-%COMP%]{justify-content:flex-end}.widget-medium[_ngcontent-%COMP%]   .list-group-item__label[_ngcontent-%COMP%], .widget-medium[_ngcontent-%COMP%]   .list-group-item__statuses[_ngcontent-%COMP%]{width:100%!important}.widget-small[_ngcontent-%COMP%]{justify-content:flex-end}.widget-small[_ngcontent-%COMP%]   .list-group-item__label[_ngcontent-%COMP%], .widget-small[_ngcontent-%COMP%]   .list-group-item__statuses[_ngcontent-%COMP%]{width:100%!important}.widget-small[_ngcontent-%COMP%]   .statuses[_ngcontent-%COMP%]{justify-content:space-between}"],changeDetection:0}),n})();var _e=l(82722);function be(n,a){if(1&n&&e._UZ(0,"nui-icon",9),2&n){const t=e.oxw();e.Q6J("icon",t.icon)("status",t.status)}}function yt(n,a){if(1&n&&e._uU(0),2&n){const t=e.oxw();e.Oqu(t.status)}}function Jt(n,a){1&n&&e._UZ(0,"nui-icon",10)}let Mt=(()=>{class n{constructor(t,i){this.changeDetector=t,this.eventBus=i,this.navigated=new e.vpe,this.searchTerm="",this.destroy$=new ie.x}onButtonClick(){this.canNavigate&&this.navigated.emit(this)}ngOnInit(){this.eventBus.getStream(T.kV).pipe((0,_e.R)(this.destroy$)).subscribe(t=>{var i;this.searchTerm=null!==(i=t.payload)&&void 0!==i?i:"",this.changeDetector.markForCheck()})}}return n.lateLoadKey="ListLeafItemComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(m.nY))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-list-leaf-item"]],hostAttrs:[1,"w-100"],inputs:{icon:"icon",status:"status",detailedUrl:"detailedUrl",label:"label",canNavigate:"canNavigate",url:"url"},outputs:{navigated:"navigated"},decls:12,vars:14,consts:[[1,"nui-list-leaf-item",3,"click"],[1,"nui-list-leaf-item__info-container"],[1,"nui-list-leaf-item__icon-container"],["class","mr-1",3,"icon","status",4,"ngIf","ngIfElse"],[1,"nui-list-leaf-item__description"],[1,"nui-text-ellipsis",3,"ngClass","innerHTML"],[1,"nui-text-secondary","nui-text-ellipsis",3,"innerHTML"],["statusTpl",""],["icon","caret-right",4,"ngIf"],[1,"mr-1",3,"icon","status"],["icon","caret-right"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0),e.NdJ("click",function(){return i.onButtonClick()}),e.TgZ(1,"div",1)(2,"div",2),e.YNc(3,be,1,2,"nui-icon",3),e.qZA(),e.TgZ(4,"div",4),e._UZ(5,"a",5),e.ALo(6,"nuiHighlight"),e._UZ(7,"div",6),e.ALo(8,"nuiHighlight"),e.qZA(),e.YNc(9,yt,1,1,"ng-template",null,7,e.W1O),e.qZA(),e.YNc(11,Jt,1,0,"nui-icon",8),e.qZA()),2&t){const o=e.MAs(10);e.xp6(3),e.Q6J("ngIf",i.icon)("ngIfElse",o),e.xp6(2),e.Q6J("ngClass",i.url?"":"not-active")("innerHTML",e.xi3(6,8,i.label,i.searchTerm),e.oJD),e.uIk("target",i.url?"_blank":null)("href",i.url||null,e.LSH),e.xp6(2),e.Q6J("innerHTML",e.xi3(8,11,i.detailedUrl,i.searchTerm),e.oJD),e.xp6(4),e.Q6J("ngIf",i.canNavigate)}},directives:[s.O5,d.oJW,s.mk],pipes:[d.SgB],styles:[".nui-list-leaf-item[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-between;align-items:center;padding:5px 0}.nui-list-leaf-item__info-container[_ngcontent-%COMP%]{display:flex;height:40px}.nui-list-leaf-item__icon-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-width:30px}.nui-list-leaf-item__description[_ngcontent-%COMP%]{display:grid;grid-template-rows:1fr 1fr;grid-template-columns:1fr;max-width:100%}a.not-active[_ngcontent-%COMP%]{text-decoration:none;color:#111}"],changeDetection:0}),n})();function Yt(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",1)(1,"button",2),e.NdJ("click",function(){return e.CHM(t),e.oxw().onBack()}),e.qZA(),e.TgZ(2,"button",3),e.NdJ("click",function(){return e.CHM(t),e.oxw().onHome()}),e.qZA(),e.TgZ(3,"div",4),e._uU(4),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("isRepeat",!0)("disabled",!(null!=t.navBarConfig&&null!=t.navBarConfig.buttons&&null!=t.navBarConfig.buttons.back&&t.navBarConfig.buttons.back.disabled)),e.xp6(1),e.Q6J("isRepeat",!0),e.xp6(2),e.Oqu(null==t.navBarConfig?null:t.navBarConfig.label)}}let ht=(()=>{class n{constructor(t,i){this.changeDetector=t,this.eventBus=i,this.navigated=new e.vpe}onBack(){var t,i,o;this.navBarConfig&&this.eventBus.getStream(T.EC).next({payload:{back:null===(o=null===(i=null===(t=this.navBarConfig)||void 0===t?void 0:t.buttons)||void 0===i?void 0:i.back)||void 0===o?void 0:o.disabled}})}onHome(){this.eventBus.getStream(T.EC).next({payload:{reset:!0}})}}return n.lateLoadKey="ListNavigationBarComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(m.nY))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-navigation-bar"]],inputs:{navBarConfig:"navBarConfig"},outputs:{navigated:"navigated"},decls:1,vars:1,consts:[["class","list-nav-bar",4,"ngIf"],[1,"list-nav-bar"],["nui-button","","type","button","displayStyle","action","icon","arrow-left",3,"isRepeat","disabled","click"],["nui-button","","type","button","displayStyle","action","icon","overview",3,"isRepeat","click"],[1,"list-nav-bar__label"]],template:function(t,i){1&t&&e.YNc(0,Yt,5,4,"div",0),2&t&&e.Q6J("ngIf",i.navBarConfig&&!(null!=i.navBarConfig&&i.navBarConfig.isRoot))},directives:[s.O5,d.r0F],styles:[".list-nav-bar[_ngcontent-%COMP%]{width:100%;margin:2px 0;padding:0 15px;display:flex;align-items:center}.list-nav-bar__label[_ngcontent-%COMP%]{padding-left:5px;color:#1119}"],changeDetection:0}),n})();function at(n,a){}const Me=function(){return["navigated"]};function K(n,a){if(1&n){const t=e.EpF();e.ynx(0,2,3),e.NdJ("output",function(){const r=e.CHM(t).item;return e.oxw().onListItemEvent(r)}),e.YNc(2,at,0,0,"ng-template",4),e.NdJ("attached",function(o){return e.CHM(t),e.MAs(1).attached(o)}),e.BQk()}if(2&n){const t=a.item,i=e.MAs(1),o=e.oxw();e.Q6J("componentId",o.configuration.componentType)("componentType",o.configuration.componentType)("properties",o.getPropsFor(t))("outputs",e.DdM(5,Me)),e.xp6(2),e.Q6J("cdkPortalOutlet",i.portal)}}let _=(()=>{class n{constructor(t,i,o,r){this.changeDetector=t,this.zone=i,this.host=o,this.eventBus=r,this.itemFormatterProps=new Map,this.destroy$=new ie.x}ngOnInit(){this.initResizeObserver()}ngOnChanges(t){var i;(null===(i=t.data)||void 0===i?void 0:i.currentValue)&&t.data.currentValue.forEach(o=>this.itemFormatterProps.set(o,this.calcItemProps(o)))}onListItemEvent(t){this.eventBus.getStream(T.EC).next({payload:t})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.itemFormatterProps.clear()}getPropsFor(t){return Object.assign(Object.assign({},this.itemFormatterProps.get(t)),{widgetWidth:this.widgetWidth})}calcItemProps(t){return this.configuration?Object.assign(Object.assign({},b(this.configuration,t)),this.configuration.itemProperties):t}initResizeObserver(){const t=new d.Pa2(this.host,this.zone);t.debounceTime=10,t.ngAfterViewInit(),t.containerResize.pipe((0,_e.R)(this.destroy$)).subscribe(()=>{this.widgetWidth=this.host.nativeElement.offsetWidth})}}return n.lateLoadKey="ListWidgetComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(e.R0b),e.Y36(e.SBq),e.Y36(m.nY))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-list-widget"]],hostAttrs:[2,"overflow","scroll"],hostVars:2,hostBindings:function(t,i){2&t&&e.Tol(i.elementClass)},inputs:{data:"data",configuration:"configuration",elementClass:"elementClass"},features:[e.TTD],decls:3,vars:2,consts:[[3,"itemsSource","repeatItemTemplateRef"],["repeatItemTemplate",""],["nuiComponentPortal","",3,"componentId","componentType","properties","outputs","output"],["componentPortal","nuiComponentPortal"],[3,"cdkPortalOutlet","attached"]],template:function(t,i){if(1&t&&(e._UZ(0,"nui-repeat",0),e.YNc(1,K,3,6,"ng-template",null,1,e.W1O)),2&t){const o=e.MAs(2);e.Q6J("itemsSource",i.data)("repeatItemTemplateRef",o)}},directives:[d.$N6,L.$,z.Pl],styles:[""]}),n})();var f=l(92474),S=l(98864),V=l(294),H=l(32656),ge=l(47243),Ce=l(60343),fe=l(21366);let Ie=(()=>{class n extends fe.k{constructor(t){super(t,"ProportionalContentAggregatorsRegistryService")}getItemKey(t){return t.aggregatorType}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(d.mQy))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function xe(n,a){}function Ke(n,a){if(1&n){const t=e.EpF();e.ynx(0,1,2),e.YNc(2,xe,0,0,"ng-template",3),e.NdJ("attached",function(o){return e.CHM(t),e.MAs(1).attached(o)}),e.BQk()}if(2&n){const t=e.MAs(1),i=e.oxw();e.Q6J("componentType",null==i.contentFormatter?null:i.contentFormatter.componentType)("properties",i.contentFormatterProperties),e.xp6(2),e.Q6J("cdkPortalOutlet",t.portal)}}let Je=(()=>{class n{constructor(t,i,o,r){this.aggregatorRegistry=t,this.formatterRegistry=i,this.changeDetector=o,this.logger=r,this.destroy$=new ie.x}ngOnChanges(t){if(t.donutConfig){const i=t.donutConfig.currentValue,{formatter:o,aggregator:r}=i;(null==r?void 0:r.aggregatorType)&&(this.updateAggregatorDefinition(r),this.updateAggregatedValue()),(null==o?void 0:o.componentType)&&(this.contentFormatter=o,this.updateFormatterDefinition(o),this.updateFormatterProperties())}t.widgetData&&(this.updateAggregatedValue(),this.updateFormatterProperties()),t.chartAssist&&this.subscribeToChartAssist()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}getFormatterProperties(t){var i;if(t)return Object.assign(Object.assign({},null===(i=this.contentFormatterDefinition)||void 0===i?void 0:i.properties),{data:b(t,{value:this.aggregatedValue})})}updateAggregatorDefinition(t){const i=this.aggregatorRegistry.getItem(t.aggregatorType);i?this.contentAggregatorDefinition=i:this.logger.warn(`No aggregator with key ${t.aggregatorType} found in registry.`)}updateFormatterDefinition(t){const i=this.formatterRegistry.getItem(t.componentType);i?this.contentFormatterDefinition=i:this.logger.warn(`No aggregator with key ${t.componentType} found in registry.`)}updateAggregatedValue(){var t;if(!this.widgetData||!this.contentAggregatorDefinition)return void this.logger.warn(`Can't aggregate value. Aggregator key: ${null===(t=this.contentAggregatorDefinition)||void 0===t?void 0:t.aggregatorType}. Data: ${this.widgetData}`);const i=this.getAggregatorProperties();this.aggregatedValue=this.contentAggregatorDefinition.fn(this.widgetData,Object.assign(Object.assign({},i),{activeMetricId:this.emphasizedSeriesId||i.activeMetricId})).toString()}updateFormatterProperties(){this.contentFormatterProperties=this.getFormatterProperties(this.contentFormatter)}getAggregatorProperties(){var t,i,o;return Object.assign(Object.assign({},null===(t=this.contentAggregatorDefinition)||void 0===t?void 0:t.properties),null===(o=null===(i=this.donutConfig)||void 0===i?void 0:i.aggregator)||void 0===o?void 0:o.properties)}subscribeToChartAssist(){var t,i,o;null===(t=this.chartAssistSubscription)||void 0===t||t.unsubscribe(),this.chartAssistSubscription=null===(o=null===(i=this.chartAssist)||void 0===i?void 0:i.chartAssistSubject)||void 0===o?void 0:o.pipe((0,_e.R)(this.destroy$)).subscribe(r=>{var c;this.emphasizedSeriesId=null===(c=r.payload)||void 0===c?void 0:c.seriesId,this.updateAggregatedValue(),this.updateFormatterProperties(),this.changeDetector.detectChanges()})}}return n.lateLoadKey="ProportionalDonutContentComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(Ie),e.Y36(ge.UA),e.Y36(e.sBO),e.Y36(d.mQy))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-proportional-donut-content"]],inputs:{widgetData:"widgetData",donutConfig:"donutConfig",chartAssist:"chartAssist"},features:[e.TTD],decls:1,vars:1,consts:[["nuiComponentPortal","",3,"componentType","properties",4,"ngIf"],["nuiComponentPortal","",3,"componentType","properties"],["componentPortal","nuiComponentPortal"],[3,"cdkPortalOutlet","attached"]],template:function(t,i){1&t&&e.YNc(0,Ke,3,3,"ng-container",0),2&t&&e.Q6J("ngIf",null==i.contentFormatter?null:i.contentFormatter.componentType)},directives:[s.O5,L.$,z.Pl],styles:[""],changeDetection:0}),n})();var $e=l(64509),Ye=l.n($e),rt=l(50772),Be=l.n(rt);let lt=(()=>{class n{constructor(t){this.unitConversionService=t,this.transform=(i,o="generic",r=1e6)=>{const c="string"==typeof i?parseFloat(i):i;if(void 0===c||isNaN(c)||c<r&&"percent"!==o)return(null==i?void 0:i.toString())||"";const g=this.unitConversionService.convert(c,"bytes"===o?d.Qln.Bytes:d.Qln.Standard,1);return this.unitConversionService.getFullDisplay(g,o)}}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(d.CrH,16))},n.\u0275pipe=e.Yjl({name:"nuiDashboardUnitConversion",type:n,pure:!0}),n})();var Le=(()=>{return(n=Le||(Le={})).DonutChart="DonutChart",n.PieChart="PieChart",n.VerticalBarChart="VerticalBarChart",n.HorizontalBarChart="HorizontalBarChart",Le;var n})();let Qt=(()=>{class n{static buildChartSeries(t,i,o,r){return(t||[]).map(g=>Object.assign(Object.assign({},g),{accessors:i,renderer:o,scales:r}))}static getChartAttributes(t,i,o){const r=n.getChartTools(t),c={grid:r.gridFunction(),accessors:r.accessorFunction(i,o),renderer:r.rendererFunction(),scales:r.scaleFunction()};return r.preprocessor&&(c.preprocessor=r.preprocessor),c}static getChartTools(t){const i=c=>{const g=new h.UDz(c);return g.series.color=(E,P)=>{var Z;return null!==(Z=P.color)&&void 0!==Z?Z:c.get(E)},g};function o(c,g){const E=(0,h.Q6e)(this.config,c,g);return E.series.color=(P,Z)=>{var U;return null!==(U=Z.color)&&void 0!==U?U:null==c?void 0:c.get(P)},E.data.value=P=>Number.isFinite(P)?P:P.value,E}return{[Le.DonutChart]:{preprocessor:h.fy$,gridFunction:h.Y6Q,rendererFunction:()=>new h.E8N,accessorFunction:i,scaleFunction:h._N$},[Le.PieChart]:{preprocessor:h.fy$,gridFunction:h.Y6Q,rendererFunction:()=>new h.bOg,accessorFunction:i,scaleFunction:h._N$},[Le.HorizontalBarChart]:{config:{horizontal:!0},gridFunction(){return(0,h.skL)(this.config)},rendererFunction:()=>new h.Z7w({highlightStrategy:new h.TrQ("y")}),accessorFunction:o,scaleFunction(){return(0,h.CQI)(this.config)}},[Le.VerticalBarChart]:{config:{horizontal:!1},gridFunction(){return(0,h.skL)(this.config)},rendererFunction:()=>new h.Z7w({highlightStrategy:new h.TrQ("x")}),accessorFunction:o,scaleFunction(){return(0,h.CQI)(this.config)}}}[t]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();var we=l(55413);const _i=["gridContainer"];function B(n,a){}function J(n,a){if(1&n){const t=e.EpF();e.ynx(0)(1,12,13),e.YNc(3,B,0,0,"ng-template",14),e.NdJ("attached",function(o){return e.CHM(t),e.MAs(2).attached(o)}),e.BQk()()}if(2&n){const t=e.MAs(2),i=e.oxw(3);e.xp6(1),e.Q6J("componentType",(null==i.contentFormatter?null:i.contentFormatter.componentType)||"DonutContentRawFormatterComponent")("properties",i.contentFormatterProperties),e.xp6(2),e.Q6J("cdkPortalOutlet",t.portal)}}function I(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"nui-proportional-donut-content",15),e.BQk()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("widgetData",t.widgetData)("donutConfig",null==t.configuration||null==t.configuration.chartOptions?null:t.configuration.chartOptions.donutContentConfig)("chartAssist",t.chartAssist)}}function D(n,a){if(1&n&&(e.TgZ(0,"nui-chart-donut-content",8)(1,"div",9)(2,"div",10),e.YNc(3,J,4,3,"ng-container",11),e.YNc(4,I,2,3,"ng-container",11),e.qZA()()()),2&n){const t=e.oxw(2);e.Q6J("plugin",t.donutContentPlugin),e.xp6(2),e.Q6J("useZoom",!1),e.xp6(1),e.Q6J("ngIf",!(null!=t.configuration&&null!=t.configuration.chartOptions&&t.configuration.chartOptions.donutContentConfig)),e.xp6(1),e.Q6J("ngIf",null==t.configuration||null==t.configuration.chartOptions?null:t.configuration.chartOptions.donutContentConfig)}}function $(n,a){if(1&n&&(e.TgZ(0,"div",5),e._UZ(1,"nui-chart",6),e.YNc(2,D,5,4,"nui-chart-donut-content",7),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("chart",t.chartAssist.chart),e.xp6(1),e.Q6J("ngIf",t.donutContentPlugin)}}function Q(n,a){}const ee=function(n){return{data:n}};function se(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",22),e.ynx(2,12,23),e.YNc(4,Q,0,0,"ng-template",14),e.NdJ("attached",function(o){return e.CHM(t),e.MAs(3).attached(o)}),e.BQk(),e.qZA()()}if(2&n){const t=e.MAs(3),i=e.oxw().index,o=e.oxw(2);e.xp6(2),e.Q6J("componentType",o.legendFormatter.componentType)("properties",e.VKq(3,ee,o.widgetData[i])),e.xp6(2),e.Q6J("cdkPortalOutlet",t.portal)}}function me(n,a){if(1&n&&e._UZ(0,"nui-icon",29),2&n){const t=e.oxw(2).$implicit,i=e.oxw(2);e.Q6J("icon",i.seriesToIconMap[t.id])}}const ve=function(n){return{"nui-text-link-small link":n}};function Xe(n,a){if(1&n&&(e.TgZ(0,"div",30),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).$implicit,i=e.oxw(2);e.Q6J("ngClass",e.VKq(2,ve,i.interactive)),e.xp6(1),e.hij(" ",t.name," ")}}function Pt(n,a){if(1&n&&(e.TgZ(0,"a",31),e.NdJ("click",function(i){return i.stopPropagation()}),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).$implicit;e.Q6J("href",t.link,e.LSH)("title",t.name),e.xp6(1),e.hij(" ",t.name," ")}}function ui(n,a){if(1&n&&(e._UZ(0,"nui-rich-legend-tile",24),e.ALo(1,"nuiDashboardUnitConversion"),e.YNc(2,me,1,1,"nui-icon",25),e.TgZ(3,"div",26),e.YNc(4,Xe,2,4,"div",27),e.YNc(5,Pt,2,3,"a",28),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.Q6J("value",e.lcZ(1,7,i.computeLegendTileValue(t.data[0])))("unitLabel",i.legendUnitLabel)("color",i.chartAssist.palette.textColors.get(t.id))("backgroundColor",i.chartAssist.palette.standardColors.get(t.id)),e.xp6(2),e.Q6J("ngIf",i.seriesToIconMap&&i.seriesToIconMap[t.id]),e.xp6(2),e.Q6J("ngIf",!t.link),e.xp6(1),e.Q6J("ngIf",t.link)}}function pi(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"nui-legend-series",19),e.NdJ("isSelectedChange",function(o){const c=e.CHM(t).$implicit;return e.oxw(2).chartAssist.toggleSeries(c.id,o)})("mouseenter",function(){const r=e.CHM(t).$implicit;return e.oxw(2).chartAssist.emphasizeSeries(r.id)})("click",function(){const r=e.CHM(t).$implicit;return e.oxw(2).onInteraction(r)}),e.YNc(1,se,5,5,"div",20),e.YNc(2,ui,6,9,"ng-template",null,21,e.W1O),e.qZA()}if(2&n){const t=a.$implicit,i=e.MAs(3),o=e.oxw(2);e.ekj("nui-proportional-widget__legend--interactive",o.interactive),e.Q6J("ngClass",(o.prioritizedGridRows.right||o.prioritizedGridRows.bottom)&&"description-min-width--unset")("isSelected",!o.chartAssist.isSeriesHidden(t.id))("seriesRenderState",null==o.chartAssist.renderStatesIndex[t.id]?null:o.chartAssist.renderStatesIndex[t.id].state),e.xp6(1),e.Q6J("ngIf",o.legendFormatter&&o.legendFormatter.componentType)("ngIfElse",i)}}const Co=function(n){return[n]};function Oo(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",16)(1,"nui-legend",17),e.NdJ("mouseleave",function(){return e.CHM(t),e.oxw().chartAssist.resetVisibleSeries()}),e.YNc(2,pi,4,7,"nui-legend-series",18),e.qZA()()}if(2&n){const t=e.oxw();e.Q6J("ngClass",e.VKq(5,Co,t.legendShouldBeAlignedRight()?"scrollable":"legend-bottom")),e.xp6(1),e.Q6J("interactive",!1)("orientation",t.legendShouldBeAlignedRight()?"vertical":"horizontal"),e.xp6(1),e.Q6J("ngForOf",t.chartAssist.legendSeriesSet)("ngForTrackBy",t.chartAssist.seriesTrackByFn)}}function Io(n,a){1&n&&(e.TgZ(0,"div",32),e._UZ(1,"nui-image",33),e.qZA())}const vo=function(n,a,t){return{"prioritize-rows__right":n,"prioritize-rows__bottom":a,"empty-grid":t}};let gi=(()=>{class n{constructor(t,i,o,r,c,g,E){this.changeDetector=t,this.ngZone=i,this.kvDiffers=o,this.eventBus=r,this.dataSource=c,this.logger=g,this.prioritizedGridRows={right:!1,bottom:!1},this.chartPalette=new h.syg((0,h.GUR)()),this.differ=this.kvDiffers.find(this.prioritizedGridRows).create(),this.unitConversionPipe=new lt(E)}get interactive(){var t,i,o,r;return(null===(t=this.configuration)||void 0===t?void 0:t.interactive)||(null===(r=null===(o=null===(i=this.dataSource)||void 0===i?void 0:i.features)||void 0===o?void 0:o.getFeatureConfig(m.ni.Interactivity))||void 0===r?void 0:r.enabled)||!1}computeLegendTileValue(t){var i,o;return null===(o=null===(i=this.accessors.data)||void 0===i?void 0:i.value)||void 0===o?void 0:o.call(i,t,0,null,null)}ngOnChanges(t){var i,o,r,c;const g=null===(o=null===(i=t.configuration)||void 0===i?void 0:i.currentValue)||void 0===o?void 0:o.chartColors,E=null===(c=null===(r=t.configuration)||void 0===r?void 0:r.previousValue)||void 0===c?void 0:c.chartColors;if((t.widgetData||!Ye()(g,E))&&this.updateChartColors(),t.configuration){const P=t.configuration.currentValue.chartOptions.type,Z=t.configuration.previousValue&&t.configuration.previousValue.chartOptions.type;P&&P!==Z&&(this.buildChart(P),this.widgetData&&this.updateChart()),this.legendFormatter=this.configuration.chartOptions.legendFormatter,this.contentFormatter=this.configuration.chartOptions.contentFormatter,this.chartFormatterComponentType=this.configuration.chartOptions.chartFormatterComponentType,this.getContentFormatterProperties(),this.changeDetector.markForCheck()}t.widgetData&&this.chartAssist&&(this.updateChart(),this.getContentFormatterProperties(),this.changeDetector.markForCheck())}ngAfterViewInit(){this.handleGridFlowOnResize()}ngOnDestroy(){var t,i;null===(t=this.proportionalWidgetResizeObserver)||void 0===t||t.disconnect(),null===(i=this.chartTypeSubscription$)||void 0===i||i.unsubscribe()}getContentFormatterProperties(){var t;this.contentFormatterProperties={data:this.widgetData,config:this.configuration,chartAssist:this.chartAssist,properties:null===(t=this.contentFormatter)||void 0===t?void 0:t.properties}}isDonutChart(){return this.configuration.chartOptions.type===Le.DonutChart}isRadialChart(){return-1!==[Le.DonutChart,Le.PieChart].indexOf(this.configuration.chartOptions.type)}hasLegend(){return this.configuration.chartOptions.legendPlacement!==we.w.None}legendShouldBeAlignedRight(){return this.configuration.chartOptions.legendPlacement===we.w.Right}onInteraction(t){!this.interactive||this.eventBus.getStream(T.b1).next({payload:{data:t}})}buildChart(t){var i,o;this.donutContentPlugin=null;const{grid:r,accessors:c,renderer:g,scales:E,preprocessor:P}=Qt.getChartAttributes(t,null===(i=this.chartPalette)||void 0===i?void 0:i.standardColors);this.chartAssist=new h.doR(new h.kL2(r),P,this.chartPalette),this.renderer=g,this.accessors=c,this.scales=E,this.isDonutChart()&&(this.donutContentPlugin=new h.iM,this.chartAssist.chart.addPlugin(this.donutContentPlugin)),this.configuration.chartOptions.type===Le.HorizontalBarChart?(this.scales.x.formatters.tick=Z=>this.unitConversionPipe.transform(Z),this.applyTickLabelMaxWidths()):this.configuration.chartOptions.type===Le.VerticalBarChart&&(this.scales.y.formatters.tick=Z=>this.unitConversionPipe.transform(Z)),null===(o=this.chartTypeSubscription$)||void 0===o||o.unsubscribe(),this.chartTypeSubscription$=this.chartAssist.chart.getEventBus().getStream(h.q7O).subscribe(Z=>{const U=this.widgetData.find(ne=>ne.id===Z.data.seriesId);this.onInteraction(U)})}handleGridFlowOnResize(){this.proportionalWidgetResizeObserver=new ResizeObserver(()=>this.onResize()),this.ngZone.runOutsideAngular(()=>{this.proportionalWidgetResizeObserver.observe(this.gridContainer.nativeElement)})}applyTickLabelMaxWidths(){var t,i,o,r,c,g;const E=this.chartAssist.chart.getGrid().config().axis;E.left.tickLabel.maxWidth=null!==(o=null===(i=null===(t=this.configuration.chartOptions.horizontalBarTickLabelConfig)||void 0===t?void 0:t.maxWidth)||void 0===i?void 0:i.left)&&void 0!==o?o:n.TICK_LABEL_MAX_WIDTH,E.right.tickLabel.maxWidth=null!==(g=null===(c=null===(r=this.configuration.chartOptions.horizontalBarTickLabelConfig)||void 0===r?void 0:r.maxWidth)||void 0===c?void 0:c.right)&&void 0!==g?g:n.TICK_LABEL_MAX_WIDTH}onResize(){if(!this.isContainerInNoSwitchLayoutInterval()){switch(this.configuration.chartOptions.legendPlacement){case we.w.Bottom:this.prioritizedGridRows.bottom=this.containerHasRowLayoutWidth();break;case we.w.Right:this.prioritizedGridRows.right=this.containerHasRowLayoutWidth()}this.differ.diff(this.prioritizedGridRows)&&this.changeDetector.detectChanges()}}isContainerInNoSwitchLayoutInterval(){const t=this.gridContainer.nativeElement.getBoundingClientRect().width;return t>n.MAX_ROW_LAYOUT_SIZE-n.NO_SWITCH_LAYOUT_INTERVAL_SIZE/2&&t<n.MAX_ROW_LAYOUT_SIZE+n.NO_SWITCH_LAYOUT_INTERVAL_SIZE/2}containerHasRowLayoutWidth(){return this.gridContainer.nativeElement.getBoundingClientRect().width<n.MAX_ROW_LAYOUT_SIZE}updateChart(){this.chartAssist.update(Qt.buildChartSeries(this.widgetData,this.accessors,this.renderer,this.scales))}updateChartColors(){var t,i;let o;const r=null===(t=this.widgetData)||void 0===t?void 0:t.map(g=>g.color),c=this.configuration.chartColors;o=!this.configuration.prioritizeWidgetColors&&Be()(r)?this.getDataDriverColorProvider(this.widgetData):c?this.getConfigurationColorProvider(c):(0,h.GUR)(),this.chartPalette=new h.syg(o),this.buildChart(null===(i=this.configuration)||void 0===i?void 0:i.chartOptions.type),this.chartAssist&&(this.chartAssist.palette=this.chartPalette,this.updateChart())}getDataDriverColorProvider(t){let i;if((null==t?void 0:t.map(r=>r.color).filter(r=>!!r)).length===t.length){const r=t.reduce((c,g)=>(c[g.id]=g.color,c),{});i=new h.oki(r)}else{const r=t.filter(c=>c.color);this.logger.warn(`Not all series have colors set, setting default pallette. Current series color config: ${JSON.stringify(r)}`),i=(0,h.GUR)()}return i}getConfigurationColorProvider(t){var i;let o;return this.configuration.prioritizeWidgetColors&&this.widgetData&&(this.widgetData=this.widgetData.map(r=>{const c=Object.assign({},r);return c.color&&delete c.color,c})),Array.isArray(t)?o=new h.jpW(t):Object.keys(t).length===(null===(i=this.widgetData)||void 0===i?void 0:i.length)?o=new h.oki(t):(this.logger.warn(`Not all series have colors set, setting default pallette. Current series color config: ${JSON.stringify(t)}`),o=(0,h.GUR)()),o}}return n.lateLoadKey="ProportionalWidgetComponent",n.NO_SWITCH_LAYOUT_INTERVAL_SIZE=20,n.MAX_ROW_LAYOUT_SIZE=360,n.TICK_LABEL_MAX_WIDTH=75,n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(e.R0b),e.Y36(e.aQg),e.Y36(m.nY),e.Y36(m.Fk),e.Y36(d.mQy),e.Y36(d.CrH))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-proportional-widget"]],viewQuery:function(t,i){if(1&t&&e.Gf(_i,7),2&t){let o;e.iGM(o=e.CRH())&&(i.gridContainer=o.first)}},hostVars:2,hostBindings:function(t,i){2&t&&e.Tol(i.elementClass)},inputs:{widgetData:"widgetData",configuration:"configuration",elementClass:"elementClass",seriesToIconMap:"seriesToIconMap"},features:[e.TTD],decls:5,vars:8,consts:[[1,"w-100","nui-chart-layout","flex-grow-1","p-3",3,"ngClass"],["gridContainer",""],["class","d-flex chart has-overlay",4,"ngIf"],["class","w-100 d-flex legend",3,"ngClass",4,"ngIf"],["class","mb-3 mt-3 d-flex align-items-center justify-content-center",4,"ngIf"],[1,"d-flex","chart","has-overlay"],[1,"w-100",3,"chart"],["class","nui-proportional-widget__chart-donut-content",3,"plugin",4,"ngIf"],[1,"nui-proportional-widget__chart-donut-content",3,"plugin"],[1,"h-100","w-100","d-flex","justify-content-center","align-items-center","text-center"],["nuiZoomContent","",1,"d-inline-block",3,"useZoom"],[4,"ngIf"],["nuiComponentPortal","",3,"componentType","properties"],["componentPortal2","nuiComponentPortal"],[3,"cdkPortalOutlet","attached"],[3,"widgetData","donutConfig","chartAssist"],[1,"w-100","d-flex","legend",3,"ngClass"],[1,"w-100","m-auto",3,"interactive","orientation","mouseleave"],["class","proportional-chart__legend-series",3,"ngClass","isSelected","seriesRenderState","nui-proportional-widget__legend--interactive","isSelectedChange","mouseenter","click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"proportional-chart__legend-series",3,"ngClass","isSelected","seriesRenderState","isSelectedChange","mouseenter","click"],[4,"ngIf","ngIfElse"],["legendDefaultTile",""],["description",""],["componentPortal","nuiComponentPortal"],[3,"value","unitLabel","color","backgroundColor"],["legendTransclusion","","class","align-items-center",3,"icon",4,"ngIf"],["description","",1,"description-container","d-flex","flex-column","nui-text-small","justify-content-center"],["class","description description-primary",3,"ngClass",4,"ngIf"],["class","description description-primary nui-text-link-small link","rel","noopener noreferrer",3,"href","title","click",4,"ngIf"],["legendTransclusion","",1,"align-items-center",3,"icon"],[1,"description","description-primary",3,"ngClass"],["rel","noopener noreferrer",1,"description","description-primary","nui-text-link-small","link",3,"href","title","click"],[1,"mb-3","mt-3","d-flex","align-items-center","justify-content-center"],["image","no-data-to-show"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0,1),e.YNc(2,$,3,2,"div",2),e.YNc(3,Oo,3,7,"div",3),e.YNc(4,Io,2,0,"div",4),e.qZA()),2&t&&(e.Q6J("ngClass",e.kEZ(4,vo,i.prioritizedGridRows.right,i.prioritizedGridRows.bottom,!(i.widgetData&&i.widgetData.length>0&&i.chartAssist))),e.xp6(2),e.Q6J("ngIf",i.widgetData&&i.widgetData.length>0&&i.chartAssist),e.xp6(1),e.Q6J("ngIf",i.hasLegend()&&i.chartAssist),e.xp6(1),e.Q6J("ngIf",!i.widgetData||0===i.widgetData.length||!i.chartAssist))},directives:[s.mk,s.O5,h.xH4,h.kwD,d.mEK,L.$,z.Pl,Je,h.FVX,s.sg,h.kJo,h.wHi,d.oJW,d.cuP],pipes:[lt],styles:['.nui-proportional-widget__chart-donut-content[_ngcontent-%COMP%]{position:absolute}.nui-proportional-widget__legend--interactive[_ngcontent-%COMP%]{cursor:pointer!important}.has-overlay[_ngcontent-%COMP%]{overflow:auto}.nui-chart-layout[_ngcontent-%COMP%]{grid-template:"axis-label-left    axis-label-right    ." 0fr "chart              chart               legend" minmax(60%,auto) "axis-label-bottom  axis-label-bottom   ." 0fr "legend-bottom      legend-bottom       ." minmax(auto,min-content) / 1fr 1fr auto}.nui-chart-layout[_ngcontent-%COMP%]   .legend-bottom[_ngcontent-%COMP%]{overflow:auto;align-self:auto;padding-left:0}.prioritize-rows__right[_ngcontent-%COMP%]   .nui-legend-series[_ngcontent-%COMP%], .prioritize-rows__bottom[_ngcontent-%COMP%]   .nui-legend-series[_ngcontent-%COMP%]{max-width:unset;width:100%}.prioritize-rows[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]{justify-self:start}.prioritize-rows__right[_ngcontent-%COMP%]{grid-template:"chart       chart        ." 60% "legend      legend       ." 40%}.prioritize-rows__bottom[_ngcontent-%COMP%]{grid-template:"chart       chart        ." 60% "legend-bottom      legend-bottom      ." 40%}.empty-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;grid-template-rows:1fr}.proportional-chart__legend-series[_ngcontent-%COMP%]   .link.description-primary[_ngcontent-%COMP%]{color:var(--nui-color-text-link,#0079aa)}']}),n})();var hi=l(61455);let qi=(()=>{class n{constructor(){this.enabled=!0,this.delay=500}onHostMouseenter(){!this.enabled||(this.timeout=setTimeout(()=>{this.mousePresentSubject.next(!0)},this.delay))}onHostClick(){!this.enabled||this.mousePresentSubject.next(!0)}onHostMouseleave(){!this.enabled||(clearTimeout(this.timeout),this.mousePresentSubject.next(!1))}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=e.lG2({type:n,selectors:[["","nuiDelayedMousePresenceDetection",""]],hostBindings:function(t,i){1&t&&e.NdJ("mouseenter",function(){return i.onHostMouseenter()})("click",function(){return i.onHostClick()})("mouseleave",function(){return i.onHostMouseleave()})},inputs:{enabled:["nuiDelayedMousePresenceDetection","enabled"],mousePresentSubject:"mousePresentSubject",delay:"delay"}}),n})();var Eo=l(8817),Ht=l.n(Eo),So=l(95835),Ro=l.n(So),en=l(61135),$t=l(56451),tn=l(39646),st=l(18505),Xt=l(39300),It=l(54004),mi=l(95698),nn=l(78372);let on=(()=>{class n{constructor(){this.searchDebounceTime=500}initWidget(t){this.widget=t,this.initSearch()}initSearch(){var t,i;this.defineSearch();const o=null===(i=null===(t=this.widget.dataSource)||void 0===t?void 0:t.features)||void 0===i?void 0:i.featuresChanged;o&&o.pipe((0,_e.R)(this.widget.onDestroy$)).subscribe(()=>{this.defineSearch()})}registerSearch(){this.widget.dataSource&&this.widget.dataSource.registerComponent({search:{componentInstance:{getFilters:()=>({type:"search",value:this.widget.searchValue})}}})}deregisterSearch(){var t,i;this.widget.dataSource&&(null===(i=(t=this.widget.dataSource).deregisterComponent)||void 0===i||i.call(t,"search"))}defineSearch(){var t,i;const o=null===(t=this.widget.configuration)||void 0===t?void 0:t.searchConfiguration,r=null===(i=this.widget.dataSource.features)||void 0===i?void 0:i.getFeatureConfig("search");this.widget.isSearchEnabled=!(!(null==o?void 0:o.enabled)||!(null==r?void 0:r.enabled)),this.widget.isSearchEnabled?(this.widget.searchValue=(null==o?void 0:o.searchTerm)||"",this.registerSearch(),this.searchDebounceTime=k()(null==o?void 0:o.searchDebounce)?this.searchDebounceTime:null==o?void 0:o.searchDebounce,this.watchSearchTerm()):this.deregisterSearch()}watchSearchTerm(){this.widget.searchTerm$.pipe((0,nn.b)(this.searchDebounceTime),(0,_e.R)(this.widget.onDestroy$)).subscribe(()=>{this.widget.pizzagnaService.setProperty({pizzagnaKey:m.xW.Configuration,componentId:this.widget.componentId,propertyPath:["configuration.searchConfiguration.searchTerm"]},this.widget.searchValue),this.widget.eventBus.getStream(T.RG).next({})})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})(),rn=(()=>{class n{constructor(){this.visibleItems=[]}initWidget(t){this.widget=t}initVirtualScroll(){this.widget.hasVirtualScroll?this.registerVirtualScroll():this.deregisterVirtualScroll()}registerVirtualScroll(){this.widget.dataSource&&this.widget.dataSource.registerComponent({[(0,d.$0I)("virtualScroll")]:{componentInstance:this.widget.viewportManager}})}deregisterVirtualScroll(){var t,i;this.widget.dataSource&&(null===(i=(t=this.widget.dataSource).deregisterComponent)||void 0===i||i.call(t,(0,d.$0I)("virtualScroll")))}subscribeToVirtualScroll(){!this.widget.vscrollViewport||((0,$t.T)(this.widget.vscrollViewport.renderedRangeStream,this.widget.tableUpdate$.pipe((0,It.U)(()=>{var t;return null===(t=this.widget.vscrollViewport)||void 0===t?void 0:t.getRenderedRange()}))).pipe((0,st.b)(t=>{this.visibleItems=this.widget.tableData.slice(null==t?void 0:t.start,null==t?void 0:t.end),this.widget.changeDetector.detectChanges()}),(0,_e.R)(this.widget.onDestroy$)).subscribe(),this.widget.viewportManager.setViewport(this.widget.vscrollViewport).observeNextPage$({pageSize:this.widget.range,emitFirstPage:!0}).pipe((0,Xt.h)(t=>{var i,o;return t.end>=(null!==(o=null===(i=this.widget.vscrollViewport)||void 0===i?void 0:i.getDataLength())&&void 0!==o?o:0)}),(0,st.b)(t=>this.widget.zone.run(()=>{this.widget.dataSource.page=t.end/(t.end-t.start),this.widget.eventBus.getStream(T.df).next({}),this.widget.changeDetector.detectChanges()})),(0,_e.R)(this.widget.onDestroy$)).subscribe())}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();var No=l(63776);const Ao=["widgetTable"];function yo(n,a){1&n&&(e.TgZ(0,"div",10),e._UZ(1,"nui-image",11),e.qZA())}function Mo(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",12)(1,"nui-search",13),e.NdJ("inputChange",function(o){return e.CHM(t),e.oxw().onSearchInputChanged(o)})("cancel",function(o){return e.CHM(t),e.oxw().onSearchInputChanged(o)}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("value",t.searchValue)}}function Po(n,a){if(1&n&&(e.TgZ(0,"th",17),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw();e.Udp("width",i.columnsWidthMap.get(t.id),"px")("max-width",i.columnsWidthMap.get(t.id),"px")("min-width",i.columnsWidthMap.get(t.id),"px"),e.Q6J("isColumnSortingDisabled",!t.sortable)("title",t.label)("tooltipText",i.headerTooltipsEnabled?t.label:void 0)("alignment",i.getColumnAlignment(t)),e.xp6(1),e.hij(" ",t.label," ")}}function Do(n,a){}function bo(n,a){if(1&n){const t=e.EpF();e.ynx(0,20,21),e.YNc(2,Do,0,0,"ng-template",22),e.NdJ("attached",function(o){return e.CHM(t),e.MAs(1).attached(o)}),e.BQk()}if(2&n){const t=e.MAs(1),i=e.oxw().$implicit,o=e.oxw().$implicit;e.Q6J("componentType",null==o.formatter?null:o.formatter.componentType)("properties",i[o.id]),e.xp6(2),e.Q6J("cdkPortalOutlet",t.portal)}}function Fo(n,a){if(1&n&&(e.TgZ(0,"td",18),e.YNc(1,bo,3,3,"ng-container",19),e.qZA()),2&n){const t=a.$implicit,i=e.oxw().$implicit,o=e.oxw();e.Udp("width",o.columnsWidthMap.get(i.id),"px")("max-width",o.columnsWidthMap.get(i.id),"px")("min-width",o.columnsWidthMap.get(i.id),"px"),e.Q6J("alignment",o.getColumnAlignment(i)),e.xp6(1),e.Q6J("ngIf",t[i.id]&&i.formatter)}}function xo(n,a){1&n&&(e.ynx(0,14),e.YNc(1,Po,2,11,"th",15),e.ynx(2),e.YNc(3,Fo,2,8,"td",16),e.BQk()()),2&n&&e.s9C("nuiColumnDef",a.$implicit.id)}function Lo(n,a){1&n&&e._UZ(0,"tr",23)}function wo(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"tr",24),e.NdJ("click",function(o){const c=e.CHM(t).$implicit;return e.oxw().onInteraction(c,o)}),e.qZA()}if(2&n){const t=e.oxw();e.uIk("role",t.interactive?"button":"")}}const Go=function(n){return{"virtual-scroll-disabled":n}};let fi=(()=>{class n{constructor(t,i,o,r,c,g,E,P,Z,U,ne,ue){this.eventBus=t,this.dataSource=i,this.widgetConfigurationService=o,this.changeDetector=r,this.pizzagnaService=c,this.viewportManager=g,this.zone=E,this.el=P,this.logger=Z,this.searchAddon=U,this.virtualScrollAddon=ne,this.formattersRegistryService=ue,this.indentFromTop=70,this.sortable=!0,this.delayedMousePresenceDetectionEnabled=!0,this.tableData=[],this.columns=[],this.columnsWidthMap=new Map,this.hasVirtualScroll=!0,this.isSearchEnabled=!1,this.searchTerm$=new ie.x,this.onDestroy$=new ie.x,this.tableUpdate$=new ie.x,this.mousePresent$=new en.X(!1),this.rowHeight=24,this._scrollBuffer=0,this.totalPages=0,this.lastPageFetched=0,this.sortableSet={},this.defaultColumnAlignment="left",this.idle=!1,this.isBusy=this.lastPageFetched!==this.totalPages}set range(t){this._range=t}get range(){return this.getTableScrollRange()}get headerTooltipsEnabled(){var t;return null===(t=this.configuration.headerTooltipsEnabled)||void 0===t||t}set scrollBuffer(t){if(t>100||t<0)throw new Error("Invalid scroll buffer provided. Required range 1..100");this._scrollBuffer=t}get interactive(){var t,i,o,r,c,g;return null!==(g=null!==(i=null===(t=this.configuration)||void 0===t?void 0:t.interactive)&&void 0!==i?i:null===(c=null===(r=null===(o=this.dataSource)||void 0===o?void 0:o.features)||void 0===r?void 0:r.getFeatureConfig(m.ni.Interactivity))||void 0===c?void 0:c.enabled)&&void 0!==g&&g}ngOnChanges(t){var i,o,r,c;if(t.dataFields&&(null===(i=this.dataFields)||void 0===i?void 0:i.length)&&this.setSortableSet(),(t.widgetData||t.configuration||t.dataFields)&&(this.updateTable(),null===(o=this.vscrollViewport)||void 0===o||o.checkViewportSize()),t.configuration){this.isSortByUpdated(t.configuration)&&(null===(r=t.configuration.currentValue.sortable)||void 0===r||r)&&this.onSortOrderChanged({direction:t.configuration.currentValue.sorterConfiguration.descendantSorting?d.aQE.descending:d.aQE.ascending,sortBy:t.configuration.currentValue.sorterConfiguration.sortBy});const g=Ht()(t,"configuration.currentValue.hasVirtualScroll",!0);this.hasVirtualScroll!==g&&(this.hasVirtualScroll=g,this.virtualScrollAddon.initVirtualScroll())}t.totalItems&&(this.totalPages=Math.floor((null!==(c=this.totalItems)&&void 0!==c?c:0)/this.range))}ngOnInit(){this.dataSource&&(this.setSortFilter(),this.registerSorter(),this.virtualScrollAddon.initWidget(this))}ngAfterViewInit(){var t;if(!this.dataSource)return;null===(t=this.dataSource.busy)||void 0===t||t.pipe((0,st.b)(o=>this.isBusy=o),(0,_e.R)(this.onDestroy$)).subscribe(),this.virtualScrollAddon.initVirtualScroll(),this.searchAddon.initWidget(this);const i=this.eventBus.getStream(T.pV).pipe((0,Xt.h)(o=>{var r,c;return(null===(c=null===(r=o.payload)||void 0===r?void 0:r.widgetId)||void 0===c?void 0:c.toString())===this.widgetConfigurationService.getWidget().id}),(0,It.U)(o=>{var r,c;return null!==(c=null===(r=o.payload)||void 0===r?void 0:r.height)&&void 0!==c?c:0}));i.pipe((0,_e.R)(this.onDestroy$)).subscribe(o=>{var r;this.tableContainerHeight=o-this.indentFromTop,null===(r=this.vscrollViewport)||void 0===r||r.checkViewportSize(),this.changeDetector.detectChanges()}),setTimeout(()=>{(0,$t.T)((0,tn.of)(this.range*this.rowHeight),i,(0,tn.of)(this.el.nativeElement.getBoundingClientRect().height)).pipe((0,Xt.h)(o=>!!o),(0,mi.q)(1),(0,st.b)(o=>{this.tableWidgetHeight=o,this.virtualScrollAddon.subscribeToVirtualScroll(),this.eventBus.getStream(T.j7).next({})})).subscribe()})}ngOnDestroy(){var t;this.onDestroy$.next(),this.onDestroy$.complete(),this.tableUpdate$.complete(),null===(t=this.searchTerm$)||void 0===t||t.complete(),this.pizzagnaService.setProperty({componentId:"bodyContent",propertyPath:["fallbackKey"],pizzagnaKey:m.xW.Data},void 0)}shouldDisplayTable(){var t;const i=this.columns.length>0,o=(null===(t=this.tableData)||void 0===t?void 0:t.length)>0;return this.isSearchEnabled||this.hasVirtualScroll&&(this.isBusy||this.idle)?i:i&&o}dataTrackBy(t,i){return i?i.id:t}columnTrackBy(t,i){return i.id}updateColumns(t){this.headers=t.columns.filter(r=>r.isActive).map(r=>r.id);const i=t.columns.every(r=>Boolean(r.width)),o=t.columns.map((r,c,g)=>{var E,P,Z,U;return this.columnsWidthMap.set(r.id,r.width),i&&this.columnsWidthMap.set(g[g.length-1].id,void 0),Object.assign(Object.assign({},r),{sortable:null===(U=this.sortableSet[null===(Z=null===(P=null===(E=null==r?void 0:r.formatter)||void 0===E?void 0:E.properties)||void 0===P?void 0:P.dataFieldIds)||void 0===Z?void 0:Z.value])||void 0===U||U})});o.length>0&&i&&this.logger.warn("Cannot set width for all columns. Resetting last column width."),this.columns.length!==o.length?this.columns=[...o]:this.columns.forEach((r,c)=>{Object.assign(r,o[c],{})})}mapTableData(t,i,o){return o&&0!==o.length?t.map(r=>{const c=i.reduce((g,E)=>{var P,Z,U;const ne=null===(Z=null===(P=E.formatter)||void 0===P?void 0:P.properties)||void 0===Z?void 0:Z.dataFieldIds;if(!ne)return g;const ue=Object.keys(ne).reduce((le,Oe)=>(le[Oe]=r[ne[Oe]],le),{});return g[E.id]=Object.assign({data:ue},Ro()(null===(U=E.formatter)||void 0===U?void 0:U.properties,"dataFieldIds")),g},{});return c.__record=r,c}):(this.logger.warn("There are no data fields defined, so table data cannot be displayed."),[])}onSortOrderChanged(t){var i,o;this.sortedColumn=t;const r=this.columns.find(P=>P.id===t.sortBy);if(!r)return;const c=null===(o=null===(i=r.formatter)||void 0===i?void 0:i.properties)||void 0===o?void 0:o.dataFieldIds,g=null==c?void 0:c.value;if(!g)return;const E={sortBy:g,direction:t.direction};Ye()(E,this.sortFilter)||(this.sortFilter=E,this.flushTableData(),this.eventBus.getStream(T.RG).next({}))}onInteraction(t,i){this.interactive&&(i.target.closest((this.configuration.interactionIgnoredSelectors||d.hrM).join(","))||this.eventBus.getStream(T.b1).next({payload:{data:t.__record}}))}onSearchInputChanged(t){this.searchValue=t,this.searchTerm$.next("")}getColumnAlignment(t){var i,o,r;return!(null===(i=null==t?void 0:t.formatter)||void 0===i?void 0:i.componentType)||this.formattersRegistryService.isEmpty?this.defaultColumnAlignment:((null===(o=this.formatters)||void 0===o?void 0:o.version)!==this.formattersRegistryService.stateVersion&&(this.formatters={items:this.formattersRegistryService.getItems().reduce((c,g)=>Object.assign(Object.assign({},c),{[g.componentType]:g}),{}),version:this.formattersRegistryService.stateVersion}),(null===(r=this.formatters.items[t.formatter.componentType])||void 0===r?void 0:r.alignment)||this.defaultColumnAlignment)}setSortFilter(){var t,i,o,r,c,g,E;if(this.configuration){const P=null===(t=this.configuration.sorterConfiguration)||void 0===t?void 0:t.sortBy,Z=null===(g=null===(c=null===(r=null===(o=null===(i=this.configuration.columns)||void 0===i?void 0:i.find(U=>U.id===P))||void 0===o?void 0:o.formatter)||void 0===r?void 0:r.properties)||void 0===c?void 0:c.dataFieldIds)||void 0===g?void 0:g.value;this.sortFilter={direction:(null===(E=this.configuration.sorterConfiguration)||void 0===E?void 0:E.descendantSorting)?d.aQE.descending:d.aQE.ascending,sortBy:Z}}}isSortByUpdated(t){var i;const o=null===(i=t.previousValue)||void 0===i?void 0:i.sorterConfiguration,r=t.currentValue.sorterConfiguration,c=null==o?void 0:o.sortBy,g=null==r?void 0:r.sortBy;return g?!(c===g&&r.descendantSorting===o.descendantSorting):Boolean(c)}updateTable(){this.widgetData&&this.dataFields&&this.configuration.columns&&(this.updateColumns(this.configuration),this.idle=!1,this.tableData=this.mapTableData(this.widgetData,this.configuration.columns,this.dataFields),this.tableUpdate$.next(),this.changeDetector.detectChanges())}registerSorter(){this.dataSource.registerComponent({sorter:{componentInstance:{getFilters:()=>({type:"sorter",value:this.sortFilter})}}})}setSortableSet(){this.sortableSet={},this.dataFields.forEach(t=>{var i;this.sortableSet[t.id]=null===(i=t.sortable)||void 0===i||i})}flushTableData(){this.idle=!0,this.tableData=[]}getTableScrollRange(){var t;const o=(null!==(t=this._scrollBuffer)&&void 0!==t?t:0)/100+1;return this._range?Math.floor(this._range*o):Math.floor(this.tableWidgetHeight/this.rowHeight*2*o)}}return n.lateLoadKey="TableWidgetComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(m.nY),e.Y36(m.Fk,8),e.Y36(No.I,8),e.Y36(e.sBO),e.Y36(ce.p),e.Y36(d.zCP),e.Y36(e.R0b),e.Y36(e.SBq),e.Y36(d.mQy),e.Y36(on),e.Y36(rn),e.Y36(ge.C))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-table-widget"]],viewQuery:function(t,i){if(1&t&&(e.Gf(Ao,5),e.Gf(C.N7,5),e.Gf(d.xhB,5,e.SBq)),2&t){let o;e.iGM(o=e.CRH())&&(i.table=o.first),e.iGM(o=e.CRH())&&(i.vscrollViewport=o.first),e.iGM(o=e.CRH())&&(i.tableRows=o)}},hostVars:4,hostBindings:function(t,i){2&t&&(e.Tol(i.elementClass),e.ekj("table-widget-fullwidth",!0))},inputs:{widgetData:"widgetData",componentId:"componentId",configuration:"configuration",dataFields:"dataFields",totalItems:"totalItems",indentFromTop:"indentFromTop",sortable:"sortable",delayedMousePresenceDetectionEnabled:"delayedMousePresenceDetectionEnabled",range:"range",elementClass:"elementClass"},features:[e._Bn([on,rn]),e.TTD],decls:11,vars:24,consts:[["class","h-100 d-flex justify-content-center align-items-center",4,"ngIf"],[1,"nui-table-widget","d-flex","flex-column",3,"ngClass"],["class","mr-2 mb-2 flex-row",4,"ngIf"],[1,"flex-row","h-100","nui-table-widget-container",3,"nuiDelayedMousePresenceDetection","delay","mousePresentSubject"],["tableStickyHeader","",1,"calc-height",2,"height","calc(100% - 2px)",3,"itemSize","ngClass"],["nui-table","",1,"nui-table-widget__main",3,"reorderable","sortable","totalItems","dataSource","sortedColumn","trackBy","sortOrderChanged"],["widgetTable",""],[3,"nuiColumnDef",4,"ngFor","ngForOf","ngForTrackBy"],["nui-header-row","",4,"nuiHeaderRowDef"],["nuiRowDef","","cdkVirtualFor","",3,"nuiRowDefColumns","cdkVirtualForOf","cdkVirtualForTrackBy"],[1,"h-100","d-flex","justify-content-center","align-items-center"],["image","no-data-to-show"],[1,"mr-2","mb-2","flex-row"],[1,"unlimited-width","d-flex","justify-content-end","flex-grow-1",3,"value","inputChange","cancel"],[3,"nuiColumnDef"],["nui-header-cell","",3,"isColumnSortingDisabled","width","max-width","min-width","title","tooltipText","alignment",4,"nuiHeaderCellDef"],["nui-cell","",3,"width","max-width","min-width","alignment",4,"nuiCellDef"],["nui-header-cell","",3,"isColumnSortingDisabled","title","tooltipText","alignment"],["nui-cell","",3,"alignment"],["nuiComponentPortal","","componentId","formatter",3,"componentType","properties",4,"ngIf"],["nuiComponentPortal","","componentId","formatter",3,"componentType","properties"],["componentPortal","nuiComponentPortal"],[3,"cdkPortalOutlet","attached"],["nui-header-row",""],["nui-row","","density","tiny",3,"click"]],template:function(t,i){1&t&&(e.YNc(0,yo,2,0,"div",0),e.TgZ(1,"div",1),e.YNc(2,Mo,2,1,"div",2),e.TgZ(3,"div",3)(4,"cdk-virtual-scroll-viewport",4),e.ALo(5,"async"),e.TgZ(6,"table",5,6),e.NdJ("sortOrderChanged",function(r){return i.onSortOrderChanged(r)}),e.YNc(8,xo,4,1,"ng-container",7),e.YNc(9,Lo,1,0,"tr",8),e.YNc(10,wo,1,1,"ng-template",9),e.qZA()()()()),2&t&&(e.Q6J("ngIf",!i.shouldDisplayTable()),e.xp6(1),e.Q6J("ngClass",i.shouldDisplayTable()?"h-100":"invisible"),e.xp6(1),e.Q6J("ngIf",i.isSearchEnabled),e.xp6(1),e.Q6J("nuiDelayedMousePresenceDetection",i.delayedMousePresenceDetectionEnabled)("delay",i.configuration.scrollActivationDelayMs)("mousePresentSubject",i.mousePresent$),e.xp6(1),e.Q6J("itemSize",i.rowHeight)("ngClass",e.VKq(22,Go,!1===e.lcZ(5,20,i.mousePresent$)&&i.delayedMousePresenceDetectionEnabled)),e.xp6(2),e.Q6J("reorderable",null==i.configuration?null:i.configuration.reorderable)("sortable",i.sortable)("totalItems",i.totalItems)("dataSource",i.virtualScrollAddon.visibleItems)("sortedColumn",i.sortedColumn)("trackBy",i.dataTrackBy),e.xp6(2),e.Q6J("ngForOf",i.columns)("ngForTrackBy",i.columnTrackBy),e.xp6(1),e.Q6J("nuiHeaderRowDef",i.headers),e.xp6(1),e.Q6J("nuiRowDefColumns",i.headers)("cdkVirtualForOf",i.tableData)("cdkVirtualForTrackBy",i.dataTrackBy))},directives:[s.O5,d.cuP,s.mk,d.gSk,qi,C.N7,d.Fpu,C.xd,d.ac$,s.sg,d.yNF,d.Go6,d.Asp,d.wCL,d.tNH,L.$,z.Pl,d.Pu4,d.ue9,d.l6o,C.x0,d.xhB],pipes:[s.Ov],styles:[".nui-table-widget[_ngcontent-%COMP%]{overflow:auto;width:100%}.nui-table-widget[_ngcontent-%COMP%]   .display-contents[_ngcontent-%COMP%]{display:contents}.nui-table-widget__main[_ngcontent-%COMP%]{flex:1 1 auto}.nui-table-widget__paginator[_ngcontent-%COMP%]{margin-top:10px}.nui-table-widget__overflow[_ngcontent-%COMP%]{overflow-y:auto}.nui-table-widget[_ngcontent-%COMP%]   .nui-table-widget-container[_ngcontent-%COMP%]   .virtual-scroll-disabled.cdk-virtual-scroll-viewport[_ngcontent-%COMP%]{overflow:hidden!important}.mobile[_nghost-%COMP%]   .calc-height[_ngcontent-%COMP%], .mobile   [_nghost-%COMP%]   .calc-height[_ngcontent-%COMP%]{min-height:200px}.table-widget-fullwidth[_nghost-%COMP%]{width:calc(100% - 10px)}.invisible[_ngcontent-%COMP%]{height:0}@-moz-document url-prefix(){.nui-table-widget-container{margin-right:10px}}"],changeDetection:0}),n})();var sn=l(69769),Ti=l(15439),We=l.n(Ti);let $o=(()=>{class n{convertToSerializable(t){return{startDatetime:t.startDatetime.format(),endDatetime:t.endDatetime.format(),selectedPresetId:t.selectedPresetId,title:t.title}}convertFromSerializable(t){return{startDatetime:We()(t.startDatetime,We().defaultFormat),endDatetime:We()(t.endDatetime,We().defaultFormat),selectedPresetId:t.selectedPresetId,title:t.title}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Ci=(()=>{class n{constructor(t,i,o,r,c,g,E){this.pizzagnaService=t,this.timeframeService=i,this.tfSerialization=o,this.history=r,this.dataSource=c,this.eventBus=g,this.changeDetector=E,this.currentTimeframe=this.timeframeService.getTimeframeByPresetId("last7Days")}ngOnChanges(t){if(t.timeframe){let i=this.tfSerialization.convertFromSerializable(this.timeframe);i=this.timeframeService.reconcileTimeframe(i),i.selectedPresetId&&(i=this.timeframeService.getTimeframeByPresetId(i.selectedPresetId)),this.currentTimeframe=i,t.timeframe.isFirstChange()||this.eventBus.getStream(T.RG).next({})}t.minDate&&(this.minDateAsMoment=We()(this.minDate,We().defaultFormat)),t.maxDate&&(this.maxDateAsMoment=We()(this.maxDate,We().defaultFormat))}ngOnInit(){this.history.restart(this.currentTimeframe),this.eventBus.getStream(T.re).subscribe(t=>{if(!t.payload)throw new Error("Unable to set timeframe. Event payload is undefined");this.onTimeframeChange(this.history.save(this.tfSerialization.convertFromSerializable(t.payload)))}),this.dataSource&&this.dataSource.registerComponent({timeframe:{componentInstance:{getFilters:()=>({type:"timeframe",value:this.timeframeService.reconcileTimeframe(this.currentTimeframe)})}}})}onTimeframeChange(t){const i=this.timeframeService.reconcileTimeframe(t);i.selectedPresetId=i.selectedPresetId||"",this.timeframeService.isEqual(i,this.currentTimeframe)||this.pizzagnaService.setProperty({pizzagnaKey:m.xW.Data,componentId:this.componentId,propertyPath:["timeframe"]},this.tfSerialization.convertToSerializable(i))}}return n.lateLoadKey="TimeframeSelectionComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(ce.p),e.Y36(d.hYR),e.Y36($o),e.Y36(d.vpR),e.Y36(m.Fk,8),e.Y36(m.nY),e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-timeframe-selection"]],hostVars:2,hostBindings:function(t,i){2&t&&e.Tol(i.elementClass)},inputs:{componentId:"componentId",minDate:"minDate",maxDate:"maxDate",timeframe:"timeframe"},features:[e._Bn([d.vpR]),e.TTD],decls:6,vars:8,consts:[[3,"minDate","maxDate","timeFrame","historyIndex","timeFrameChange","undo","clear"],["icon","calendar",1,"pr-3"],["timeFrameSelection","",3,"presets"]],template:function(t,i){1&t&&(e.TgZ(0,"nui-time-frame-bar",0),e.NdJ("timeFrameChange",function(r){return i.onTimeframeChange(i.history.restart(r))})("undo",function(){return i.onTimeframeChange(i.history.undo())})("clear",function(){return i.onTimeframeChange(i.history.restart())}),e._UZ(1,"nui-icon",1),e._uU(2),e.ALo(3,"timeFrame"),e.TgZ(4,"nui-quick-picker",2),e._UZ(5,"nui-time-frame-picker"),e.qZA()()),2&t&&(e.Q6J("minDate",i.minDateAsMoment)("maxDate",i.maxDateAsMoment)("timeFrame",i.currentTimeframe)("historyIndex",i.history.index),e.xp6(2),e.hij(" ",e.lcZ(3,6,i.currentTimeframe)," "),e.xp6(2),e.Q6J("presets",i.timeframeService.currentPresets))},directives:[d.y0H,d.oJW,d.mtp,d.xlZ],pipes:[d.aEp],styles:["[_nghost-%COMP%]{border-top:1px solid;border-top-color:var(--nui-color-line-default,#d9d9d9);border-bottom:1px solid;border-bottom-color:var(--nui-color-line-default,#d9d9d9)}"]}),n})();var Ut=(()=>{return(n=Ut||(Ut={})).DataPoints="dataPoints",n.Series="series",n.Values="values",Ut;var n})(),nt=(()=>{return(n=nt||(nt={})).Time="time",n.TimeInterval="timeInterval",n.Linear="linear",nt;var n})(),Pe=(()=>{return(n=Pe||(Pe={})).Line="line",n.StackedArea="stackedArea",n.StackedPercentageArea="stackedPercentageArea",n.StackedBar="stackedBar",n.StatusBar="statusBar",Pe;var n})(),zt=(()=>{return(n=zt||(zt={}))[n.gauge=1]="gauge",n[n.counter=2]="counter",n[n.event=3]="event",n[n.alert=4]="alert",n[n.state=5]="state",n[n.multi=6]="multi",n[n.dpaWaitTime=7]="dpaWaitTime",zt;var n})(),je=(()=>{return(n=je||(je={})).None="none",n.Normalize="normalize",n.ChangePoint="changePoint",n.Difference="difference",n.Linear="linear",n.PercentileStd="percentileStd",n.Smoothing="smoothing",n.LoessStandardize="loessStandardize",n.Standardize="standardize",n.FloatingAverage="floatingAverage",je;var n})(),vt=(()=>{return(n=vt||(vt={}))[n.ModernDashboard=0]="ModernDashboard",n[n.PerfstackApp=1]="PerfstackApp",vt;var n})();const Uo={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"},Bo=n=>{const t=((n,a)=>new Intl.DateTimeFormat(We().locale(),a).format(n))(n,Uo).split(",");if(2!==t.length)throw new Error("Invalid timeseries date time format.");return`${t[0]} ${t[1]}`};let Dt=(()=>{class n{constructor(t){this.unitConversionService=t,this.unitConversionPipe=new lt(this.unitConversionService)}getScale(t,i,o){let r;switch(t.type){case nt.Time:r=new h.FBd,r.isTimeseriesScale=!0,r.formatters.title=Bo;break;case nt.Linear:r=new h.f$s,r.isTimeseriesScale=!0,r.formatters.tick=(c,g)=>{var E,P;return this.unitConversionPipe.transform(c,null!==(P=null===(E=t.properties)||void 0===E?void 0:E.axisUnits)&&void 0!==P?P:i,d.Qln.Standard)};break;case nt.TimeInterval:r=new h.lTH((0,Ti.duration)(1,"hour"))}return this.updateConfiguration(r,t,o),r}updateConfiguration(t,i,o){var r,c,g,E,P,Z;switch(i.type){case nt.Time:{const U=null===(r=i.properties)||void 0===r?void 0:r.timeInterval;(null==U?void 0:U.startDatetime)&&(null==U?void 0:U.endDatetime)&&t.fixDomain([U.startDatetime,U.endDatetime]);break}case nt.TimeInterval:{const U=null===(c=i.properties)||void 0===c?void 0:c.interval;if("number"==typeof U){if(U<=0)throw new Error("Interval value must be greater than zero.");t instanceof h.lTH&&t.interval((0,Ti.duration)(U,"seconds"))}break}case nt.Linear:if((null===(g=i.properties)||void 0===g?void 0:g.axisUnits)&&(t.scaleUnits=i.properties.axisUnits),(null==o?void 0:o.preset)===Pe.StatusBar||(null==o?void 0:o.preset)===Pe.StackedArea)return;if("percent"===(null===(E=i.properties)||void 0===E?void 0:E.axisUnits)&&t.setFixDomainValues&&t.setFixDomainValues([0,25,50,75,100]),"percent"!==(null===(P=i.properties)||void 0===P?void 0:P.axisUnits)&&(null===(Z=i.properties)||void 0===Z?void 0:Z.domain)&&t.setFixDomainValues){const U=(null==o?void 0:o.preset)===Pe.StackedBar?this.getStackedBarScaleDomain(i.properties.domain):this.getLineScaleDomain(i.properties.domain);t.setFixDomainValues(U)}}}getStackedBarScaleDomain({min:t,max:i}){(0===i||i%4>0)&&(i=i+4-i%4);const o=Math.floor((i-t)/4);return[t,t+o,t+2*o,i-o,i]}getLineScaleDomain({min:t,max:i}){if(t>i){const c=t;t=i,i=c}Math.abs((i-t)/((i+t)/2))<.5&&(t-=.5*Math.abs(t),i+=.5*Math.abs(i)),0===t&&0===i&&(t=-1,i=1),Math.abs(i-t)<.04&&(i+=.04);const r=(i-t)/4;return[t,t+r,t+2*r,i-r,i]}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(d.CrH))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();function Wo(n,a){if("percent"===a)return{min:0,max:100};const t=n.filter(o=>{var r;return"percent"!==o.metricUnits&&(null===(r=o.data)||void 0===r?void 0:r.length)});if(0===t.length)return{min:-1,max:1};const i=t.flatMap(o=>{var r;return null!==(r=o.data)&&void 0!==r?r:[]});return i.reduce((o,r)=>({min:Math.min(o.min,r.y),max:Math.max(o.max,r.y)}),{min:i[0].y,max:i[0].y})}let an=(()=>{class n{constructor(t,i){this.timeseriesScalesService=t,this.dataSource=i,this.widgetData={},this.configuration={},this.scales={},this.destroy$=new ie.x,this.buildChart$=new ie.x,this.resetChart=!1,this.chartBuilt=!1,this.buildChart$.pipe((0,_e.R)(this.destroy$)).subscribe(()=>{this.chartBuilt=!0})}get seriesInteractive(){var t,i,o,r;return"series"===(null===(t=this.configuration)||void 0===t?void 0:t.interaction)||(null===(r=null===(o=null===(i=this.dataSource)||void 0===i?void 0:i.features)||void 0===o?void 0:o.getFeatureConfig(m.ni.Interactivity))||void 0===r?void 0:r.enabled)||!1}ngOnInit(){this.configuration.preset===Pe.Line&&this.widgetData&&this.widgetData.series&&this.widgetData.series.forEach(t=>t.rawData=t.data)}ngOnChanges(t){var i,o,r,c,g,E,P,Z;let U=!1,ne=!1;if(t.configuration){const ue=t.configuration.currentValue,le=t.configuration.previousValue;if((null==ue?void 0:ue.preset)!==(null==le?void 0:le.preset)&&(ne=!0),(null==ue?void 0:ue.scales)!==(null==le?void 0:le.scales)){const Oe=Object.keys(null==ue?void 0:ue.scales);for(const he of Oe){const Se=null===(i=null==ue?void 0:ue.scales)||void 0===i?void 0:i[he],ye=null===(o=null==le?void 0:le.scales)||void 0===o?void 0:o[he];!Se||((null==Se?void 0:Se.type)!==(null==ye?void 0:ye.type)||(null===(r=null==Se?void 0:Se.properties)||void 0===r?void 0:r.axisUnits)!==(null===(c=null==ye?void 0:ye.properties)||void 0===c?void 0:c.axisUnits)?(this.scales[he]=this.timeseriesScalesService.getScale(Se,ue.units,this.configuration),U=!0):(null==Se?void 0:Se.properties)!==(null==ye?void 0:ye.properties)&&(this.timeseriesScalesService.updateConfiguration(this.scales[he],Se,this.configuration),U=!0))}}}(ne||!this.chartBuilt)&&this.buildChart(),t.widgetData&&!t.widgetData.isFirstChange()&&(0===(null===(E=null===(g=this.widgetData)||void 0===g?void 0:g.series)||void 0===E?void 0:E.length)&&(this.resetChart=!0),this.widgetData&&this.widgetData.series&&(this.resetChart&&(null===(Z=null===(P=this.widgetData)||void 0===P?void 0:P.series)||void 0===Z?void 0:Z.length)>0&&(this.resetChart=!1,this.buildChart()),this.applyPreviousTransformer(t.widgetData.previousValue),U=!0)),U&&this.updateChartData()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.buildChart$.complete()}applyPreviousTransformer(t){this.widgetData.series.forEach(i=>{var o;i.rawData=i.data,i.transformer=null===(o=null==t?void 0:t.series.find(r=>r.id===i.id))||void 0===o?void 0:o.transformer,this.transformSeriesData(i)})}transformSeriesData(t){if(t.transformer&&t.rawData&&t.rawData.length>0)try{t.data=t.transformer(t.rawData,"percent"===t.metricUnits),this.updateYAxisDomain()}catch(i){t.transformer=void 0,t.data=t.rawData,console.error(i.message)}}updateYAxisDomain(){var t,i;const o=["y","yRight"];for(const r of o){const c=null===(t=this.configuration.scales)||void 0===t?void 0:t[r];(null==c?void 0:c.properties)&&(c.properties.domain=Object.assign({},Wo(this.widgetData.series,null===(i=null==c?void 0:c.properties)||void 0===i?void 0:i.axisUnits)),this.timeseriesScalesService.updateConfiguration(this.scales[r],c,this.configuration))}}}return n.\u0275fac=function(t){e.$Z()},n.\u0275dir=e.lG2({type:n,inputs:{widgetData:"widgetData",configuration:"configuration"},features:[e.TTD]}),n})();function ko(n,a){1&n&&e._UZ(0,"nui-icon",12),2&n&&e.Q6J("icon",a.$implicit)}function Zo(n,a){if(1&n&&(e.TgZ(0,"div",6)(1,"nui-legend",7)(2,"nui-legend-series",8)(3,"div",9),e._UZ(4,"div",10),e.YNc(5,ko,1,1,"nui-icon",11),e.qZA()()()()),2&n){const t=a.$implicit,i=e.oxw(3);e.ekj("layout-fixed-legend",null==i.configuration.gridConfig?null:i.configuration.gridConfig.fixedLayout),e.xp6(1),e.Q6J("active",i.chartAssist.isLegendActive),e.xp6(1),e.Q6J("descriptionPrimary",t.legendDescriptionPrimary)("descriptionSecondary",t.legendDescriptionSecondary),e.xp6(2),e.Udp("background-color",i.getDataPointData(t,"color")),e.xp6(1),e.Q6J("ngIf",i.getDataPointData(t,"icon"))}}function Vo(n,a){if(1&n&&(e.TgZ(0,"div",3),e._UZ(1,"nui-chart",4),e.YNc(2,Zo,6,8,"div",5),e.qZA()),2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("chart",t.chart)("nuiChartCollectionId",i.collectionId),e.xp6(1),e.Q6J("ngIf",(null==t.chartSeriesSet?null:t.chartSeriesSet.length)>0&&t.chartSeriesSet[0])}}function Jo(n,a){if(1&n&&(e.TgZ(0,"div",1),e.YNc(1,Vo,3,3,"div",2),e.qZA()),2&n){const t=e.oxw();e.ekj("layout-fixed",null==t.configuration.gridConfig?null:t.configuration.gridConfig.fixedLayout),e.xp6(1),e.Q6J("ngForOf",t.chartAssist.sparks)("ngForTrackBy",t.chartAssist.trackByFn)}}let Oi=(()=>{class n extends an{constructor(t,i,o,r,c,g){super(o,i),this.iconService=t,this.timeseriesScalesService=o,this.changeDetector=r,this.eventBus=c,this.zoomPluginsSyncService=g,this.collectionId=(0,d.VjN)("timeseries-status-charts"),this.chartUpdate$=new ie.x}ngOnInit(){}getDataPointData(t,i){var o;const r=null===(o=this.chartAssist.highlightedDataPoints[t.id])||void 0===o?void 0:o.data;return r?r[i]:t.data.length>0?t.data[t.data.length-1][i]:void 0}buildChart(){this.buildChart$.next(),this.chartAssist=new h.ruA,this.accessors=(0,h.s_I)(this.chartAssist.palette.standardColors),this.accessors.data.color=(i,o,r,c)=>void 0===i.color?"var(--nui-color-semantic-unknown)":i.color,this.accessors.data.thickness=i=>void 0===i.thick||i.thick?h.Z7w.THICK:h.Z7w.THIN,this.accessors.data.marker=i=>i.icon?this.iconService.getIconResized(this.iconService.getIconData(i.icon).code,8):void 0,this.renderer=new h.Z7w({highlightStrategy:new h.Pkp("x"),pointerEvents:!1}),this.setGridConfigFromConfiguration(this.chartAssist.gridConfig),this.setGridConfigFromConfiguration(this.chartAssist.lastGridConfig),this.scales.y=new h.jS7,this.scales.y.fixDomain(h.s1E.STATUS_DOMAIN),this.scales.y.isTimeseriesScale=!0,this.scales.yRight&&(this.scales.yRight=this.scales.y)}updateChartData(){var t,i,o,r,c,g;const{gridConfig:E,lastGridConfig:P}=this.chartAssist;E.axis.bottom.visible=!(null===(t=this.configuration)||void 0===t?void 0:t.hasAdjacentChart),P.axis.bottom.visible=!(null===(i=this.configuration)||void 0===i?void 0:i.hasAdjacentChart),E.borders.bottom.className=(null===(o=this.configuration)||void 0===o?void 0:o.hasAdjacentChart)?"nui-chart-border":"nui-chart-border nui-chart-border--thick",P.borders.bottom.className=(null===(r=this.configuration)||void 0===r?void 0:r.hasAdjacentChart)?"nui-chart-border":"nui-chart-border nui-chart-border--thick",this.chartUpdate$.next();const Z=this.widgetData.series.map(U=>Object.assign(Object.assign({},U),{data:this.transformData(U.data,this.scales.x instanceof h.lTH),accessors:this.accessors,renderer:this.renderer,scales:this.scales}));this.chartAssist.update(Z),this.configuration.enableZoom&&(this.chartAssist.sparks.forEach(U=>{var ne,ue,le,Oe,he;(null===(ne=this.configuration)||void 0===ne?void 0:ne.projectType)===vt.PerfstackApp?(null===(ue=null==U?void 0:U.chart)||void 0===ue?void 0:ue.hasPlugin(h.F7W))||null===(le=null==U?void 0:U.chart)||void 0===le||le.addPlugin(new h.F7W({collectionId:this.collectionId},this.zoomPluginsSyncService)):(null===(Oe=null==U?void 0:U.chart)||void 0===Oe?void 0:Oe.hasPlugin(h.Rbc))||null===(he=null==U?void 0:U.chart)||void 0===he||he.addPlugin(new h.Rbc({enableExternalEvents:!0}))}),null===(c=this.chartAssist.sparks[0].chart)||void 0===c||c.getEventBus().getStream(h.bdF).pipe((0,_e.R)((0,$t.T)(this.chartUpdate$,null===(g=this.chartAssist.sparks[0].chart)||void 0===g?void 0:g.eventBus.getStream(h.wu_),this.buildChart$))).subscribe(U=>{const ne=U.data,ue=ne[Object.keys(ne)[0]];this.eventBus.getStream(T.re).next({payload:{startDatetime:ue[0],endDatetime:ue[1],selectedPresetId:void 0}})}))}transformData(t,i){const o=[];return t.forEach((r,c)=>{(i||t.length-1!==c)&&o.push({start:r.x,end:i?r.x:t[c+1].x,status:r.y,color:r.color,thick:r.thick,icon:r.icon})}),o}setGridConfigFromConfiguration(t){var i,o,r;const c=this.configuration;(null===(i=c.gridConfig)||void 0===i?void 0:i.xAxisTicksCount)&&(t.axis.bottom.approximateTicks=c.gridConfig.xAxisTicksCount),t.dimension.marginLocked&&(null===(o=c.gridConfig)||void 0===o?void 0:o.sideMarginLocked)&&(t.dimension.marginLocked.left=!0,t.dimension.marginLocked.right=!0),(null===(r=c.gridConfig)||void 0===r?void 0:r.sideMargin)&&(t.dimension.margin.left=c.gridConfig.sideMargin,t.dimension.margin.right=c.gridConfig.sideMargin)}}return n.lateLoadKey="StatusChartComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(d.C6t),e.Y36(m.Fk,8),e.Y36(Dt),e.Y36(e.sBO),e.Y36(m.nY),e.Y36(h.n_R))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-status-bar-chart"]],features:[e.qOj],decls:1,vars:1,consts:[["class","status-bar-chart",3,"layout-fixed",4,"ngIf"],[1,"status-bar-chart"],["class","d-flex",4,"ngFor","ngForOf","ngForTrackBy"],[1,"d-flex"],[1,"d-flex","flex-grow-1",3,"chart","nuiChartCollectionId"],["class","d-flex flex-column pl-2",3,"layout-fixed-legend",4,"ngIf"],[1,"d-flex","flex-column","pl-2"],[1,"status-bar-chart__legend",3,"active"],[3,"descriptionPrimary","descriptionSecondary"],[1,"status-bar-chart__legend__tile","d-flex","justify-content-center","align-items-center"],[1,"w-100","h-100","status-bar-chart__legend__tile__background"],["class","status-bar-chart__legend__tile__icon",3,"icon",4,"ngIf"],[1,"status-bar-chart__legend__tile__icon",3,"icon"]],template:function(t,i){1&t&&e.YNc(0,Jo,2,4,"div",0),2&t&&e.Q6J("ngIf",i.chartAssist)},directives:[s.O5,s.sg,h.xH4,h.VMb,h.FVX,h.kJo,d.oJW],styles:[".status-bar-chart__legend__tile[_ngcontent-%COMP%]{width:60px;position:relative}.status-bar-chart__legend__tile__background[_ngcontent-%COMP%]{position:absolute;opacity:.4}.status-bar-chart__legend__tile__icon[_ngcontent-%COMP%]{position:absolute}.layout-fixed-legend[_ngcontent-%COMP%]{max-width:250px;min-width:250px;padding-left:8px!important}.layout-fixed-legend[_ngcontent-%COMP%]   nui-legend[_ngcontent-%COMP%]{margin:0!important;width:100%}"]}),n})();var Yo=l(90733),dt=l.n(Yo);function Ho(n,a){const t=dt()(n),i=n.length,o={x:[],y:[]};return t.forEach(g=>{o.x.push(g.x.valueOf()),o.y.push(g.y)}),function r(g){const E=[];let P,Z,U=0;for(let ne=0;ne<i;ne++){if(ne===i-1){E.push(U);break}P=g[ne+1],Z=g[ne],U=P-Z,a&&(U=Math.abs(U)),E.push(U)}return E}(o.y).forEach((g,E)=>{t[E].y=g}),t}var Et=l(34978);function Ii(n){let a=n.length,t=-1;for(;++t<a;)if(!isFinite(n[t]))return!1;return!0}function Qo(n){let a=n.length,t=0;for(;++t<a;)if(n[t-1]>=n[t])return!1;return!0}function Xo(n){return(n=1-n*n*n)*n*n}function jo(n,a,t,i){const o=i[0],c=ln(a,i[1]);if(c<n.length&&n[c]-n[t]<n[t]-n[o]){const g=ln(a,o);i[0]=g,i[1]=c}}function ln(n,a){let t=a+1;for(;t<n.length&&0===n[t];)t++;return t}function qo(n){return function er(n,a){let t=(n=n.slice().sort(tr)).length-1;return a.map(function(i){if(0===i)return n[0];if(1===i)return n[t];let o=1+i*t,r=Math.floor(o),c=o-r,g=n[r-1];return 0===c?g:g+c*(n[r]-g)})}(n,[.5])[0]}function tr(n,a){return n-a}function vi(n,a){const t=dt()(n),i={x:[],y:[]};return t.forEach(r=>{i.x.push(r.x.valueOf()),i.y.push(r.y)}),function Ko(){let n=.3,a=2,t=1e-12;function i(o,r,c){let E,g=o.length;if(g!==r.length)throw new Error("Mismatched array lengths");if(0===g)throw new Error("At least one point required.");if(arguments.length<3)for(c=[],E=-1;++E<g;)c[E]=1;if(Ii(o),Ii(r),Ii(c),Qo(o),1===g)return[r[0]];if(2===g)return[r[0],r[1]];const P=Math.floor(n*g);if(P<2)throw new Error("Bandwidth too small.");const Z=[],U=[],ne=[];for(E=-1;++E<g;)Z[E]=0,U[E]=0,ne[E]=1;let ue=-1;for(;++ue<=a;){const le=[0,P-1];let Oe;for(E=-1;++E<g;){Oe=o[E],E>0&&jo(o,c,E,le);const Ue=le[0],Lt=le[1];let Kt=0,_o=0,uo=0,po=0,go=0,Ic=Math.abs(1/(o[o[E]-o[Ue]>o[Lt]-o[E]?Ue:Lt]-Oe));for(let wt=Ue;wt<=Lt;++wt){let ci=o[wt],To=r[wt],Xi=Xo((wt<E?Oe-ci:ci-Oe)*Ic)*ne[wt]*c[wt],ji=ci*Xi;Kt+=Xi,_o+=ji,uo+=ci*ji,po+=To*Xi,go+=To*ji}const Vt=_o/Kt,ho=po/Kt,vc=go/Kt,mo=uo/Kt,fo=Math.sqrt(Math.abs(mo-Vt*Vt))<t?0:(vc-Vt*ho)/(mo-Vt*Vt);Z[E]=fo*Oe+(ho-fo*Vt),U[E]=Math.abs(r[E]-Z[E])}if(ue===a)break;const he=qo(U);if(Math.abs(he)<t)break;let Se,ye;for(E=-1;++E<g;)Se=U[E]/(6*he),ne[E]=Se>=1?0:(ye=1-Se*Se)*ye}return Z}return i.bandwidth=function(o){return arguments.length?(n=o,i):o},i.robustnessIterations=function(o){return arguments.length?(a=o,i):o},i.accuracy=function(o){return arguments.length?(t=o,i):o},i}().bandwidth(.1)(i.x,i.y).forEach((r,c)=>{t[c].y=r}),t}function ir(n,a){var t,i,o,r;let c=dt()(n);c=vi(c);let P,U,ne,ue,Z=0,le=[],Oe=[],he=!0,Se=0,ye=19,Ue=20,Lt=Ue+ye;for(;he;){he=!1,le=[],Oe=[];for(let Ze=Se;Ze<=ye;Ze++)le.push(n[Ze].y);for(let Ze=Ue;Ze<=Lt;Ze++)Oe.push(n[Ze].y);if(Z=null!==(t=Et.J69(le))&&void 0!==t?t:0,ne=null!==(i=Et.J69(Oe))&&void 0!==i?i:0,U=null!==(o=Et.P3(le))&&void 0!==o?o:0,U<1&&(U=1),ue=null!==(r=Et.P3(Oe))&&void 0!==r?r:0,ue<1&&(ue=1),P=nr(Z,ne,U,ue,le.length,Oe.length,1.729),P>1.729){for(let Ze=Se;Ze<=ye;Ze++)c[Ze].y=Z;Se=Ue}ye=Lt,ye+20<n.length?(he=!0,Ue=ye+1,Lt=Ue+20-1):ye=n.length-1}for(let Ze=Se;Ze<=ye;Ze++)c[Ze].y=Z;return c}function nr(n,a,t,i,o,r,c){const g=n-a,E=Math.pow(t,2)/o+Math.pow(i,2)/r;let Z=g/Math.sqrt(E);return Z>c&&n<a+2*i&&n>a-2*i&&a<n+2*t&&a>n-2*t&&(Z=0),Math.abs(Z)}function or(n,a){const t=dt()(n);return t.forEach((o,r)=>{t[r].y=function i(o,r){let c=0,g=0;const E=We()(o[r].x);for(;r>=0&&E.diff(We()(o[r].x),"minutes")<=60;)g++,c+=o[r].y,r--;return c/g}(t,r)}),t}function Ei(n,a){const t=dt()(n),i={x:[],y:[]};return t.forEach(c=>{i.x.push(c.x.valueOf()),i.y.push(c.y)}),function r(c){const g=Math.max(...c),E=Math.min(...c);return c.map(g===E?P=>0:P=>(P-E)/(g-E))}(i.y).forEach((c,g)=>{t[g].y=100*c}),t}function rr(n,a){const t=dt()(n),i={x:[],y:[]};return t.forEach(c=>{i.x.push(c.x.valueOf()),i.y.push(c.y)}),function o(c,g){let E=0,P=0,Z=0,U=0,ne=0,ue=0,le=0;if(c.length!==g.length)throw new Error("The x and y data arrays need to be the same length");if(0===c.length)throw new Error("There's no data to work with");for(let Ue=0;Ue<c.length;Ue++)ue=c[Ue],le=g[Ue],E+=ue,P+=le,U+=Math.pow(ue,2),Z+=ue*le,ne++;const Oe=(ne*Z-E*P)/(ne*U-E*E),he=P/ne-Oe*E/ne,Se=[],ye=[];for(let Ue=0;Ue<c.length;Ue++)ue=c[Ue],le=ue*Oe+he,Se.push(ue),ye.push(le);return ye}(i.x,i.y).forEach((c,g)=>{t[g].y=c}),t}function dn(n,a){let t=dt()(n);const i={x:[],y:[]};return t.forEach(c=>{i.x.push(c.x.valueOf()),i.y.push(c.y)}),function r(c){var g;const E=null!==(g=Et.P3(c))&&void 0!==g?g:1;return c.map(P=>{var Z;return(P-(null!==(Z=Et.J69(c))&&void 0!==Z?Z:0))/(E<1?1:E)})}(i.y).forEach((c,g)=>{t[g].y=a?Math.abs(c):c}),a&&(t=Ei(t)),t}function sr(n,a){let t=dt()(n);return t=vi(t),t=dn(t,a),t}function ar(n,a){let t=dt()(n);const i={x:[],y:[]};return t.forEach(g=>{i.x.push(g.x.valueOf()),i.y.push(g.y)}),function o(g){var E;const P=null!==(E=Et.C2o(g))&&void 0!==E?E:0,Z=function r(g,E){var P;const Z=g.map(ne=>Math.abs(ne-E));let U=null!==(P=Et.C2o(Z))&&void 0!==P?P:0;return U<1&&(U=1),U}(g,P);return g.map(U=>(U-P)/Z)}(i.y).forEach((g,E)=>{t[E].y=a?Math.abs(g):g}),a&&(t=Ei(t)),t}let jt=(()=>{class n extends an{constructor(t,i,o,r,c){super(o,i),this.eventBus=t,this.timeseriesScalesService=o,this.changeDetector=r,this.zoomPluginsSyncService=c,this.valueAccessorKey="y",this.collectionId="",this.transformers=new Map([[je.None,{displayName:$localize`None`,transformer:void 0}],[je.ChangePoint,{displayName:$localize`Change Point`,transformer:ir}],[je.Difference,{displayName:$localize`Difference`,transformer:Ho}],[je.FloatingAverage,{displayName:$localize`Floating Average`,transformer:or}],[je.Linear,{displayName:$localize`Linear`,transformer:rr}],[je.Normalize,{displayName:$localize`Normalize`,transformer:Ei}],[je.PercentileStd,{displayName:$localize`Percentile Standardized`,transformer:ar}],[je.Smoothing,{displayName:$localize`Smoothing`,transformer:vi}],[je.LoessStandardize,{displayName:$localize`Smoothing Standardized`,transformer:sr}],[je.Standardize,{displayName:$localize`Standardize`,transformer:dn}]])}mapSeriesSet(t,i){const o=[i.y];return i.yRight&&o.push(i.yRight),t.map((r,c)=>{var g;let E=o.find(P=>P.scaleUnits===r.metricUnits);return E||(E=null!==(g=o.find(P=>"generic"===P.scaleUnits))&&void 0!==g?g:i.y),Object.assign(Object.assign({},r),{scales:{x:i.x,y:E},renderer:this.renderer,accessors:this.accessors})})}hasLegend(){return this.configuration.legendPlacement&&this.configuration.legendPlacement!==we.w.None}legendShouldBeAlignedRight(){return this.configuration.legendPlacement===we.w.Right}onPrimaryDescClick(t,i){!this.seriesInteractive||(t.stopPropagation(),this.eventBus.getStream(T.b1).next({payload:{data:i,interactionType:Ut.Series}}))}updateChartData(){var t,i,o,r;const c=this.chartAssist.chart.getGrid();(null===(t=this.scales.y)||void 0===t?void 0:t.id)&&(c.leftScaleId=this.scales.y.id),this.scales.yRight&&1===this.widgetData.series.length||this.scales.y&&this.scales.yRight&&this.scales.y.scaleUnits===this.scales.yRight.scaleUnits?(this.scales.yRight=this.scales.y,c.rightScaleId=this.scales.y.id):(null===(i=this.scales.yRight)||void 0===i?void 0:i.id)&&(c.rightScaleId=this.scales.yRight.id);const g=c.config();g.axis.bottom.visible=!(null===(o=this.configuration)||void 0===o?void 0:o.hasAdjacentChart),g.borders.bottom.visible=!(null===(r=this.configuration)||void 0===r?void 0:r.hasAdjacentChart),this.chartAssist.update(this.mapSeriesSet(this.widgetData.series,this.scales))}buildChart(){var t,i,o,r;this.buildChart$.next();const c=this.configuration.chartColors&&(null===(t=this.configuration.chartColors)||void 0===t?void 0:t.length)>0?new h.jpW(this.configuration.chartColors):(0,h.GUR)(),g=new h.syg(c);this.accessors=this.createAccessors(g.standardColors),this.chartAssist=this.createChartAssist(g);const E=this.chartAssist.chart,P=E.getGrid().config();(null===(i=this.configuration.gridConfig)||void 0===i?void 0:i.xAxisTicksCount)&&(P.axis.bottom.approximateTicks=this.configuration.gridConfig.xAxisTicksCount),P.dimension.marginLocked&&(null===(o=this.configuration.gridConfig)||void 0===o?void 0:o.sideMarginLocked)&&(P.dimension.marginLocked.left=!0,P.dimension.marginLocked.right=!0),(null===(r=this.configuration.gridConfig)||void 0===r?void 0:r.sideMargin)&&(P.dimension.margin.left=this.configuration.gridConfig.sideMargin,P.dimension.margin.right=this.configuration.gridConfig.sideMargin),this.configuration.enableZoom&&E.addPlugin(this.zoomPlugin),E.getEventBus().getStream(h.bdF).pipe((0,_e.R)((0,$t.T)(this.destroy$,this.buildChart$))).subscribe(Z=>{const U=Z.data,ne=U[Object.keys(U)[0]];this.eventBus.getStream(T.re).next({payload:{startDatetime:ne[0],endDatetime:ne[1],selectedPresetId:void 0}})}),this.setupInteraction()}setupInteraction(){this.chartAssist.chart.getEventBus().getStream(h.C1c).pipe((0,_e.R)((0,$t.T)(this.destroy$,this.buildChart$))).subscribe(t=>{const i=t.data;i.interactionType===h.s_5.Click&&this.eventBus.getStream(T.b1).next({payload:{data:i.dataPoints,interactionType:Ut.DataPoints}})}),this.chartAssist.chart.getEventBus().getStream(h.hkV).pipe((0,_e.R)((0,$t.T)(this.destroy$,this.buildChart$))).subscribe(t=>{const i=t.data;i.interactionType===h.s_5.Click&&this.eventBus.getStream(T.b1).next({payload:{data:i.values,interactionType:Ut.Values}})})}displayLegendMenu(){return this.configuration.preset===Pe.Line&&!!this.configuration.allowLegendMenu&&this.configuration.projectType===vt.PerfstackApp}removeMetric(t){this.eventBus.next(T.$d,{payload:{metricId:t,groupUniqueId:this.configuration.groupUniqueId}})}transformData(t,i){var o;const r=this.widgetData.series.find(c=>c.id===t);!r||(r.transformer=null===(o=this.transformers.get(i))||void 0===o?void 0:o.transformer,r.rawData&&(void 0===r.transformer?(r.data=r.rawData,this.updateYAxisDomain()):this.transformSeriesData(r)),this.updateChartData())}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(m.nY),e.LFG(m.Fk,8),e.LFG(Dt),e.LFG(e.sBO),e.LFG(h.n_R))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();function lr(n,a){if(1&n&&(e.TgZ(0,"div",5)(1,"strong"),e._uU(2),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.Oqu(t.configuration.leftAxisLabel)}}const dr=function(n){return{"nui-text-link-small link":n}};function cr(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",20),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw().$implicit;return e.oxw(2).onPrimaryDescClick(o,r)}),e._uU(1),e.qZA()}if(2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.Q6J("ngClass",e.VKq(3,dr,i.seriesInteractive))("title",t.legendDescriptionPrimary),e.xp6(1),e.hij(" ",t.legendDescriptionPrimary," ")}}function _r(n,a){if(1&n&&(e.TgZ(0,"a",21),e.NdJ("click",function(i){return i.stopPropagation()}),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("href",t.link,e.LSH)("title",t.legendDescriptionPrimary),e.xp6(1),e.hij(" ",t.legendDescriptionPrimary," ")}}function ur(n,a){if(1&n&&(e.TgZ(0,"div",22),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("title",t.legendDescriptionSecondary),e.xp6(1),e.hij(" ",t.legendDescriptionSecondary," ")}}function pr(n,a){if(1&n&&(e.TgZ(0,"a",23),e.NdJ("click",function(i){return i.stopPropagation()}),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("href",t.secondaryLink,e.LSH)("title",t.legendDescriptionSecondary),e.xp6(1),e.hij(" ",t.legendDescriptionSecondary," ")}}function gr(n,a){1&n&&e._UZ(0,"nui-icon",24)}function hr(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"nui-menu-action",26),e.NdJ("actionDone",function(){const r=e.CHM(t).$implicit,c=e.oxw(2).$implicit;return e.oxw(2).transformData(c.id,r.key)}),e._uU(1),e.qZA()}if(2&n){const t=a.$implicit,i=e.oxw(2).$implicit;e.ekj("selected",(null==i.transformer?null:i.transformer.name)===(null==t.value.transformer?null:t.value.transformer.name)),e.xp6(1),e.hij(" ",t.value.displayName," ")}}function mr(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"nui-menu",25)(1,"nui-menu-group")(2,"nui-menu-action",26),e.NdJ("actionDone",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw(2).removeMetric(o.id)}),e.SDv(3,27),e.qZA()(),e.TgZ(4,"nui-menu-group",28),e.YNc(5,hr,2,3,"nui-menu-action",29),e.ALo(6,"nuiMapKeyValue"),e.qZA()()}if(2&n){const t=e.oxw(3);e.Q6J("appendToBody",!0),e.xp6(5),e.Q6J("ngForOf",e.lcZ(6,2,t.transformers))}}function fr(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"nui-legend-series",9),e.NdJ("isSelectedChange",function(o){const c=e.CHM(t).$implicit;return e.oxw(2).chartAssist.toggleSeries(c.id,o)})("mouseenter",function(){const r=e.CHM(t).$implicit;return e.oxw(2).chartAssist.emphasizeSeries(r.id)})("mouseleave",function(){return e.CHM(t),e.oxw(2).chartAssist.resetVisibleSeries()}),e.TgZ(1,"nui-rich-legend-tile",10),e._UZ(2,"nui-chart-marker",11),e.qZA(),e.TgZ(3,"div",12)(4,"div",13),e.YNc(5,cr,2,5,"div",14),e.YNc(6,_r,2,3,"a",15),e.YNc(7,ur,2,2,"div",16),e.YNc(8,pr,2,3,"a",17),e.qZA(),e.YNc(9,gr,1,0,"nui-icon",18),e.YNc(10,mr,7,4,"nui-menu",19),e.qZA()()}if(2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("ngClass","xy-chart__legend-series--state-"+(null==i.chartAssist.renderStatesIndex[t.id]?null:i.chartAssist.renderStatesIndex[t.id].state))("isSelected",!i.chartAssist.isSeriesHidden(t.id))("seriesRenderState",null==i.chartAssist.renderStatesIndex[t.id]?null:i.chartAssist.renderStatesIndex[t.id].state),e.xp6(1),e.Q6J("value",i.chartAssist.getHighlightedValue(t,"y","tick",i.valueAccessorKey))("backgroundColor",i.chartAssist.palette.standardColors.get(t.id))("color",i.chartAssist.palette.textColors.get(t.id)),e.xp6(1),e.Q6J("marker",i.chartAssist.markers.get(t.id))("color",i.chartAssist.palette.standardColors.get(t.id)),e.xp6(3),e.Q6J("ngIf",!t.link),e.xp6(1),e.Q6J("ngIf",t.link),e.xp6(1),e.Q6J("ngIf",!t.secondaryLink),e.xp6(1),e.Q6J("ngIf",t.secondaryLink),e.xp6(1),e.Q6J("ngIf",t.transformer),e.xp6(1),e.Q6J("ngIf",i.displayLegendMenu())}}const Tr=function(n){return[n]};function Cr(n,a){if(1&n&&(e.TgZ(0,"div",6)(1,"nui-legend",7),e.YNc(2,fr,11,14,"nui-legend-series",8),e.qZA()()),2&n){const t=e.oxw();e.Q6J("ngClass",e.VKq(6,Tr,t.legendShouldBeAlignedRight()?"legend scrollable":"legend-bottom")),e.xp6(1),e.Q6J("active",t.chartAssist.isLegendActive)("interactive",!0)("orientation",t.legendShouldBeAlignedRight()?"vertical":"horizontal"),e.xp6(1),e.Q6J("ngForOf",t.chartAssist.legendSeriesSet)("ngForTrackBy",t.chartAssist.seriesTrackByFn)}}let Si=(()=>{class n extends jt{constructor(t,i,o,r,c){super(t,i,o,r,c),this.renderer=new h.Med}createAccessors(t){return new h.qxh(t)}createChartAssist(t){const i=new h.c_e;i.axis.left.fit=!0;const o=new h.kL2(new h.Be5(i));return new h.doR(o,null,t)}}return n.lateLoadKey="LineChartComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(m.nY),e.Y36(m.Fk,8),e.Y36(Dt),e.Y36(e.sBO),e.Y36(h.n_R))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-line-chart"]],features:[e.qOj],decls:5,vars:6,consts:function(){let a,t;return a=$localize`:␟019d4bd6a5690f0cfa0ecf346a4e6bf7f0d8debb␟4814285799071780083:Remove`,t=$localize`:␟0e0f4abd3e0ba041e65167d13502b5506faddadc␟6744532767173419675:Display Transforms`,[[1,"nui-chart-layout","h-100"],["class","axis-label-left nui-text-small",4,"ngIf"],[1,"chart"],[1,"w-100",3,"nuiChartCollectionId","chart"],["class","d-flex",3,"ngClass",4,"ngIf"],[1,"axis-label-left","nui-text-small"],[1,"d-flex",3,"ngClass"],[1,"m-auto",3,"active","interactive","orientation"],["class","xy-chart__legend-series",3,"ngClass","isSelected","seriesRenderState","isSelectedChange","mouseenter","mouseleave",4,"ngFor","ngForOf","ngForTrackBy"],[1,"xy-chart__legend-series",3,"ngClass","isSelected","seriesRenderState","isSelectedChange","mouseenter","mouseleave"],[3,"value","backgroundColor","color"],["rightEdge","",3,"marker","color"],["description","",1,"description-container"],[1,"description-text","nui-text-small"],["class","description description-primary",3,"ngClass","title","click",4,"ngIf"],["class","description description-primary nui-text-link-small link","rel","noopener noreferrer",3,"href","title","click",4,"ngIf"],["class","description description-secondary",3,"title",4,"ngIf"],["class","description description-secondary nui-text-link-small link","rel","noopener noreferrer",3,"href","title","click",4,"ngIf"],["icon","performance","iconColor","primary-blue",4,"ngIf"],["icon","menu","displayStyle","action","class","legend-menu",3,"appendToBody",4,"ngIf"],[1,"description","description-primary",3,"ngClass","title","click"],["rel","noopener noreferrer",1,"description","description-primary","nui-text-link-small","link",3,"href","title","click"],[1,"description","description-secondary",3,"title"],["rel","noopener noreferrer",1,"description","description-secondary","nui-text-link-small","link",3,"href","title","click"],["icon","performance","iconColor","primary-blue"],["icon","menu","displayStyle","action",1,"legend-menu",3,"appendToBody"],[3,"actionDone"],a,["header",t],[3,"selected","actionDone",4,"ngFor","ngForOf"]]},template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,lr,3,1,"div",1),e.TgZ(2,"div",2),e._UZ(3,"nui-chart",3),e.qZA(),e.YNc(4,Cr,3,8,"div",4),e.qZA()),2&t&&(e.ekj("layout-fixed",null==i.configuration.gridConfig?null:i.configuration.gridConfig.fixedLayout),e.xp6(1),e.Q6J("ngIf",!(null!=i.configuration.gridConfig&&i.configuration.gridConfig.hideYAxisLabel)),e.xp6(2),e.Q6J("nuiChartCollectionId",i.collectionId)("chart",i.chartAssist.chart),e.xp6(1),e.Q6J("ngIf",i.hasLegend()))},directives:[s.O5,h.xH4,h.VMb,s.mk,h.FVX,s.sg,h.kJo,h.wHi,h.sRf,d.oJW,d.Mnp,d.y7b,d.VDk],pipes:[d.eQ8],styles:[".xy-chart__legend-series[_ngcontent-%COMP%]   .link.description-primary[_ngcontent-%COMP%], .xy-chart__legend-series[_ngcontent-%COMP%]   .link.description-secondary[_ngcontent-%COMP%]{color:var(--nui-color-text-link,#0079aa)}.xy-chart__legend-series[_ngcontent-%COMP%]:not(:hover).xy-chart__legend-series--state-hidden   .link.description-primary[_ngcontent-%COMP%], .xy-chart__legend-series[_ngcontent-%COMP%]:not(:hover).xy-chart__legend-series--state-hidden   .link.description-secondary[_ngcontent-%COMP%]{color:var(--nui-color-text-default,#111)}.layout-fixed[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]{max-width:250px;min-width:250px;padding-left:8px!important}.layout-fixed[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]   nui-legend[_ngcontent-%COMP%]{margin:0!important;width:100%}.description-container[_ngcontent-%COMP%]{display:flex;align-items:center;flex-grow:1;padding-right:2px}.description-text[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;overflow:hidden}.legend-menu[_ngcontent-%COMP%]{opacity:0;display:none;margin-left:auto}nui-legend-series[_ngcontent-%COMP%]:hover   .legend-menu[_ngcontent-%COMP%]{opacity:1;display:unset}nui-legend-series[_ngcontent-%COMP%]{width:100%}nui-icon[_ngcontent-%COMP%]{padding:0 5px}[_nghost-%COMP%]  nui-legend-series div div:nth-child(2).d-flex{flex-grow:1;overflow:hidden}[_nghost-%COMP%]  .nui-legend-series .description{min-width:unset}.selected[_ngcontent-%COMP%]{background-color:#00c4d21a}.selected[_ngcontent-%COMP%]:hover{background-color:#00c4d233}"]}),n})();function Or(n,a){if(1&n&&(e.TgZ(0,"div",5)(1,"strong"),e._uU(2),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.Oqu(t.configuration.leftAxisLabel)}}const Ir=function(n){return{"nui-text-link-small link":n}};function vr(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",20),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw().$implicit;return e.oxw(2).onPrimaryDescClick(o,r)}),e._uU(1),e.qZA()}if(2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.Q6J("ngClass",e.VKq(3,Ir,i.seriesInteractive))("title",t.legendDescriptionPrimary),e.xp6(1),e.hij(" ",t.legendDescriptionPrimary," ")}}function Er(n,a){if(1&n&&(e.TgZ(0,"a",21),e.NdJ("click",function(i){return i.stopPropagation()}),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("href",t.link,e.LSH)("title",t.legendDescriptionPrimary),e.xp6(1),e.hij(" ",t.legendDescriptionPrimary," ")}}function Sr(n,a){if(1&n&&(e.TgZ(0,"div",22),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("title",t.legendDescriptionSecondary),e.xp6(1),e.hij(" ",t.legendDescriptionSecondary," ")}}function Rr(n,a){if(1&n&&(e.TgZ(0,"a",23),e.NdJ("click",function(i){return i.stopPropagation()}),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("href",t.secondaryLink,e.LSH)("title",t.legendDescriptionSecondary),e.xp6(1),e.hij(" ",t.legendDescriptionSecondary," ")}}function Nr(n,a){1&n&&e._UZ(0,"nui-icon",24)}function Ar(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"nui-menu-action",26),e.NdJ("actionDone",function(){const r=e.CHM(t).$implicit,c=e.oxw(2).$implicit;return e.oxw(2).transformData(c.id,r.key)}),e._uU(1),e.qZA()}if(2&n){const t=a.$implicit,i=e.oxw(2).$implicit;e.ekj("selected",(null==i.transformer?null:i.transformer.name)===(null==t.value.transformer?null:t.value.transformer.name)),e.xp6(1),e.hij(" ",t.value.displayName," ")}}function yr(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"nui-menu",25)(1,"nui-menu-group")(2,"nui-menu-action",26),e.NdJ("actionDone",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw(2).removeMetric(o.id)}),e.SDv(3,27),e.qZA()(),e.TgZ(4,"nui-menu-group",28),e.YNc(5,Ar,2,3,"nui-menu-action",29),e.ALo(6,"nuiMapKeyValue"),e.qZA()()}if(2&n){const t=e.oxw(3);e.Q6J("appendToBody",!0),e.xp6(5),e.Q6J("ngForOf",e.lcZ(6,2,t.transformers))}}function Mr(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"nui-legend-series",9),e.NdJ("isSelectedChange",function(o){const c=e.CHM(t).$implicit;return e.oxw(2).chartAssist.toggleSeries(c.id,o)})("mouseenter",function(){const r=e.CHM(t).$implicit;return e.oxw(2).chartAssist.emphasizeSeries(r.id)})("mouseleave",function(){return e.CHM(t),e.oxw(2).chartAssist.resetVisibleSeries()}),e.TgZ(1,"nui-rich-legend-tile",10),e._UZ(2,"nui-chart-marker",11),e.qZA(),e.TgZ(3,"div",12)(4,"div",13),e.YNc(5,vr,2,5,"div",14),e.YNc(6,Er,2,3,"a",15),e.YNc(7,Sr,2,2,"div",16),e.YNc(8,Rr,2,3,"a",17),e.qZA(),e.YNc(9,Nr,1,0,"nui-icon",18),e.YNc(10,yr,7,4,"nui-menu",19),e.qZA()()}if(2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("ngClass","xy-chart__legend-series--state-"+(null==i.chartAssist.renderStatesIndex[t.id]?null:i.chartAssist.renderStatesIndex[t.id].state))("isSelected",!i.chartAssist.isSeriesHidden(t.id))("seriesRenderState",null==i.chartAssist.renderStatesIndex[t.id]?null:i.chartAssist.renderStatesIndex[t.id].state),e.xp6(1),e.Q6J("value",i.chartAssist.getHighlightedValue(t,"y","tick",i.valueAccessorKey))("backgroundColor",i.chartAssist.palette.standardColors.get(t.id))("color",i.chartAssist.palette.textColors.get(t.id)),e.xp6(1),e.Q6J("marker",i.chartAssist.markers.get(t.id))("color",i.chartAssist.palette.standardColors.get(t.id)),e.xp6(3),e.Q6J("ngIf",!t.link),e.xp6(1),e.Q6J("ngIf",t.link),e.xp6(1),e.Q6J("ngIf",!t.secondaryLink),e.xp6(1),e.Q6J("ngIf",t.secondaryLink),e.xp6(1),e.Q6J("ngIf",t.transformer),e.xp6(1),e.Q6J("ngIf",i.displayLegendMenu())}}const Pr=function(n){return[n]};function Dr(n,a){if(1&n&&(e.TgZ(0,"div",6)(1,"nui-legend",7),e.YNc(2,Mr,11,14,"nui-legend-series",8),e.qZA()()),2&n){const t=e.oxw();e.Q6J("ngClass",e.VKq(6,Pr,t.legendShouldBeAlignedRight()?"legend scrollable":"legend-bottom")),e.xp6(1),e.Q6J("active",t.chartAssist.isLegendActive)("interactive",!0)("orientation",t.legendShouldBeAlignedRight()?"vertical":"horizontal"),e.xp6(1),e.Q6J("ngForOf",t.chartAssist.legendSeriesSet)("ngForTrackBy",t.chartAssist.seriesTrackByFn)}}let Ri=(()=>{class n extends jt{constructor(t,i,o,r,c){super(t,i,o,r,c),this.renderer=new h.QtU,this.valueAccessorKey="y1"}createAccessors(t){return(0,h.mIe)(t)}createChartAssist(t){var i;const o=(0,h.nuZ)(),r=o.config();r.axis.left.fit=!0;const c=new h.kL2(o);return(null===(i=this.configuration.gridConfig)||void 0===i?void 0:i.hideYAxisTicksLabels)&&(r.axis.left.visible=!1,r.axis.right.visible=!1),new h.doR(c,h.aCj,t)}}return n.lateLoadKey="StackedAreaChartComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(m.nY),e.Y36(m.Fk,8),e.Y36(Dt),e.Y36(e.sBO),e.Y36(h.n_R))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-stacked-area-chart"]],features:[e.qOj],decls:5,vars:6,consts:function(){let a,t;return a=$localize`:␟019d4bd6a5690f0cfa0ecf346a4e6bf7f0d8debb␟4814285799071780083:Remove`,t=$localize`:␟0e0f4abd3e0ba041e65167d13502b5506faddadc␟6744532767173419675:Display Transforms`,[[1,"nui-chart-layout","h-100"],["class","axis-label-left nui-text-small",4,"ngIf"],[1,"chart"],[1,"w-100",3,"nuiChartCollectionId","chart"],["class","d-flex",3,"ngClass",4,"ngIf"],[1,"axis-label-left","nui-text-small"],[1,"d-flex",3,"ngClass"],[1,"m-auto",3,"active","interactive","orientation"],["class","xy-chart__legend-series",3,"ngClass","isSelected","seriesRenderState","isSelectedChange","mouseenter","mouseleave",4,"ngFor","ngForOf","ngForTrackBy"],[1,"xy-chart__legend-series",3,"ngClass","isSelected","seriesRenderState","isSelectedChange","mouseenter","mouseleave"],[3,"value","backgroundColor","color"],["rightEdge","",3,"marker","color"],["description","",1,"description-container"],[1,"description-text","nui-text-small"],["class","description description-primary",3,"ngClass","title","click",4,"ngIf"],["class","description description-primary nui-text-link-small link","rel","noopener noreferrer",3,"href","title","click",4,"ngIf"],["class","description description-secondary",3,"title",4,"ngIf"],["class","description description-secondary nui-text-link-small link","rel","noopener noreferrer",3,"href","title","click",4,"ngIf"],["icon","performance","iconColor","primary-blue",4,"ngIf"],["icon","menu","displayStyle","action","class","legend-menu",3,"appendToBody",4,"ngIf"],[1,"description","description-primary",3,"ngClass","title","click"],["rel","noopener noreferrer",1,"description","description-primary","nui-text-link-small","link",3,"href","title","click"],[1,"description","description-secondary",3,"title"],["rel","noopener noreferrer",1,"description","description-secondary","nui-text-link-small","link",3,"href","title","click"],["icon","performance","iconColor","primary-blue"],["icon","menu","displayStyle","action",1,"legend-menu",3,"appendToBody"],[3,"actionDone"],a,["header",t],[3,"selected","actionDone",4,"ngFor","ngForOf"]]},template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,Or,3,1,"div",1),e.TgZ(2,"div",2),e._UZ(3,"nui-chart",3),e.qZA(),e.YNc(4,Dr,3,8,"div",4),e.qZA()),2&t&&(e.ekj("layout-fixed",null==i.configuration.gridConfig?null:i.configuration.gridConfig.fixedLayout),e.xp6(1),e.Q6J("ngIf",!(null!=i.configuration.gridConfig&&i.configuration.gridConfig.hideYAxisLabel)),e.xp6(2),e.Q6J("nuiChartCollectionId",i.collectionId)("chart",i.chartAssist.chart),e.xp6(1),e.Q6J("ngIf",i.hasLegend()))},directives:[s.O5,h.xH4,h.VMb,s.mk,h.FVX,s.sg,h.kJo,h.wHi,h.sRf,d.oJW,d.Mnp,d.y7b,d.VDk],pipes:[d.eQ8],styles:[".xy-chart__legend-series[_ngcontent-%COMP%]   .link.description-primary[_ngcontent-%COMP%], .xy-chart__legend-series[_ngcontent-%COMP%]   .link.description-secondary[_ngcontent-%COMP%]{color:var(--nui-color-text-link,#0079aa)}.xy-chart__legend-series[_ngcontent-%COMP%]:not(:hover).xy-chart__legend-series--state-hidden   .link.description-primary[_ngcontent-%COMP%], .xy-chart__legend-series[_ngcontent-%COMP%]:not(:hover).xy-chart__legend-series--state-hidden   .link.description-secondary[_ngcontent-%COMP%]{color:var(--nui-color-text-default,#111)}.layout-fixed[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]{max-width:250px;min-width:250px;padding-left:8px!important}.layout-fixed[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]   nui-legend[_ngcontent-%COMP%]{margin:0!important;width:100%}.description-container[_ngcontent-%COMP%]{display:flex;align-items:center;flex-grow:1;padding-right:2px}.description-text[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;overflow:hidden}.legend-menu[_ngcontent-%COMP%]{opacity:0;display:none;margin-left:auto}nui-legend-series[_ngcontent-%COMP%]:hover   .legend-menu[_ngcontent-%COMP%]{opacity:1;display:unset}nui-legend-series[_ngcontent-%COMP%]{width:100%}nui-icon[_ngcontent-%COMP%]{padding:0 5px}[_nghost-%COMP%]  nui-legend-series div div:nth-child(2).d-flex{flex-grow:1;overflow:hidden}[_nghost-%COMP%]  .nui-legend-series .description{min-width:unset}.selected[_ngcontent-%COMP%]{background-color:#00c4d21a}.selected[_ngcontent-%COMP%]:hover{background-color:#00c4d233}"]}),n})();function br(n,a){if(1&n&&(e.TgZ(0,"div",5)(1,"strong"),e._uU(2),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.Oqu(t.configuration.leftAxisLabel)}}const Fr=function(n){return{"nui-text-link-small link":n}};function xr(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",20),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw().$implicit;return e.oxw(2).onPrimaryDescClick(o,r)}),e._uU(1),e.qZA()}if(2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.Q6J("ngClass",e.VKq(3,Fr,i.seriesInteractive))("title",t.legendDescriptionPrimary),e.xp6(1),e.hij(" ",t.legendDescriptionPrimary," ")}}function Lr(n,a){if(1&n&&(e.TgZ(0,"a",21),e.NdJ("click",function(i){return i.stopPropagation()}),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("href",t.link,e.LSH)("title",t.legendDescriptionPrimary),e.xp6(1),e.hij(" ",t.legendDescriptionPrimary," ")}}function wr(n,a){if(1&n&&(e.TgZ(0,"div",22),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("title",t.legendDescriptionSecondary),e.xp6(1),e.hij(" ",t.legendDescriptionSecondary," ")}}function Gr(n,a){if(1&n&&(e.TgZ(0,"a",23),e.NdJ("click",function(i){return i.stopPropagation()}),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("href",t.secondaryLink,e.LSH)("title",t.legendDescriptionSecondary),e.xp6(1),e.hij(" ",t.legendDescriptionSecondary," ")}}function $r(n,a){1&n&&e._UZ(0,"nui-icon",24)}function Ur(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"nui-menu-action",26),e.NdJ("actionDone",function(){const r=e.CHM(t).$implicit,c=e.oxw(2).$implicit;return e.oxw(2).transformData(c.id,r.key)}),e._uU(1),e.qZA()}if(2&n){const t=a.$implicit,i=e.oxw(2).$implicit;e.ekj("selected",(null==i.transformer?null:i.transformer.name)===(null==t.value.transformer?null:t.value.transformer.name)),e.xp6(1),e.hij(" ",t.value.displayName," ")}}function zr(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"nui-menu",25)(1,"nui-menu-group")(2,"nui-menu-action",26),e.NdJ("actionDone",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw(2).removeMetric(o.id)}),e.SDv(3,27),e.qZA()(),e.TgZ(4,"nui-menu-group",28),e.YNc(5,Ur,2,3,"nui-menu-action",29),e.ALo(6,"nuiMapKeyValue"),e.qZA()()}if(2&n){const t=e.oxw(3);e.Q6J("appendToBody",!0),e.xp6(5),e.Q6J("ngForOf",e.lcZ(6,2,t.transformers))}}function Br(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"nui-legend-series",9),e.NdJ("isSelectedChange",function(o){const c=e.CHM(t).$implicit;return e.oxw(2).chartAssist.toggleSeries(c.id,o)})("mouseenter",function(){const r=e.CHM(t).$implicit;return e.oxw(2).chartAssist.emphasizeSeries(r.id)})("mouseleave",function(){return e.CHM(t),e.oxw(2).chartAssist.resetVisibleSeries()}),e.TgZ(1,"nui-rich-legend-tile",10),e._UZ(2,"nui-chart-marker",11),e.qZA(),e.TgZ(3,"div",12)(4,"div",13),e.YNc(5,xr,2,5,"div",14),e.YNc(6,Lr,2,3,"a",15),e.YNc(7,wr,2,2,"div",16),e.YNc(8,Gr,2,3,"a",17),e.qZA(),e.YNc(9,$r,1,0,"nui-icon",18),e.YNc(10,zr,7,4,"nui-menu",19),e.qZA()()}if(2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("ngClass","xy-chart__legend-series--state-"+(null==i.chartAssist.renderStatesIndex[t.id]?null:i.chartAssist.renderStatesIndex[t.id].state))("isSelected",!i.chartAssist.isSeriesHidden(t.id))("seriesRenderState",null==i.chartAssist.renderStatesIndex[t.id]?null:i.chartAssist.renderStatesIndex[t.id].state),e.xp6(1),e.Q6J("value",i.chartAssist.getHighlightedValue(t,"y","tick",i.valueAccessorKey))("backgroundColor",i.chartAssist.palette.standardColors.get(t.id))("color",i.chartAssist.palette.textColors.get(t.id)),e.xp6(1),e.Q6J("marker",i.chartAssist.markers.get(t.id))("color",i.chartAssist.palette.standardColors.get(t.id)),e.xp6(3),e.Q6J("ngIf",!t.link),e.xp6(1),e.Q6J("ngIf",t.link),e.xp6(1),e.Q6J("ngIf",!t.secondaryLink),e.xp6(1),e.Q6J("ngIf",t.secondaryLink),e.xp6(1),e.Q6J("ngIf",t.transformer),e.xp6(1),e.Q6J("ngIf",i.displayLegendMenu())}}const Wr=function(n){return[n]};function kr(n,a){if(1&n&&(e.TgZ(0,"div",6)(1,"nui-legend",7),e.YNc(2,Br,11,14,"nui-legend-series",8),e.qZA()()),2&n){const t=e.oxw();e.Q6J("ngClass",e.VKq(6,Wr,t.legendShouldBeAlignedRight()?"legend scrollable":"legend-bottom")),e.xp6(1),e.Q6J("active",t.chartAssist.isLegendActive)("interactive",!0)("orientation",t.legendShouldBeAlignedRight()?"vertical":"horizontal"),e.xp6(1),e.Q6J("ngForOf",t.chartAssist.legendSeriesSet)("ngForTrackBy",t.chartAssist.seriesTrackByFn)}}let Ni=(()=>{class n extends jt{constructor(t,i,o,r,c){super(t,i,o,r,c),this.valueAccessorKey="value",this.renderer=new h.Z7w({highlightStrategy:new h.Pkp("x"),pointerEvents:!1})}mapSeriesSet(t,i){return this.accessors.data.thickness=i.x instanceof h.lTH?void 0:()=>5,super.mapSeriesSet(t,i)}createAccessors(t){const i=(0,h.Q6e)({horizontal:!1},t);return i.data.category=o=>o.x,i.data.value=o=>o.y,i}createChartAssist(t){const i=new h.kL2((0,h.skL)());return i.addPlugin(new h.koE),i.addPlugin(new h.$fK),new h.doR(i,h.knu,t)}}return n.lateLoadKey="StackedBarChartComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(m.nY),e.Y36(m.Fk,8),e.Y36(Dt),e.Y36(e.sBO),e.Y36(h.n_R))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-stacked-bar-chart"]],features:[e.qOj],decls:5,vars:6,consts:function(){let a,t;return a=$localize`:␟019d4bd6a5690f0cfa0ecf346a4e6bf7f0d8debb␟4814285799071780083:Remove`,t=$localize`:␟0e0f4abd3e0ba041e65167d13502b5506faddadc␟6744532767173419675:Display Transforms`,[[1,"nui-chart-layout","h-100"],["class","axis-label-left nui-text-small",4,"ngIf"],[1,"chart"],[1,"w-100",3,"nuiChartCollectionId","chart"],["class","d-flex",3,"ngClass",4,"ngIf"],[1,"axis-label-left","nui-text-small"],[1,"d-flex",3,"ngClass"],[1,"m-auto",3,"active","interactive","orientation"],["class","xy-chart__legend-series",3,"ngClass","isSelected","seriesRenderState","isSelectedChange","mouseenter","mouseleave",4,"ngFor","ngForOf","ngForTrackBy"],[1,"xy-chart__legend-series",3,"ngClass","isSelected","seriesRenderState","isSelectedChange","mouseenter","mouseleave"],[3,"value","backgroundColor","color"],["rightEdge","",3,"marker","color"],["description","",1,"description-container"],[1,"description-text","nui-text-small"],["class","description description-primary",3,"ngClass","title","click",4,"ngIf"],["class","description description-primary nui-text-link-small link","rel","noopener noreferrer",3,"href","title","click",4,"ngIf"],["class","description description-secondary",3,"title",4,"ngIf"],["class","description description-secondary nui-text-link-small link","rel","noopener noreferrer",3,"href","title","click",4,"ngIf"],["icon","performance","iconColor","primary-blue",4,"ngIf"],["icon","menu","displayStyle","action","class","legend-menu",3,"appendToBody",4,"ngIf"],[1,"description","description-primary",3,"ngClass","title","click"],["rel","noopener noreferrer",1,"description","description-primary","nui-text-link-small","link",3,"href","title","click"],[1,"description","description-secondary",3,"title"],["rel","noopener noreferrer",1,"description","description-secondary","nui-text-link-small","link",3,"href","title","click"],["icon","performance","iconColor","primary-blue"],["icon","menu","displayStyle","action",1,"legend-menu",3,"appendToBody"],[3,"actionDone"],a,["header",t],[3,"selected","actionDone",4,"ngFor","ngForOf"]]},template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,br,3,1,"div",1),e.TgZ(2,"div",2),e._UZ(3,"nui-chart",3),e.qZA(),e.YNc(4,kr,3,8,"div",4),e.qZA()),2&t&&(e.ekj("layout-fixed",null==i.configuration.gridConfig?null:i.configuration.gridConfig.fixedLayout),e.xp6(1),e.Q6J("ngIf",!(null!=i.configuration.gridConfig&&i.configuration.gridConfig.hideYAxisLabel)),e.xp6(2),e.Q6J("nuiChartCollectionId",i.collectionId)("chart",i.chartAssist.chart),e.xp6(1),e.Q6J("ngIf",i.hasLegend()))},directives:[s.O5,h.xH4,h.VMb,s.mk,h.FVX,s.sg,h.kJo,h.wHi,h.sRf,d.oJW,d.Mnp,d.y7b,d.VDk],pipes:[d.eQ8],styles:[".xy-chart__legend-series[_ngcontent-%COMP%]   .link.description-primary[_ngcontent-%COMP%], .xy-chart__legend-series[_ngcontent-%COMP%]   .link.description-secondary[_ngcontent-%COMP%]{color:var(--nui-color-text-link,#0079aa)}.xy-chart__legend-series[_ngcontent-%COMP%]:not(:hover).xy-chart__legend-series--state-hidden   .link.description-primary[_ngcontent-%COMP%], .xy-chart__legend-series[_ngcontent-%COMP%]:not(:hover).xy-chart__legend-series--state-hidden   .link.description-secondary[_ngcontent-%COMP%]{color:var(--nui-color-text-default,#111)}.layout-fixed[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]{max-width:250px;min-width:250px;padding-left:8px!important}.layout-fixed[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]   nui-legend[_ngcontent-%COMP%]{margin:0!important;width:100%}.description-container[_ngcontent-%COMP%]{display:flex;align-items:center;flex-grow:1;padding-right:2px}.description-text[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;overflow:hidden}.legend-menu[_ngcontent-%COMP%]{opacity:0;display:none;margin-left:auto}nui-legend-series[_ngcontent-%COMP%]:hover   .legend-menu[_ngcontent-%COMP%]{opacity:1;display:unset}nui-legend-series[_ngcontent-%COMP%]{width:100%}nui-icon[_ngcontent-%COMP%]{padding:0 5px}[_nghost-%COMP%]  nui-legend-series div div:nth-child(2).d-flex{flex-grow:1;overflow:hidden}[_nghost-%COMP%]  .nui-legend-series .description{min-width:unset}.selected[_ngcontent-%COMP%]{background-color:#00c4d21a}.selected[_ngcontent-%COMP%]:hover{background-color:#00c4d233}"]}),n})();function Zr(n,a){if(1&n&&(e.TgZ(0,"div",5)(1,"strong"),e._uU(2),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.Oqu(t.configuration.leftAxisLabel)}}const Vr=function(n){return{"nui-text-link-small link":n}};function Jr(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",20),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw().$implicit;return e.oxw(2).onPrimaryDescClick(o,r)}),e._uU(1),e.qZA()}if(2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.Q6J("ngClass",e.VKq(3,Vr,i.seriesInteractive))("title",t.legendDescriptionPrimary),e.xp6(1),e.hij(" ",t.legendDescriptionPrimary," ")}}function Yr(n,a){if(1&n&&(e.TgZ(0,"a",21),e.NdJ("click",function(i){return i.stopPropagation()}),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("href",t.link,e.LSH)("title",t.legendDescriptionPrimary),e.xp6(1),e.hij(" ",t.legendDescriptionPrimary," ")}}function Hr(n,a){if(1&n&&(e.TgZ(0,"div",22),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("title",t.legendDescriptionSecondary),e.xp6(1),e.hij(" ",t.legendDescriptionSecondary," ")}}function Kr(n,a){if(1&n&&(e.TgZ(0,"a",23),e.NdJ("click",function(i){return i.stopPropagation()}),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("href",t.secondaryLink,e.LSH)("title",t.legendDescriptionSecondary),e.xp6(1),e.hij(" ",t.legendDescriptionSecondary," ")}}function Qr(n,a){1&n&&e._UZ(0,"nui-icon",24)}function Xr(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"nui-menu-action",26),e.NdJ("actionDone",function(){const r=e.CHM(t).$implicit,c=e.oxw(2).$implicit;return e.oxw(2).transformData(c.id,r.key)}),e._uU(1),e.qZA()}if(2&n){const t=a.$implicit,i=e.oxw(2).$implicit;e.ekj("selected",(null==i.transformer?null:i.transformer.name)===(null==t.value.transformer?null:t.value.transformer.name)),e.xp6(1),e.hij(" ",t.value.displayName," ")}}function jr(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"nui-menu",25)(1,"nui-menu-group")(2,"nui-menu-action",26),e.NdJ("actionDone",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw(2).removeMetric(o.id)}),e.SDv(3,27),e.qZA()(),e.TgZ(4,"nui-menu-group",28),e.YNc(5,Xr,2,3,"nui-menu-action",29),e.ALo(6,"nuiMapKeyValue"),e.qZA()()}if(2&n){const t=e.oxw(3);e.Q6J("appendToBody",!0),e.xp6(5),e.Q6J("ngForOf",e.lcZ(6,2,t.transformers))}}function qr(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"nui-legend-series",9),e.NdJ("isSelectedChange",function(o){const c=e.CHM(t).$implicit;return e.oxw(2).chartAssist.toggleSeries(c.id,o)})("mouseenter",function(){const r=e.CHM(t).$implicit;return e.oxw(2).chartAssist.emphasizeSeries(r.id)})("mouseleave",function(){return e.CHM(t),e.oxw(2).chartAssist.resetVisibleSeries()}),e.TgZ(1,"nui-rich-legend-tile",10),e._UZ(2,"nui-chart-marker",11),e.qZA(),e.TgZ(3,"div",12)(4,"div",13),e.YNc(5,Jr,2,5,"div",14),e.YNc(6,Yr,2,3,"a",15),e.YNc(7,Hr,2,2,"div",16),e.YNc(8,Kr,2,3,"a",17),e.qZA(),e.YNc(9,Qr,1,0,"nui-icon",18),e.YNc(10,jr,7,4,"nui-menu",19),e.qZA()()}if(2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("ngClass","xy-chart__legend-series--state-"+(null==i.chartAssist.renderStatesIndex[t.id]?null:i.chartAssist.renderStatesIndex[t.id].state))("isSelected",!i.chartAssist.isSeriesHidden(t.id))("seriesRenderState",null==i.chartAssist.renderStatesIndex[t.id]?null:i.chartAssist.renderStatesIndex[t.id].state),e.xp6(1),e.Q6J("value",i.chartAssist.getHighlightedValue(t,"y","tick",i.valueAccessorKey))("backgroundColor",i.chartAssist.palette.standardColors.get(t.id))("color",i.chartAssist.palette.textColors.get(t.id)),e.xp6(1),e.Q6J("marker",i.chartAssist.markers.get(t.id))("color",i.chartAssist.palette.standardColors.get(t.id)),e.xp6(3),e.Q6J("ngIf",!t.link),e.xp6(1),e.Q6J("ngIf",t.link),e.xp6(1),e.Q6J("ngIf",!t.secondaryLink),e.xp6(1),e.Q6J("ngIf",t.secondaryLink),e.xp6(1),e.Q6J("ngIf",t.transformer),e.xp6(1),e.Q6J("ngIf",i.displayLegendMenu())}}const es=function(n){return[n]};function ts(n,a){if(1&n&&(e.TgZ(0,"div",6)(1,"nui-legend",7),e.YNc(2,qr,11,14,"nui-legend-series",8),e.qZA()()),2&n){const t=e.oxw();e.Q6J("ngClass",e.VKq(6,es,t.legendShouldBeAlignedRight()?"legend scrollable":"legend-bottom")),e.xp6(1),e.Q6J("active",t.chartAssist.isLegendActive)("interactive",!0)("orientation",t.legendShouldBeAlignedRight()?"vertical":"horizontal"),e.xp6(1),e.Q6J("ngForOf",t.chartAssist.legendSeriesSet)("ngForTrackBy",t.chartAssist.seriesTrackByFn)}}let Ai=(()=>{class n extends jt{constructor(t,i,o,r,c){super(t,i,o,r,c),this.renderer=new h.QtU,this.valueAccessorKey="y1"}createAccessors(t){return(0,h.mIe)(t)}createChartAssist(t){const i=(0,h.nuZ)();i.config().axis.left.fit=!0;const o=new h.kL2(i);return new h.doR(o,h.HAP,t)}}return n.lateLoadKey="StackedPercentageAreaChartComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(m.nY),e.Y36(m.Fk,8),e.Y36(Dt),e.Y36(e.sBO),e.Y36(h.n_R))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-stacked-percentage-area-chart"]],features:[e.qOj],decls:5,vars:6,consts:function(){let a,t;return a=$localize`:␟019d4bd6a5690f0cfa0ecf346a4e6bf7f0d8debb␟4814285799071780083:Remove`,t=$localize`:␟0e0f4abd3e0ba041e65167d13502b5506faddadc␟6744532767173419675:Display Transforms`,[[1,"nui-chart-layout","h-100"],["class","axis-label-left nui-text-small",4,"ngIf"],[1,"chart"],[1,"w-100",3,"nuiChartCollectionId","chart"],["class","d-flex",3,"ngClass",4,"ngIf"],[1,"axis-label-left","nui-text-small"],[1,"d-flex",3,"ngClass"],[1,"m-auto",3,"active","interactive","orientation"],["class","xy-chart__legend-series",3,"ngClass","isSelected","seriesRenderState","isSelectedChange","mouseenter","mouseleave",4,"ngFor","ngForOf","ngForTrackBy"],[1,"xy-chart__legend-series",3,"ngClass","isSelected","seriesRenderState","isSelectedChange","mouseenter","mouseleave"],[3,"value","backgroundColor","color"],["rightEdge","",3,"marker","color"],["description","",1,"description-container"],[1,"description-text","nui-text-small"],["class","description description-primary",3,"ngClass","title","click",4,"ngIf"],["class","description description-primary nui-text-link-small link","rel","noopener noreferrer",3,"href","title","click",4,"ngIf"],["class","description description-secondary",3,"title",4,"ngIf"],["class","description description-secondary nui-text-link-small link","rel","noopener noreferrer",3,"href","title","click",4,"ngIf"],["icon","performance","iconColor","primary-blue",4,"ngIf"],["icon","menu","displayStyle","action","class","legend-menu",3,"appendToBody",4,"ngIf"],[1,"description","description-primary",3,"ngClass","title","click"],["rel","noopener noreferrer",1,"description","description-primary","nui-text-link-small","link",3,"href","title","click"],[1,"description","description-secondary",3,"title"],["rel","noopener noreferrer",1,"description","description-secondary","nui-text-link-small","link",3,"href","title","click"],["icon","performance","iconColor","primary-blue"],["icon","menu","displayStyle","action",1,"legend-menu",3,"appendToBody"],[3,"actionDone"],a,["header",t],[3,"selected","actionDone",4,"ngFor","ngForOf"]]},template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,Zr,3,1,"div",1),e.TgZ(2,"div",2),e._UZ(3,"nui-chart",3),e.qZA(),e.YNc(4,ts,3,8,"div",4),e.qZA()),2&t&&(e.ekj("layout-fixed",null==i.configuration.gridConfig?null:i.configuration.gridConfig.fixedLayout),e.xp6(1),e.Q6J("ngIf",!(null!=i.configuration.gridConfig&&i.configuration.gridConfig.hideYAxisLabel)),e.xp6(2),e.Q6J("nuiChartCollectionId",i.collectionId)("chart",i.chartAssist.chart),e.xp6(1),e.Q6J("ngIf",i.hasLegend()))},directives:[s.O5,h.xH4,h.VMb,s.mk,h.FVX,s.sg,h.kJo,h.wHi,h.sRf,d.oJW,d.Mnp,d.y7b,d.VDk],pipes:[d.eQ8],styles:[".xy-chart__legend-series[_ngcontent-%COMP%]   .link.description-primary[_ngcontent-%COMP%], .xy-chart__legend-series[_ngcontent-%COMP%]   .link.description-secondary[_ngcontent-%COMP%]{color:var(--nui-color-text-link,#0079aa)}.xy-chart__legend-series[_ngcontent-%COMP%]:not(:hover).xy-chart__legend-series--state-hidden   .link.description-primary[_ngcontent-%COMP%], .xy-chart__legend-series[_ngcontent-%COMP%]:not(:hover).xy-chart__legend-series--state-hidden   .link.description-secondary[_ngcontent-%COMP%]{color:var(--nui-color-text-default,#111)}.layout-fixed[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]{max-width:250px;min-width:250px;padding-left:8px!important}.layout-fixed[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]   nui-legend[_ngcontent-%COMP%]{margin:0!important;width:100%}.description-container[_ngcontent-%COMP%]{display:flex;align-items:center;flex-grow:1;padding-right:2px}.description-text[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;overflow:hidden}.legend-menu[_ngcontent-%COMP%]{opacity:0;display:none;margin-left:auto}nui-legend-series[_ngcontent-%COMP%]:hover   .legend-menu[_ngcontent-%COMP%]{opacity:1;display:unset}nui-legend-series[_ngcontent-%COMP%]{width:100%}nui-icon[_ngcontent-%COMP%]{padding:0 5px}[_nghost-%COMP%]  nui-legend-series div div:nth-child(2).d-flex{flex-grow:1;overflow:hidden}[_nghost-%COMP%]  .nui-legend-series .description{min-width:unset}.selected[_ngcontent-%COMP%]{background-color:#00c4d21a}.selected[_ngcontent-%COMP%]:hover{background-color:#00c4d233}"]}),n})(),cn=(()=>{class n{constructor(){this.presets={[Pe.Line]:{componentType:Si.lateLoadKey},[Pe.StackedArea]:{componentType:Ri.lateLoadKey},[Pe.StackedPercentageArea]:{componentType:Ai.lateLoadKey},[Pe.StackedBar]:{componentType:Ni.lateLoadKey},[Pe.StatusBar]:{componentType:Oi.lateLoadKey}}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function is(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",7),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).explore(!0)}),e.qZA()}}function ns(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",8),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).zoomIn()}),e.qZA()}}function os(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",2),e.YNc(1,is,1,0,"button",3),e.YNc(2,ns,1,0,"button",4),e.TgZ(3,"button",5),e.NdJ("click",function(){return e.CHM(t),e.oxw().zoomOut()}),e.qZA(),e.TgZ(4,"button",6),e.NdJ("click",function(){return e.CHM(t),e.oxw().clearZoom()}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.exploringEnabled),e.xp6(1),e.Q6J("ngIf",t.isZoomInAllowed())}}const rs={id:"TIMESERIES_INSPECTION_MENU_ZOOM_IN"},ss={id:"TIMESERIES_INSPECTION_MENU_ZOOM_OUT"},as={id:"TIMESERIES_INSPECTION_MENU_EXPLORE"},ls={id:"TIMESERIES_INSPECTION_MENU_CLOSE"},ds={id:"TIMESERIES_INSPECTION_MENU_SYNCHRONIZE"};let _n=(()=>{class n{constructor(t,i,o){this.element=t,this.eventBus=i,this.syncService=o,this.exploringEnabled=!1,this.allowed=!1,this.offset=38,this.destroy$=new ie.x}ngOnInit(){var t;this.plugin.zoomCreated$.subscribe(()=>this.explore(!1)),this.eventBus.getStream(ds).subscribe(()=>{var i;const{startDate:o,endDate:r}=this.plugin.getInspectionFrame();o&&r&&this.syncService.syncPositionInsideCollection(null!==(i=this.collectionId)&&void 0!==i?i:"",o,r)}),null===(t=this.plugin)||void 0===t||t.openPopover$.pipe((0,_e.R)(this.destroy$)).subscribe(i=>{this.element.nativeElement.style.left=this.offset+i+"px"})}ngOnChanges(t){var i;(null===(i=t.allowed)||void 0===i?void 0:i.currentValue)?this.plugin.showPopover():this.plugin.closePopover()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}clearZoom(){var t;this.syncService.clearZoomInsideCollection(null!==(t=this.collectionId)&&void 0!==t?t:""),this.eventBus.next(ls,{})}isZoomInAllowed(){const{startDate:t,endDate:i}=this.plugin.getInspectionFrame();return!t||!i||i.diff(t,"minutes")>10}zoomIn(){var t;const i=this.plugin.getInspectionFrame();this.eventBus.next(rs,{payload:i}),this.syncService.clearZoomInsideCollection(null!==(t=this.collectionId)&&void 0!==t?t:"")}zoomOut(){const t=this.plugin.getInspectionFrame();this.eventBus.next(ss,{payload:t}),setTimeout(()=>{this.plugin.closePopover()})}explore(t=!1){const i=this.plugin.getInspectionFrame();this.eventBus.next(as,{payload:{ids:this.metricIds,startDate:i.startDate,endDate:i.endDate,openSidePanel:t,exploringEnabled:this.exploringEnabled}})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.SBq),e.Y36(m.nY),e.Y36(h.n_R))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-timeseries-inspection-menu"]],inputs:{plugin:"plugin",exploringEnabled:"exploringEnabled",metricIds:"metricIds",collectionId:"collectionId",allowed:"allowed"},features:[e.TTD],decls:3,vars:7,consts:function(){let a,t,i,o;return a=$localize`:␟edba83a887582b9af04b111ef3aeaa0cd10f4c60␟5327174997241408397:Inspect selection in the data explorer`,t=$localize`:␟34fb6028a6630cf3a7308084b31e86e89d057965␟1470758907984185227:Zoom In`,i=$localize`:␟677ce9c57b5558cb10f0b39327d5a965bfb21dc5␟1356460275822781324:Zoom Out`,o=$localize`:␟97fc19ab6ec2f01cfa529e2f22c232f4e3cc0c70␟103921551219467537:Clear selection`,[["trigger","openPopoverSubject","placement","right",1,"popover",3,"unlimited","template","container","openPopover","closePopover","hasPadding","withGrowAfterOpen"],["popoverTemplate",""],[1,"inspection-menu"],["nui-button","","type","button","icon","details","title",a,3,"click",4,"ngIf"],["nui-button","","type","button","icon","zoom-in","title",t,3,"click",4,"ngIf"],["nui-button","","type","button","icon","zoom-out","title",i,3,"click"],["nui-button","","type","button","icon","remove","title",o,3,"click"],["nui-button","","type","button","icon","details","title",a,3,"click"],["nui-button","","type","button","icon","zoom-in","title",t,3,"click"]]},template:function(t,i){if(1&t&&(e._UZ(0,"nui-popover",0),e.YNc(1,os,5,2,"ng-template",null,1,e.W1O)),2&t){const o=e.MAs(2);e.Q6J("unlimited",!0)("template",o)("container",i.element.nativeElement)("openPopover",i.plugin.openPopover$)("closePopover",i.plugin.closePopover$)("hasPadding",!1)("withGrowAfterOpen",!0)}},directives:[d.U$R,s.O5,d.r0F],styles:["[_nghost-%COMP%]{position:absolute;top:5px}.popover[_ngcontent-%COMP%]{position:absolute;pointer-events:none}[_nghost-%COMP%]     nui-overlay-arrow{display:none!important}.inspection-menu[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}.inspection-menu[_ngcontent-%COMP%]     button{border:0}.inspection-menu[_ngcontent-%COMP%]     .nui-button.is-empty{min-width:25px!important;min-height:25px!important}"]}),n})();function cs(n,a){}function _s(n,a){if(1&n&&e._UZ(0,"nui-timeseries-inspection-menu",7),2&n){const t=e.oxw(2);e.Q6J("allowed",t.allowPopover)("plugin",t.zoomPlugin)("collectionId",t.collectionId)("exploringEnabled",t.isExploringEnabled())("metricIds",null==t.configuration?null:t.configuration.metricIds)}}const us=function(n,a,t,i){return{widgetData:n,configuration:a,collectionId:t,zoomPlugin:i}};function ps(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",2),e.NdJ("mouseleave",function(){return e.CHM(t),e.oxw().toggleLeave()})("mouseenter",function(){return e.CHM(t),e.oxw().toggleEnter()}),e.ynx(1,3,4),e.YNc(3,cs,0,0,"ng-template",5),e.NdJ("attached",function(o){return e.CHM(t),e.MAs(2).attached(o)}),e.BQk(),e.YNc(4,_s,1,5,"nui-timeseries-inspection-menu",6),e.qZA()}if(2&n){const t=e.MAs(2),i=e.oxw();e.xp6(1),e.Q6J("componentType",i.chartPreset.componentType)("properties",e.l5B(4,us,i.widgetData,i.configuration,i.collectionId||(null==i.configuration?null:i.configuration.collectionId),i.zoomPlugin)),e.xp6(2),e.Q6J("cdkPortalOutlet",t.portal),e.xp6(1),e.Q6J("ngIf",(null==i.configuration?null:i.configuration.enableZoom)&&(null==i.configuration?null:i.configuration.projectType)===i.timeseriesWidgetProjectType.PerfstackApp)}}function gs(n,a){1&n&&(e.TgZ(0,"div"),e._UZ(1,"nui-image",8),e.qZA())}let yi=(()=>{class n{constructor(t,i,o){this.timeseriesChartPresetService=t,this.changeDetector=i,this.zoomPluginsSyncService=o,this.elementClass="",this.allowPopover=!1,this.timeseriesWidgetProjectType=vt}ngOnInit(){var t;this.zoomPlugin=(null===(t=this.configuration)||void 0===t?void 0:t.projectType)===vt.PerfstackApp?new h.F7W({collectionId:this.collectionId},this.zoomPluginsSyncService):new h.Rbc}ngOnChanges(t){var i,o;if(t.configuration){const r=t.configuration.currentValue,c=t.configuration.previousValue;(null==r?void 0:r.preset)!==(null==c?void 0:c.preset)&&(this.chartPreset=this.timeseriesChartPresetService.presets[null!==(o=null===(i=this.configuration)||void 0===i?void 0:i.preset)&&void 0!==o?o:Pe.Line])}}shouldShowChart(){var t,i,o;return(null!==(o=null===(i=null===(t=this.widgetData)||void 0===t?void 0:t.series)||void 0===i?void 0:i.length)&&void 0!==o?o:0)>0}toggleLeave(){this.allowPopover=!1}toggleEnter(){this.allowPopover=!0}isExploringEnabled(){var t,i,o;return(null===(t=this.configuration)||void 0===t?void 0:t.type)!==zt.gauge&&(null===(i=this.configuration)||void 0===i?void 0:i.type)!==zt.multi&&(null===(o=this.configuration)||void 0===o?void 0:o.type)!==zt.state}}return n.lateLoadKey="TimeseriesWidgetComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(cn),e.Y36(e.sBO),e.Y36(h.n_R))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-timeseries-widget"]],hostVars:2,hostBindings:function(t,i){2&t&&e.Tol(i.elementClass)},inputs:{widgetData:"widgetData",configuration:"configuration",collectionId:"collectionId",elementClass:"elementClass"},features:[e.TTD],decls:2,vars:2,consts:[["class","h-100 timeseries-widget-content",3,"mouseleave","mouseenter",4,"ngIf"],[4,"ngIf"],[1,"h-100","timeseries-widget-content",3,"mouseleave","mouseenter"],["nuiComponentPortal","","componentId","timeseriesWidgetChart",3,"componentType","properties"],["componentPortal","nuiComponentPortal"],[3,"cdkPortalOutlet","attached"],[3,"allowed","plugin","collectionId","exploringEnabled","metricIds",4,"ngIf"],[3,"allowed","plugin","collectionId","exploringEnabled","metricIds"],["image","no-data-to-show"]],template:function(t,i){1&t&&(e.YNc(0,ps,5,9,"div",0),e.YNc(1,gs,2,0,"div",1)),2&t&&(e.Q6J("ngIf",i.shouldShowChart()),e.xp6(1),e.Q6J("ngIf",!i.shouldShowChart()))},directives:[s.O5,L.$,z.Pl,_n,d.cuP],styles:[".timeseries-widget-content[_ngcontent-%COMP%]{padding:10px;position:relative}"]}),n})();function hs(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"nui-search",1),e.NdJ("inputChange",function(o){return e.CHM(t),e.oxw().onSearchInputChanged(o)})("cancel",function(o){return e.CHM(t),e.oxw().onSearch(o)})("search",function(o){return e.CHM(t),e.oxw().onSearch(o)}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("value",t.searchValue)}}let Mi=(()=>{class n{constructor(t,i){this.dataSource=t,this.eventBus=i,this.enabled=!1,this.searchTerm$=new ie.x,this.destroy$=new ie.x}ngOnInit(){var t,i,o,r;(null===(o=null===(i=null===(t=this.dataSource.features)||void 0===t?void 0:t.getSupportedFeatures())||void 0===i?void 0:i.search)||void 0===o?void 0:o.enabled)&&(this.enabled=!0),this.registerFilters(),this.handleSearchTermSubscription(null===(r=this.configuration)||void 0===r?void 0:r.searchOnKeyUp)}ngOnChanges(t){t.configuration&&this.handleSearchTermSubscription(t.configuration.currentValue.searchOnKeyUp)}onSearchInputChanged(t){var i,o;(null===(o=null===(i=this.configuration)||void 0===i?void 0:i.searchOnKeyUp)||void 0===o?void 0:o.enabled)&&(this.searchValue=t,this.searchTerm$.next(t))}onSearch(t){this.searchValue=t,this.searchTerm$.next(t)}ngOnDestroy(){this.eventBus.getStream(T.kV).next({payload:""}),this.destroy$.next(),this.destroy$.complete()}registerFilters(){var t;null===(t=this.dataSource)||void 0===t||t.registerComponent({search:{componentInstance:{getFilters:()=>({value:this.searchValue})}}})}handleSearchTermSubscription(t){var i;null===(i=this.searchTermSubscription)||void 0===i||i.unsubscribe(),this.searchTermSubscription=this.searchTerm$.pipe((0,_e.R)(this.destroy$),(0,nn.b)((null==t?void 0:t.debounceTime)||n.defaultSearchDebounce)).subscribe(o=>{this.eventBus.getStream(T.RG).next({}),this.eventBus.getStream(T.kV).next({payload:o})})}}return n.lateLoadKey="WidgetSearchComponent",n.defaultSearchDebounce=500,n.\u0275fac=function(t){return new(t||n)(e.Y36(m.Fk,8),e.Y36(m.nY))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-widget-search"]],hostVars:4,hostBindings:function(t,i){2&t&&e.ekj("default",i.enabled)("invisible",!i.enabled)},inputs:{configuration:"configuration",searchValue:"searchValue"},features:[e.TTD],decls:1,vars:1,consts:[["class","unlimited-width",3,"value","inputChange","cancel","search",4,"ngIf"],[1,"unlimited-width",3,"value","inputChange","cancel","search"]],template:function(t,i){1&t&&e.YNc(0,hs,1,1,"nui-search",0),2&t&&e.Q6J("ngIf",i.enabled)},directives:[s.O5,d.gSk],styles:[".default[_nghost-%COMP%]{padding:5px 10px}.invisible[_nghost-%COMP%]{height:0}"],changeDetection:0}),n})();var qe=(()=>{return(n=qe||(qe={})).ErrorUnknown="errorUnknown",n.ErrorForbidden="errorForbidden",n.ErrorNotFound="errorNotFound",qe;var n})();function ms(n,a){}function fs(n,a){}function Ts(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",5),e.ynx(1,1,2),e.YNc(3,fs,0,0,"ng-template",3),e.NdJ("attached",function(o){return e.CHM(t),e.MAs(2).attached(o)}),e.BQk(),e.qZA()}if(2&n){const t=e.MAs(2),i=e.oxw();e.xp6(1),e.Q6J("componentId",i.nodeConfigs[1].id)("componentType",i.nodeConfigs[1].componentType)("providers",i.nodeConfigs[1].providers)("properties",i.nodeConfigs[1].properties),e.xp6(2),e.Q6J("cdkPortalOutlet",t.portal)}}const Cs=function(n,a){return{"d-none":n,"d-flex":a}};let Pi=(()=>{class n extends Ee{constructor(t,i,o){super(t,i,o),this.elementClass="",this.defaultClasses="w-100"}ngOnInit(){this.classNames=`${this.defaultClasses} ${this.elementClass}`}ngOnDestroy(){super.ngOnDestroy()}getNodes(){return this.fallbackKey?[this.primaryContent,this.fallbackMap&&this.fallbackMap[this.fallbackKey]||qe.ErrorUnknown]:[this.primaryContent]}}return n.lateLoadKey="WidgetBodyContentComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(ce.p),e.Y36(d.mQy))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-widget-body-content"]],hostVars:2,hostBindings:function(t,i){2&t&&e.Tol(i.classNames)},inputs:{componentId:"componentId",primaryContent:"primaryContent",fallbackKey:"fallbackKey",fallbackMap:"fallbackMap",elementClass:"elementClass"},features:[e.qOj],decls:5,vars:10,consts:[[1,"h-100",3,"ngClass"],["nuiComponentPortal","",3,"componentId","componentType","providers","properties"],["componentPortal","nuiComponentPortal"],[3,"cdkPortalOutlet","attached"],["class","d-flex h-100",4,"ngIf"],[1,"d-flex","h-100"]],template:function(t,i){if(1&t){const o=e.EpF();e.TgZ(0,"div",0),e.ynx(1,1,2),e.YNc(3,ms,0,0,"ng-template",3),e.NdJ("attached",function(c){return e.CHM(o),e.MAs(2).attached(c)}),e.BQk(),e.qZA(),e.YNc(4,Ts,4,5,"div",4)}if(2&t){const o=e.MAs(2);e.Q6J("ngClass",e.WLB(7,Cs,i.fallbackKey,!i.fallbackKey)),e.xp6(1),e.Q6J("componentId",i.nodeConfigs[0].id)("componentType",i.nodeConfigs[0].componentType)("providers",i.nodeConfigs[0].providers)("properties",i.nodeConfigs[0].properties),e.xp6(2),e.Q6J("cdkPortalOutlet",o.portal),e.xp6(1),e.Q6J("ngIf",i.fallbackKey)}},directives:[s.mk,L.$,z.Pl,s.O5],encapsulation:2}),n})();function Os(n,a){1&n&&e._UZ(0,"nui-preview-overlay")}function Is(n,a){}let Di=(()=>{class n extends Ee{constructor(t,i,o,r){super(i,o,r),this.eventBus=t,this.editMode=!1,this.elementClass="",this.defaultClasses="d-flex h-100 w-100",this.getNodes=()=>[this.content]}ngOnInit(){this.classNames=`${this.defaultClasses} ${this.elementClass}`,this.eventBus.getStream(T.N9).pipe((0,_e.R)(this.destroyed$)).subscribe(t=>{this.pizzagnaService.setProperty({componentId:this.componentId,pizzagnaKey:m.xW.Data,propertyPath:["editMode"]},!!t.payload)})}ngOnDestroy(){super.ngOnDestroy()}}return n.lateLoadKey="WidgetBodyComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(m.nY),e.Y36(e.sBO),e.Y36(ce.p),e.Y36(d.mQy))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-widget-body"]],hostVars:2,hostBindings:function(t,i){2&t&&e.Tol(i.classNames)},inputs:{componentId:"componentId",editMode:"editMode",content:"content",elementClass:"elementClass"},features:[e.qOj],decls:4,vars:6,consts:[[4,"ngIf"],["nuiComponentPortal","",3,"componentId","componentType","providers","properties"],["componentPortal","nuiComponentPortal"],[3,"cdkPortalOutlet","attached"]],template:function(t,i){if(1&t){const o=e.EpF();e.YNc(0,Os,1,0,"nui-preview-overlay",0),e.ynx(1,1,2),e.YNc(3,Is,0,0,"ng-template",3),e.NdJ("attached",function(c){return e.CHM(o),e.MAs(2).attached(c)}),e.BQk()}if(2&t){const o=e.MAs(2);e.Q6J("ngIf",i.editMode),e.xp6(1),e.Q6J("componentId",i.nodeConfigs[0].id)("componentType",i.nodeConfigs[0].componentType)("providers",i.nodeConfigs[0].providers)("properties",i.nodeConfigs[0].properties),e.xp6(2),e.Q6J("cdkPortalOutlet",o.portal)}},directives:[s.O5,O.b,L.$,z.Pl],styles:["[_nghost-%COMP%]{position:relative}"]}),n})();var bt=l(41777);const vs=["widgetHeaderCustomElement"];function Es(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",18),e.NdJ("click",function(){return e.CHM(t),e.oxw().toggleCollapsed()}),e._UZ(1,"span",19),e.qZA()}}function Ss(n,a){1&n&&(e.TgZ(0,"div",20),e._UZ(1,"nui-icon",21),e.qZA())}function Rs(n,a){if(1&n&&(e.TgZ(0,"div",22),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.Q6J("title",t.title),e.xp6(1),e.hij(" ",t.title," ")}}function Ns(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"a",23),e.NdJ("click",function(o){return e.CHM(t),e.oxw().prepareLink(o)})("mouseenter",function(o){return e.CHM(t),e.oxw().prepareLink(o)})("mousedown",function(o){return o.stopPropagation(),o.preventDefault()}),e._uU(2),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("href",t.url,e.LSH)("nuiTooltip",t.linkTooltip),e.xp6(1),e.Oqu(t.title)}}function As(n,a){if(1&n&&(e.TgZ(0,"div",24),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.Q6J("title",t.subtitle),e.xp6(1),e.hij(" ",t.subtitle," ")}}function ys(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"a",25),e.NdJ("click",function(o){return e.CHM(t),e.oxw().prepareLink(o)})("mouseenter",function(o){return e.CHM(t),e.oxw().prepareLink(o)})("mousedown",function(o){return o.stopPropagation(),o.preventDefault()}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("href",t.url,e.LSH)("nuiTooltip",t.linkTooltip)}}function Ms(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){return e.CHM(t),e.oxw().onEditWidget()}),e.qZA()}}function Ps(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",27),e.NdJ("click",function(){return e.CHM(t),e.oxw().toggleCollapsed()}),e.qZA()}}function Ds(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"nui-menu-action",30),e.NdJ("actionDone",function(){return e.CHM(t),e.oxw(2).onReloadData()}),e._UZ(1,"nui-icon",31),e.TgZ(2,"span"),e.SDv(3,32),e.qZA()()}}function bs(n,a){if(1&n&&(e.TgZ(0,"nui-menu",28),e.YNc(1,Ds,4,0,"nui-menu-action",29),e.qZA()),2&n){const t=e.oxw();e.Q6J("appendToBody",!0),e.xp6(1),e.Q6J("ngIf",t.reloadable)}}function Fs(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"nui-popup",33)(1,"span",34),e._UZ(2,"button",35),e.qZA(),e.TgZ(3,"div",36)(4,"nui-menu-action",37),e.NdJ("actionDone",function(){return e.CHM(t),e.oxw().removeWidget()}),e.SDv(5,38),e.qZA()()()}2&n&&e.Q6J("appendToBody",!0)}function xs(n,a){1&n&&e._UZ(0,"div",39)}const Ls=["*"];let bi=(()=>{class n{constructor(t,i,o,r,c){this.eventBus=t,this.pizzagnaService=i,this.changeDetector=o,this.eventProxy=r,this.linkProvider=c,this.editMode=!0,this.editable=!0,this.removable=!0,this.collapsible=!1,this.reloadable=!0,this.hideMenu=!1,this.collapsed=!1,this.onDestroy$=new ie.x,this.linkTooltip=$localize`Explore this data`}get hostClass(){return!0}get state(){return this.collapsed&&this.collapsible?"collapsed":"expanded"}ngOnInit(){this.collapsible&&this.pizzagnaService.setProperty({componentId:this.componentId,pizzagnaKey:m.xW.Data,propertyPath:["isCollapsed"]},!0),this.eventProxy&&(this.eventProxy.addUpstream(T.Ef),this.eventProxy.addUpstream(T.y4),this.eventProxy.addDownstream(T.N9)),this.eventBus.getStream(T.N9).pipe((0,_e.R)(this.onDestroy$)).subscribe(t=>{this.pizzagnaService.setProperty({componentId:this.componentId,pizzagnaKey:m.xW.Data,propertyPath:["collapsed"]},!t.payload),this.pizzagnaService.setProperty({componentId:this.componentId,pizzagnaKey:m.xW.Data,propertyPath:["editMode"]},!!t.payload)})}ngAfterViewInit(){setTimeout(()=>{this.withCustomElement=0!==this.widgetHeaderCustomElement.nativeElement.childNodes.length})}ngOnDestroy(){this.onDestroy$.next(),this.onDestroy$.complete()}removeWidget(){this.eventBus.getStream(T.y4).next({})}toggleCollapsed(){this.pizzagnaService.setProperty({componentId:this.componentId,pizzagnaKey:m.xW.Data,propertyPath:["collapsed"]},!this.collapsed)}onEditWidget(){this.eventBus.getStream(T.Ef).next({})}onReloadData(){if(!this.reloadable)throw new Error("The widget is not reloadable, so it can't be reloaded manually.");this.eventBus.getStream(T.RG).next({})}prepareLink(t){const i=t.target;if(i&&this.linkProvider){const o=this.linkProvider.getLink(this.url);o&&i.setAttribute("href",o)}return!0}}return n.lateLoadKey="WidgetHeaderComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(m.nY),e.Y36(ce.p),e.Y36(e.sBO),e.Y36(V.q,8),e.Y36(m.B5,8))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-widget-header"]],viewQuery:function(t,i){if(1&t&&e.Gf(vs,5),2&t){let o;e.iGM(o=e.CRH())&&(i.widgetHeaderCustomElement=o.first)}},hostVars:2,hostBindings:function(t,i){2&t&&e.ekj("nui-widget-header",i.hostClass)},inputs:{componentId:"componentId",editMode:"editMode",editable:"editable",removable:"removable",collapsible:"collapsible",reloadable:"reloadable",title:"title",subtitle:"subtitle",hideMenu:"hideMenu",url:"url",collapsed:"collapsed"},ngContentSelectors:Ls,decls:19,vars:20,consts:function(){let a,t,i,o;return a=$localize`:␟8028b4b4a38e861642d3d465f1fd0e08ea5bdcd0␟8529558445404824560:Edit widget`,t=$localize`:␟aefc550c9735e4112bc884389f77c619007acb8e␟9121781503543370614:Reload data`,i=$localize`:␟6d4f27e8085712e506aaaee1704b3e0455d15652␟8500807759101015900:Remove widget`,o=$localize`:␟0f0e6eea7e5a63ccfd2d07117d5560cb89936c2c␟495801405190883151:Remove Widget`,[[1,"nui-widget__header"],[1,"nui-widget__header__container"],["class","collapse-container",3,"click",4,"ngIf"],[1,"nui-widget__header__content"],["class","nui-widget__header__content-drag-icon nui-dashboard__widget--drag-handle",4,"ngIf"],[1,"nui-widget__header__content-custom-element"],["widgetHeaderCustomElement",""],[1,"nui-widget__header__content-title-container","nui-dashboard__widget--drag-handle"],["class","nui-text-widget nui-widget__header__content-title",3,"title",4,"ngIf"],[4,"ngIf"],["class","nui-text-hint nui-widget__header__content-help-hint",3,"title",4,"ngIf"],[1,"nui-widget__header__content-actions"],["nui-button","","displayStyle","action","icon","external-link",3,"href","nuiTooltip","click","mouseenter","mousedown",4,"ngIf"],["class","nui-widget-header__action-edit","nui-button","","type","button","displayStyle","action","icon","edit","nuiTooltip",a,3,"click",4,"ngIf"],["class","nui-widget-header__action-toggle-collapsed","nui-button","","type","button","displayStyle","action","nuiTooltip","Collapse header","icon","double-caret-up",3,"click",4,"ngIf"],["class","nui-widget__header__content-actions__menu","icon","menu","displayStyle","action",3,"appendToBody",4,"ngIf"],["class","nui-widget-header__action-remove",3,"appendToBody",4,"ngIf"],["class","collapse-spacer",4,"ngIf"],[1,"collapse-container",3,"click"],[1,"collapse-container__line"],[1,"nui-widget__header__content-drag-icon","nui-dashboard__widget--drag-handle"],["icon","drag","iconColor","gray"],[1,"nui-text-widget","nui-widget__header__content-title",3,"title"],[1,"nui-text-widget","nui-widget__header__content-title",3,"href","nuiTooltip","click","mouseenter","mousedown"],[1,"nui-text-hint","nui-widget__header__content-help-hint",3,"title"],["nui-button","","displayStyle","action","icon","external-link",3,"href","nuiTooltip","click","mouseenter","mousedown"],["nui-button","","type","button","displayStyle","action","icon","edit","nuiTooltip",a,1,"nui-widget-header__action-edit",3,"click"],["nui-button","","type","button","displayStyle","action","nuiTooltip","Collapse header","icon","double-caret-up",1,"nui-widget-header__action-toggle-collapsed",3,"click"],["icon","menu","displayStyle","action",1,"nui-widget__header__content-actions__menu",3,"appendToBody"],[3,"actionDone",4,"ngIf"],[3,"actionDone"],["icon","reload"],t,[1,"nui-widget-header__action-remove",3,"appendToBody"],["nuiTooltip",i],["nui-button","","nuiPopupToggle","","type","button","icon","remove","iconColor","red","displayStyle","action"],["popupAreaContent","",1,"nui-menu"],["type","destructive",3,"actionDone"],o,[1,"collapse-spacer"]]},template:function(t,i){1&t&&(e.F$t(),e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,Es,2,0,"div",2),e.TgZ(3,"div",3),e.YNc(4,Ss,2,0,"div",4),e.TgZ(5,"div",5,6),e.Hsn(7),e.qZA(),e.TgZ(8,"div",7),e.YNc(9,Rs,2,2,"div",8),e.YNc(10,Ns,3,3,"div",9),e.YNc(11,As,2,2,"div",10),e.qZA(),e.TgZ(12,"div",11),e.YNc(13,ys,1,2,"a",12),e.YNc(14,Ms,1,0,"button",13),e.YNc(15,Ps,1,0,"button",14),e.YNc(16,bs,2,2,"nui-menu",15),e.YNc(17,Fs,6,1,"nui-popup",16),e.qZA()()(),e.YNc(18,xs,1,0,"div",17),e.qZA()),2&t&&(e.xp6(1),e.ekj("nui-widget__header__container--collapsible",i.collapsible)("nui-widget__header__container--collapsed",i.collapsible&&i.collapsed)("nui-widget__header__container--expanded",i.collapsible&&!i.collapsed),e.Q6J("@expandedState",i.state),e.xp6(1),e.Q6J("ngIf",i.collapsed&&i.collapsible),e.xp6(2),e.Q6J("ngIf",i.editMode),e.xp6(4),e.ekj("nui-widget__header__content-title-with-additional-content",i.withCustomElement||i.editMode),e.xp6(1),e.Q6J("ngIf",!i.url||i.editMode),e.xp6(1),e.Q6J("ngIf",i.url&&!i.editMode),e.xp6(1),e.Q6J("ngIf",i.subtitle),e.xp6(2),e.Q6J("ngIf",i.url&&!i.editMode),e.xp6(1),e.Q6J("ngIf",i.editable&&i.editMode),e.xp6(1),e.Q6J("ngIf",i.collapsible&&!i.editMode),e.xp6(1),e.Q6J("ngIf",!i.hideMenu&&!i.editMode),e.xp6(1),e.Q6J("ngIf",i.removable&&i.editMode),e.xp6(1),e.Q6J("ngIf",i.collapsible))},directives:[s.O5,d.oJW,d.i9q,d.r0F,d.Mnp,d.VDk,d.RXH,d.btB],styles:[".nui-widget__header[_ngcontent-%COMP%]{display:flex;position:relative}.nui-widget__header[_ngcontent-%COMP%]   .collapse-spacer[_ngcontent-%COMP%]{margin-bottom:15px}.nui-widget__header__container[_ngcontent-%COMP%]{z-index:500;width:100%}.nui-widget__header__container--collapsible[_ngcontent-%COMP%]{width:100%}.nui-widget__header__container--collapsed[_ngcontent-%COMP%]   .nui-widget__header__content[_ngcontent-%COMP%]{opacity:0;visibility:hidden}.nui-widget__header__container[_ngcontent-%COMP%]   .collapse-container[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;cursor:pointer}.nui-widget__header__container[_ngcontent-%COMP%]   .collapse-container__line[_ngcontent-%COMP%]{width:16px;height:1px;background:var(--nui-color-line-active,#0079aa);margin:5px 0;cursor:pointer}.nui-widget__header__container[_ngcontent-%COMP%]   .nui-widget__header__content[_ngcontent-%COMP%]{align-items:flex-start;display:flex;opacity:1}.nui-widget__header__container[_ngcontent-%COMP%]   .nui-widget__header__content-drag-icon[_ngcontent-%COMP%]{align-items:center;cursor:move;display:flex;height:30px;justify-content:center;margin:5px;width:30px}.nui-widget__header__container[_ngcontent-%COMP%]   .nui-widget__header__content-title[_ngcontent-%COMP%]{display:block;max-width:100%;white-space:nowrap;overflow:hidden;-ms-text-overflow:ellipsis;text-overflow:ellipsis}.nui-widget__header__container[_ngcontent-%COMP%]   .nui-widget__header__content-title-container[_ngcontent-%COMP%]{flex:1;min-width:0;padding:10px 0 5px 10px}.nui-widget__header__container[_ngcontent-%COMP%]   .nui-widget__header__content-title-with-additional-content[_ngcontent-%COMP%]{padding-left:0}.nui-widget__header__container[_ngcontent-%COMP%]   .nui-widget__header__content-help-hint[_ngcontent-%COMP%]{max-width:100%;white-space:nowrap;overflow:hidden;-ms-text-overflow:ellipsis;text-overflow:ellipsis}.nui-widget__header__container[_ngcontent-%COMP%]   .nui-widget__header__content-actions[_ngcontent-%COMP%]{display:flex;padding:5px 10px 0 5px}"],data:{animation:[(0,bt.X$)("expandedState",[(0,bt.SB)("expanded",(0,bt.oB)({height:"*"})),(0,bt.SB)("collapsed",(0,bt.oB)({height:"11px"})),(0,bt.eR)("expanded <=> collapsed",[(0,bt.jt)("350ms ease-in-out")])])]}}),n})();l(43046);var et=l(53737);let un=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[z.eL,A],z.eL]}),n})();const Gs=new Map([["aliceblue","#f0f8ff"],["antiquewhite","#faebd7"],["aqua","#00ffff"],["aquamarine","#7fffd4"],["azure","#f0ffff"],["beige","#f5f5dc"],["bisque","#ffe4c4"],["black","#000000"],["blanchedalmond","#ffebcd"],["blue","#0000ff"],["blueviolet","#8a2be2"],["brown","#a52a2a"],["burlywood","#deb887"],["cadetblue","#5f9ea0"],["chartreuse","#7fff00"],["chocolate","#d2691e"],["coral","#ff7f50"],["cornflowerblue","#6495ed"],["cornsilk","#fff8dc"],["crimson","#dc143c"],["cyan","#00ffff"],["darkblue","#00008b"],["darkcyan","#008b8b"],["darkgoldenrod","#b8860b"],["darkgray","#a9a9a9"],["darkgreen","#006400"],["darkkhaki","#bdb76b"],["darkmagenta","#8b008b"],["darkolivegreen","#556b2f"],["darkorange","#ff8c00"],["darkorchid","#9932cc"],["darkred","#8b0000"],["darksalmon","#e9967a"],["darkseagreen","#8fbc8f"],["darkslateblue","#483d8b"],["darkslategray","#2f4f4f"],["darkturquoise","#00ced1"],["darkviolet","#9400d3"],["deeppink","#ff1493"],["deepskyblue","#00bfff"],["dimgray","#696969"],["dodgerblue","#1e90ff"],["firebrick","#b22222"],["floralwhite","#fffaf0"],["forestgreen","#228b22"],["fuchsia","#ff00ff"],["gainsboro","#dcdcdc"],["ghostwhite","#f8f8ff"],["gold","#ffd700"],["goldenrod","#daa520"],["gray","#808080"],["green","#008000"],["greenyellow","#adff2f"],["honeydew","#f0fff0"],["hotpink","#ff69b4"],["indianred ","#cd5c5c"],["indigo","#4b0082"],["ivory","#fffff0"],["khaki","#f0e68c"],["lavender","#e6e6fa"],["lavenderblush","#fff0f5"],["lawngreen","#7cfc00"],["lemonchiffon","#fffacd"],["lightblue","#add8e6"],["lightcoral","#f08080"],["lightcyan","#e0ffff"],["lightgoldenrodyellow","#fafad2"],["lightgrey","#d3d3d3"],["lightgreen","#90ee90"],["lightpink","#ffb6c1"],["lightsalmon","#ffa07a"],["lightseagreen","#20b2aa"],["lightskyblue","#87cefa"],["lightslategray","#778899"],["lightsteelblue","#b0c4de"],["lightyellow","#ffffe0"],["lime","#00ff00"],["limegreen","#32cd32"],["linen","#faf0e6"],["magenta","#ff00ff"],["maroon","#800000"],["mediumaquamarine","#66cdaa"],["mediumblue","#0000cd"],["mediumorchid","#ba55d3"],["mediumpurple","#9370d8"],["mediumseagreen","#3cb371"],["mediumslateblue","#7b68ee"],["mediumspringgreen","#00fa9a"],["mediumturquoise","#48d1cc"],["mediumvioletred","#c71585"],["midnightblue","#191970"],["mintcream","#f5fffa"],["mistyrose","#ffe4e1"],["moccasin","#ffe4b5"],["navajowhite","#ffdead"],["navy","#000080"],["oldlace","#fdf5e6"],["olive","#808000"],["olivedrab","#6b8e23"],["orange","#ffa500"],["orangered","#ff4500"],["orchid","#da70d6"],["palegoldenrod","#eee8aa"],["palegreen","#98fb98"],["paleturquoise","#afeeee"],["palevioletred","#d87093"],["papayawhip","#ffefd5"],["peachpuff","#ffdab9"],["peru","#cd853f"],["pink","#ffc0cb"],["plum","#dda0dd"],["powderblue","#b0e0e6"],["purple","#800080"],["rebeccapurple","#663399"],["red","#ff0000"],["rosybrown","#bc8f8f"],["royalblue","#4169e1"],["saddlebrown","#8b4513"],["salmon","#fa8072"],["sandybrown","#f4a460"],["seagreen","#2e8b57"],["seashell","#fff5ee"],["sienna","#a0522d"],["silver","#c0c0c0"],["skyblue","#87ceeb"],["slateblue","#6a5acd"],["slategray","#708090"],["snow","#fffafa"],["springgreen","#00ff7f"],["steelblue","#4682b4"],["tan","#d2b48c"],["teal","#008080"],["thistle","#d8bfd8"],["tomato","#ff6347"],["turquoise","#40e0d0"],["violet","#ee82ee"],["wheat","#f5deb3"],["white","#ffffff"],["whitesmoke","#f5f5f5"],["yellow","#ffff00"],["yellowgreen","#9acd32"]]);let pn=(()=>{class n{RGBToHexRGBToHex(t){const i=t.indexOf(",")>-1?",":" ",o=t.substr(4).split(")")[0].split(i);let r=(+o[0]).toString(16),c=(+o[1]).toString(16),g=(+o[2]).toString(16);return 1===r.length&&(r="0"+r),1===c.length&&(c="0"+c),1===g.length&&(g="0"+g),"#"+r+c+g}isHEX(t){return/^#[0-9A-F]{6}$/i.test(t)||/^#([0-9A-F]{3}){1,2}$/i.test(t)}colorKeywordsToHex(t){const i=Gs.get(t);return k()(i)?"":i}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();var $s=l(91314);function Us(n,a){if(1&n&&e._UZ(0,"div",10),2&n){const t=e.oxw().$implicit,i=e.oxw();e.ekj("black-tick",i.isBlackTick||(null==t?null:t.color)===i.defaultColor)}}function zs(n,a){if(1&n&&(e.TgZ(0,"div",4)(1,"nui-select-v2-option",5,6)(3,"div",7)(4,"div",8),e.YNc(5,Us,1,2,"div",9),e.qZA()()()()),2&n){const t=a.$implicit,i=e.MAs(2),o=e.oxw();e.xp6(1),e.Q6J("value",null==t?null:t.color)("displayValueContext",t),e.xp6(2),e.ekj("color-picker-option--selected",null==i?null:i.selected),e.uIk("title",null==t?null:t.label),e.xp6(1),e.Q6J("ngStyle",o.setStyles(null==t?null:t.color)),e.xp6(1),e.Q6J("ngIf",null==i?null:i.selected)}}function Bs(n,a){if(1&n&&(e.TgZ(0,"div",11)(1,"div",12),e._UZ(2,"div",13),e.qZA(),e.TgZ(3,"div",14),e._UZ(4,"nui-icon",15),e.qZA()()),2&n){const t=a.$implicit,i=a.open,o=e.oxw();e.xp6(1),e.uIk("title",null==t?null:t.label),e.xp6(1),e.Q6J("ngStyle",o.setStyles(null==t?null:t.color)),e.xp6(2),e.Udp("transform",i?"rotate(180deg)":"")}}let Fi=(()=>{class n{constructor(t,i,o){this.changeDetection=t,this.colorService=i,this.cdkOverlay=o,this.defaultColor="var(--nui-color-bg-secondary)",this.overlayUtilities=new d.KcF,this.destroy$=new ie.x,this.setStyles=r=>({"background-color":r||this.defaultColor})}ngOnChanges(t){t.colors&&(this.colors=t.colors.currentValue),t.colorPalette&&(this.colorPalette=t.colorPalette.currentValue)}ngAfterViewInit(){var t;this.value&&(null===(t=this.select)||void 0===t||t.writeValue(this.value),this.isBlackTick=this.determineBlackTick(this.value.toString())),this.palette=this.colorPalette||this.colors.map(r=>({color:r})),this.initOverlayUtilities(),this.select.valueSelected.pipe((0,st.b)(r=>this.writeValue(r)),(0,st.b)(r=>this.onChange(r)),(0,_e.R)(this.destroy$)).subscribe(r=>{r&&(this.isBlackTick=this.determineBlackTick(r.toString()))});const i=(0,d.gpG)(),o=this.cdkOverlay.position().flexibleConnectedTo(this.select.elRef.nativeElement).withPush(!1).withViewportMargin(0).withPositions([i["bottom-right"],i["bottom-left"],i["top-right"],i["top-left"]]);this.overlayConfig={maxWidth:this.cols?30*this.cols+20+"px":"260px",positionStrategy:o}}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}onChange(t){}_onTouched(){}writeValue(t){var i;this.value=t,null===(i=this.select)||void 0===i||i.writeValue(t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this._onTouched=t}determineBlackTick(t){let i="#fff";return i=this.colorService.isHEX(t)?t:(0,h.ruO)(t)||this.colorService.RGBToHexRGBToHex(t)||this.colorService.colorKeywordsToHex(t),"#fff"===this.getContrastOnBgColor(i)}initOverlayUtilities(){const t=this.select.dropdown;this.selectResizeObserver=this.overlayUtilities.setPopupComponent(this.select.dropdown).getResizeObserver({updateSize:!1}),t.show$.pipe((0,_e.R)(this.destroy$)).subscribe(()=>{this.overlayUtilities.syncWidth(),this.selectResizeObserver.observe(this.select.elRef.nativeElement)}),t.hide$.pipe((0,_e.R)(this.destroy$)).subscribe(()=>{this.selectResizeObserver.unobserve(this.select.elRef.nativeElement)})}getContrastOnBgColor(t){return t?parseInt(t.replace("#",""),16)>8388607.5?"#fff":"#000":""}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(pn),e.Y36($s.aV))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-color-picker"]],viewQuery:function(t,i){if(1&t&&e.Gf(d.j_n,5),2&t){let o;e.iGM(o=e.CRH())&&(i.select=o.first)}},inputs:{colors:"colors",colorPalette:"colorPalette",cols:"cols"},features:[e._Bn([{provide:d.MDN,useExisting:(0,e.Gpc)(()=>n),multi:!0},{provide:p.JU,useExisting:(0,e.Gpc)(()=>n),multi:!0},pn]),e.TTD],decls:5,vars:4,consts:[[1,"color-picker-select",3,"overlayConfig","syncWidth","displayValueTemplate"],[1,"color-picker-container"],["class","d-inline-flex flex-wrap box",4,"ngFor","ngForOf"],["colorSelectTemplate",""],[1,"d-inline-flex","flex-wrap","box"],[1,"w-100","h-100","reset-box-sizes",3,"value","displayValueContext"],["option",""],[1,"color-picker-option"],[1,"color-picker-option__color-box",3,"ngStyle"],["class","color-picker-option__glyph",3,"black-tick",4,"ngIf"],[1,"color-picker-option__glyph"],[1,"color-picker-input"],[1,"color-picker-input__box"],[1,"color-picker-input__color-box",3,"ngStyle"],[1,"color-picker-input__toggle"],["icon","caret-down"]],template:function(t,i){if(1&t&&(e.TgZ(0,"nui-select-v2",0)(1,"div",1),e.YNc(2,zs,6,7,"div",2),e.qZA()(),e.YNc(3,Bs,5,4,"ng-template",null,3,e.W1O)),2&t){const o=e.MAs(4);e.Q6J("overlayConfig",i.overlayConfig)("syncWidth",!1)("displayValueTemplate",o),e.xp6(2),e.Q6J("ngForOf",i.palette)}},directives:[d.j_n,s.sg,d.rLF,s.PC,s.O5,d.oJW],styles:[".box[_ngcontent-%COMP%]{width:30px;height:30px}.color-picker-container[_ngcontent-%COMP%]{padding:5px 10px}.color-picker-select[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;min-width:unset;cursor:pointer}.color-picker-input[_ngcontent-%COMP%]{display:flex}.color-picker-input__box[_ngcontent-%COMP%]{display:flex;align-items:center;flex-grow:1}.color-picker-input__color-box[_ngcontent-%COMP%]{width:16px;height:16px;border-radius:3px;border:1px solid;border-color:var(--nui-color-line-default,#d9d9d9);width:17px;height:17px;flex-grow:1;margin:0 10px}.color-picker-input__toggle[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;border-left:1px solid;border-left-color:var(--nui-color-line-default,#d9d9d9);width:30px;height:30px}.color-picker-option[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%}.color-picker-option__color-box[_ngcontent-%COMP%]{width:16px;height:16px;border-radius:3px;border:1px solid;border-color:var(--nui-color-line-default,#d9d9d9);padding:1px 0 0 1px}.color-picker-option--selected[_ngcontent-%COMP%]{background-color:var(--nui-color-selected,rgba(0, 196, 210, .1))}.color-picker-option--selected[_ngcontent-%COMP%]:focus{outline:none}.color-picker-option__glyph[_ngcontent-%COMP%]{width:100%;height:100%;background-size:12px;background-image:url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCIKCSB2aWV3Qm94PSIwIDAgMjAgMjAiIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMjAgMjA7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KCS54dWktY2hlY2tib3gtZ2x5cGh7ZmlsbDpub25lO3N0cm9rZTojRkZGRkZGO3N0cm9rZS13aWR0aDozO3N0cm9rZS1taXRlcmxpbWl0OjEwO3N0cm9rZS1saW5lY2FwOnJvdW5kO30KPC9zdHlsZT4KPHBvbHlsaW5lIGNsYXNzPSJ4dWktY2hlY2tib3gtZ2x5cGgiIHBvaW50cz0iMTcsNCA4LDE1IDMsOSAiLz4KPC9zdmc+);background-repeat:no-repeat}.color-picker-option__glyph.black-tick[_ngcontent-%COMP%]{filter:invert(1) grayscale(1) contrast(100)}"],changeDetection:0}),n})();var gn=l(69155);let qt=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-drop-area"]],decls:0,vars:0,template:function(t,i){},styles:["[_nghost-%COMP%]{display:flex;align-items:center;justify-content:center;border:3px solid;border-color:var(--nui-color-selected-contrast,#00c4d2);background-color:var(--nui-color-busy-default,rgba(0, 196, 210, .2))}"]}),n})();function Zs(n,a){}const Vs=function(){return["formReady"]};function Js(n,a){if(1&n){const t=e.EpF();e.ynx(0)(1,1,2),e.NdJ("output",function(o){const c=e.CHM(t).$implicit;return e.oxw().onEvent(c.id,o)}),e.YNc(3,Zs,0,0,"ng-template",3),e.NdJ("attached",function(o){return e.CHM(t),e.MAs(2).attached(o)}),e.BQk()()}if(2&n){const t=a.$implicit,i=e.MAs(2);e.xp6(1),e.Q6J("componentId",t.id)("componentType",t.componentType)("providers",t.providers)("properties",t.properties)("outputs",e.DdM(6,Vs)),e.xp6(2),e.Q6J("cdkPortalOutlet",i.portal)}}let St=(()=>{class n extends Ee{constructor(t,i,o,r,c){super(t,i,o),this.formDirective=r,this.eventBus=c,this.elementClass=""}ngOnInit(){this.form=this.formDirective.form}ngOnChanges(t){super.ngOnChanges(t)}onEvent(t,i){"formReady"===i.id&&this.addFormGroup(t,i.payload)}addFormGroup(t,i){this.form.addControl(t,i)}getNodes(){return this.nodes}}return n.lateLoadKey="FormStackComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(ce.p),e.Y36(d.mQy),e.Y36(p.sg),e.Y36(m.nY))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-form-stack"]],hostVars:2,hostBindings:function(t,i){2&t&&e.Tol(i.elementClass)},inputs:{nodes:"nodes"},features:[e._Bn([],[{provide:p.gN,useExisting:p.sg}]),e.qOj,e.TTD],decls:1,vars:2,consts:[[4,"ngFor","ngForOf","ngForTrackBy"],["nuiComponentPortal","",3,"componentId","componentType","providers","properties","outputs","output"],["componentPortal","nuiComponentPortal"],[3,"cdkPortalOutlet","attached"]],template:function(t,i){1&t&&e.YNc(0,Js,4,7,"ng-container",0),2&t&&e.Q6J("ngForOf",i.nodeConfigs)("ngForTrackBy",i.trackByFn)},directives:[s.sg,L.$,z.Pl],encapsulation:2}),n})();var xi=l(40801),Ys=(l(1892),l(87686));l(29614);let hn=(()=>{class n{constructor(t,i,o){this.changeDetector=t,this.formBuilder=i,this.logger=o,this.formReady=new e.vpe}ngOnChanges(t){var i,o;this.form||this.initForm(),this.contentFormatterProperties?Object.keys(this.contentFormatterProperties).forEach(r=>{var c,g;null===(g=null===(c=this.form)||void 0===c?void 0:c.get(r))||void 0===g||g.setValue(this.contentFormatterProperties[r])}):null===(o=null===(i=this.form)||void 0===i?void 0:i.get("currentMetric"))||void 0===o||o.patchValue(this.properMetric)}ngOnInit(){this.initForm()}initForm(){this.form=this.formBuilder.group({currentMetric:[this.properMetric,p.kI.required]}),this.addCustomFormControls(this.form),this.formReady.emit(this.form)}get currentMetric(){return this.form.get("currentMetric")}get properMetric(){var t,i,o,r;const c=null===(t=this.contentFormatterProperties)||void 0===t?void 0:t.currentMetric;return(null===(i=this.dsOutput)||void 0===i?void 0:i.result.find(E=>E.id===c))?c:null===(r=null===(o=this.dsOutput)||void 0===o?void 0:o.result[0])||void 0===r?void 0:r.id}addCustomFormControls(t){}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(e.sBO),e.LFG(p.qu),e.LFG(d.mQy))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();function Hs(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",7),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",null==t?null:t.id),e.xp6(1),e.hij(" ",null==t?null:t.name," ")}}let mn=(()=>{class n extends hn{constructor(t,i,o,r){super(t,i,o),this.pizzagnaService=r}}return n.lateLoadKey="DonutContentPercentageConfigurationComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(p.qu),e.Y36(d.mQy),e.Y36(ce.p))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-donut-content-configurator"]],features:[e.qOj],decls:7,vars:3,consts:function(){let a,t;return a=$localize`:␟447ffd4cbfd3d8c3ca8dd216c0a82ecadc24a7de␟4196232656388343089:Metrics`,t=$localize`:␟b17406f843dc33feb81478ae8273dc1aae06bbf6␟2244196281006156184: This field is required `,[[3,"formGroup"],[1,"mt-4"],["caption",a,1,"mb-3",3,"control"],["formControlName","currentMetric"],[3,"value",4,"ngFor","ngForOf"],["for","required"],t,[3,"value"]]},template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"nui-form-field",2)(3,"nui-select-v2",3),e.YNc(4,Hs,2,2,"nui-select-v2-option",4),e.qZA(),e.TgZ(5,"nui-validation-message",5),e.SDv(6,6),e.qZA()()()()),2&t&&(e.Q6J("formGroup",i.form),e.xp6(2),e.Q6J("control",i.currentMetric),e.xp6(2),e.Q6J("ngForOf",null==i.dsOutput?null:i.dsOutput.result))},directives:[p.JL,p.sg,d.hgI,d.j_n,p.JJ,p.u,s.sg,d.rLF,d.CfE],encapsulation:2}),n})();var Ks=l(10912),Li=l.n(Ks);let wi=(()=>{class n{constructor(t){this.changeDetector=t,this.destroy$=new ie.x}ngOnChanges(t){var i;t.data&&(this.sum=Li()(this.data,o=>o.data[0])),t.properties&&(this.currentMetricData=(null===(i=this.data.find(o=>{var r;return o.id===(null===(r=this.properties)||void 0===r?void 0:r.currentMetric)}))||void 0===i?void 0:i.data[0])||this.data[0].data[0]),this.getProperContentValue()}ngOnInit(){this.chartAssist.chartAssistSubject.pipe((0,st.b)(t=>this.emphasizedSeriesData=this.data.find(i=>i.id===t.payload.seriesId)),(0,st.b)(()=>this.getProperContentValue()),(0,_e.R)(this.destroy$)).subscribe()}getProperSeriesData(){var t;return this.emphasizedSeriesData?null===(t=this.emphasizedSeriesData)||void 0===t?void 0:t.data[0]:this.currentMetricData}getProperContentValue(){this.chartContent=(this.getProperSeriesData()/this.sum*100).toFixed(2)+"%"}}return n.lateLoadKey="DonutContentPercentageFormatterComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],inputs:{data:"data",chartAssist:"chartAssist",properties:"properties"},features:[e.TTD],decls:4,vars:1,consts:[[1,"nui-text-page"]],template:function(t,i){1&t&&(e.ynx(0),e.TgZ(1,"div",0)(2,"div",0),e._uU(3),e.qZA()(),e.BQk()),2&t&&(e.xp6(3),e.hij(" ",i.chartContent," "))},encapsulation:2}),n})();function Qs(n,a){if(1&n&&e._UZ(0,"nui-icon",5),2&n){const t=e.oxw();e.Q6J("icon",null==t.config?null:t.config.chartDonutContentIcon)}}function Xs(n,a){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"number"),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Oqu(e.xi3(2,1,t.sum,"1.0-3"))}}function js(n,a){if(1&n&&e._uU(0),2&n){const t=e.oxw();e.Oqu(t.convertedValue)}}function qs(n,a){if(1&n&&(e.TgZ(0,"div",6),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",null==t.config?null:t.config.chartDonutContentLabel," ")}}let fn=(()=>{class n{constructor(t,i){this.changeDetector=t,this.conversionThreshold=1e6,this.unitConversionPipe=new lt(i)}ngOnChanges(){this.sum=Li()(this.data,t=>t.data[0]),this.convertedValue=this.unitConversionPipe.transform(this.sum)}}return n.lateLoadKey="DonutContentRawFormatterComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(d.CrH))},n.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],inputs:{data:"data",config:"config"},features:[e.TTD],decls:7,vars:4,consts:[["iconSize","medium",3,"icon",4,"ngIf"],[1,"nui-text-page"],[4,"ngIf","ngIfElse"],["convertedValueDisplay",""],["class","nui-text-secondary",4,"ngIf"],["iconSize","medium",3,"icon"],[1,"nui-text-secondary"]],template:function(t,i){if(1&t&&(e.ynx(0),e.YNc(1,Qs,1,1,"nui-icon",0),e.TgZ(2,"div",1),e.YNc(3,Xs,3,4,"span",2),e.YNc(4,js,1,1,"ng-template",null,3,e.W1O),e.qZA(),e.YNc(6,qs,2,1,"div",4),e.BQk()),2&t){const o=e.MAs(5);e.xp6(1),e.Q6J("ngIf",null==i.config?null:i.config.chartDonutContentIcon),e.xp6(2),e.Q6J("ngIf",i.sum<i.conversionThreshold)("ngIfElse",o),e.xp6(3),e.Q6J("ngIf",null==i.config?null:i.config.chartDonutContentLabel)}},directives:[s.O5,d.oJW],pipes:[s.JJ],encapsulation:2}),n})(),Gi=(()=>{class n{constructor(t){this.changeDetector=t}ngOnChanges(){this.sum=Li()(this.data,t=>t.data[0])}}return n.lateLoadKey="DonutContentSumFormatterComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],inputs:{data:"data"},features:[e.TTD],decls:3,vars:1,consts:[[1,"nui-text-page"]],template:function(t,i){1&t&&(e.ynx(0),e.TgZ(1,"div",0),e._uU(2),e.qZA(),e.BQk()),2&t&&(e.xp6(2),e.Oqu(i.sum))},encapsulation:2}),n})();var $i=l(16134),ei=l(61621),Bt=l(14366);let Ui=(()=>{class n extends Bt.a{}return n.lateLoadKey="PercentageFormatterComponent",n.\u0275fac=function(){let a;return function(i){return(a||(a=e.n5z(n)))(i||n)}}(),n.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],features:[e.qOj],decls:2,vars:1,template:function(t,i){1&t&&(e.ynx(0),e._uU(1),e.BQk()),2&t&&(e.xp6(1),e.hij(" ",null==i.data?null:i.data.value,"% "))},encapsulation:2}),n})();var ea=l(51467),ta=l.n(ea),ia=l(73943),na=l.n(ia);const oa=[{power:1,prefix:"",label:""},{power:3,prefix:"k",label:"kilo"},{power:6,prefix:"M",label:"mega"},{power:9,prefix:"G",label:"giga"},{power:12,prefix:"T",label:"tera"},{power:15,prefix:"P",label:"peta"},{power:18,prefix:"E",label:"exa"},{power:21,prefix:"Z",label:"zetta"},{power:24,prefix:"Y",label:"yotta"}],ra=[{power:-24,prefix:"y",label:"yocto"},{power:-21,prefix:"z",label:"zepto"},{power:-18,prefix:"a",label:"atto"},{power:-15,prefix:"f",label:"femto"},{power:-12,prefix:"p",label:"pico"},{power:-9,prefix:"n",label:"nano"},{power:-6,prefix:"\xb5",label:"micro"},{power:-3,prefix:"m",label:"milli"},{power:1,prefix:"",label:""}];let ti=(()=>{class n{constructor(t){this.changeDetector=t,this.value="0"}ngOnChanges(t){if(t.data){const{value:i}=t.data.currentValue;i&&this.processSiUnitsValue(na()(i))}}processSiUnitsValue(t){const i=this.getTransformPrefix(ta()(t));this.value=this.getTransformedValue(t,i),this.modifier=null==i?void 0:i.prefix}getTransformedValue(t,i){if(!i)return t;const o=1!==i.power?+t*Math.pow(10,-i.power):+t;return(Math.round(10*o)/10).toString()}getTransformPrefix(t){var i;const o=Math.abs(t);if(Number.isNaN(o))return;const r=(null===(i=this.data)||void 0===i?void 0:i.shiftPoint)||n.SHIFT_POINT_DEFAULT;if(o>=1){const E=Math.round(o).toString().length;return[...oa].reverse().find(Z=>E>=Z.power+1+r)}{const c=Tn(o);return[...ra].reverse().find(E=>c<=Math.abs(E.power)+1+r)}}}return n.lateLoadKey="SiUnitsFormatterComponent",n.SHIFT_POINT_DEFAULT=0,n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],hostVars:2,hostBindings:function(t,i){2&t&&e.Tol(i.elementClass)},inputs:{data:"data",elementClass:"elementClass"},features:[e.TTD],decls:6,vars:2,consts:[[1,"d-flex","flex-nowrap"]],template:function(t,i){1&t&&(e.ynx(0),e.TgZ(1,"div",0)(2,"span"),e._uU(3),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.qZA()(),e.BQk()),2&t&&(e.xp6(3),e.Oqu(i.value),e.xp6(2),e.hij(" ",i.modifier,""))},encapsulation:2}),n})();function Tn(n,a=1){const t=Math.abs(n);if(t>=1)return 1;const i=a+1;return t*Math.pow(10,i)>1?i:Tn(t,i)}function sa(n,a){if(1&n&&(e.TgZ(0,"div")(1,"a",6),e.NdJ("click",function(i){return i.stopPropagation()}),e._uU(2),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("href",null==t.data?null:t.data.link,e.LSH)("title",t.data.name),e.xp6(1),e.hij(" ",t.data.name," ")}}function aa(n,a){if(1&n&&(e.TgZ(0,"span",7),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.Udp("font-size",11,"px"),e.xp6(1),e.Oqu(t.data.name)}}function la(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",1)(2,"span",2),e._uU(3),e.qZA(),e._UZ(4,"nui-icon",3),e.YNc(5,sa,3,3,"div",4),e.YNc(6,aa,2,3,"ng-template",null,5,e.W1O),e.qZA(),e.BQk()),2&n){const t=e.MAs(7),i=e.oxw();e.xp6(3),e.Oqu(i.data.data),e.xp6(1),e.Q6J("icon",i.data.icon),e.xp6(1),e.Q6J("ngIf",null==i.data?null:i.data.link)("ngIfElse",t)}}let zi=(()=>{class n{constructor(t){this.changeDetector=t,this.isValid=!1}ngOnChanges(){this.isValid=!!(this.data&&this.data.icon&&this.data.name&&this.data.data)}}return n.lateLoadKey="StatusWithIconFormatterComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],inputs:{data:"data"},features:[e.TTD],decls:1,vars:1,consts:[[4,"ngIf"],[1,"nui-text-label","align-items-center","status-icon-formatter"],[1,"nui-text-ellipsis","text-right","pl-3"],[1,"nui-icon","nui-icon-line-height","mx-2",3,"icon"],[4,"ngIf","ngIfElse"],["noLink",""],["rel","noopener noreferrer",1,"nui-text-link-small","nui-text-ellipsis","link",3,"href","title","click"],[1,"nui-text-ellipsis"]],template:function(t,i){1&t&&e.YNc(0,la,8,4,"ng-container",0),2&t&&e.Q6J("ngIf",i.isValid)},directives:[s.O5,d.oJW],styles:[".status-icon-formatter[_ngcontent-%COMP%]{display:grid;grid-template-columns:50px auto minmax(114px,1fr)}"]}),n})();var Cn=l(85822),Bi=l(68675);let Wi=(()=>{class n{constructor(){this.defaultHeaderPrefix=$localize`Value`}transform(t,i,o=this.defaultHeaderPrefix){return`${o} ${i+1}${t?" - ":""}${t||""}`}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275pipe=e.Yjl({name:"nuiWidgetConfiguratorSectionHeader",type:n,pure:!0}),n})();var da=l(21503),On=l.n(da);let ki=(()=>{class n{transform(t,i,o){if(!k()(t)){if(On()(t)){if(!i)return t;const c=[...t];return c.push(i),c}return Object.assign({},t,{[void 0===o?"undefined":o]:i})}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275pipe=e.Yjl({name:"nuiAddData",type:n,pure:!0}),n})();function ca(n,a){if(1&n&&e._UZ(0,"nui-drop-area",9),2&n){const t=e.oxw(2);e.Udp("height",t.height,"px")}}function _a(n,a){1&n&&(e.ynx(0),e.TgZ(1,"div",12),e._UZ(2,"nui-icon",13),e.qZA(),e.BQk())}function ua(n,a){if(1&n&&(e.YNc(0,_a,3,0,"ng-container",10),e.TgZ(1,"span",11),e.ALo(2,"nuiWidgetConfiguratorSectionHeader"),e._uU(3),e.ALo(4,"nuiWidgetConfiguratorSectionHeader"),e.qZA()),2&n){const t=e.oxw(),i=t.$implicit,o=t.index,r=e.oxw();e.Q6J("ngIf",r.moveButtons),e.xp6(1),e.Q6J("title",e.Dn7(2,3,r.headerMap.get(i.id),o,r.headerPrefix)),e.xp6(2),e.hij(" ",e.Dn7(4,7,r.headerMap.get(i.id),o,r.headerPrefix)," ")}}function pa(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",14)(1,"button",15),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(),r=o.$implicit,c=o.index,g=e.oxw();return g.removeItem(g.getItemForNode(r),c)}),e.qZA()()}if(2&n){const t=e.oxw().index;e.xp6(1),e.MGl("id","kpi-widget-remove-btn-",t,"")}}function ga(n,a){}const ha=function(){return["formReady","formDestroy"]};function ma(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",2),e.NdJ("cdkDragStarted",function(o){return e.CHM(t),e.oxw().cdkDragStarted(o)}),e.YNc(1,ca,1,2,"nui-drop-area",3),e.YNc(2,ua,5,11,"ng-template",null,4,e.W1O),e.YNc(4,pa,2,1,"ng-template",null,5,e.W1O),e.ynx(6,6,7),e.NdJ("output",function(o){const c=e.CHM(t).$implicit;return e.oxw().onEvent(c.id,o)}),e.ALo(8,"nuiAddData"),e.ALo(9,"nuiAddData"),e.YNc(10,ga,0,0,"ng-template",8),e.NdJ("attached",function(o){return e.CHM(t),e.MAs(7).attached(o)}),e.BQk(),e.qZA()}if(2&n){const t=a.$implicit,i=e.MAs(3),o=e.MAs(5),r=e.MAs(7);e.xp6(6),e.Q6J("componentId",t.id)("componentType",t.componentType)("providers",t.providers)("properties",e.Dn7(8,6,e.Dn7(9,10,t.properties,i,"headerTextTemplate"),o,"headerButtonsTemplate"))("outputs",e.DdM(14,ha)),e.xp6(4),e.Q6J("cdkPortalOutlet",r.portal)}}let ii=(()=>{class n extends Ee{constructor(t,i,o,r){super(t,i,o),this.formBuilder=r,this.items=[],this.moveButtons=!0,this.formReady=new e.vpe,this.itemsChange=new e.vpe,this.headerMap=new Map}getItemForNode(t){return this.items.find(i=>i.id===t.id)}getNodes(){return this.nodes}ngOnInit(){this.form=this.formBuilder.array([],p.kI.required),this.formReady.emit(this.form)}onEvent(t,i){const o=this.items.find(c=>c.id===t),r=this.items.findIndex(c=>c.id===t);"formReady"===i.id&&o&&this.onFormReady(o,i.payload,r),"formDestroy"===i.id&&this.onFormDestroy(i.payload)}onFormReady(t,i,o){const r=this.formBuilder.group({id:[t.id],componentType:[t.componentType],properties:i});this.form.setControl(o,r),setTimeout(()=>{var c;const g=null===(c=i.get(`${t.id}/description`))||void 0===c?void 0:c.get("label");null==g||g.valueChanges.pipe((0,Bi.O)(g.value),(0,_e.R)(this.destroyed$)).subscribe(E=>{this.headerMap.set(t.id,E||""),this.changeDetector.markForCheck()})})}onFormDestroy(t){setTimeout(()=>{let i=0;for(;i<this.form.length&&this.form.at(i).get("properties")!==t;i++);this.form.removeAt(i),this.form.patchValue(this.form.value,{emitEvent:!0})})}trackBy(t,i){return i.id}removeItem(t,i){if(!t)throw new Error("Unable to remove undefined item from pizzagna");this.itemsChange.emit(this.items.filter(o=>o!==t)),this.items.splice(i,1),this.nodes.splice(i,1),this.pizzagnaService.removeComponents(t.id)}moveItem(t,i){const o=[...this.items],r=o.splice(t,1);o.splice(i,0,...r);const c=[...this.nodes],g=c.splice(t,1);c.splice(i,0,...g),this.nodes=[...c],this.moveFormValues(t,i),this.itemsChange.emit(o),setTimeout(()=>{this.form.setValue(this.form.value,{emitEvent:!0})})}drop(t){this.moveItem(t.previousIndex,t.currentIndex)}cdkDragStarted(t){this.height=t.source.element.nativeElement.offsetHeight}moveFormValues(t,i){const o=this.form.at(t);this.form.removeAt(t),this.form.insert(i,o)}ngOnDestroy(){super.ngOnDestroy()}}return n.lateLoadKey="ItemsDynamicComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(ce.p),e.Y36(d.mQy),e.Y36(p.qu))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-items-dynamic"]],inputs:{items:"items",moveButtons:"moveButtons",nodes:"nodes",headerPrefix:"headerPrefix"},outputs:{formReady:"formReady",itemsChange:"itemsChange"},features:[e.qOj],decls:2,vars:3,consts:[["cdkDropList","",1,"nui-items-dynamic",3,"formGroup","cdkDropListDropped"],["cdkDrag","","class","nui-items-dynamic__node-item",3,"cdkDragStarted",4,"ngFor","ngForOf","ngForTrackBy"],["cdkDrag","",1,"nui-items-dynamic__node-item",3,"cdkDragStarted"],["class","nui-items-dynamic__drop-area",3,"height",4,"cdkDragPlaceholder"],["headerText",""],["headerButtons",""],["nuiComponentPortal","",3,"componentId","componentType","providers","properties","outputs","output"],["componentPortal","nuiComponentPortal"],[3,"cdkPortalOutlet","attached"],[1,"nui-items-dynamic__drop-area"],[4,"ngIf"],[1,"nui-items-dynamic__header-text",3,"title"],["cdkDragHandle","",1,"nui-items-dynamic__drag-handler"],["icon","drag"],[1,"d-flex"],["nui-button","","type","button","icon","delete","displayStyle","action",3,"id","click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.NdJ("cdkDropListDropped",function(r){return i.drop(r)}),e.YNc(1,ma,11,15,"div",1),e.qZA()),2&t&&(e.Q6J("formGroup",i.form),e.xp6(1),e.Q6J("ngForOf",i.nodeConfigs)("ngForTrackBy",i.trackBy))},directives:[et.Wj,p.JL,p.sg,s.sg,et.Zt,et.Hk,qt,s.O5,et.Bh,d.oJW,d.r0F,L.$,z.Pl],pipes:[Wi,ki],styles:[".nui-items-dynamic__header-text{white-space:nowrap;overflow:hidden;-ms-text-overflow:ellipsis;text-overflow:ellipsis}.nui-items-dynamic__drag-handler{cursor:move;display:flex}.nui-items-dynamic__node-item{background-color:var(--nui-color-bg-light,#fff);margin:15px}.nui-items-dynamic__node-item .widget-configurator-section{margin:0}.nui-items-dynamic__drop-area{margin:15px}.kpi-indicators-configuration__color-preview{width:16px;height:16px;margin-right:15px;border-radius:3px}.cdk-drag-preview{z-index:2000!important;opacity:.9;box-shadow:0 0 5px 0 var(--nui-shadow-color, rgba(17, 17, 17, .3))}\n"],encapsulation:2,changeDetection:0}),n})(),In=(()=>{class n{}return n.lateLoadKey="PreviewPlaceholderComponent",n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-preview-placeholder"]],decls:6,vars:0,consts:function(){let a,t;return a=$localize`:␟2dddb51ea396d77c6eae240cec72bcac05cbd28b␟7484658843094717966:This is a preview of your widget`,t=$localize`:␟fd2e41589bd70eddf4486b814980d2891ec182f9␟3997823842478388980: As you make configuration changes, this area will update to match. To get started, select a widget type on the configuration panel.
`,[a,t]},template:function(t,i){1&t&&(e.TgZ(0,"div")(1,"b"),e.SDv(2,0),e.qZA(),e._uU(3,"."),e.qZA(),e.TgZ(4,"div"),e.SDv(5,1),e.qZA())},styles:["[_nghost-%COMP%]{max-width:300px;padding:0 10px;margin:auto}"]}),n})();var fa=l(45122),vn=l(61842),En=l(10628);function Ta(n,a){}const Ca=function(){return["widgetSelected"]};function Oa(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",6),e.ynx(1,7,8),e.NdJ("output",function(o){return e.CHM(t),e.oxw().onSelect(o.payload)}),e.YNc(3,Ta,0,0,"ng-template",9),e.NdJ("attached",function(o){return e.CHM(t),e.MAs(2).attached(o)}),e.BQk(),e.qZA()}if(2&n){const t=e.MAs(2),i=e.oxw();e.xp6(1),e.Q6J("componentType",i.cloneSelectionComponentType)("outputs",e.DdM(3,Ca)),e.xp6(2),e.Q6J("cdkPortalOutlet",t.portal)}}function Ia(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",10)(1,"nui-pizzagna",11,12),e.NdJ("pizzagnaChange",function(o){return e.CHM(t),e.oxw().formPizzagna=o}),e.qZA()()}if(2&n){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("pizzagna",t.formPizzagna)}}let Sn=(()=>{class n{constructor(t,i,o,r,c){this.changeDetector=t,this.configurator=i,this.previewService=o,this.formBuilder=r,this.widgetTypesService=c,this.navigationControl=new en.X({busyState:{busy:!1},allowStepChange:!0}),this.destroy$=new ie.x,this.resetForm$=new ie.x,this.busy=!1,this.isFormDisplayed=!1,this.resetForm()}ngOnInit(){this.previewService.previewChanged.pipe((0,_e.R)(this.destroy$)).subscribe(t=>{this.onPreviewPizzagnaUpdate(t)}),this.configurator.submitError.pipe((0,_e.R)(this.destroy$)).subscribe(()=>{this.toggleBusy()})}ngAfterViewInit(){this.changeDetector.markForCheck()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.resetForm$.complete()}onPreviewPizzagnaUpdate(t){var i;if(!this.isFormDisplayed)return;const o=Object.assign(Object.assign({},this.configurator.previewWidget),{pizzagna:Object.assign(Object.assign({},null===(i=this.configurator.previewWidget)||void 0===i?void 0:i.pizzagna),{[m.xW.Configuration]:t})});this.configurator.updateWidget(o)}canFinish(){var t,i,o,r;return!!(null===(i=null===(t=this.widgetTemplate)||void 0===t?void 0:t.pizzagna)||void 0===i?void 0:i.configuration)&&!(null===(r=null===(o=this.widgetTemplate)||void 0===o?void 0:o.metadata)||void 0===r?void 0:r.needsConfiguration)}onFinish(){if(this.form.invalid)return this.form.markAllAsTouched(),this.form.patchValue(this.form.value),void this.form.updateValueAndValidity({onlySelf:!1});this.toggleBusy(),this.configurator.formSubmit()}onCancel(){this.configurator.formCancel()}onStepNavigated(t){this.isFormDisplayed=1===t.currentStepIndex,0===t.currentStepIndex&&1===t.previousStepIndex?(this.formPizzagna=void 0,this.resetForm(),this.onSelect(this.widgetTemplate)):1===t.currentStepIndex&&(this.formPizzagna=this.widgetTypesService.getWidgetType(this.widgetTemplate.type,this.widgetTemplate.version).configurator,this.previewService.preview=this.widgetTemplate.pizzagna[m.xW.Configuration])}onSelect(t){var i;this.widgetTemplate=t;const o=Object.assign(Object.assign({},t),{id:(null===(i=this.configurator.previewWidget)||void 0===i?void 0:i.id)||null});this.configurator.updateWidget(null),setTimeout(()=>{this.configurator.updateWidget(dt()(o))})}toggleBusy(){this.busy=!this.busy,this.navigationControl.next({busyState:{busy:this.busy},allowStepChange:!this.busy})}resetForm(){this.resetForm$.next(),this.form=this.formBuilder.group({}),this.form.statusChanges.pipe((0,_e.R)(this.resetForm$),(0,_e.R)(this.destroy$)).subscribe(()=>{this.changeDetector.markForCheck()})}}return n.lateLoadKey="WidgetClonerComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(gn.n),e.Y36(fa.m),e.Y36(p.qu),e.Y36(H.x))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-widget-cloner"]],hostAttrs:[1,"d-flex","flex-column","h-100"],inputs:{formPizzagna:"formPizzagna",cloneSelectionComponentType:"cloneSelectionComponentType"},decls:8,vars:7,consts:function(){let a,t,i;return a=$localize`:␟a638e97aa8422948b3e628089bbc9e0cd89e0087␟696117927395958397:Creating Widget`,t=$localize`:␟1af9862ac515933a9a72e92970c3e92bda63f6e8␟8076137290276236439:Create Widget`,i=$localize`:␟072d4d4ec83a5a97345a1c13b90c213b47326d09␟6673660887182833564:Customize`,[["configuratorTitle",a,3,"disableCloseButton","close"],["finishText",t,3,"hideHeader","canProceed","canFinish","navigationControl","finish","cancel","stepNavigated"],["nextText",i,3,"stepTemplate"],[3,"stepTemplate"],["step1",""],["step2",""],[1,"p-4","h-100"],["nuiComponentPortal","",3,"componentType","outputs","output"],["componentPortal","nuiComponentPortal"],[3,"cdkPortalOutlet","attached"],[3,"formGroup"],[3,"pizzagna","pizzagnaChange"],["formPizzagnaComponent",""]]},template:function(t,i){if(1&t&&(e.TgZ(0,"nui-configurator-heading",0),e.NdJ("close",function(){return i.onCancel()}),e.qZA(),e.TgZ(1,"nui-dashwiz",1),e.NdJ("finish",function(){return i.onFinish()})("cancel",function(){return i.onCancel()})("stepNavigated",function(r){return i.onStepNavigated(r)}),e._UZ(2,"nui-dashwiz-step",2)(3,"nui-dashwiz-step",3),e.qZA(),e.YNc(4,Oa,4,4,"ng-template",null,4,e.W1O),e.YNc(6,Ia,3,2,"ng-template",null,5,e.W1O)),2&t){const o=e.MAs(5),r=e.MAs(7);e.Q6J("disableCloseButton",i.busy),e.xp6(1),e.Q6J("hideHeader",!0)("canProceed",!!i.widgetTemplate)("canFinish",i.canFinish())("navigationControl",i.navigationControl),e.xp6(1),e.Q6J("stepTemplate",o),e.xp6(1),e.Q6J("stepTemplate",r)}},directives:[Cn.Q,vn.i,En.u,L.$,z.Pl,p.JL,p.sg,Ys.R],encapsulation:2,changeDetection:0}),n})();var va=l(71536);function Ea(n,a){1&n&&e.GkF(0)}function Sa(n,a){1&n&&e.GkF(0)}function Ra(n,a){if(1&n&&(e.TgZ(0,"div",5),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.Q6J("title",t.headerText),e.xp6(1),e.hij(" ",t.headerText," ")}}function Na(n,a){}const Aa=function(){return["formReady"]};function ya(n,a){if(1&n){const t=e.EpF();e.ynx(0)(1,6,7),e.NdJ("output",function(o){const c=e.CHM(t).$implicit;return e.oxw().onEvent(c.id,o)}),e.YNc(3,Na,0,0,"ng-template",8),e.NdJ("attached",function(o){return e.CHM(t),e.MAs(2).attached(o)}),e.BQk()()}if(2&n){const t=a.$implicit,i=e.MAs(2);e.xp6(1),e.Q6J("componentId",t.id)("componentType",t.componentType)("providers",t.providers)("properties",t.properties)("outputs",e.DdM(6,Aa)),e.xp6(2),e.Q6J("cdkPortalOutlet",i.portal)}}const Ma=[[["","headerText",""]],[["","headerButtons",""]],"*"],Pa=["[headerText]","[headerButtons]","*"];let He=(()=>{class n extends Ee{constructor(t,i,o,r){super(t,i,o),this.formBuilder=r,this.nodes=[],this.headerText="",this.formReady=new e.vpe,this.formDestroy=new e.vpe}getNodes(){return this.nodes}ngOnInit(){this.form=this.formBuilder.group({})}onEvent(t,i){"formReady"===i.id&&this.addFormGroup(t,i.payload),Object.keys(this.form.controls).length===this.getNodes().length&&this.formReady.emit(this.form)}addFormGroup(t,i){this.form.addControl(t,i)}ngOnDestroy(){this.formDestroy.emit(this.form),super.ngOnDestroy()}}return n.lateLoadKey="WidgetConfiguratorSectionComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(ce.p),e.Y36(d.mQy),e.Y36(p.qu))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-widget-configurator-section"]],hostAttrs:[1,"nui-widget-configurator-section"],inputs:{headerTextTemplate:"headerTextTemplate",headerButtonsTemplate:"headerButtonsTemplate",nodes:"nodes",headerText:"headerText"},outputs:{formReady:"formReady",formDestroy:"formDestroy"},features:[e.qOj],ngContentSelectors:Pa,decls:9,vars:5,consts:[[1,"widget-configurator-section"],[1,"widget-configurator-section__header","d-flex","justify-content-between","align-items-center"],[4,"ngTemplateOutlet"],["headerText","","class","widget-configurator-section__header-text",3,"title",4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],["headerText","",1,"widget-configurator-section__header-text",3,"title"],["nuiComponentPortal","",3,"componentId","componentType","providers","properties","outputs","output"],["componentPortal","nuiComponentPortal"],[3,"cdkPortalOutlet","attached"]],template:function(t,i){1&t&&(e.F$t(Ma),e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,Ea,1,0,"ng-container",2),e.YNc(3,Sa,1,0,"ng-container",2),e.YNc(4,Ra,2,2,"div",3),e.Hsn(5),e.Hsn(6,1),e.qZA(),e.YNc(7,ya,4,7,"ng-container",4),e.Hsn(8,2),e.qZA()),2&t&&(e.xp6(2),e.Q6J("ngTemplateOutlet",i.headerTextTemplate),e.xp6(1),e.Q6J("ngTemplateOutlet",i.headerButtonsTemplate),e.xp6(1),e.Q6J("ngIf",i.headerText),e.xp6(3),e.Q6J("ngForOf",i.nodeConfigs)("ngForTrackBy",i.trackByFn))},directives:[s.tP,s.O5,s.sg,L.$,z.Pl],styles:[".widget-configurator-section{margin:15px;border-radius:3px;border:1px solid;border-color:var(--nui-color-line-default,#d9d9d9)}.widget-configurator-section__header{padding:15px 5px 15px 15px;height:40px;font-size:16px;font-weight:600;background-color:var(--nui-color-bg-table_header,#f0f0f0);color:var(--nui-color-text-secondary,rgba(17, 17, 17, .6))}.widget-configurator-section__header-text{white-space:nowrap;overflow:hidden;-ms-text-overflow:ellipsis;text-overflow:ellipsis}\n"],encapsulation:2,changeDetection:0}),n})();var De=l(19837),Da=l(64406),ba=l(21617);const xa=[$localize`Blue`,$localize`Blue Light`,$localize`Blue Dark`,$localize`Pink`,$localize`Pink Light`,$localize`Pink Dark`,$localize`Sea Green`,$localize`Sea Green Light`,$localize`Sea Green Dark`,$localize`Violet`,$localize`Violet Light`,$localize`Violet Dark`,$localize`Lime Green`,$localize`Lime Green Light`,$localize`Lime Green Dark`,$localize`Orange`,$localize`Orange Light`,$localize`Orange Dark`,$localize`Ultramarine`,$localize`Ultramarine Light`,$localize`Ultramarine Dark`,$localize`Bordeaux`,$localize`Bordeaux Light`,$localize`Bordeaux Dark`,$localize`Ochroid`,$localize`Ochroid Light`,$localize`Ochroid Dark`,$localize`Anthracite`,$localize`Anthracite Light`,$localize`Anthracite Dark`],La=[$localize`Down`,$localize`Down Light`,$localize`Critical`,$localize`Critical Light`,$localize`Warning`,$localize`Warning Light`,$localize`Unknown`,$localize`Unknown Light`,$localize`Ok`,$localize`Ok Light`,$localize`Info`,$localize`Info Light`],Rn=l.n(ba)()([...h.wlb,...h.Sj$],[...xa,...La]),Zi="var(--nui-color-bg-secondary)",Vi=[...h.wlb,...h.Sj$].map(n=>({color:n,label:Rn[n]}));var Fe=l(16193),Ge=l(15838);function wa(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",27),e._uU(1),e.qZA()),2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("value",t.key),e.xp6(1),e.hij(" ",i.getLabel(t.key)," ")}}function Ga(n,a){if(1&n&&e._UZ(0,"nui-drop-area"),2&n){const t=e.oxw(2);e.Udp("height",t.height,"px")}}function $a(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",14),e.NdJ("cdkDragStarted",function(o){return e.CHM(t),e.oxw().cdkDragStarted(o)}),e.TgZ(2,"div",15),e._UZ(3,"nui-icon",16),e.qZA(),e.TgZ(4,"div",17)(5,"nui-form-field",18)(6,"nui-select-v2",19),e.YNc(7,wa,2,2,"nui-select-v2-option",20),e.ALo(8,"keyvalue"),e.qZA()(),e.TgZ(9,"nui-form-field",21),e._UZ(10,"nui-textbox",22),e.qZA(),e.TgZ(11,"nui-form-field",23),e._UZ(12,"nui-color-picker",24),e.qZA()(),e.TgZ(13,"button",25),e.NdJ("click",function(){const r=e.CHM(t).index;return e.oxw().removeRule(r)}),e.qZA(),e.YNc(14,Ga,1,2,"nui-drop-area",26),e.qZA(),e.BQk()}if(2&n){const t=a.$implicit,i=e.oxw();e.xp6(1),e.Q6J("formGroup",t),e.xp6(4),e.Q6J("control",t.get("comparisonType")),e.xp6(1),e.Q6J("formControl",t.get("comparisonType")),e.xp6(1),e.Q6J("ngForOf",e.lcZ(8,7,i.availableComparators)),e.xp6(2),e.Q6J("control",t.get("value")),e.xp6(2),e.Q6J("control",t.get("color")),e.xp6(1),e.Q6J("colorPalette",i.palette)}}let Nn=(()=>{class n{constructor(t,i,o){this.changeDetector=t,this.formBuilder=i,this.formReady=new e.vpe,this.destroy$=new ie.x,this.availableComparators=o.getComparators()}ngOnInit(){var t;this.palette=[{color:Zi,label:$localize`Default color`}].concat(this.backgroundColors),this.formLocal=this.initDefaultRulesGroup(),this.form=this.formBuilder.group({rules:[[]]}),null===(t=this.formLocal.get("rules"))||void 0===t||t.value.valueChanges.pipe((0,st.b)(i=>{var o;return null===(o=this.form.get("rules"))||void 0===o?void 0:o.patchValue([...i])}),(0,_e.R)(this.destroy$)).subscribe(),this.formReady.emit(this.form)}ngOnChanges(t){var i,o;t.rules&&((null===(o=null===(i=this.formLocal)||void 0===i?void 0:i.get("rules"))||void 0===o?void 0:o.value).setValue([]),this.rules&&On()(this.rules)&&this.rules.forEach(r=>{var c;(null===(c=this.formLocal.get("rules"))||void 0===c?void 0:c.value).push(this.formBuilder.group({comparisonType:[r.comparisonType,[p.kI.required]],value:[r.value,[p.kI.required]],color:[r.color]}))}))}getColorRulesSubtitle(){var t,i,o,r;return 0===(null===(i=null===(t=this.formLocal)||void 0===t?void 0:t.get("rules"))||void 0===i?void 0:i.value).controls.length?$localize`No color rules`:$localize`${(null===(r=null===(o=this.formLocal)||void 0===o?void 0:o.get("rules"))||void 0===r?void 0:r.value).controls.length} color rules`}getLabel(t){var i;return(null===(i=this.availableComparators[t])||void 0===i?void 0:i.label)||"Custom Comparator"}removeRule(t){var i,o;(null===(o=null===(i=this.formLocal)||void 0===i?void 0:i.get("rules"))||void 0===o?void 0:o.value).removeAt(t)}addRule(){var t,i;(null===(i=null===(t=this.formLocal)||void 0===t?void 0:t.get("rules"))||void 0===i?void 0:i.value).push(this.formBuilder.group({comparisonType:[">",[p.kI.required]],value:[0,[p.kI.required]],color:[Zi]}))}drop(t){this.move(t.currentIndex,t.previousIndex)}cdkDragStarted(t){this.height=t.source.element.nativeElement.offsetHeight}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}initDefaultRulesGroup(){return this.formBuilder.group({rules:[this.formBuilder.array([],p.kI.required)]})}move(t,i){var o,r;const c=null===(r=null===(o=this.formLocal)||void 0===o?void 0:o.get("rules"))||void 0===r?void 0:r.value,g=t>i?1:-1;if(!c)return;const E=c.at(i);for(let P=i;P*g<t*g;P+=g){const Z=c.at(P+g);c.setControl(P,Z)}c.setControl(t,E)}}return n.lateLoadKey="BackgroundColorRulesConfigurationComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(p.qu),e.Y36(Ce.Z))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-background-color-rules-configuration"]],inputs:{rules:"rules",backgroundColors:"backgroundColors"},outputs:{formReady:"formReady"},features:[e.TTD],decls:20,vars:15,consts:function(){let a,t,i;return a=$localize`:␟3b53b67118a64c409177ae5a41f5978d0e5a95bd␟4898023314284497772:Background color rules`,t=$localize`:␟9c8318d49f867d23436872f260ebf9263e9d0120␟2303161252907317626: Add new rule `,i=$localize`:␟42daf87f19836ef3d1b8f58a5cf93e2c43b82c1c␟8325381706328570325:Select Item`,[[3,"formGroup","state"],["accordionHeader","",1,"d-flex","align-items-center","px-4","py-2"],[1,"align-self-start","pt-2",3,"icon"],[1,"d-flex","flex-column","ml-4","pt-1"],[1,"nui-text-label"],a,[1,"nui-text-secondary",3,"title"],[1,"kpi-color-rules-configuration__accordion-content"],[1,"mb-4"],[1,"mb-3"],["cdkDropList","",3,"cdkDropListDropped"],[4,"ngFor","ngForOf"],["nui-button","","icon","add","displayStyle","action","type","button",3,"click"],t,["cdkDrag","",1,"kpi-color-rule","d-flex","pt-3",3,"formGroup","cdkDragStarted"],[1,"kpi-color-rule__control","justify-content-center","d-flex"],["icon","drag","cdkDragHandle","",1,"kpi-color-rule__drag","align-items-center"],[1,"d-flex","flex-grow-1","flex-wrap"],[1,"mr-3","mb-3","flex-grow-1",3,"control"],["placeholder",i,2,"min-width","220px",3,"formControl"],[3,"value",4,"ngFor","ngForOf"],[1,"mr-3","mb-3",2,"max-width","100px",3,"control"],["formControlName","value"],[1,"mr-3","mb-3",3,"control"],["formControlName","color",3,"colorPalette"],["nui-button","","icon","delete","displayStyle","action","type","button",1,"kpi-color-rule__control",3,"click"],[3,"height",4,"cdkDragPlaceholder"],[3,"value"]]},template:function(t,i){if(1&t&&(e.TgZ(0,"nui-widget-editor-accordion",0),e.ALo(1,"async"),e.ALo(2,"nuiWidgetEditorAccordionFormState"),e.TgZ(3,"div",1),e._UZ(4,"nui-icon",2),e.ALo(5,"async"),e.ALo(6,"nuiFormHeaderIconPipe"),e.TgZ(7,"div",3)(8,"span",4),e.SDv(9,5),e.qZA(),e.TgZ(10,"div",6),e._uU(11),e.qZA()()(),e.TgZ(12,"div",7)(13,"div",8)(14,"p",9),e._uU(15," We can automatically change the background color when the value meets certain conditions. "),e.qZA(),e.TgZ(16,"div",10),e.NdJ("cdkDropListDropped",function(r){return i.drop(r)}),e.YNc(17,$a,15,9,"ng-container",11),e.qZA(),e.TgZ(18,"button",12),e.NdJ("click",function(){return i.addRule()}),e.SDv(19,13),e.qZA()()()()),2&t){let o;e.Q6J("formGroup",i.formLocal)("state",e.lcZ(1,6,e.lcZ(2,8,i.formLocal))),e.xp6(4),e.Q6J("icon",e.lcZ(5,10,e.xi3(6,12,i.formLocal,"color"))),e.xp6(6),e.Q6J("title",i.getColorRulesSubtitle()),e.xp6(1),e.hij(" ",i.getColorRulesSubtitle()," "),e.xp6(6),e.Q6J("ngForOf",null==(o=i.formLocal.get("rules"))?null:o.value.controls)}},directives:[De.J,p.JL,p.sg,d.oJW,et.Wj,s.sg,et.Zt,et.Bh,d.hgI,d.j_n,p.JJ,p.oH,d.rLF,d.XHW,p.u,Fi,d.r0F,et.Hk,qt],pipes:[s.Ov,Fe.F,Ge.d,s.Nd],styles:[".kpi-color-rules-configuration__accordion-content[_ngcontent-%COMP%]{padding:15px 15px 15px 46px}.kpi-color-rules-configuration__color-select[_ngcontent-%COMP%]{display:flex;align-items:center}.kpi-color-rules-configuration__color-preview[_ngcontent-%COMP%]{width:100%;height:20px;border-radius:3px}.kpi-color-rules-configuration__color-preview.with-arrow[_ngcontent-%COMP%]{width:calc(100% - 40px);margin-left:10px}.kpi-color-rules-configuration__selector-arrow[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:30px;height:30px;border-left:1px solid;border-left-color:var(--nui-color-line-default,#d9d9d9);margin-left:10px}.kpi-color-rule[_ngcontent-%COMP%]{background-color:var(--nui-color-bg-content,#fff)}.kpi-color-rule__drag[_ngcontent-%COMP%]{cursor:move}.kpi-color-rule__control[_ngcontent-%COMP%]{min-width:30px;height:30px}"],changeDetection:0}),n})();var ke=l(81466),za=l(34235),ni=l.n(za);function Ba(n,a){1&n&&(e.TgZ(0,"nui-message",2)(1,"b"),e.SDv(2,3),e.qZA()()),2&n&&e.Q6J("allowDismiss",!1)}function Wa(n,a){if(1&n&&(e.TgZ(0,"nui-message",4)(1,"b"),e.SDv(2,5),e.qZA(),e._uU(3),e.qZA()),2&n){const t=e.oxw();e.Q6J("allowDismiss",!1),e.xp6(3),e.hij(" ",t.dataSourceError.message||t.dataSourceError.type," ")}}let Ft=(()=>{class n{constructor(t){this.changeDetector=t,this.errorState=new e.vpe,this.onDestroy$=new ie.x,this.dataSourceClear$=new ie.x}ngOnChanges(t){t.dataSource&&this.onDataSourceChanged()}onDataSourceChanged(){var t,i,o;this.dataSourceClear$.next(),null===(i=null===(t=this.dataSource)||void 0===t?void 0:t.busy)||void 0===i||i.pipe((0,_e.R)(this.dataSourceClear$)).subscribe(r=>{this.busy=r,this.changeDetector.markForCheck()}),null===(o=this.dataSource)||void 0===o||o.outputsSubject.pipe((0,_e.R)(this.dataSourceClear$)).subscribe(r=>{this.data=ni()(null==r?void 0:r.result)?r:null==r?void 0:r.result,this.dataSourceError=null==r?void 0:r.error,this.errorState.emit(!!this.dataSourceError),this.changeDetector.markForCheck()})}ngOnDestroy(){this.onDestroy$.next(),this.onDestroy$.complete(),this.dataSourceClear$.next(),this.dataSourceClear$.complete()}}return n.lateLoadKey="DataSourceErrorComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-data-source-error"]],inputs:{dataSource:"dataSource"},outputs:{errorState:"errorState"},features:[e.TTD],decls:3,vars:2,consts:function(){let a,t;return a=$localize`:␟7471accb59033b8bee2f7d6907d8deefcfe7d5de␟8643306703234832815:Select a data source`,t=$localize`:␟c399afe21627dcfed1a9865c0e084fac997896c2␟4016661485141937765:Something went wrong with the data source: `,[["class","mt-4 d-block","type","info",3,"allowDismiss",4,"ngIf"],["class","mt-4 d-block","type","critical",3,"allowDismiss",4,"ngIf"],["type","info",1,"mt-4","d-block",3,"allowDismiss"],a,["type","critical",1,"mt-4","d-block",3,"allowDismiss"],t]},template:function(t,i){1&t&&(e.TgZ(0,"div"),e.YNc(1,Ba,3,1,"nui-message",0),e.YNc(2,Wa,4,2,"nui-message",1),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",!i.dataSource),e.xp6(1),e.Q6J("ngIf",i.dataSourceError))},directives:[s.O5,d.qqZ],encapsulation:2,changeDetection:0}),n})();var Qe=l(32148);function ka(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",14),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("title",null==t?null:t.label)("value",t),e.xp6(1),e.hij(" ",t.label," ")}}function Za(n,a){}const Va=function(){return["errorState"]},Ja=function(n){return{dataSource:n}};let An=(()=>{class n{constructor(t,i,o,r,c,g,E){this.changeDetector=t,this.configuratorHeading=i,this.formBuilder=o,this.providerRegistryService=r,this.eventBus=c,this.injector=g,this.logger=E,this.dataSourceProviders=[],this.errorComponent=Ft.lateLoadKey,this.formReady=new e.vpe,this.hasDataSourceError=!1,this.dataFieldIds=new ie.x}ngOnInit(){var t;this.form=this.formBuilder.group({providerId:[this.providerId||"",[p.kI.required]],properties:[this.properties||{}],dataSource:[null,[p.kI.required]]}),this.form.setValidators([()=>this.hasDataSourceError?{dataSourceError:!0}:null]),null===(t=this.form.get("dataSource"))||void 0===t||t.valueChanges.subscribe(i=>{var o,r;null===(o=this.form.get("providerId"))||void 0===o||o.setValue(null==i?void 0:i.providerId),(null==i?void 0:i.properties)&&(null===(r=this.form.get("properties"))||void 0===r||r.setValue(null==i?void 0:i.properties))}),this.formReady.emit(this.form)}ngOnChanges(t){var i,o,r,c,g,E,P,Z,U;if(t.providerId&&!t.providerId.isFirstChange()||t.properties&&!t.properties.isFirstChange()){const ne=null===(i=t.providerId)||void 0===i?void 0:i.previousValue,ue=null===(o=t.properties)||void 0===o?void 0:o.previousValue;if(ne!==this.providerId||ue!==this.properties){const le=this.dataSourceProviders.find(Oe=>{var he,Se;return Oe.providerId===this.providerId&&Ye()(null!==(he=Oe.properties)&&void 0!==he?he:{},null!==(Se=this.properties)&&void 0!==Se?Se:{})});le?(null===(Z=null===(P=this.form)||void 0===P?void 0:P.get("dataSource"))||void 0===Z||Z.setValue(le),this.invokeDataSource(le)):(null===(c=null===(r=this.form)||void 0===r?void 0:r.get("providerId"))||void 0===c||c.setValue(this.providerId),null===(E=null===(g=this.form)||void 0===g?void 0:g.get("properties"))||void 0===E||E.setValue(this.properties),this.invokeDataSource({properties:this.properties,providerId:this.providerId}))}}if(t.dataSourceProviders&&!t.dataSourceProviders.isFirstChange()&&1===this.dataSourceProviders.length){const ne=this.dataSourceProviders[0];null===(U=this.form.get("dataSource"))||void 0===U||U.setValue(ne),this.invokeDataSource(ne)}}ngAfterViewInit(){var t;if(this.dataSourceProviders&&1===this.dataSourceProviders.length){const i=this.dataSourceProviders[0];null===(t=this.form.get("dataSource"))||void 0===t||t.setValue(i),this.invokeDataSource(i)}}onDataSourceSelected(t){this.eventBus.next(ke.ay,{}),this.invokeDataSource(t)}invokeDataSource(t){var i;if(!t.providerId)return;const o=this.providerRegistryService.getProvider(t.providerId);if(o){this.dataSource=this.providerRegistryService.getProviderInstance(o,this.injector),this.eventBus.next(ke.gg,{payload:this.dataSource}),this.dataSource.outputsSubject.pipe((0,mi.q)(1)).subscribe(c=>{this.eventBus.next(ke.PF,{payload:c}),this.dataFieldIds.next(Object.keys(c.result||c))});const r=this.dataSource;(null==r?void 0:r.updateConfiguration)&&r.updateConfiguration(null!==(i=t.properties)&&void 0!==i?i:{}),setTimeout(()=>{this.dataSource.applyFilters()})}else this.logger.warn("No provider found for id:",t.providerId)}onErrorState(t){this.hasDataSourceError=t,this.form.markAsTouched({onlySelf:!0}),this.form.updateValueAndValidity({emitEvent:!1}),this.changeDetector.detectChanges()}}return n.lateLoadKey="DataSourceConfigurationV2Component",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(Qe.p),e.Y36(p.qu),e.Y36(S.C),e.Y36(m.nY),e.Y36(e.zs3),e.Y36(d.mQy))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-data-source-configuration"]],inputs:{dataSourceProviders:"dataSourceProviders",properties:"properties",providerId:"providerId",errorComponent:"errorComponent"},outputs:{formReady:"formReady"},features:[e.TTD],decls:20,vars:28,consts:function(){let a,t;return a=$localize`:␟1b6bc6d5daaa6ec75d201690bb6f782f30bf98a0␟1107354728956440783:Data Source`,t=$localize`:␟87aabb92d16c162e46a9ef3703445351a3e41739␟6527825109146827187:Select data source`,[[3,"formGroup","state"],["accordionHeader","",1,"d-flex","align-items-center","pl-4","py-2"],[1,"align-self-start","pt-2",3,"icon"],[1,"d-flex","flex-column","ml-4","pt1"],[1,"nui-text-label"],a,[1,"nui-text-secondary",3,"title"],[1,"datasource-configuration__accordion-content"],[3,"control"],["placeholder",t,"formControlName","dataSource",1,"datasource-configuration__accordion-content__datasource-input",3,"title","popupViewportMargin","valueSelected"],[3,"title","value",4,"ngFor","ngForOf"],["nuiComponentPortal","",3,"componentId","componentType","outputs","properties","output"],["componentPortal","nuiComponentPortal"],[3,"cdkPortalOutlet","attached"],[3,"title","value"]]},template:function(t,i){if(1&t){const o=e.EpF();e.TgZ(0,"nui-widget-editor-accordion",0),e.ALo(1,"async"),e.ALo(2,"nuiWidgetEditorAccordionFormState"),e.TgZ(3,"div",1),e._UZ(4,"nui-icon",2),e.ALo(5,"async"),e.ALo(6,"nuiFormHeaderIconPipe"),e.TgZ(7,"div",3)(8,"span",4),e.SDv(9,5),e.qZA(),e.TgZ(10,"div",6),e._uU(11),e.qZA()()(),e.TgZ(12,"div",7)(13,"nui-form-field",8)(14,"nui-select-v2",9),e.NdJ("valueSelected",function(c){return i.onDataSourceSelected(c)}),e.ALo(15,"async"),e.YNc(16,ka,2,3,"nui-select-v2-option",10),e.qZA()(),e.ynx(17,11,12),e.NdJ("output",function(c){return i.onErrorState(c.payload)}),e.YNc(19,Za,0,0,"ng-template",13),e.NdJ("attached",function(c){return e.CHM(o),e.MAs(18).attached(c)}),e.BQk(),e.qZA()()}if(2&t){const o=e.MAs(18);let r,c,g;e.Q6J("formGroup",i.form)("state",e.lcZ(1,14,e.lcZ(2,16,i.form))),e.xp6(4),e.Q6J("icon",e.lcZ(5,18,e.xi3(6,20,i.form,"database"))),e.xp6(6),e.Q6J("title",null==(r=i.form.get("dataSource"))||null==r.value?null:r.value.label),e.xp6(1),e.hij(" ",null==(c=i.form.get("dataSource"))||null==c.value?null:c.value.label," "),e.xp6(2),e.Q6J("control",i.form.get("dataSource")),e.xp6(1),e.Q6J("title",null==(g=i.form.get("dataSource"))||null==g.value?null:g.value.label)("popupViewportMargin",e.lcZ(15,23,i.configuratorHeading.height$)),e.xp6(2),e.Q6J("ngForOf",i.dataSourceProviders),e.xp6(1),e.Q6J("componentId",i.errorComponent)("componentType",i.errorComponent)("outputs",e.DdM(25,Va))("properties",e.VKq(26,Ja,i.dataSource)),e.xp6(2),e.Q6J("cdkPortalOutlet",o.portal)}},directives:[De.J,p.JL,p.sg,d.oJW,d.hgI,d.j_n,p.JJ,p.u,s.sg,d.rLF,L.$,z.Pl],pipes:[s.Ov,Fe.F,Ge.d],styles:[".datasource-configuration__accordion-content[_ngcontent-%COMP%]{padding:15px 15px 15px 46px}"],changeDetection:0}),n})();function Ya(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",14),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("title",t)("value",t),e.xp6(1),e.hij(" ",t," ")}}function Ha(n,a){}const Ka=function(){return["errorState"]},Qa=function(n){return{dataSource:n}};let Wt=(()=>{class n{constructor(t,i,o,r,c,g,E){this.changeDetector=t,this.configuratorHeading=i,this.formBuilder=o,this.providerRegistryService=r,this.eventBus=c,this.injector=g,this.logger=E,this.dataSourceProviders=[],this.errorComponent=Ft.lateLoadKey,this.formReady=new e.vpe,this.hasDataSourceError=!1,this.dsOutput=new ie.x,this.dataFieldIds=new ie.x}ngOnInit(){this.form=this.formBuilder.group({providerId:[this.providerId||"",[p.kI.required]],properties:this.formBuilder.group(this.properties||{})}),this.form.setValidators([()=>this.hasDataSourceError?{dataSourceError:!0}:null]),this.formReady.emit(this.form)}ngOnChanges(t){var i;t.providerId&&!t.providerId.isFirstChange()&&t.providerId.previousValue!==this.providerId&&(null===(i=this.form.get("providerId"))||void 0===i||i.setValue(this.providerId),this.invokeDataSource(this.providerId))}onDataSourceChange(t){this.eventBus.next(ke.ay,{}),this.invokeDataSource(t)}invokeDataSource(t){if(!t)return;const i=this.providerRegistryService.getProvider(t);i?(this.dataSource=this.providerRegistryService.getProviderInstance(i,this.injector),this.eventBus.next(ke.gg,{payload:this.dataSource}),this.dataSource.outputsSubject.pipe((0,mi.q)(1)).subscribe(o=>{this.eventBus.next(ke.PF,{payload:o}),this.dsOutput.next(o);const r=(null==o?void 0:o.result)||o;r&&this.dataFieldIds.next(Object.keys(r))}),setTimeout(()=>{this.dataSource.applyFilters()})):this.logger.warn("No provider found for id:",t)}onErrorState(t){this.hasDataSourceError=t,this.form.markAsTouched({onlySelf:!0}),this.form.updateValueAndValidity({emitEvent:!1}),this.changeDetector.detectChanges()}}return n.lateLoadKey="DataSourceConfigurationComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(Qe.p),e.Y36(p.qu),e.Y36(S.C),e.Y36(m.nY),e.Y36(e.zs3),e.Y36(d.mQy))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-data-source-configuration"]],inputs:{dataSourceProviders:"dataSourceProviders",errorComponent:"errorComponent",properties:"properties",providerId:"providerId"},outputs:{formReady:"formReady"},features:[e.TTD],decls:20,vars:28,consts:function(){let a,t,i;return a=$localize`:␟1b6bc6d5daaa6ec75d201690bb6f782f30bf98a0␟1107354728956440783:Data Source`,t=$localize`:␟7f3bce5049b2c517378a6624460b84d2da9ce332␟7245698475792706694:Select Data Source`,i=$localize`:␟18c18c5d61f92ef5c3caa37df00fc514fef3d90c␟4806513497858020797:Data Sources`,[[3,"formGroup","state"],["accordionHeader","",1,"d-flex","align-items-center","pl-4","py-2"],[1,"align-self-start","pt-2",3,"icon"],[1,"d-flex","flex-column","ml-4","pt1"],[1,"nui-text-label"],a,[1,"nui-text-secondary",3,"title"],[1,"datasource-configuration__accordion-content"],["caption",t,3,"control"],["placeholder",i,"formControlName","providerId",1,"datasource-configuration__accordion-content__datasource-input",3,"title","popupViewportMargin","valueSelected"],[3,"title","value",4,"ngFor","ngForOf"],["nuiComponentPortal","",3,"componentId","componentType","outputs","properties","output"],["componentPortal","nuiComponentPortal"],[3,"cdkPortalOutlet","attached"],[3,"title","value"]]},template:function(t,i){if(1&t){const o=e.EpF();e.TgZ(0,"nui-widget-editor-accordion",0),e.ALo(1,"async"),e.ALo(2,"nuiWidgetEditorAccordionFormState"),e.TgZ(3,"div",1),e._UZ(4,"nui-icon",2),e.ALo(5,"async"),e.ALo(6,"nuiFormHeaderIconPipe"),e.TgZ(7,"div",3)(8,"span",4),e.SDv(9,5),e.qZA(),e.TgZ(10,"div",6),e._uU(11),e.qZA()()(),e.TgZ(12,"div",7)(13,"nui-form-field",8)(14,"nui-select-v2",9),e.NdJ("valueSelected",function(c){return i.onDataSourceChange(c)}),e.ALo(15,"async"),e.YNc(16,Ya,2,3,"nui-select-v2-option",10),e.qZA()(),e.ynx(17,11,12),e.NdJ("output",function(c){return i.onErrorState(c.payload)}),e.YNc(19,Ha,0,0,"ng-template",13),e.NdJ("attached",function(c){return e.CHM(o),e.MAs(18).attached(c)}),e.BQk(),e.qZA()()}if(2&t){const o=e.MAs(18);let r,c,g;e.Q6J("formGroup",i.form)("state",e.lcZ(1,14,e.lcZ(2,16,i.form))),e.xp6(4),e.Q6J("icon",e.lcZ(5,18,e.xi3(6,20,i.form,"database"))),e.xp6(6),e.Q6J("title",null==(r=i.form.get("providerId"))?null:r.value),e.xp6(1),e.hij(" ",null==(c=i.form.get("providerId"))?null:c.value," "),e.xp6(2),e.Q6J("control",i.form.get("providerId")),e.xp6(1),e.Q6J("title",null==(g=i.form.get("providerId"))?null:g.value)("popupViewportMargin",e.lcZ(15,23,i.configuratorHeading.height$)),e.xp6(2),e.Q6J("ngForOf",i.dataSourceProviders),e.xp6(1),e.Q6J("componentId",i.errorComponent)("componentType",i.errorComponent)("outputs",e.DdM(25,Ka))("properties",e.VKq(26,Qa,i.dataSource)),e.xp6(2),e.Q6J("cdkPortalOutlet",o.portal)}},directives:[De.J,p.JL,p.sg,d.oJW,d.hgI,d.j_n,p.JJ,p.u,s.sg,d.rLF,L.$,z.Pl],pipes:[s.Ov,Fe.F,Ge.d],styles:[".datasource-configuration__accordion-content[_ngcontent-%COMP%]{padding:15px 15px 15px 46px}"],changeDetection:0}),n})();function Xa(n,a){1&n&&(e.TgZ(0,"nui-message",2)(1,"b"),e.SDv(2,3),e.qZA()()),2&n&&e.Q6J("allowDismiss",!1)}function ja(n,a){1&n&&(e.TgZ(0,"nui-message",2)(1,"b"),e.SDv(2,4),e.qZA()()),2&n&&e.Q6J("allowDismiss",!1)}function qa(n,a){if(1&n&&(e.TgZ(0,"nui-message",5)(1,"b"),e.SDv(2,6),e.qZA(),e._uU(3),e.qZA()),2&n){const t=e.oxw();e.Q6J("allowDismiss",!1),e.xp6(3),e.hij(" ",t.dataSourceError.message||t.dataSourceError.type," ")}}let yn=(()=>{class n extends Ft{constructor(t){super(t),this.changeDetector=t}ngOnDestroy(){super.ngOnDestroy()}}return n.lateLoadKey="TableDataSourceErrorComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-table-data-source-error"]],features:[e.qOj],decls:4,vars:3,consts:function(){let a,t,i;return a=$localize`:␟f4720e7c5bf93bfef522f919823f31793a4a09fb␟3836782658203534481:Data source needs to be configured`,t=$localize`:␟7471accb59033b8bee2f7d6907d8deefcfe7d5de␟8643306703234832815:Select a data source`,i=$localize`:␟c399afe21627dcfed1a9865c0e084fac997896c2␟4016661485141937765:Something went wrong with the data source: `,[["class","mt-4 d-block","type","info",3,"allowDismiss",4,"ngIf"],["class","mt-4 d-block","type","critical",3,"allowDismiss",4,"ngIf"],["type","info",1,"mt-4","d-block",3,"allowDismiss"],a,t,["type","critical",1,"mt-4","d-block",3,"allowDismiss"],i]},template:function(t,i){1&t&&(e.TgZ(0,"div"),e.YNc(1,Xa,3,1,"nui-message",0),e.YNc(2,ja,3,1,"nui-message",0),e.YNc(3,qa,4,2,"nui-message",1),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",i.dataSource&&!(null!=i.data&&i.data.dataFields.length)&&!i.dataSourceError&&!i.busy),e.xp6(1),e.Q6J("ngIf",!i.dataSource),e.xp6(1),e.Q6J("ngIf",i.dataSourceError))},directives:[s.O5,d.qqZ],encapsulation:2,changeDetection:0}),n})();function el(n,a){}let Ji=(()=>{class n{constructor(t,i){this.changeDetector=t,this.formBuilder=i,this.mode=M.URL,this.formReady=new e.vpe,this.destroy$=new ie.x,this.form=this.formBuilder.group({mode:[this.mode],urlCustomContent:[""],htmlCustomContent:[""],customEmbeddedContent:[""]}),this.modes=[{value:M.URL,displayValue:$localize`Show the contents of a specific URL`},{value:M.HTML,displayValue:$localize`Show the exact HTML I supply below`}]}get urlCustomContent(){return this.form.get("urlCustomContent")}get htmlCustomContent(){return this.form.get("htmlCustomContent")}get modeValue(){return this.form.get("mode")}get customEmbeddedContentValue(){return this.form.get("customEmbeddedContent")}ngOnInit(){this.initializeForm(),this.formReady.emit(this.form)}ngOnChanges(t){var i,o,r;t.customEmbeddedContent&&(this.mode===M.URL?null===(i=this.urlCustomContent)||void 0===i||i.setValue(this.customEmbeddedContent):this.mode===M.HTML&&(null===(o=this.htmlCustomContent)||void 0===o||o.setValue(this.customEmbeddedContent))),t.mode&&(null===(r=this.modeValue)||void 0===r||r.setValue(t.mode.currentValue))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}initializeForm(){var t,i,o;null===(t=this.modeValue)||void 0===t||t.valueChanges.pipe((0,_e.R)(this.destroy$)).subscribe(r=>{var c,g,E,P,Z,U,ne,ue;r===M.URL?(null===(c=this.customEmbeddedContentValue)||void 0===c||c.setValue(null===(g=this.form.get("urlCustomContent"))||void 0===g?void 0:g.value),null===(E=this.htmlCustomContent)||void 0===E||E.disable(),null===(P=this.urlCustomContent)||void 0===P||P.enable()):r===M.HTML&&(null===(Z=this.customEmbeddedContentValue)||void 0===Z||Z.setValue(null===(U=this.form.get("htmlCustomContent"))||void 0===U?void 0:U.value),null===(ne=this.urlCustomContent)||void 0===ne||ne.disable(),null===(ue=this.htmlCustomContent)||void 0===ue||ue.enable())}),null===(i=this.urlCustomContent)||void 0===i||i.valueChanges.pipe((0,_e.R)(this.destroy$)).subscribe(r=>{var c;null===(c=this.customEmbeddedContentValue)||void 0===c||c.setValue(r)}),null===(o=this.htmlCustomContent)||void 0===o||o.valueChanges.pipe((0,_e.R)(this.destroy$)).subscribe(r=>{var c;null===(c=this.customEmbeddedContentValue)||void 0===c||c.setValue(r)})}}return n.lateLoadKey="EmbeddedContentConfigurationComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(p.qu))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-embedded-content-configuration"]],inputs:{mode:"mode",messageComponent:"messageComponent",customEmbeddedContent:"customEmbeddedContent"},outputs:{formReady:"formReady"},features:[e.TTD],decls:26,vars:23,consts:function(){let a,t;return a=$localize`:␟d18bb86a09ed7c63d7d00a1dad418e5328f59406␟5492801901920760741:Embedded Content`,t=$localize`:␟6a175ac244e51f9c713f8829e3ba9192f6728ba2␟9012225804233265629:What do you want to show in the widget?`,[[3,"formGroup","state"],["accordionHeader","",1,"d-flex","align-items-center","pl-4","py-2"],[1,"align-self-start","pt-2",3,"icon"],[1,"d-flex","flex-column","ml-4","pt1"],[1,"nui-text-label"],a,[1,"nui-text-secondary"],[1,"embedded-configurator-section__accordion-content"],["nuiComponentPortal","",3,"componentType","properties"],["componentPortal","nuiComponentPortal"],[3,"cdkPortalOutlet","attached"],["caption",t,3,"control"],["formControlName","mode","name","mode","required","",3,"value","valueChange"],[3,"value"],[3,"control"],["formControlName","urlCustomContent"],["formControlName","htmlCustomContent","rows","7",1,"textarea-scrollable"]]},template:function(t,i){if(1&t){const o=e.EpF();e.TgZ(0,"nui-widget-editor-accordion",0),e.ALo(1,"async"),e.ALo(2,"nuiWidgetEditorAccordionFormState"),e.TgZ(3,"div",1),e._UZ(4,"nui-icon",2),e.ALo(5,"async"),e.ALo(6,"nuiFormHeaderIconPipe"),e.TgZ(7,"div",3)(8,"span",4),e.SDv(9,5),e.qZA(),e.TgZ(10,"div",6),e._uU(11," Show the specific HTML I supply "),e.qZA()()(),e.TgZ(12,"div",7),e.ynx(13,8,9),e.YNc(15,el,0,0,"ng-template",10),e.NdJ("attached",function(c){return e.CHM(o),e.MAs(14).attached(c)}),e.BQk(),e.TgZ(16,"nui-form-field",11)(17,"nui-radio-group",12),e.NdJ("valueChange",function(c){return i.mode=c}),e.TgZ(18,"nui-radio",13),e._uU(19),e.qZA(),e.TgZ(20,"nui-form-field",14),e._UZ(21,"nui-textbox",15),e.qZA(),e.TgZ(22,"nui-radio",13),e._uU(23),e.qZA(),e.TgZ(24,"nui-form-field",14),e._UZ(25,"nui-textbox",16),e.qZA()()()()()}if(2&t){const o=e.MAs(14);e.Q6J("formGroup",i.form)("state",e.lcZ(1,14,e.lcZ(2,16,i.form))),e.xp6(4),e.Q6J("icon",e.lcZ(5,18,e.xi3(6,20,i.form,"tag"))),e.xp6(9),e.Q6J("componentType",i.messageComponent.componentType)("properties",i.messageComponent.properties),e.xp6(2),e.Q6J("cdkPortalOutlet",o.portal),e.xp6(1),e.Q6J("control",i.form.get("mode")),e.xp6(1),e.Q6J("value",i.mode),e.xp6(1),e.Q6J("value",i.modes[0].value),e.xp6(1),e.hij(" ",i.modes[0].displayValue," "),e.xp6(1),e.Q6J("control",i.form.get("urlCustomContent")),e.xp6(2),e.Q6J("value",i.modes[1].value),e.xp6(1),e.hij(" ",i.modes[1].displayValue," "),e.xp6(1),e.Q6J("control",i.form.get("htmlCustomContent"))}},directives:[De.J,p.JL,p.sg,d.oJW,L.$,z.Pl,d.hgI,d.wTj,p.JJ,p.u,p.Q7,d.UKb,d.XHW],pipes:[s.Ov,Fe.F,Ge.d],styles:[".embedded-configurator-section__accordion-content[_ngcontent-%COMP%]{padding:15px 15px 15px 46px}"],changeDetection:0}),n})();function tl(n,a){if(1&n&&(e.tHW(0,1,1),e._UZ(1,"a",3),e.N_p()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("href",t.link.href,e.LSH)("target",t.link.target),e.pQV(t.link.text),e.QtT(0)}}let Mn=(()=>{class n{constructor(t){this.changeDetector=t}}return n.lateLoadKey="InfoMessageConfigurationComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-info-message-configuration"]],inputs:{emphasizeText:"emphasizeText",generalText:"generalText",link:"link",allowDismiss:"allowDismiss"},decls:4,vars:4,consts:function(){let a;return a=$localize`:␟a533c3d45bdc55cc7b8fce70d448ffafc70b0f5b␟4231249583296268212:${"\ufffd#2\ufffd"}:START_BOLD_TEXT: ${"\ufffd0\ufffd"}:INTERPOLATION: ${"\ufffd/#2\ufffd"}:CLOSE_BOLD_TEXT: ${"\ufffd1\ufffd"}:INTERPOLATION_1: ${"\ufffd*3:1\ufffd\ufffd#1:1\ufffd"}:START_LINK:${"\ufffd0:1\ufffd"}:INTERPOLATION_2:${"\ufffd/#1:1\ufffd\ufffd/*3:1\ufffd"}:CLOSE_LINK:`,[["type","info",3,"allowDismiss"],a,[3,"href","target",4,"ngIf"],[3,"href","target"]]},template:function(t,i){1&t&&(e.TgZ(0,"nui-message",0),e.tHW(1,1),e._UZ(2,"b"),e.YNc(3,tl,2,3,"a",2),e.N_p(),e.qZA()),2&t&&(e.Q6J("allowDismiss",i.allowDismiss),e.xp6(3),e.Q6J("ngIf",i.link),e.pQV(i.emphasizeText)(i.generalText),e.QtT(1))},directives:[d.qqZ,s.O5],encapsulation:2,changeDetection:0}),n})();var Pn=l(39841);function il(n,a){if(1&n&&(e.TgZ(0,"div",14)(1,"nui-form-field",15),e._UZ(2,"nui-textbox",16),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("control",t.form.get("units"))}}let Dn=(()=>{class n{constructor(t,i){this.changeDetector=t,this.formBuilder=i,this.defaultColor={label:$localize`Default color`,color:Zi},this.label="",this.backgroundColor=this.defaultColor.color,this.units="",this.formReady=new e.vpe}ngOnInit(){this.backgroundColors=[...this.backgroundColors],this.backgroundColors.unshift(this.defaultColor),this.form=this.formBuilder.group({label:[this.label,[p.kI.required]],backgroundColor:[this.backgroundColor,[p.kI.required]]}),this.configurableUnits&&this.form.addControl("units",this.formBuilder.control(this.units));const t=this.form.get("label"),i=null==t?void 0:t.valueChanges.pipe((0,Bi.O)(t.value)),o=this.form.get("backgroundColor"),r=null==o?void 0:o.valueChanges.pipe((0,Bi.O)(null==o?void 0:o.value));this.subtitle$=(0,Pn.a)([null==i?void 0:i.pipe((0,It.U)(c=>c||$localize`no label`)),null==r?void 0:r.pipe((0,It.U)(c=>Rn[c]||$localize`Default Color`))]).pipe((0,It.U)(c=>c.join(", "))),this.formReady.emit(this.form)}ngOnChanges(t){var i,o,r;t.label&&(null===(i=this.form)||void 0===i||i.patchValue({label:t.label.currentValue})),t.backgroundColor&&(null===(o=this.form)||void 0===o||o.patchValue({backgroundColor:t.backgroundColor.currentValue})),t.units&&(null===(r=this.form)||void 0===r||r.patchValue({units:t.units.currentValue}))}}return n.lateLoadKey="KpiDescriptionConfigurationComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(p.qu))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-kpi-description-configuration"]],inputs:{componentId:"componentId",configurableUnits:"configurableUnits",label:"label",backgroundColor:"backgroundColor",units:"units",backgroundColors:"backgroundColors"},outputs:{formReady:"formReady"},features:[e.TTD],decls:21,vars:22,consts:function(){let a,t,i,o,r,c;return a=$localize`:␟eec715de352a6b114713b30b640d319fa78207a0␟4902817035128594900:Description`,t=$localize`:␟863226cffd5b66a6fee9810a9282a5006d6ef576␟4077520913910941990:Label`,i=$localize`:␟8f40d8c34a1e732d86581f53b3ed6ff4e1baf8b5␟725093659603391179:Set label`,o=$localize`:␟e088252c0e2ede83d27a24702b1f77c90cee60b7␟3468485835384597147:Background Color`,r=$localize`:␟be537f4ddb09e1a2856314f2cbe84063ab6b4170␟9074327260054432941:Units`,c=$localize`:␟be537f4ddb09e1a2856314f2cbe84063ab6b4170␟9074327260054432941:Units`,[[3,"formGroup","state"],["accordionHeader","",1,"d-flex","align-items-center","px-4","py-2"],[1,"align-self-start","pt-2",3,"icon"],[1,"d-flex","flex-column","ml-4","pt-1"],[1,"nui-text-label"],a,[1,"nui-text-secondary",3,"title"],[1,"kpi-description-configuration__accordion-content"],[1,"mb-4"],["caption",t,1,"form-group",3,"control"],["formControlName","label","placeholder",i],["caption",o,1,"form-group",3,"control"],["formControlName","backgroundColor",1,"kpi-description-configuration__accordion-content__color-picker",3,"colorPalette"],["class","mt-4",4,"ngIf"],[1,"mt-4"],["caption",r,1,"form-group",3,"control"],["formControlName","units","placeholder",c]]},template:function(t,i){1&t&&(e.TgZ(0,"nui-widget-editor-accordion",0),e.ALo(1,"async"),e.ALo(2,"nuiWidgetEditorAccordionFormState"),e.TgZ(3,"div",1),e._UZ(4,"nui-icon",2),e.ALo(5,"async"),e.ALo(6,"nuiFormHeaderIconPipe"),e.TgZ(7,"div",3)(8,"span",4),e.SDv(9,5),e.qZA(),e.TgZ(10,"div",6),e.ALo(11,"async"),e._uU(12),e.ALo(13,"async"),e.qZA()()(),e.TgZ(14,"div",7)(15,"div",8)(16,"nui-form-field",9),e._UZ(17,"nui-textbox",10),e.qZA()(),e.TgZ(18,"nui-form-field",11),e._UZ(19,"nui-color-picker",12),e.qZA(),e.YNc(20,il,3,1,"div",13),e.qZA()()),2&t&&(e.Q6J("formGroup",i.form)("state",e.lcZ(1,9,e.lcZ(2,11,i.form))),e.xp6(4),e.Q6J("icon",e.lcZ(5,13,e.xi3(6,15,i.form,"widget_list"))),e.xp6(6),e.Q6J("title",e.lcZ(11,18,i.subtitle$)),e.xp6(2),e.hij(" ",e.lcZ(13,20,i.subtitle$)," "),e.xp6(4),e.Q6J("control",i.form.get("label")),e.xp6(2),e.Q6J("control",i.form.get("backgroundColor")),e.xp6(1),e.Q6J("colorPalette",i.backgroundColors),e.xp6(1),e.Q6J("ngIf",i.configurableUnits))},directives:[De.J,p.JL,p.sg,d.oJW,d.hgI,d.XHW,p.JJ,p.u,Fi,s.O5],pipes:[s.Ov,Fe.F,Ge.d],styles:[".kpi-description-configuration__accordion-content[_ngcontent-%COMP%]{padding:15px 15px 15px 46px}.kpi-description-configuration__color-select[_ngcontent-%COMP%]{display:flex;align-items:center}.kpi-description-configuration__color-preview[_ngcontent-%COMP%]{width:100%;height:20px;border-radius:3px}.kpi-description-configuration__color-preview.with-arrow[_ngcontent-%COMP%]{width:calc(100% - 40px);margin-left:10px}.kpi-description-configuration__selector-arrow[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:30px;height:30px;border-left:1px solid;border-left-color:var(--nui-color-line-default,#d9d9d9);margin-left:10px}"],changeDetection:0}),n})();var nl=l(25032),Ne=(()=>{return(n=Ne||(Ne={})).Second="second",n.Minute="minute",n.Hour="hour",Ne;var n})();const bn={[Ne.Second]:1e3,[Ne.Minute]:6e4,[Ne.Hour]:36e5},ol={[Ne.Hour]:$localize`:hours unit (long):hours`,[Ne.Minute]:$localize`:minutes unit (long):minutes`,[Ne.Second]:$localize`:seconds unit (long):seconds`},oi={[Ne.Hour]:$localize`:hours unit (short):h`,[Ne.Minute]:$localize`:minutes unit (short):min`,[Ne.Second]:$localize`:seconds unit (short):sec`};function kt(n,a){return bn[n]/bn[a]}function rl(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",7),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.label," ")}}let Yi=(()=>{class n{constructor(t,i){this.fb=t,this.cd=i,this.possibleUnits=[Ne.Second,Ne.Minute,Ne.Hour],this.unitItems=[],this.displayedUnitItems=[],this.currentUnit=null,this.valueChangeFix=nl.Z,this.destroy$=new ie.x}ngOnInit(){this.generateUnitItems(),this.filterUnitItems(),this.createForm()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}getNumberMin(){if(!this.unitControl.value||null==this.minSeconds)return;const t=kt(Ne.Second,this.unitControl.value.id);return Math.ceil(this.minSeconds*t)}getNumberMax(){if(!this.unitControl.value||null==this.maxSeconds)return;const t=kt(Ne.Second,this.unitControl.value.id);return Math.floor(this.maxSeconds*t)}writeValue(t){if(isFinite(t)&&this.isRangeValid()&&this.unitControl.value){const i=kt(Ne.Second,this.unitControl.value.id);this.numberControl.setValue(t*i)}else this.numberControl.setValue(null);this.cd.markForCheck()}registerOnChange(t){this.onChange=t}registerOnTouched(t){}setDisabledState(t){t?(this.numberControl.disable({emitEvent:!1}),this.unitControl.disable({emitEvent:!1})):(this.numberControl.enable({emitEvent:!1}),this.unitControl.enable({emitEvent:!1})),this.cd.markForCheck()}resetUnits(){this.unitControl.setValue(this.displayedUnitItems[0])}generateUnitItems(){this.possibleUnits.forEach((t,i)=>{this.unitItems[i]={id:t,label:ol[t]}})}filterUnitItems(){this.displayedUnitItems=this.unitItems.filter(t=>{let i=!1;if(null!=this.maxSeconds){const o=kt(Ne.Second,t.id);i=Math.floor(this.maxSeconds*o)<=0}return!i})}createForm(){this.form=this.fb.group({number:[1,[p.kI.required]],unit:this.displayedUnitItems[0]}),this.numberControl=this.form.get("number"),this.unitControl=this.form.get("unit"),this.unitControl.value&&(this.currentUnit=this.unitControl.value.id),this.form.valueChanges.pipe((0,_e.R)(this.destroy$)).subscribe(()=>{this.updateError(),this.emitValueChange()})}updateError(){this.isNumberValid()?this.numberControl.setErrors(null):this.numberControl.setErrors({invalidNumber:!0})}emitValueChange(){const t=this.numberControl.value,i=this.unitControl.value;if(null==t||null==i)return void(this.onChange&&this.onChange(null));const o=kt(i.id,Ne.Second);this.onChange&&this.onChange(t*o)}isRangeValid(){return this.minSeconds<=this.maxSeconds||null==this.maxSeconds}isNumberValid(){const t=this.numberControl.value;return!(t<this.minSeconds||t%1!=0)&&(!(t*kt(this.unitControl.value.id,Ne.Second)>this.maxSeconds)&&this.isRangeValid())}getNumberValidationMessage(){const t={min:this.getNumberMin(),max:this.getNumberMax(),whole:!0};return this.getLocalizedNumberValidationMessage(t)}getLocalizedNumberValidationMessage(t){const{min:i,max:o,whole:r}=t,c=r?$localize`a whole number`:$localize`a number`;return null!=i&&null!=o?i===o?$localize`Must be ${c} equal to ${i}`:$localize`Must be ${c} between ${i} and ${o}`:null==i&&null!=o?$localize`Must be ${c} not larger than ${o}`:null!=i&&null==o?$localize`Must be ${c} not smaller than ${i}`:$localize`Must be ${c}`}validate(){var t;return(null===(t=this.form.get("number"))||void 0===t?void 0:t.errors)||null}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(p.qu),e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-refresh-rate-configurator"]],inputs:{minSeconds:"minSeconds",maxSeconds:"maxSeconds"},features:[e._Bn([{provide:p.JU,useExisting:(0,e.Gpc)(()=>n),multi:!0},{provide:p.Cf,useExisting:(0,e.Gpc)(()=>n),multi:!0}])],decls:8,vars:6,consts:[[1,"d-flex","flex-column",3,"formGroup"],[1,"d-flex","flex-row"],["formControlName","number","customBoxWidth","90px",3,"minValue","maxValue","valueChange"],["formControlName","unit",1,"ml-3"],[3,"value",4,"ngFor","ngForOf"],[3,"control"],["for","invalidNumber"],[3,"value"]],template:function(t,i){1&t&&(e.TgZ(0,"form",0)(1,"div",1)(2,"nui-textbox-number",2),e.NdJ("valueChange",function(){return i.valueChangeFix()}),e.qZA(),e.TgZ(3,"nui-select-v2",3),e.YNc(4,rl,2,2,"nui-select-v2-option",4),e.qZA()(),e.TgZ(5,"nui-form-field",5)(6,"nui-validation-message",6),e._uU(7),e.qZA()()()),2&t&&(e.Q6J("formGroup",i.form),e.xp6(2),e.Q6J("minValue",i.minSeconds)("maxValue",i.maxSeconds),e.xp6(2),e.Q6J("ngForOf",i.displayedUnitItems),e.xp6(1),e.Q6J("control",i.form.get("number")),e.xp6(2),e.hij(" ",i.getNumberValidationMessage()," "))},directives:[p._Y,p.JL,p.sg,d.I5I,p.JJ,p.u,d.j_n,s.sg,d.rLF,d.hgI,d.CfE],encapsulation:2,changeDetection:0}),n})();function sl(n,a){if(1&n&&(e.TgZ(0,"div",15),e.SDv(1,16),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.pQV(t.getDurationLabel(t.refresherSettings.refreshRateSeconds)),e.QtT(1)}}let Fn=(()=>{class n{constructor(t,i,o,r,c){this.changeDetector=t,this.formBuilder=i,this.logger=o,this.refresherSettings=r,this.cd=c,this.minSeconds=1,this.maxSeconds=86400,this.overrideDefaultSettingsCaption=$localize`Custom refresh rate`,this.overrideDefaultSettings=!0,this.formReady=new e.vpe,this.destroyed$=new ie.x,this.resetInterval=()=>{var g;this.refreshRateComp.resetUnits(),null===(g=this.form.get("interval"))||void 0===g||g.setValue(this.interval||this.minSeconds)}}ngOnInit(){var t;this.form=this.formBuilder.group({enabled:[!0,[p.kI.required]],overrideDefaultSettings:[this.overrideDefaultSettings,[p.kI.required]],interval:[null!==(t=this.interval)&&void 0!==t?t:0,[p.kI.required]]}),this.form.statusChanges.pipe((0,_e.R)(this.destroyed$)).subscribe(()=>{this.form.markAllAsTouched(),this.cd.detectChanges()}),(0,Pn.a)([this.form.controls.enabled.valueChanges,this.form.controls.overrideDefaultSettings.valueChanges]).pipe((0,Xt.h)(i=>i.some(o=>!o)),(0,st.b)(this.resetInterval),(0,_e.R)(this.destroyed$)).subscribe(),this.formReady.emit(this.form)}ngOnChanges(t){var i,o,r,c,g,E;t.enabled&&(null===(o=null===(i=this.form)||void 0===i?void 0:i.get("enabled"))||void 0===o||o.patchValue(this.enabled)),t.interval&&(null===(c=null===(r=this.form)||void 0===r?void 0:r.get("interval"))||void 0===c||c.patchValue(this.interval)),t.overrideDefaultSettings&&(null===(E=null===(g=this.form)||void 0===g?void 0:g.get("overrideDefaultSettings"))||void 0===E||E.patchValue(this.overrideDefaultSettings))}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}getHeaderSubtitle(){var t,i,o;let r="";return(null===(t=this.form.get("enabled"))||void 0===t?void 0:t.value)?(r+=$localize`Enabled`,r+=", ",(null===(i=this.form.get("overrideDefaultSettings"))||void 0===i?void 0:i.value)?r+=this.getDurationLabel(null===(o=this.form.get("interval"))||void 0===o?void 0:o.value):r+=$localize`Use default value`+" ("+this.getDurationLabel(this.refresherSettings.refreshRateSeconds)+")"):r+=$localize`Disabled`,r}getDurationLabel(t){let i=t,o="";const r=Math.floor(i/3600);i%=3600;const c=Math.floor(i/60),g=i%60;return r>0&&(o+=r+" "+oi[Ne.Hour]+" "),c>0&&(o+=c+" "+oi[Ne.Minute]+" "),g>0&&(o+=g+" "+oi[Ne.Second]+" "),o=o.trim(),""===o?"0 "+oi[Ne.Second]:o}}return n.lateLoadKey="RefresherConfigurationComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(p.qu),e.Y36(d.mQy),e.Y36(hi.g),e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-refresher-configuration"]],viewQuery:function(t,i){if(1&t&&e.Gf(Yi,5),2&t){let o;e.iGM(o=e.CRH())&&(i.refreshRateComp=o.first)}},inputs:{enabled:"enabled",interval:"interval",minSeconds:"minSeconds",maxSeconds:"maxSeconds",overrideDefaultSettingsCaption:"overrideDefaultSettingsCaption",overrideDefaultSettings:"overrideDefaultSettings"},outputs:{formReady:"formReady"},features:[e.TTD],decls:26,vars:25,consts:function(){let a,t,i;return a=$localize`:␟c8d1785038d461ec66b5799db21864182b35900a␟1102717806459547726:Refresh`,t=$localize`:␟913ac9d5354818a43028659e12bb79cc3a8d19e3␟2148212086281974142:Refresh widget periodically`,i=$localize`:␟094103d9c7a2be810d7fc6a1935e14695f19925f␟4443005292001830097: By default, the widget will refresh every ${"\ufffd0\ufffd"}:INTERPOLATION:. `,[[3,"formGroup","state"],["accordionHeader","",1,"d-flex","align-items-center","px-4","py-2"],["iconColor","gray",1,"align-self-start","pt-2",3,"icon"],[1,"d-flex","flex-column","ml-4","pt-1"],[1,"nui-text-label"],a,[1,"nui-text-secondary",3,"title"],[1,"d-flex","flex-column","nui-refresher-configuration__accordion-content"],[3,"control"],["formControlName","enabled"],t,[1,"mt-4"],["formControlName","overrideDefaultSettings"],["class","nui-help-hint",4,"ngIf"],["formControlName","interval",3,"minSeconds","maxSeconds"],[1,"nui-help-hint"],i]},template:function(t,i){if(1&t&&(e.TgZ(0,"nui-widget-editor-accordion",0),e.ALo(1,"async"),e.ALo(2,"nuiWidgetEditorAccordionFormState"),e.TgZ(3,"div",1),e._UZ(4,"nui-icon",2),e.ALo(5,"async"),e.ALo(6,"nuiFormHeaderIconPipe"),e.TgZ(7,"div",3)(8,"span",4),e.SDv(9,5),e.qZA(),e.TgZ(10,"div",6),e._uU(11),e.qZA()()(),e.TgZ(12,"div",7)(13,"div")(14,"nui-form-field",8)(15,"nui-switch",9),e.SDv(16,10),e.qZA()()(),e.TgZ(17,"div")(18,"div",11)(19,"nui-form-field",8)(20,"nui-switch",12),e._uU(21),e.YNc(22,sl,2,1,"div",13),e.qZA()()(),e.TgZ(23,"div",11)(24,"nui-form-field",8),e._UZ(25,"nui-refresh-rate-configurator",14),e.qZA()()()()()),2&t){let o,r,c;e.Q6J("formGroup",i.form)("state",e.lcZ(1,16,e.lcZ(2,18,i.form))),e.xp6(4),e.Q6J("icon",e.lcZ(5,20,e.xi3(6,22,i.form,"reset"))),e.xp6(6),e.Q6J("title",i.getHeaderSubtitle()),e.xp6(1),e.hij(" ",i.getHeaderSubtitle()," "),e.xp6(3),e.Q6J("control",i.form.get("enabled")),e.xp6(3),e.ekj("hidden",!(null!=(o=i.form.get("enabled"))&&o.value)),e.xp6(2),e.Q6J("control",i.form.get("overrideDefaultSettings")),e.xp6(2),e.hij("",i.overrideDefaultSettingsCaption," "),e.xp6(1),e.Q6J("ngIf",!(null!=(r=i.form.get("overrideDefaultSettings"))&&r.value)),e.xp6(1),e.ekj("hidden",!(null!=(c=i.form.get("overrideDefaultSettings"))&&c.value)),e.xp6(1),e.Q6J("control",i.form.get("interval")),e.xp6(1),e.Q6J("minSeconds",i.minSeconds)("maxSeconds",i.maxSeconds)}},directives:[De.J,p.JL,p.sg,d.oJW,d.hgI,d.qUD,p.JJ,p.u,s.O5,Yi],pipes:[s.Ov,Fe.F,Ge.d],styles:[".nui-refresher-configuration__accordion-content[_ngcontent-%COMP%]{padding:15px 15px 15px 46px}"]}),n})();var al=l(45588),ll=l.n(al);const dl=n=>{const a=n.get("criticalThresholdValue"),t=n.get("warningThresholdValue"),i=n.get("reversedThresholds"),o=n.get("showThresholds");if(!a)throw new Error("criticalThresholdValue formControl is not defined");if((0,d.fS1)(a,"min","max"),!t)throw new Error("warningThresholdValue formControl is not defined");if((0,d.fS1)(t,"min","max"),null==o?void 0:o.value){if(k()(t.value))return null;if(null==i?void 0:i.value){if(a.value>=t.value)return t.setErrors({min:!0}),a.setErrors({max:!0}),{thresholds:!0}}else if(a.value<=t.value)return t.setErrors({max:!0}),a.setErrors({min:!0}),{thresholds:!0}}return null};function cl(n,a){if(1&n&&(e.TgZ(0,"nui-radio",14),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.displayValue," ")}}function _l(n,a){if(1&n&&(e.TgZ(0,"div",15)(1,"div",16)(2,"nui-form-field",17),e._UZ(3,"nui-textbox-number",18),e.TgZ(4,"nui-validation-message",11),e.SDv(5,19),e.qZA(),e.TgZ(6,"nui-validation-message",20),e.SDv(7,21),e.qZA(),e.TgZ(8,"nui-validation-message",22),e.SDv(9,23),e.qZA()()(),e.TgZ(10,"div",16)(11,"nui-form-field",24),e._UZ(12,"nui-textbox-number",25),e.TgZ(13,"nui-validation-message",11),e.SDv(14,26),e.qZA(),e.TgZ(15,"nui-validation-message",20),e.SDv(16,27),e.qZA(),e.TgZ(17,"nui-validation-message",22),e.SDv(18,28),e.qZA()()(),e.TgZ(19,"nui-form-field",29),e._UZ(20,"nui-checkbox",30),e.TgZ(21,"nui-validation-message",11),e.SDv(22,31),e.qZA()()()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("control",t.form.get("warningThresholdValue")),e.xp6(9),e.Q6J("control",t.form.get("criticalThresholdValue")),e.xp6(8),e.Q6J("control",t.form.get("reversedThresholds"))("showOptionalText",!1)}}let xn=(()=>{class n{constructor(t,i,o,r){this.changeDetector=t,this.formBuilder=i,this.logger=o,this.cd=r,this.formReady=new e.vpe,this.thresholdOptions=[{value:!1,displayValue:$localize`Never show critical or warning states for this KPI`},{value:!0,displayValue:$localize`Set custom thresholds for this widget`}],this.destroy$=new ie.x}ngOnInit(){this.validateRadioButtonsGroupValue(),this.form=this.formBuilder.group({criticalThresholdValue:[this.criticalThresholdValue||0,[p.kI.required]],warningThresholdValue:[this.warningThresholdValue||0],showThresholds:[this.showThresholds||!1,[p.kI.required]],reversedThresholds:[this.reversedThresholds||!1]},{validators:dl}),this.handleWarningThreshold(this.warningThresholdValue),this.form.statusChanges.pipe((0,_e.R)(this.destroy$)).subscribe(t=>{this.form.markAllAsTouched(),this.cd.detectChanges()}),this.formReady.emit(this.form)}ngOnChanges(t){var i;const o=["criticalThresholdValue","warningThresholdValue","showThresholds","reversedThresholds"];if(t){for(const r of Object.keys(t))if(ll()(o,r)){const c=t[r].currentValue;c&&(null===(i=this.form)||void 0===i||i.patchValue({[r]:c}))}t.showThresholds&&setTimeout(()=>this.validateRadioButtonsGroupValue())}t.warningThresholdValue&&this.handleWarningThreshold(t.warningThresholdValue.currentValue)}getThresholdsSubtitle(t){return t?$localize`Custom thresholds`:$localize`No thresholds`}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}validateRadioButtonsGroupValue(){this.radioButtonGroupValue=this.showThresholds}handleWarningThreshold(t){var i;const o=null===(i=this.form)||void 0===i?void 0:i.get("warningThresholdValue");k()(t)&&(null==o||o.setValue(null))}}return n.lateLoadKey="ThresholdsConfigurationComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(p.qu),e.Y36(d.mQy),e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-thresholds-configuration"]],inputs:{criticalThresholdValue:"criticalThresholdValue",warningThresholdValue:"warningThresholdValue",showThresholds:"showThresholds",reversedThresholds:"reversedThresholds"},outputs:{formReady:"formReady"},features:[e.TTD],decls:19,vars:18,consts:function(){let a,t,i,o,r,c,g,E,P,Z,U,ne,ue,le,Oe;return a=$localize`:␟784fdd6b2dc26499eca6e15094b55f0b1c1e1b7a␟8815471757829352344:Thresholds`,t=$localize`:␟6875687abe0982b513f60d230d71b9cc2d9eef3e␟9007062817247777645:How do you want to set warning/critical thresholds?`,i=$localize`:␟b17406f843dc33feb81478ae8273dc1aae06bbf6␟2244196281006156184: This field is required `,o=$localize`:␟5dda34ec4b693f2b13afdf28a4e5f00062f4c896␟4003830139037367407:Warning value`,r=$localize`:␟cae671d9eb277eadfd7752518814d3f852369cc9␟6643132921042050963:Never show the warning state`,c=$localize`:␟c9a9da14b0f8c677efa737185f1232f8537bd2a6␟3224868488156254475: This field is required `,g=$localize`:␟19d6eb371557c8ab18db5332a2e1955f18c2f16d␟3184669981998118637: Warning threshold should be greater than critical threshold `,E=$localize`:␟6c62f1e33dd914743cb977df6baba31779d7aed6␟1030183925045576042: Warning threshold should be lower than critical threshold `,P=$localize`:␟f8baa78544aa27624d43d59e5a225216aff1042f␟6033897450960508846:Critical value`,Z=$localize`:␟9b66a7e6fdeb05f4c1ffdc78ea8f4a7a2fb64d79␟7643729389671069649:Set critical value`,U=$localize`:␟c9a9da14b0f8c677efa737185f1232f8537bd2a6␟3224868488156254475: This field is required `,ne=$localize`:␟540b9b0f637cc0605bc00ccc586a3eab73aabcfc␟4465977748799047247: Critical threshold should be greater than warning threshold `,ue=$localize`:␟2efae84e117a2639681a8e5c0e4ce4eee42af17d␟9156849514888688496: Critical threshold should be lower than warning threshold `,le=$localize`:␟18bcbeb2b14e6064ec6fe9276db140a4e800da3c␟5716867848923884165:Warning and critical when below threshold values`,Oe=$localize`:␟8eb0e5b7a8ec1199d38c9e92ca26bd4b3aae7f2c␟8999046125839025839: This field is required `,[[3,"formGroup","state"],["accordionHeader","",1,"d-flex","align-items-center","px-4","py-2"],[1,"align-self-start","pt-2",3,"icon"],[1,"d-flex","flex-column","ml-4","pt-1"],[1,"nui-text-label"],a,[1,"nui-text-secondary",3,"title"],[1,"kpi-thresholds-configuration__accordion-content"],["caption",t,3,"control"],["formControlName","showThresholds","name","showThresholds","required","",3,"value"],[3,"value",4,"ngFor","ngForOf"],["for","required"],i,["class","mt-4",4,"ngIf"],[3,"value"],[1,"mt-4"],[1,"mb-4"],["caption",o,3,"control"],["formControlName","warningThresholdValue","placeholder",r],c,["for","min"],g,["for","max"],E,["caption",P,3,"control"],["formControlName","criticalThresholdValue","placeholder",Z],U,ne,ue,["caption",le,3,"control","showOptionalText"],["formControlName","reversedThresholds","required",""],Oe]},template:function(t,i){if(1&t&&(e.TgZ(0,"nui-widget-editor-accordion",0),e.ALo(1,"async"),e.ALo(2,"nuiWidgetEditorAccordionFormState"),e.TgZ(3,"div",1),e._UZ(4,"nui-icon",2),e.ALo(5,"async"),e.ALo(6,"nuiFormHeaderIconPipe"),e.TgZ(7,"div",3)(8,"span",4),e.SDv(9,5),e.qZA(),e.TgZ(10,"div",6),e._uU(11),e.qZA()()(),e.TgZ(12,"div",7)(13,"nui-form-field",8)(14,"nui-radio-group",9),e.YNc(15,cl,2,2,"nui-radio",10),e.qZA(),e.TgZ(16,"nui-validation-message",11),e.SDv(17,12),e.qZA()(),e.YNc(18,_l,23,4,"div",13),e.qZA()()),2&t){let o,r,c;e.Q6J("formGroup",i.form)("state",e.lcZ(1,9,e.lcZ(2,11,i.form))),e.xp6(4),e.Q6J("icon",e.lcZ(5,13,e.xi3(6,15,i.form,"thresholds"))),e.xp6(6),e.Q6J("title",i.getThresholdsSubtitle(null==(o=i.form.get("showThresholds"))?null:o.value)),e.xp6(1),e.hij(" ",i.getThresholdsSubtitle(null==(r=i.form.get("showThresholds"))?null:r.value)," "),e.xp6(2),e.Q6J("control",i.form.get("showThresholds")),e.xp6(1),e.Q6J("value",i.radioButtonGroupValue),e.xp6(1),e.Q6J("ngForOf",i.thresholdOptions),e.xp6(3),e.Q6J("ngIf",null==(c=i.form.get("showThresholds"))?null:c.value)}},directives:[De.J,p.JL,p.sg,d.oJW,d.hgI,d.wTj,p.JJ,p.u,p.Q7,s.sg,d.UKb,d.CfE,s.O5,d.I5I,d.bK4],pipes:[s.Ov,Fe.F,Ge.d],styles:[".kpi-thresholds-configuration__accordion-content[_ngcontent-%COMP%]{padding:15px 15px 15px 46px}"],changeDetection:0}),n})();function ul(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",23),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.name," ")}}function pl(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",23),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.label," ")}}function gl(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",23),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t.value),e.xp6(1),e.Oqu(t.label)}}let Ln=(()=>{class n{constructor(t,i,o,r){this.changeDetector=t,this.configuratorHeading=i,this.formBuilder=o,this.eventBus=r,this.legendPlacements=[],this.timeSpans=[],this.availableChartTypes=[{label:$localize`Line`,value:Pe.Line},{label:$localize`Stacked area`,value:Pe.StackedArea},{label:$localize`Stacked % area`,value:Pe.StackedPercentageArea},{label:$localize`Bar`,value:Pe.StackedBar},{label:$localize`Status`,value:Pe.StatusBar}],this.formReady=new e.vpe,this.destroy$=new ie.x,this.form=this.formBuilder.group({leftAxisLabel:[""],startingTimespan:[null,p.kI.required],legendPlacement:[we.w.None,[p.kI.required]],preset:[Pe.Line,[p.kI.required]]})}ngOnInit(){var t;null===(t=this.form.get("startingTimespan"))||void 0===t||t.valueChanges.pipe((0,_e.R)(this.destroy$)).subscribe(i=>{setTimeout(()=>{this.eventBus.next(T.xZ,{payload:{id:T.RG}})})}),this.formReady.emit(this.form)}ngOnChanges(t){var i,o,r,c;const g=this.form.get("startingTimespan");t.leftAxisLabel&&(null===(i=this.form.get("leftAxisLabel"))||void 0===i||i.setValue(this.leftAxisLabel,{emitEvent:!1})),t.startingTimespan&&(null==g||g.setValue(this.startingTimespan,{emitEvent:!1})),t.legendPlacement&&(null===(o=this.form.get("legendPlacement"))||void 0===o||o.setValue(this.legendPlacement,{emitEvent:!1})),t.preset&&(null===(r=this.form.get("preset"))||void 0===r||r.setValue(this.preset,{emitEvent:!1})),t.timeSpans&&!(null==g?void 0:g.value)&&(null===(c=this.timeSpans)||void 0===c?void 0:c.length)>0&&(null==g||g.setValue(this.timeSpans[0]))}getSecondaryText(){const t=this.form.controls.startingTimespan.value;return`${t&&t.name||$localize`No timespan`}, ${this.form.controls.legendPlacement.value||$localize`No legend`}, ${this.form.controls.leftAxisLabel.value||$localize`No y-axis label`}`}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return n.lateLoadKey="TimeseriesMetadataConfigurationComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(Qe.p),e.Y36(p.qu),e.Y36(m.nY))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-timeseries-metadata-configuration"]],inputs:{legendPlacements:"legendPlacements",timeSpans:"timeSpans",startingTimespan:"startingTimespan",legendPlacement:"legendPlacement",leftAxisLabel:"leftAxisLabel",preset:"preset",availableChartTypes:"availableChartTypes"},outputs:{formReady:"formReady"},features:[e.TTD],decls:40,vars:37,consts:function(){let a,t,i,o,r,c,g,E,P,Z,U,ne,ue;return a=$localize`:␟82fac4002b38b13e6e76cab565857c651740e8d4␟7635587638460371959:Timeseries metadata`,t=$localize`:␟7c1e198b83571c6f6d6774bbf5e8ef469b8ed3f8␟83369046626581484:Starting timespan`,i=$localize`:␟cea52b8401042ba9c3aac1cd5a7507d754f0d809␟4391839922437157830:Starting Timespan`,o=$localize`:␟8eb0e5b7a8ec1199d38c9e92ca26bd4b3aae7f2c␟8999046125839025839: This field is required `,r=$localize`:␟a9e3fc4b717bf285f084fc443a97f4c08b345203␟2498436426359230001:Chart legend`,c=$localize`:␟8137d4a0a1b9974f796c96ea5b70f4ec4304af97␟9008417256629743113:Select Legend Orientation`,g=$localize`:␟8eb0e5b7a8ec1199d38c9e92ca26bd4b3aae7f2c␟8999046125839025839: This field is required `,E=$localize`:␟20f8b383236e858a2369abf573aa3a662a61dc2c␟7603862017185374134:Chart y-axis label`,P=$localize`:␟da1b3b8ad86495e008972fe0f8dfca60c9c60ac5␟5670370419656051485:Set chart y-axis label`,Z=$localize`:␟8eb0e5b7a8ec1199d38c9e92ca26bd4b3aae7f2c␟8999046125839025839: This field is required `,U=$localize`:␟d4821e6eaad5b45a36e2873de2a6e0075c4b7621␟8983610989099122824:Chart type`,ne=$localize`:␟d4821e6eaad5b45a36e2873de2a6e0075c4b7621␟8983610989099122824:Chart type`,ue=$localize`:␟b17406f843dc33feb81478ae8273dc1aae06bbf6␟2244196281006156184: This field is required `,[[3,"formGroup","state"],["accordionHeader","",1,"d-flex","align-items-center","px-4","py-2"],[3,"icon","iconColor"],[1,"d-flex","flex-column","ml-4"],[1,"nui-text-label"],a,[1,"nui-text-secondary",3,"title"],[1,"timeseries-metadata-configuration__accordion-content"],[1,"mb-4"],["caption",t,3,"control"],["placeholder",i,"formControlName","startingTimespan",3,"popupViewportMargin"],[3,"value",4,"ngFor","ngForOf"],["for","required"],o,["caption",r,3,"control"],["placeholder",c,"formControlName","legendPlacement",3,"popupViewportMargin"],g,["caption",E,3,"control"],["formControlName","leftAxisLabel","placeholder",P],Z,["caption",U,3,"control"],["placeholder",ne,"formControlName","preset",3,"popupViewportMargin"],ue,[3,"value"]]},template:function(t,i){1&t&&(e.TgZ(0,"nui-widget-editor-accordion",0),e.ALo(1,"async"),e.ALo(2,"nuiWidgetEditorAccordionFormState"),e.TgZ(3,"div",1),e._UZ(4,"nui-icon",2),e.ALo(5,"async"),e.ALo(6,"nuiFormHeaderIconPipe"),e.ALo(7,"async"),e.ALo(8,"nuiFormHeaderIconPipe"),e.TgZ(9,"div",3)(10,"span",4),e.SDv(11,5),e.qZA(),e.TgZ(12,"div",6),e._uU(13),e.qZA()()(),e.TgZ(14,"div",7)(15,"div",8)(16,"nui-form-field",9)(17,"nui-select-v2",10),e.ALo(18,"async"),e.YNc(19,ul,2,2,"nui-select-v2-option",11),e.qZA(),e.TgZ(20,"nui-validation-message",12),e.SDv(21,13),e.qZA()()(),e.TgZ(22,"div",8)(23,"nui-form-field",14)(24,"nui-select-v2",15),e.ALo(25,"async"),e.YNc(26,pl,2,2,"nui-select-v2-option",11),e.qZA(),e.TgZ(27,"nui-validation-message",12),e.SDv(28,16),e.qZA()()(),e.TgZ(29,"div",8)(30,"nui-form-field",17),e._UZ(31,"nui-textbox",18),e.TgZ(32,"nui-validation-message",12),e.SDv(33,19),e.qZA()()(),e.TgZ(34,"nui-form-field",20)(35,"nui-select-v2",21),e.ALo(36,"async"),e.YNc(37,gl,2,2,"nui-select-v2-option",11),e.qZA(),e.TgZ(38,"nui-validation-message",12),e.SDv(39,22),e.qZA()()()()),2&t&&(e.Q6J("formGroup",i.form)("state",e.lcZ(1,16,e.lcZ(2,18,i.form))),e.xp6(4),e.Q6J("icon",e.lcZ(5,20,e.xi3(6,22,i.form,"edit")))("iconColor",e.lcZ(7,25,e.Dn7(8,27,i.form,"gray",""))),e.xp6(8),e.Q6J("title",i.getSecondaryText()),e.xp6(1),e.hij(" ",i.getSecondaryText()," "),e.xp6(3),e.Q6J("control",i.form.controls.startingTimespan),e.xp6(1),e.Q6J("popupViewportMargin",e.lcZ(18,31,i.configuratorHeading.height$)),e.xp6(2),e.Q6J("ngForOf",i.timeSpans),e.xp6(4),e.Q6J("control",i.form.controls.legendPlacement),e.xp6(1),e.Q6J("popupViewportMargin",e.lcZ(25,33,i.configuratorHeading.height$)),e.xp6(2),e.Q6J("ngForOf",i.legendPlacements),e.xp6(4),e.Q6J("control",i.form.controls.leftAxisLabel),e.xp6(4),e.Q6J("control",i.form.controls.preset),e.xp6(1),e.Q6J("popupViewportMargin",e.lcZ(36,35,i.configuratorHeading.height$)),e.xp6(2),e.Q6J("ngForOf",i.availableChartTypes))},directives:[De.J,p.JL,p.sg,d.oJW,d.hgI,d.j_n,p.JJ,p.u,s.sg,d.rLF,d.CfE,d.XHW],pipes:[s.Ov,Fe.F,Ge.d],styles:[".timeseries-metadata-configuration__accordion-content[_ngcontent-%COMP%]{padding:15px 15px 15px 46px}"]}),n})(),Rt=(()=>{class n{constructor(t,i,o){this.changeDetector=t,this.formBuilder=i,this.logger=o,this.formReady=new e.vpe,this.form=this.formBuilder.group({title:["",p.kI.required],subtitle:[""],url:[""],description:[""],collapsible:[!1],collapsed:[!0]})}ngOnInit(){this.formReady.emit(this.form)}ngOnChanges(t){var i,o,r,c,g;t.title&&(null===(i=this.form.get("title"))||void 0===i||i.setValue(this.title)),t.url&&(null===(o=this.form.get("url"))||void 0===o||o.setValue(this.url)),t.subtitle&&(null===(r=this.form.get("subtitle"))||void 0===r||r.setValue(this.subtitle)),t.description&&(null===(c=this.form.get("description"))||void 0===c||c.setValue(this.description)),t.collapsible&&(null===(g=this.form.get("collapsible"))||void 0===g||g.setValue(this.collapsible))}getSecondaryText(){return`${this.form.controls.title.value||$localize`No title`}, ${this.form.controls.subtitle.value||$localize`no subtitle`}`}}return n.lateLoadKey="TitleAndDescriptionConfigurationComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(p.qu),e.Y36(d.mQy))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-title-and-description-configuration"]],inputs:{title:"title",url:"url",subtitle:"subtitle",description:"description",collapsible:"collapsible"},outputs:{formReady:"formReady"},features:[e.TTD],decls:31,vars:20,consts:function(){let a,t,i,o,r,c,g,E,P,Z,U,ne,ue;return a=$localize`:␟c1f3e3c0c4876967ade530f67b0696f7c1f5aa76␟6274813085792990828:Title and Description`,t=$localize`:␟f75e29ac7734f16cad4d02017646720be3030367␟1720994052291036243:Widget title`,i=$localize`:␟eb94f6289d261b9d7b1288cf92c4099023695dd9␟2301126677959299103:Set widget title`,o=$localize`:␟8eb0e5b7a8ec1199d38c9e92ca26bd4b3aae7f2c␟8999046125839025839: This field is required `,r=$localize`:␟d2b3deab155463fe2b5ac59000b6e3aa7771afc8␟2073684406211180788:Widget subtitle`,c=$localize`:␟b6d324cd44176b6e2bfe2ff16bbc7e7ee1c412fc␟8934433387734849172:Do not show a subtitle`,g=$localize`:␟cb04bfea86b30d40d2d30630c957bf3fd2e50b83␟9207103926988831681:Widget link URL`,E=$localize`:␟02773997819c014e0f299deb7cb8e054003850e1␟3668070782949850100:Do not link to another page`,P=$localize`:␟ab83c23bd6135460422e95fca32b4ec38ddff9e6␟3861388441030158101:Widget description`,Z=$localize`:␟2f50115d11fc3e29acafe6f99228c2304cffb722␟3301579533722588311:This won't be shown on the widget, but can be helpful for
                          other users who want to re-use this widget on their own dashboards`,U=$localize`:␟37b56526e384f843a15323dc730b484a97b4c968␟3830487495946043372:No description`,ne=$localize`:␟9de5a44cd2d54fe77e5c12131ab7a21792ce91df␟5450302501374652801:Hide widget header`,ue=$localize`:␟6570353e3fb49053e2327cb92f257eab8ccdd274␟5369485165489692848:Collapsible`,[[3,"formGroup","state"],["accordionHeader","",1,"d-flex","align-items-center","px-4","py-2"],[1,"align-self-start","pt-2",3,"icon"],[1,"d-flex","flex-column","ml-4","pt-1"],[1,"nui-text-label"],a,[1,"nui-text-secondary",3,"title"],[1,"title-and-description-configuration__accordion-content"],[1,"mb-4"],["caption",t,3,"control"],["id","kpi-widget-title","formControlName","title","placeholder",i],["for","required"],o,["caption",r,3,"control"],["id","kpi-widget-subtitle","formControlName","subtitle","placeholder",c],["caption",g,3,"control"],["id","kpi-widget-url","formControlName","url","placeholder",E],["caption",P,"hint",Z,3,"control"],["formControlName","description","placeholder",U],["caption",ne,3,"showOptionalText","control"],["formControlName","collapsible"],ue]},template:function(t,i){1&t&&(e.TgZ(0,"nui-widget-editor-accordion",0),e.ALo(1,"async"),e.ALo(2,"nuiWidgetEditorAccordionFormState"),e.TgZ(3,"div",1),e._UZ(4,"nui-icon",2),e.ALo(5,"async"),e.ALo(6,"nuiFormHeaderIconPipe"),e.TgZ(7,"div",3)(8,"span",4),e.SDv(9,5),e.qZA(),e.TgZ(10,"div",6),e._uU(11),e.qZA()()(),e.TgZ(12,"div",7)(13,"div",8)(14,"nui-form-field",9),e._UZ(15,"nui-textbox",10),e.TgZ(16,"nui-validation-message",11),e.SDv(17,12),e.qZA()()(),e.TgZ(18,"div",8)(19,"nui-form-field",13),e._UZ(20,"nui-textbox",14),e.qZA()(),e.TgZ(21,"div",8)(22,"nui-form-field",15),e._UZ(23,"nui-textbox",16),e.qZA()(),e.TgZ(24,"div",8)(25,"nui-form-field",17),e._UZ(26,"nui-textbox",18),e.qZA()(),e.TgZ(27,"div")(28,"nui-form-field",19)(29,"nui-checkbox",20),e.SDv(30,21),e.qZA()()()()()),2&t&&(e.Q6J("formGroup",i.form)("state",e.lcZ(1,11,e.lcZ(2,13,i.form))),e.xp6(4),e.Q6J("icon",e.lcZ(5,15,e.xi3(6,17,i.form,"widget_list"))),e.xp6(6),e.Q6J("title",i.getSecondaryText()),e.xp6(1),e.hij(" ",i.getSecondaryText()," "),e.xp6(3),e.Q6J("control",i.form.get("title")),e.xp6(5),e.Q6J("control",i.form.get("subtitle")),e.xp6(3),e.Q6J("control",i.form.get("url")),e.xp6(3),e.Q6J("control",i.form.get("description")),e.xp6(3),e.Q6J("showOptionalText",!1)("control",i.form.get("collapsible")))},directives:[De.J,p.JL,p.sg,d.oJW,d.hgI,d.XHW,p.JJ,p.u,d.CfE,d.bK4],pipes:[s.Ov,Fe.F,Ge.d],styles:[".title-and-description-configuration__accordion-content[_ngcontent-%COMP%]{padding:15px 15px 15px 46px}"],changeDetection:0}),n})();function hl(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",22),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function ml(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",22),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function fl(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",22),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function Tl(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",22),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function Cl(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",22),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}let wn=(()=>{class n{constructor(t,i){this.changeDetector=t,this.formBuilder=i,this.formReady=new e.vpe,this.form=this.formBuilder.group({dataFieldIds:this.formBuilder.group({icon:"",status:"",detailedUrl:"",label:"",url:""})})}ngOnInit(){this.formReady.emit(this.form)}ngOnChanges(t){t.dataFieldIds&&this.getFieldMappingsControl.setValue(t.dataFieldIds.currentValue)}get getFieldMappingsControl(){return this.form.get("dataFieldIds")}}return n.lateLoadKey="EntityFormattingComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(p.qu))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-entity-formatting-configuration"]],inputs:{mappingKeys:"mappingKeys",dataFieldIds:"dataFieldIds"},outputs:{formReady:"formReady"},features:[e.TTD],decls:46,vars:17,consts:function(){let a,t,i,o,r,c,g,E,P,Z,U;return a=$localize`:␟38ddd26fc749a9c493e70c642d321c868c47f178␟5252376970414591923:Entity formatting`,t=$localize`:␟14688213d67b2f0e553d66f8255281db245502fb␟3074987902485823708:Icon`,i=$localize`:␟42daf87f19836ef3d1b8f58a5cf93e2c43b82c1c␟8325381706328570325:Select Item`,o=$localize`:␟81b97b8ea996ad1e4f9fca8415021850214884b1␟5611592591303869712:Status`,r=$localize`:␟42daf87f19836ef3d1b8f58a5cf93e2c43b82c1c␟8325381706328570325:Select Item`,c=$localize`:␟06ae2001bf7ffd3cbe977e0c4ce0951f660ca197␟4936125302941310356:Details URL`,g=$localize`:␟42daf87f19836ef3d1b8f58a5cf93e2c43b82c1c␟8325381706328570325:Select Item`,E=$localize`:␟863226cffd5b66a6fee9810a9282a5006d6ef576␟4077520913910941990:Label`,P=$localize`:␟42daf87f19836ef3d1b8f58a5cf93e2c43b82c1c␟8325381706328570325:Select Item`,Z=$localize`:␟ec044db4c57a4750f8bec4371dc39e94f2e26d46␟994779223497739731:Label URL`,U=$localize`:␟42daf87f19836ef3d1b8f58a5cf93e2c43b82c1c␟8325381706328570325:Select Item`,[[3,"formGroup","state"],["accordionHeader","",1,"d-flex","align-items-center","px-4","py-2"],["iconColor","gray",1,"align-self-start","pt-2",3,"icon"],[1,"d-flex","flex-column","ml-4","pt-1"],[1,"nui-text-label"],a,["title","Show status icon",1,"nui-text-secondary"],["formGroupName","dataFieldIds",1,"entity-formatting__accordion-content"],[1,"mb-3"],t,[1,"d-flex","flex-grow-1"],[1,"d-flex","flex-grow-1",3,"control"],["placeholder",i,"formControlName","icon"],[3,"value",4,"ngFor","ngForOf"],o,["placeholder",r,"formControlName","status"],c,["placeholder",g,"formControlName","detailedUrl"],E,["placeholder",P,"formControlName","label"],Z,["placeholder",U,"formControlName","url"],[3,"value"]]},template:function(t,i){1&t&&(e.TgZ(0,"nui-widget-editor-accordion",0),e.ALo(1,"async"),e.ALo(2,"nuiWidgetEditorAccordionFormState"),e.TgZ(3,"div",1),e._UZ(4,"nui-icon",2),e.TgZ(5,"div",3)(6,"span",4),e.SDv(7,5),e.qZA(),e.TgZ(8,"div",6),e._uU(9," Show status icon "),e.qZA()()(),e.TgZ(10,"div",7)(11,"div",8)(12,"label",4),e.SDv(13,9),e.qZA(),e.TgZ(14,"div",10)(15,"nui-form-field",11)(16,"nui-select-v2",12),e.YNc(17,hl,2,2,"nui-select-v2-option",13),e.qZA()()()(),e.TgZ(18,"div",8)(19,"label",4),e.SDv(20,14),e.qZA(),e.TgZ(21,"div",10)(22,"nui-form-field",11)(23,"nui-select-v2",15),e.YNc(24,ml,2,2,"nui-select-v2-option",13),e.qZA()()()(),e.TgZ(25,"div",8)(26,"label",4),e.SDv(27,16),e.qZA(),e.TgZ(28,"div",10)(29,"nui-form-field",11)(30,"nui-select-v2",17),e.YNc(31,fl,2,2,"nui-select-v2-option",13),e.qZA()()()(),e.TgZ(32,"div",8)(33,"label",4),e.SDv(34,18),e.qZA(),e.TgZ(35,"div",10)(36,"nui-form-field",11)(37,"nui-select-v2",19),e.YNc(38,Tl,2,2,"nui-select-v2-option",13),e.qZA()()()(),e.TgZ(39,"div",8)(40,"label",4),e.SDv(41,20),e.qZA(),e.TgZ(42,"div",10)(43,"nui-form-field",11)(44,"nui-select-v2",21),e.YNc(45,Cl,2,2,"nui-select-v2-option",13),e.qZA()()()()()()),2&t&&(e.Q6J("formGroup",i.form)("state",e.lcZ(1,13,e.lcZ(2,15,i.form))),e.xp6(4),e.Q6J("icon","tag"),e.xp6(11),e.Q6J("control",i.getFieldMappingsControl.get("icon")),e.xp6(2),e.Q6J("ngForOf",i.mappingKeys),e.xp6(5),e.Q6J("control",i.getFieldMappingsControl.get("status")),e.xp6(2),e.Q6J("ngForOf",i.mappingKeys),e.xp6(5),e.Q6J("control",i.getFieldMappingsControl.get("detailedUrl")),e.xp6(2),e.Q6J("ngForOf",i.mappingKeys),e.xp6(5),e.Q6J("control",i.getFieldMappingsControl.get("label")),e.xp6(2),e.Q6J("ngForOf",i.mappingKeys),e.xp6(5),e.Q6J("control",i.getFieldMappingsControl.get("url")),e.xp6(2),e.Q6J("ngForOf",i.mappingKeys))},directives:[De.J,p.JL,p.sg,d.oJW,p.x0,d.hgI,d.j_n,p.JJ,p.u,s.sg,d.rLF],pipes:[s.Ov,Fe.F],styles:[".entity-formatting__accordion-content[_ngcontent-%COMP%]{padding:15px 15px 15px 46px}"]}),n})();var Ol=l(18680),Gn=l.n(Ol);function Il(n,a){1&n&&(e.TgZ(0,"label",18),e.SDv(1,19),e.qZA())}function vl(n,a){1&n&&(e.TgZ(0,"label",20),e.SDv(1,21),e.qZA())}function El(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",22),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function Sl(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.YNc(1,Il,2,0,"label",10),e.YNc(2,vl,2,0,"label",11),e.TgZ(3,"div",12)(4,"nui-form-field",13)(5,"nui-select-v2",14),e.YNc(6,El,2,2,"nui-select-v2-option",15),e.qZA()(),e.TgZ(7,"div",16)(8,"button",17),e.NdJ("click",function(){const r=e.CHM(t).index;return e.oxw().removeRule(r)}),e.qZA()()(),e.BQk()}if(2&n){const t=a.$implicit,i=a.index,o=e.oxw();e.xp6(1),e.Q6J("ngIf",0!==i),e.xp6(1),e.Q6J("ngIf",0===i),e.xp6(2),e.Q6J("control",t),e.xp6(1),e.Q6J("formControlName",i),e.xp6(1),e.Q6J("ngForOf",o.selectData[i])}}function Rl(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",23),e.NdJ("click",function(){return e.CHM(t),e.oxw().addGrouping()}),e.SDv(1,24),e.qZA()}}let $n=(()=>{class n{constructor(t,i,o){this.changeDetector=t,this.formBuilder=i,this.eventBus=o,this.formReady=new e.vpe,this.form=this.formBuilder.group({groups:[],groupBy:this.formBuilder.array([]),drillstate:[void 0]}),this.destroy$=new ie.x}get getGroupByControl(){return this.form.get("groupBy")}get getDrillStateControl(){return this.form.get("drillstate")}get getGroupsControl(){return this.form.get("groups")}ngOnInit(){this.eventBus.getStream(ke.gg).pipe((0,_e.R)(this.destroy$)).subscribe(t=>this.onDataSourceCreated(t)),this.getGroupByControl.valueChanges.pipe((0,_e.R)(this.destroy$)).subscribe(()=>this.fillGroupsOptions()),this.fillGroupsOptions(),this.formReady.emit(this.form)}ngOnChanges(t){t.groups&&this.getGroupsControl.setValue(t.groups.currentValue),t.groupBy&&!t.groupBy.firstChange&&(this.getGroupByControl.clear(),this.groupBy.forEach(i=>this.getGroupByControl.push(this.createControl(i))),this.fillGroupsOptions())}createControl(t){return this.formBuilder.control(t||"",p.kI.required)}addGrouping(){const t=this.createControl();this.getGroupByControl.push(t),this.fillGroupsOptions(),t.setValue(this.selectData[this.getGroupByControl.controls.length-1][0])}removeRule(t){this.getGroupByControl.removeAt(t),this.fillGroupsOptions()}isAddRestricted(){return this.selectData.some(t=>1===t.length)}getSubtitle(){var t;const i=this.getGroupByControl.controls.map((o,r)=>`${0===r?"By":"then"} ${o.value}`).join(", ");return 0===(null===(t=this.getGroupByControl)||void 0===t?void 0:t.value.length)?$localize`No groups`:$localize`${i}`}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}onDataSourceCreated(t){var i,o,r;null===(r=null===(o=null===(i=null==t?void 0:t.payload)||void 0===i?void 0:i.dataFieldsConfig)||void 0===o?void 0:o.dataFields$)||void 0===r||r.pipe((0,_e.R)(this.destroy$)).subscribe(c=>{var g;if(c){const E=c.map(Z=>Z.id);(Gn()(this.groups,E).length||!(null===(g=this.groups)||void 0===g?void 0:g.length))&&(this.groups=E,this.getGroupsControl.setValue(E),this.getGroupByControl.clear(),this.getDrillStateControl.setValue([]),this.fillGroupsOptions())}})}fillGroupsOptions(){this.selectData=[];const t=this.getGroupByControl.value;this.getGroupByControl.controls.forEach((i,o)=>{this.selectData[o]=[];const r=Gn()(this.groups,t);t[o]&&this.selectData[o].push(t[o]),this.selectData[o]=[...this.selectData[o],...r]})}}return n.lateLoadKey="DrilldownConfiguratorComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(p.qu),e.Y36(m.nY))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-grouping-configuration"]],inputs:{groups:"groups",groupBy:"groupBy"},outputs:{formReady:"formReady"},features:[e.TTD],decls:13,vars:11,consts:function(){let a,t,i,o,r;return a=$localize`:␟8658ad3b268c50fe2c1106dfb7bccdaa2e4290b2␟877780134171662191:Grouping`,t=$localize`:␟42daf87f19836ef3d1b8f58a5cf93e2c43b82c1c␟8325381706328570325:Select Item`,i=$localize`:␟e2feaa48e92bd996631d6a90911db46fe38cd1a3␟4620310062886462675:Then`,o=$localize`:␟788a575e9f2466abeee0e51ab8f77e9cf19243de␟3653048554215358825:Group by`,r=$localize`:␟b8c2733945af01b52afbf8d2c9993bd9abda4c94␟3960498895552401303: Add another level `,[[3,"formGroup","state"],["accordionHeader","",1,"d-flex","align-items-center","px-4","py-2"],["iconColor","gray",1,"align-self-start","pt-2",3,"icon"],[1,"d-flex","flex-column","ml-4","pt-1"],[1,"nui-text-label"],a,[1,"nui-text-secondary",3,"title"],["formArrayName","groupBy",1,"grouping-configuration__accordion-content"],[4,"ngFor","ngForOf"],["nui-button","","icon","add","displayStyle","action","type","button",3,"click",4,"ngIf"],["class","d-flex nui-text-secondary mb-1",4,"ngIf"],["class","d-flex nui-text-panel mb-2",4,"ngIf"],[1,"d-flex","flex-row","flex-grow-1","mb-4"],[1,"d-flex","flex-grow-1",3,"control"],["placeholder",t,3,"formControlName"],[3,"value",4,"ngFor","ngForOf"],[1,"justify-content-center"],["nui-button","","icon","delete","displayStyle","action","type","button",3,"click"],[1,"d-flex","nui-text-secondary","mb-1"],i,[1,"d-flex","nui-text-panel","mb-2"],o,[3,"value"],["nui-button","","icon","add","displayStyle","action","type","button",3,"click"],r]},template:function(t,i){1&t&&(e.TgZ(0,"nui-widget-editor-accordion",0),e.ALo(1,"async"),e.ALo(2,"nuiWidgetEditorAccordionFormState"),e.TgZ(3,"div",1),e._UZ(4,"nui-icon",2),e.TgZ(5,"div",3)(6,"span",4),e.SDv(7,5),e.qZA(),e.TgZ(8,"div",6),e._uU(9),e.qZA()()(),e.TgZ(10,"div",7),e.YNc(11,Sl,9,5,"ng-container",8),e.YNc(12,Rl,2,0,"button",9),e.qZA()()),2&t&&(e.Q6J("formGroup",i.form)("state",e.lcZ(1,7,e.lcZ(2,9,i.form))),e.xp6(4),e.Q6J("icon","tag"),e.xp6(4),e.Q6J("title",i.getSubtitle()),e.xp6(1),e.hij(" ",i.getSubtitle()," "),e.xp6(2),e.Q6J("ngForOf",i.getGroupByControl.controls),e.xp6(1),e.Q6J("ngIf",!i.isAddRestricted()))},directives:[De.J,p.JL,p.sg,d.oJW,p.CE,s.sg,s.O5,d.hgI,d.j_n,p.JJ,p.u,d.rLF,d.r0F],pipes:[s.Ov,Fe.F],styles:[".grouping-configuration__accordion-content[_ngcontent-%COMP%]{padding:15px 15px 15px 46px}"],changeDetection:0}),n})();function Nl(n,a){1&n&&(e.TgZ(0,"div",4)(1,"nui-message",5),e.tHW(2,6),e._UZ(3,"b"),e.N_p(),e.qZA()()),2&n&&(e.xp6(1),e.Q6J("allowDismiss",!1))}let Un=(()=>{class n{constructor(t,i,o,r){this.pizzagnaService=t,this.changeDetector=i,this.formBuilder=o,this.eventBus=r,this.tiles=[],this.formReady=new e.vpe}ngOnChanges(t){}onFormReady(t){this.form=this.formBuilder.group({tiles:t}),this.emptyItems$=this.form.valueChanges.pipe((0,It.U)(i=>0===i.tiles.length)),this.formReady.emit(this.form)}onItemsChange(t){const o=t.map(c=>c.id);this.pizzagnaService.createComponentsFromTemplate("tiles",o),this.pizzagnaService.setProperty({componentId:this.componentId,pizzagnaKey:m.xW.Data,propertyPath:["tiles"]},t)}addTile(){this.onItemsChange([...this.tiles,{id:(0,d.VjN)("kpi"),componentType:j.lateLoadKey}])}}return n.lateLoadKey="KpiTilesConfigurationComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(ce.p),e.Y36(e.sBO),e.Y36(p.qu),e.Y36(m.nY))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-kpi-tiles-configuration-component"]],inputs:{componentId:"componentId",tiles:"tiles",nodes:"nodes"},outputs:{formReady:"formReady"},features:[e.TTD],decls:5,vars:5,consts:function(){let a,t;return a=$localize`:␟79e4ae6fc9c1cd1ee331414b873fb40154ad1e95␟5306337511240259794: Add new value
`,t=$localize`:␟7ca16fec6555e99e64e1cbd41a9ce7a4f4cae2fd␟4636957726236815999:${"\ufffd#3\ufffd"}:START_BOLD_TEXT:At least one value must be added.${"\ufffd/#3\ufffd"}:CLOSE_BOLD_TEXT:`,[[3,"items","nodes","itemsChange","formReady"],["class","pl-4 pr-4",4,"ngIf"],["nui-button","","icon","add","displayStyle","action","id","kpi-widget-add-indicator-btn","type","button",1,"ml-4","mb-4",3,"click"],a,[1,"pl-4","pr-4"],["type","critical",3,"allowDismiss"],t]},template:function(t,i){1&t&&(e.TgZ(0,"nui-items-dynamic",0),e.NdJ("itemsChange",function(r){return i.onItemsChange(r)})("formReady",function(r){return i.onFormReady(r)}),e.qZA(),e.YNc(1,Nl,4,1,"div",1),e.ALo(2,"async"),e.TgZ(3,"button",2),e.NdJ("click",function(){return i.addTile()}),e.SDv(4,3),e.qZA()),2&t&&(e.Q6J("items",i.tiles)("nodes",i.nodes),e.xp6(1),e.Q6J("ngIf",e.lcZ(2,3,i.emptyItems$)&&i.form.touched))},directives:[ii,s.O5,d.qqZ,d.r0F],pipes:[s.Ov],encapsulation:2,changeDetection:0}),n})();const Al=["metricsSelect"];function yl(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",9),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("displayValueContext",t.label)("value",t.id),e.xp6(1),e.hij(" ",t.label," ")}}function Ml(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",1)(1,"div")(2,"nui-form-field",2)(3,"nui-select-v2",3,4)(5,"nui-overlay-item",5),e.NdJ("click",function(){return e.CHM(t),e.oxw().unsetMetric()}),e._uU(6,"Unset"),e.qZA(),e.YNc(7,yl,2,3,"nui-select-v2-option",6),e.qZA(),e.TgZ(8,"nui-validation-message",7),e.SDv(9,8),e.qZA()()()()}if(2&n){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("control",t.form.controls.activeMetricId),e.xp6(5),e.Q6J("ngForOf",t.metrics)}}let ri=(()=>{class n{constructor(t,i,o){this.changeDetector=t,this.formBuilder=i,this.logger=o,this.formReady=new e.vpe,this.form=this.formBuilder.group({activeMetricId:[]})}ngOnInit(){this.formReady.emit(this.form)}ngOnChanges(t){var i;t.activeMetricId&&(null===(i=this.form.get("activeMetricId"))||void 0===i||i.setValue(t.activeMetricId.currentValue),this.metrics.find(r=>r.id===t.activeMetricId.currentValue)||this.logger.warn(`AggregatorMetricSelectorConfigurationComponent: No metric found for id: ${t.activeMetricId.currentValue}`))}unsetMetric(){this.form.controls.activeMetricId.reset(),this.meticsSelect.hideDropdown()}}return n.lateLoadKey="AggregatorMetricSelectorConfigurationComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(p.qu),e.Y36(d.mQy))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-aggregator-configurator"]],viewQuery:function(t,i){if(1&t&&e.Gf(Al,5),2&t){let o;e.iGM(o=e.CRH())&&(i.meticsSelect=o.first)}},inputs:{metrics:"metrics",activeMetricId:"activeMetricId"},outputs:{formReady:"formReady"},features:[e.TTD],decls:1,vars:1,consts:function(){let a,t,i;return a=$localize`:␟f43d8212e6ffbc04ea0190118e7f893824ec2686␟8120854355855055890:Default Metric`,t=$localize`:␟25b479494f612322c149610b9b2e3cd4c782c313␟4594093405818643397:Select Value`,i=$localize`:␟b17406f843dc33feb81478ae8273dc1aae06bbf6␟2244196281006156184: This field is required `,[[3,"formGroup",4,"ngIf"],[3,"formGroup"],["caption",a,1,"mb-3",3,"control"],["formControlName","activeMetricId","placeholder",t],["metricsSelect",""],[1,"nui-combobox-v2__popup-box",2,"cursor","pointer",3,"click"],[3,"displayValueContext","value",4,"ngFor","ngForOf"],["for","required"],i,[3,"displayValueContext","value"]]},template:function(t,i){1&t&&e.YNc(0,Ml,10,3,"div",0),2&t&&e.Q6J("ngIf",i.form)},directives:[s.O5,p.JL,p.sg,d.hgI,d.j_n,p.JJ,p.u,d.A4p,s.sg,d.rLF,d.CfE],encapsulation:2,changeDetection:0}),n})();function Pl(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",13),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("displayValueContext",t.label)("value",t.id),e.xp6(1),e.hij(" ",t.label," ")}}function Dl(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",13),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("displayValueContext",t.label)("value",t.id),e.xp6(1),e.hij(" ",t.label," ")}}function bl(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"nui-form-field",3)(3,"nui-select-v2",4,5)(5,"nui-overlay-item",6),e.NdJ("click",function(){return e.CHM(t),e.oxw().unsetMetric()}),e._uU(6,"Unset"),e.qZA(),e.YNc(7,Pl,2,3,"nui-select-v2-option",7),e.qZA(),e.TgZ(8,"nui-validation-message",8),e.SDv(9,9),e.qZA()()(),e.TgZ(10,"div",2)(11,"nui-form-field",10)(12,"nui-select-v2",11),e.YNc(13,Dl,2,3,"nui-select-v2-option",7),e.qZA(),e.TgZ(14,"nui-validation-message",8),e.SDv(15,12),e.qZA()()()()}if(2&n){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("control",t.form.controls.activeMetricId),e.xp6(5),e.Q6J("ngForOf",t.metrics),e.xp6(4),e.Q6J("control",t.form.controls.chartSeriesDataFieldId),e.xp6(2),e.Q6J("ngForOf",t.chartSeriesDataFields)}}const Fl={id:"data[0]",label:"data",dataType:null};let zn=(()=>{class n extends ri{constructor(t,i,o,r){super(t,i,o),this.eventBus=r,this.chartSeriesDataFields=[Fl],this.form=this.formBuilder.group({activeMetricId:[],chartSeriesDataFieldId:[]}),this.destroy$=new ie.x,this.eventBus.getStream(ke.gg).pipe((0,_e.R)(this.destroy$)).subscribe(c=>{var g,E;const P=c.payload;P&&(null===(E=null===(g=P.dataFieldsConfig)||void 0===g?void 0:g.chartSeriesDataFields$)||void 0===E||E.pipe((0,_e.R)(this.destroy$)).subscribe(Z=>this.chartSeriesDataFields=Z))})}ngOnChanges(t){var i;super.ngOnChanges(t),t.chartSeriesDataFieldId&&(null===(i=this.form.get("chartSeriesDataFieldId"))||void 0===i||i.setValue(t.chartSeriesDataFieldId.currentValue))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return n.lateLoadKey="FieldMapperAggregatorConfiguratorComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(p.qu),e.Y36(d.mQy),e.Y36(m.nY))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-field-mapper-aggregator-configurator"]],inputs:{chartSeriesDataFieldId:"chartSeriesDataFieldId"},features:[e.qOj,e.TTD],decls:1,vars:1,consts:function(){let a,t,i,o,r,c;return a=$localize`:␟f43d8212e6ffbc04ea0190118e7f893824ec2686␟8120854355855055890:Default Metric`,t=$localize`:␟25b479494f612322c149610b9b2e3cd4c782c313␟4594093405818643397:Select Value`,i=$localize`:␟b17406f843dc33feb81478ae8273dc1aae06bbf6␟2244196281006156184: This field is required `,o=$localize`:␟8e67f0d2aff5ba1a2d509b591efa53a4d2076369␟5258061076548910132:Chart Series Data Field`,r=$localize`:␟25b479494f612322c149610b9b2e3cd4c782c313␟4594093405818643397:Select Value`,c=$localize`:␟b17406f843dc33feb81478ae8273dc1aae06bbf6␟2244196281006156184: This field is required `,[[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"mb-4"],["caption",a,1,"mb-4",3,"control"],["formControlName","activeMetricId","placeholder",t],["metricsSelect",""],[1,"nui-combobox-v2__popup-box",2,"cursor","pointer",3,"click"],[3,"displayValueContext","value",4,"ngFor","ngForOf"],["for","required"],i,["caption",o,1,"mb-4",3,"control"],["formControlName","chartSeriesDataFieldId","placeholder",r],c,[3,"displayValueContext","value"]]},template:function(t,i){1&t&&e.YNc(0,bl,16,5,"div",0),2&t&&e.Q6J("ngIf",i.form)},directives:[s.O5,p.JL,p.sg,d.hgI,d.j_n,p.JJ,p.u,d.A4p,s.sg,d.rLF,d.CfE],encapsulation:2,changeDetection:0}),n})();function xl(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",22),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("displayValueContext",t.label)("value",t.id),e.xp6(1),e.hij(" ",t.label," ")}}function Ll(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",23),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.label," ")}}function wl(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",23),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t.componentType),e.xp6(1),e.hij(" ",t.label," ")}}let Bn=(()=>{class n{constructor(t,i,o,r){this.changeDetector=t,this.configuratorHeading=i,this.formBuilder=o,this.formReady=new e.vpe,this.form=this.formBuilder.group({type:[void 0,p.kI.required],legendPlacement:[void 0],legendFormatter:this.formBuilder.group({componentType:[void 0]})}),this.chartTypeChanged$=new ie.x,this.destroy$=new ie.x,this.legendFormatters=r.getItems(),this.form.controls.type.valueChanges.pipe((0,_e.R)(this.destroy$)).subscribe(c=>this.chartTypeChanged$.next(c))}ngOnInit(){this.formReady.emit(this.form)}ngOnChanges(t){var i;t.type&&this.form.controls.type.setValue(t.type.currentValue),t.legendPlacement&&this.form.controls.legendPlacement.setValue(t.legendPlacement.currentValue),t.legendFormatter&&(null===(i=this.form.get("legendFormatter.componentType"))||void 0===i||i.setValue(t.legendFormatter.currentValue.componentType))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.chartTypeChanged$.complete()}get chartTitle(){var t;const i=null===(t=this.form.get("type"))||void 0===t?void 0:t.value,o=this.chartTypes.find(r=>r.id===i);return null==o?void 0:o.label}get legendFormatterControl(){return this.form.get("legendFormatter.componentType")}}return n.lateLoadKey="ProportionalChartOptionsEditorV2Component",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(Qe.p),e.Y36(p.qu),e.Y36(ge.qy))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-proportional-chart-options-editor-v2-component"]],inputs:{type:"type",legendPlacement:"legendPlacement",legendFormatter:"legendFormatter",chartTypes:"chartTypes",legendPlacementOptions:"legendPlacementOptions"},outputs:{formReady:"formReady"},features:[e.TTD],decls:35,vars:31,consts:function(){let a,t,i,o,r,c,g,E;return a=$localize`:␟f3ecd72a8d0f15303a8f7f61c278783962a6d00c␟4926288099895660391:Chart Options`,t=$localize`:␟f2102c0b996b067ab2a46c7743fe5931fa47f16d␟7337152278540773645:Chart Type`,i=$localize`:␟35a0bc25979ae578aea9594e8c587200628713e1␟5551943712413491013:Select chart type`,o=$localize`:␟8eb0e5b7a8ec1199d38c9e92ca26bd4b3aae7f2c␟8999046125839025839: This field is required `,r=$localize`:␟5c5419db944ed6a96f9515a2ac0ee390ec8cf3b5␟7297822327994766046:Legend`,c=$localize`:␟8eb0e5b7a8ec1199d38c9e92ca26bd4b3aae7f2c␟8999046125839025839: This field is required `,g=$localize`:␟7f0b920b08ab06e490eff4f718ef3fecc87a719b␟5989769742900149410:Legend format`,E=$localize`:␟c9a9da14b0f8c677efa737185f1232f8537bd2a6␟3224868488156254475: This field is required `,[[3,"formGroup","state"],["accordionHeader","",1,"d-flex","align-items-center","px-4","py-2"],[1,"align-self-start","pt-2",3,"icon"],[1,"d-flex","flex-column","ml-4","pt-1"],[1,"nui-text-label"],a,[1,"nui-text-secondary",3,"title"],[1,"proportional-widget-chart-options-configuration__accordion-content"],[1,"mb-4"],["caption",t,3,"control"],["placeholder",i,"formControlName","type",3,"popupViewportMargin"],[3,"displayValueContext","value",4,"ngFor","ngForOf"],["for","required"],o,["caption",r,3,"showOptionalText","control"],["formControlName","legendPlacement",3,"popupViewportMargin"],[3,"value",4,"ngFor","ngForOf"],c,["formGroupName","legendFormatter"],["caption",g,3,"showOptionalText","control"],["formControlName","componentType",3,"popupViewportMargin"],E,[3,"displayValueContext","value"],[3,"value"]]},template:function(t,i){1&t&&(e.TgZ(0,"nui-widget-editor-accordion",0),e.ALo(1,"async"),e.ALo(2,"nuiWidgetEditorAccordionFormState"),e.TgZ(3,"div",1),e._UZ(4,"nui-icon",2),e.ALo(5,"async"),e.ALo(6,"nuiFormHeaderIconPipe"),e.TgZ(7,"div",3)(8,"span",4),e.SDv(9,5),e.qZA(),e.TgZ(10,"div",6),e._uU(11),e.qZA()()(),e.TgZ(12,"div",7)(13,"div",8)(14,"nui-form-field",9)(15,"nui-select-v2",10),e.ALo(16,"async"),e.YNc(17,xl,2,3,"nui-select-v2-option",11),e.qZA(),e.TgZ(18,"nui-validation-message",12),e.SDv(19,13),e.qZA()()(),e.TgZ(20,"div",8)(21,"nui-form-field",14)(22,"nui-select-v2",15),e.ALo(23,"async"),e.YNc(24,Ll,2,2,"nui-select-v2-option",16),e.qZA(),e.TgZ(25,"nui-validation-message",12),e.SDv(26,17),e.qZA()()(),e.TgZ(27,"div",8),e.ynx(28,18),e.TgZ(29,"nui-form-field",19)(30,"nui-select-v2",20),e.ALo(31,"async"),e.YNc(32,wl,2,2,"nui-select-v2-option",16),e.qZA(),e.TgZ(33,"nui-validation-message",12),e.SDv(34,21),e.qZA()(),e.BQk(),e.qZA()()()),2&t&&(e.Q6J("formGroup",i.form)("state",e.lcZ(1,16,e.lcZ(2,18,i.form))),e.xp6(4),e.Q6J("icon",e.lcZ(5,20,e.xi3(6,22,i.form,"widget_pie-chart"))),e.xp6(6),e.Q6J("title",i.chartTitle),e.xp6(1),e.hij(" ",i.chartTitle," "),e.xp6(3),e.Q6J("control",i.form.controls.type),e.xp6(1),e.Q6J("popupViewportMargin",e.lcZ(16,25,i.configuratorHeading.height$)),e.xp6(2),e.Q6J("ngForOf",i.chartTypes),e.xp6(4),e.Q6J("showOptionalText",!1)("control",i.form.controls.legendPlacement),e.xp6(1),e.Q6J("popupViewportMargin",e.lcZ(23,27,i.configuratorHeading.height$)),e.xp6(2),e.Q6J("ngForOf",i.legendPlacementOptions),e.xp6(5),e.Q6J("showOptionalText",!1)("control",i.legendFormatterControl),e.xp6(1),e.Q6J("popupViewportMargin",e.lcZ(31,29,i.configuratorHeading.height$)),e.xp6(2),e.Q6J("ngForOf",i.legendFormatters))},directives:[De.J,p.JL,p.sg,d.oJW,d.hgI,d.j_n,p.JJ,p.u,s.sg,d.rLF,d.CfE,p.x0],pipes:[s.Ov,Fe.F,Ge.d],styles:[".proportional-widget-chart-options-configuration__accordion-content[_ngcontent-%COMP%]{padding:15px 15px 15px 46px}"],changeDetection:0}),n})();function Gl(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",22),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.label," ")}}function $l(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",22),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t.componentType),e.xp6(1),e.hij(" ",t.label," ")}}function Ul(n,a){}const zl=function(){return["formReady"]};function Bl(n,a){if(1&n){const t=e.EpF();e.ynx(0,27,28),e.NdJ("output",function(o){return e.CHM(t),e.oxw(2).onFormReady(o.payload)}),e.YNc(2,Ul,0,0,"ng-template",29),e.NdJ("attached",function(o){return e.CHM(t),e.MAs(1).attached(o)}),e.BQk()}if(2&n){const t=e.MAs(1),i=e.oxw(2);e.Q6J("componentId",i.getConfigurationComponent())("componentType",i.getConfigurationComponent())("properties",i.configurationComponentProperties)("outputs",e.DdM(5,zl)),e.xp6(2),e.Q6J("cdkPortalOutlet",t.portal)}}function Wl(n,a){if(1&n&&(e.ynx(0,23),e.TgZ(1,"nui-form-field",24)(2,"nui-select-v2",20),e.ALo(3,"async"),e.YNc(4,$l,2,2,"nui-select-v2-option",11),e.qZA(),e.TgZ(5,"nui-validation-message",12),e.SDv(6,25),e.qZA()(),e.YNc(7,Bl,3,6,"ng-container",26),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("showOptionalText",!1)("control",t.form.controls.componentType),e.xp6(1),e.Q6J("popupViewportMargin",e.lcZ(3,5,t.configuratorHeading.height$)),e.xp6(2),e.Q6J("ngForOf",t.contentFormatters),e.xp6(3),e.Q6J("ngIf",!!t.getConfigurationComponent())}}function kl(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",22),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.label," ")}}function Zl(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",22),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t.componentType),e.xp6(1),e.hij(" ",t.label," ")}}const Vl={[Le.DonutChart]:$localize`Donut`,[Le.PieChart]:$localize`Pie`,[Le.VerticalBarChart]:$localize`Vertical Bar`,[Le.HorizontalBarChart]:$localize`Horizontal Bar`};let Wn=(()=>{class n{constructor(t,i,o){this.changeDetector=t,this.configuratorHeading=i,this.formBuilder=o,this.legendPlacement=we.w.None,this.formReady=new e.vpe,this.chartTypeNamesMap=Vl,this.legendFormatters=[],this.contentFormatters=[],this.formatterHasConfigurationComponent=!1,this.currentConfigurationComponent="",this.chartFormatters=[],this.cachedChartOptionsViewModels=[],this.rawFormatter={componentType:"",label:$localize`Raw`,dataTypes:{value:null}}}get chartTypeSelectViewModels(){var t,i,o;return(!this.cachedChartOptionsViewModels||this.cachedChartOptionsViewModels.length!==(null===(i=null===(t=this.chartOptions)||void 0===t?void 0:t.chartTypes)||void 0===i?void 0:i.length))&&(this.cachedChartOptionsViewModels=((null===(o=this.chartOptions)||void 0===o?void 0:o.chartTypes)||[]).map(r=>({label:this.chartTypeNamesMap[r],value:r}))),this.cachedChartOptionsViewModels}get chartTitle(){return this.chartTypeNamesMap[this.form.controls.type.value]}getConfigurationComponent(){var t;return(null===(t=this.getCurrentFormatterDefinition())||void 0===t?void 0:t.configurationComponent)||""}getConfigurationComponentProperties(){this.configurationComponentProperties={contentFormatterProperties:this.contentFormatterProperties,contentFormatterDefinition:this.getCurrentFormatterDefinition(),dsOutput:this.dsOutput}}getCurrentFormatterDefinition(){var t;const i=null===(t=this.form.get("contentFormatter.componentType"))||void 0===t?void 0:t.value;return this.contentFormatters.find(o=>o.componentType===i)}ngOnInit(){this.form=this.formBuilder.group({type:[this.chartType||"",p.kI.required],legendPlacement:this.legendPlacement,legendFormatter:this.formBuilder.group({componentType:this.legendFormatterComponentType||this.rawFormatter.componentType}),contentFormatter:this.formBuilder.group({componentType:this.contentFormatterComponentType})}),this.legendFormatters=[this.rawFormatter,...this.chartOptions.legendFormatters||[]],this.contentFormatters=[...this.chartOptions.contentFormatters||[]],this.formReady.emit(this.form)}ngOnChanges(t){var i,o,r,c;t.chartType&&!t.chartType.isFirstChange()&&(null===(i=this.form.get("type"))||void 0===i||i.setValue(t.chartType.currentValue)),t.legendPlacement&&!t.legendPlacement.isFirstChange()&&(null===(o=this.form.get("legendPlacement"))||void 0===o||o.setValue(t.legendPlacement.currentValue)),t.legendFormatterComponentType&&!t.legendFormatterComponentType.isFirstChange()&&(null===(r=this.form.get("legendFormatter").get("componentType"))||void 0===r||r.setValue(this.legendFormatterComponentType)),t.contentFormatterComponentType&&!t.contentFormatterComponentType.isFirstChange()&&(null===(c=this.form.get("contentFormatter").get("componentType"))||void 0===c||c.setValue(this.contentFormatterComponentType)),this.form&&this.getConfigurationComponentProperties()}onFormReady(t){this.form.get("contentFormatter").setControl("properties",t)}}return n.lateLoadKey="ProportionalChartOptionsEditorComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(Qe.p),e.Y36(p.qu))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-proportional-chart-options-editor-component"]],inputs:{chartOptions:"chartOptions",chartType:"chartType",legendPlacement:"legendPlacement",legendFormatterComponentType:"legendFormatterComponentType",contentFormatterComponentType:"contentFormatterComponentType",contentFormatterProperties:"contentFormatterProperties",dsOutput:"dsOutput"},outputs:{formReady:"formReady"},features:[e.TTD],decls:36,vars:32,consts:function(){let a,t,i,o,r,c,g,E,P,Z;return a=$localize`:␟f3ecd72a8d0f15303a8f7f61c278783962a6d00c␟4926288099895660391:Chart Options`,t=$localize`:␟f2102c0b996b067ab2a46c7743fe5931fa47f16d␟7337152278540773645:Chart Type`,i=$localize`:␟35a0bc25979ae578aea9594e8c587200628713e1␟5551943712413491013:Select chart type`,o=$localize`:␟8eb0e5b7a8ec1199d38c9e92ca26bd4b3aae7f2c␟8999046125839025839: This field is required `,r=$localize`:␟5c5419db944ed6a96f9515a2ac0ee390ec8cf3b5␟7297822327994766046:Legend`,c=$localize`:␟8eb0e5b7a8ec1199d38c9e92ca26bd4b3aae7f2c␟8999046125839025839: This field is required `,g=$localize`:␟7f0b920b08ab06e490eff4f718ef3fecc87a719b␟5989769742900149410:Legend format`,E=$localize`:␟8eb0e5b7a8ec1199d38c9e92ca26bd4b3aae7f2c␟8999046125839025839: This field is required `,P=$localize`:␟7aad3a4ab45c0132aefc2da9c78cde45d3593850␟4108378864701615700:Content format`,Z=$localize`:␟c9a9da14b0f8c677efa737185f1232f8537bd2a6␟3224868488156254475: This field is required `,[[3,"formGroup","state"],["accordionHeader","",1,"d-flex","align-items-center","px-4","py-2"],[1,"align-self-start","pt-2",3,"icon"],[1,"d-flex","flex-column","ml-4","pt-1"],[1,"nui-text-label"],a,[1,"nui-text-secondary",3,"title"],[1,"proportional-widget-chart-options-configuration__accordion-content"],[1,"mb-4"],["caption",t,3,"control"],["formControlName","type","placeholder",i,3,"popupViewportMargin"],[3,"value",4,"ngFor","ngForOf"],["for","required"],o,["formGroupName","contentFormatter",4,"ngIf"],["caption",r,3,"showOptionalText","control"],["formControlName","legendPlacement",3,"popupViewportMargin"],c,["formGroupName","legendFormatter"],["caption",g,3,"showOptionalText","control"],["formControlName","componentType",3,"popupViewportMargin"],E,[3,"value"],["formGroupName","contentFormatter"],["caption",P,1,"mb-4",3,"showOptionalText","control"],Z,["nuiComponentPortal","",3,"componentId","componentType","properties","outputs","output",4,"ngIf"],["nuiComponentPortal","",3,"componentId","componentType","properties","outputs","output"],["componentPortal","nuiComponentPortal"],[3,"cdkPortalOutlet","attached"]]},template:function(t,i){if(1&t&&(e.TgZ(0,"nui-widget-editor-accordion",0),e.ALo(1,"async"),e.ALo(2,"nuiWidgetEditorAccordionFormState"),e.TgZ(3,"div",1),e._UZ(4,"nui-icon",2),e.ALo(5,"async"),e.ALo(6,"nuiFormHeaderIconPipe"),e.TgZ(7,"div",3)(8,"span",4),e.SDv(9,5),e.qZA(),e.TgZ(10,"div",6),e._uU(11),e.qZA()()(),e.TgZ(12,"div",7)(13,"div",8)(14,"nui-form-field",9)(15,"nui-select-v2",10),e.ALo(16,"async"),e.YNc(17,Gl,2,2,"nui-select-v2-option",11),e.qZA(),e.TgZ(18,"nui-validation-message",12),e.SDv(19,13),e.qZA()()(),e.TgZ(20,"div",8),e.YNc(21,Wl,8,7,"ng-container",14),e.qZA(),e.TgZ(22,"div",8)(23,"nui-form-field",15)(24,"nui-select-v2",16),e.ALo(25,"async"),e.YNc(26,kl,2,2,"nui-select-v2-option",11),e.qZA(),e.TgZ(27,"nui-validation-message",12),e.SDv(28,17),e.qZA()()(),e.ynx(29,18),e.TgZ(30,"nui-form-field",19)(31,"nui-select-v2",20),e.ALo(32,"async"),e.YNc(33,Zl,2,2,"nui-select-v2-option",11),e.qZA(),e.TgZ(34,"nui-validation-message",12),e.SDv(35,21),e.qZA()(),e.BQk(),e.qZA()()),2&t){let o;e.Q6J("formGroup",i.form)("state",e.lcZ(1,17,e.lcZ(2,19,i.form))),e.xp6(4),e.Q6J("icon",e.lcZ(5,21,e.xi3(6,23,i.form,"widget_pie-chart"))),e.xp6(6),e.Q6J("title",i.chartTitle),e.xp6(1),e.hij(" ",i.chartTitle," "),e.xp6(3),e.Q6J("control",i.form.controls.type),e.xp6(1),e.Q6J("popupViewportMargin",e.lcZ(16,26,i.configuratorHeading.height$)),e.xp6(2),e.Q6J("ngForOf",i.chartTypeSelectViewModels),e.xp6(4),e.Q6J("ngIf","DonutChart"===(null==(o=i.form.get("type"))?null:o.value)),e.xp6(2),e.Q6J("showOptionalText",!1)("control",i.form.controls.legendPlacement),e.xp6(1),e.Q6J("popupViewportMargin",e.lcZ(25,28,i.configuratorHeading.height$)),e.xp6(2),e.Q6J("ngForOf",i.chartOptions.legendPlacementOptions),e.xp6(4),e.Q6J("showOptionalText",!1)("control",i.form.controls.componentType),e.xp6(1),e.Q6J("popupViewportMargin",e.lcZ(32,30,i.configuratorHeading.height$)),e.xp6(2),e.Q6J("ngForOf",i.legendFormatters)}},directives:[De.J,p.JL,p.sg,d.oJW,d.hgI,d.j_n,p.JJ,p.u,s.sg,d.rLF,d.CfE,s.O5,p.x0,L.$,z.Pl],pipes:[s.Ov,Fe.F,Ge.d],styles:[".proportional-widget-chart-options-configuration__accordion-content[_ngcontent-%COMP%]{padding:15px 15px 15px 46px}"],changeDetection:0}),n})();function Jl(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",18),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("displayValueContext",t.label)("value",t.aggregatorType),e.xp6(1),e.hij(" ",t.label," ")}}function Yl(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",18),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("displayValueContext",t.label)("value",t.componentType),e.xp6(1),e.hij(" ",t.label," ")}}function Hl(n,a){}const kn=function(){return["formReady"]};function Kl(n,a){if(1&n){const t=e.EpF();e.ynx(0,19,20),e.NdJ("output",function(o){return e.CHM(t),e.oxw(2).onFormReady("aggregator",o.payload)}),e.YNc(2,Hl,0,0,"ng-template",21),e.NdJ("attached",function(o){return e.CHM(t),e.MAs(1).attached(o)}),e.BQk()}if(2&n){const t=e.MAs(1),i=e.oxw(2);e.Q6J("componentType",null==i.currentAggregatorDefinition?null:i.currentAggregatorDefinition.configurationComponent)("properties",i.aggregatorConfiguratorProps)("outputs",e.DdM(4,kn)),e.xp6(2),e.Q6J("cdkPortalOutlet",t.portal)}}function Ql(n,a){}function Xl(n,a){if(1&n){const t=e.EpF();e.ynx(0,19,20),e.NdJ("output",function(o){return e.CHM(t),e.oxw(2).onFormReady("formatter",o.payload)}),e.YNc(2,Ql,0,0,"ng-template",21),e.NdJ("attached",function(o){return e.CHM(t),e.MAs(1).attached(o)}),e.BQk()}if(2&n){const t=e.MAs(1),i=e.oxw(2);e.Q6J("componentType",null==i.currentFormatterDefinition?null:i.currentFormatterDefinition.configurationComponent)("properties",i.formatterConfiguratorProps)("outputs",e.DdM(4,kn)),e.xp6(2),e.Q6J("cdkPortalOutlet",t.portal)}}function jl(n,a){if(1&n&&(e.ynx(0,1),e.TgZ(1,"nui-widget-editor-accordion",2),e.ALo(2,"async"),e.ALo(3,"nuiWidgetEditorAccordionFormState"),e.TgZ(4,"div",3),e._UZ(5,"nui-icon",4),e.ALo(6,"async"),e.ALo(7,"nuiFormHeaderIconPipe"),e.TgZ(8,"div",5)(9,"span",6),e.SDv(10,7),e.qZA(),e.TgZ(11,"div",8),e._uU(12),e.qZA()()(),e.TgZ(13,"div",9)(14,"div",10)(15,"nui-form-field",11)(16,"nui-select-v2",12),e.YNc(17,Jl,2,3,"nui-select-v2-option",13),e.qZA()()(),e.TgZ(18,"div",14)(19,"nui-form-field",15)(20,"nui-select-v2",16),e.YNc(21,Yl,2,3,"nui-select-v2-option",13),e.qZA()()(),e.YNc(22,Kl,3,5,"ng-container",17),e.YNc(23,Xl,3,5,"ng-container",17),e.qZA()(),e.BQk()),2&n){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("state",e.lcZ(2,11,e.lcZ(3,13,t.form))),e.xp6(4),e.Q6J("icon",e.lcZ(6,15,e.xi3(7,17,t.form,"customize"))),e.xp6(6),e.Q6J("title",t.subtitleText),e.xp6(1),e.hij(" ",t.subtitleText," "),e.xp6(3),e.Q6J("control",t.form.get("aggregator.aggregatorType")),e.xp6(2),e.Q6J("ngForOf",t.aggregators),e.xp6(2),e.Q6J("control",t.form.get("formatter.componentType")),e.xp6(2),e.Q6J("ngForOf",t.formatters),e.xp6(1),e.Q6J("ngIf",null==t.currentAggregatorDefinition?null:t.currentAggregatorDefinition.configurationComponent),e.xp6(1),e.Q6J("ngIf",null==t.currentFormatterDefinition?null:t.currentFormatterDefinition.configurationComponent)}}let Zn=(()=>{class n{constructor(t,i,o,r,c){this.formBuilder=t,this.changeDetector=i,this.eventBus=o,this.contentFormattersRegistry=r,this.aggregatorRegistry=c,this.formReady=new e.vpe,this.shown=!0,this.form=this.formBuilder.group({formatter:this.formBuilder.group({componentType:[void 0],properties:[]}),aggregator:this.formBuilder.group({aggregatorType:[void 0],properties:[]})}),this.dataFields=[],this.destroy$=new ie.x}ngOnInit(){this.watchFormChanges(),this.setFromRegistry(),this.eventBus.getStream(ke.gg).pipe((0,_e.R)(this.destroy$)).subscribe(t=>{var i;const o=t.payload;o&&(null===(i=o.dataFieldsConfig)||void 0===i||i.dataFields$.pipe((0,_e.R)(this.destroy$)).subscribe(r=>{this.dataFields=r,this.updateAggregatorConfiguratorProps()}))}),this.formReady.emit(this.form)}ngOnChanges(t){var i,o;t.formatter&&(null===(i=this.form.get("formatter"))||void 0===i||i.patchValue(Object.assign({},t.formatter.currentValue))),t.aggregator&&(null===(o=this.form.get("aggregator"))||void 0===o||o.patchValue(Object.assign({},t.aggregator.currentValue))),t.chartType&&(this.shown=t.chartType.currentValue===Le.DonutChart)}ngOnDestroy(){this.destroy$.complete()}onFormReady(t,i){this.form.get(t).setControl("properties",i)}get subtitleText(){var t,i;return`${null===(t=this.currentAggregatorDefinition)||void 0===t?void 0:t.label}, ${null===(i=this.currentFormatterDefinition)||void 0===i?void 0:i.label}`}setFromRegistry(){var t,i;this.formatters=this.contentFormattersRegistry.getItems(),this.aggregators=this.aggregatorRegistry.getItems();let o=this.formatters.find(c=>{var g;return c.componentType===(null===(g=this.formatter)||void 0===g?void 0:g.componentType)});o||(o=this.formatters[0]),null===(t=this.form.get("formatter.componentType"))||void 0===t||t.setValue(o.componentType);let r=this.aggregators.find(c=>{var g;return c.aggregatorType===(null===(g=this.aggregator)||void 0===g?void 0:g.aggregatorType)});r||(r=this.aggregators[0]),null===(i=this.form.get("aggregator.aggregatorType"))||void 0===i||i.setValue(r.aggregatorType)}watchFormChanges(){var t,i;null===(t=this.form.get("aggregator.aggregatorType"))||void 0===t||t.valueChanges.pipe((0,_e.R)(this.destroy$)).subscribe(o=>{this.currentAggregatorDefinition=this.aggregators.find(r=>r.aggregatorType===o),this.updateAggregatorConfiguratorProps()}),null===(i=this.form.get("formatter.componentType"))||void 0===i||i.valueChanges.pipe((0,_e.R)(this.destroy$)).subscribe(o=>{this.currentFormatterDefinition=this.formatters.find(r=>r.componentType===o),this.updateAggregatorConfiguratorProps()})}updateAggregatorConfiguratorProps(){var t,i;this.aggregatorConfiguratorProps=Object.assign(Object.assign(Object.assign({},null===(t=this.currentAggregatorDefinition)||void 0===t?void 0:t.properties),null===(i=this.aggregator)||void 0===i?void 0:i.properties),{metrics:this.dataFields})}}return n.lateLoadKey="DonutContentConfigurationComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(p.qu),e.Y36(e.sBO),e.Y36(m.nY),e.Y36(ge.UA),e.Y36(Ie))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-donut-content-configuration"]],inputs:{chartType:"chartType",formatter:"formatter",aggregator:"aggregator"},outputs:{formReady:"formReady"},features:[e.TTD],decls:1,vars:1,consts:function(){let a,t,i,o,r;return a=$localize`:␟c488fe848f6a00cefad87ff595b384e4e0f7ff1d␟2010665105219070274:Donut Content Configuration`,t=$localize`:␟87181c5142c58c027d97ac0f37b9c6bb78b624cd␟6056551297792932760:Aggregate`,i=$localize`:␟408b4f352f2fec5727e6df77cb926194384bbba0␟736196504450716827:Select Format`,o=$localize`:␟7722a92a1fc887570b4f4d8a7bb916f067f32028␟7513076467032912668:Format`,r=$localize`:␟408b4f352f2fec5727e6df77cb926194384bbba0␟736196504450716827:Select Format`,[[3,"formGroup",4,"ngIf"],[3,"formGroup"],[3,"state"],["accordionHeader","",1,"d-flex","align-items-center","px-4","py-2"],[1,"align-self-start","pt-2",3,"icon"],[1,"d-flex","flex-column","ml-4","pt-1"],[1,"nui-text-label"],a,[1,"nui-text-secondary",3,"title"],[1,"donut-content-configuration__accordion-content"],["formGroupName","aggregator",1,"mb-4"],["caption",t,3,"control"],["placeholder",i,"formControlName","aggregatorType"],[3,"displayValueContext","value",4,"ngFor","ngForOf"],["formGroupName","formatter",1,"mb-4"],["caption",o,3,"control"],["placeholder",r,"formControlName","componentType"],["nuiComponentPortal","","componentId","formatterConfigurator",3,"componentType","properties","outputs","output",4,"ngIf"],[3,"displayValueContext","value"],["nuiComponentPortal","","componentId","formatterConfigurator",3,"componentType","properties","outputs","output"],["componentPortal","nuiComponentPortal"],[3,"cdkPortalOutlet","attached"]]},template:function(t,i){1&t&&e.YNc(0,jl,24,20,"ng-container",0),2&t&&e.Q6J("ngIf",i.shown)},directives:[s.O5,p.JL,p.sg,De.J,d.oJW,p.x0,d.hgI,d.j_n,p.JJ,p.u,s.sg,d.rLF,L.$,z.Pl],pipes:[s.Ov,Fe.F,Ge.d],styles:[".donut-content-configuration__accordion-content[_ngcontent-%COMP%]{padding:15px 15px 15px 46px}"],changeDetection:0}),n})();function Hi(n,a){const t=n.markAsTouched;n.markAsTouched=()=>{t.apply(n,arguments),a()}}function ql(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",19)(2,"nui-form-field",20)(3,"nui-textbox-number",21),e.NdJ("valueChange",function(){return e.CHM(t),e.oxw(2).stub()}),e.qZA(),e.TgZ(4,"nui-validation-message",22),e.SDv(5,23),e.qZA()()(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("control",t.form.controls.width),e.xp6(2),e.Q6J("show",t.form.controls.width.invalid)}}function ed(n,a){1&n&&(e.TgZ(0,"div",19)(1,"nui-message",24),e.tHW(2,25),e._UZ(3,"b"),e.N_p(),e.qZA()()),2&n&&(e.xp6(1),e.Q6J("allowDismiss",!1))}function td(n,a){if(1&n&&(e.ynx(0),e.YNc(1,ql,6,2,"ng-container",17),e.YNc(2,ed,4,1,"div",18),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.isWidthMessageDisplayedForThisColumn()),e.xp6(1),e.Q6J("ngIf",t.isWidthMessageDisplayedForThisColumn())}}let Vn=(()=>{class n{constructor(t,i){this.formBuilder=t,this.changeDetector=i,this.isWidthMessageDisplayed=!1,this.destroy$=new ie.x,this.form=this.formBuilder.group({label:["",[p.kI.required]],isActive:!0,width:void 0}),this.form.valueChanges.pipe((0,_e.R)(this.destroy$)).subscribe(o=>{var r;null===(r=this.changeFn)||void 0===r||r.call(this,o)})}registerOnChange(t){this.changeFn=t}registerOnTouched(t){}setDisabledState(t){t?this.form.disable():this.form.enable()}validate(t){return this.form.valid?null:{nestedForm:!0}}writeValue(t){this.form.patchValue({label:t.label,isActive:t.isActive,width:t.width},{emitEvent:!1}),this.changeDetector.markForCheck()}ngOnInit(){Hi(this.formControl,()=>{this.form.markAllAsTouched()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}stub(){}isWidthMessageDisplayedForThisColumn(){return this.isWidthMessageDisplayed&&"number"!=typeof this.form.controls.width.value}}return n.lateLoadKey="DescriptionConfigurationV2Component",n.\u0275fac=function(t){return new(t||n)(e.Y36(p.qu),e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-description-configuration-v2"]],inputs:{formControl:"formControl",isWidthMessageDisplayed:"isWidthMessageDisplayed"},features:[e._Bn([{provide:p.JU,useExisting:(0,e.Gpc)(()=>n),multi:!0},{provide:p.Cf,useExisting:(0,e.Gpc)(()=>n),multi:!0}])],decls:23,vars:17,consts:function(){let a,t,i,o,r,c,g,E;return a=$localize`:␟eec715de352a6b114713b30b640d319fa78207a0␟4902817035128594900:Description`,t=$localize`:␟863226cffd5b66a6fee9810a9282a5006d6ef576␟4077520913910941990:Label`,i=$localize`:␟c9a9da14b0f8c677efa737185f1232f8537bd2a6␟3224868488156254475: This field is required `,o=$localize`:␟49e97f1ac4309fd5992a9520d74fa732c4a77481␟5413084173448405143:Show this column`,r=$localize`:␟6b3f02f1feab94e0f0a6823f49a009fa7be7dfa9␟8419094197651631948:Column width (px)`,c=$localize`:␟455a91268699c6879146b5fe44595de6628e6d32␟4319439665214681027:Auto width`,g=$localize`:␟356aa3e61db78cca0742edfab898c6bf0c8051a6␟3835988025416576743: Minimum width of the column is 62px `,E=$localize`:␟8e3d3c0a38f0221dc5901334290180f5705a0fbf␟2546138047162560558:${"\ufffd#3\ufffd"}:START_BOLD_TEXT:All columns cannot have fixed width.${"\ufffd/#3\ufffd"}:CLOSE_BOLD_TEXT:`,[[3,"formGroup"],[3,"state"],["accordionHeader","",1,"d-flex","align-items-center","px-4","py-2"],[1,"align-self-start","pt-2",3,"icon"],[1,"d-flex","flex-column","ml-4","w-100","overflow-hidden","pt-1"],[1,"nui-text-label"],a,[1,"nui-text-secondary","nui-text-ellipsis",3,"title"],[1,"description-configuration__accordion-content"],[1,"mb-4"],["caption",t,1,"mb-3",3,"control"],["formControlName","label"],["for","required"],i,[3,"control"],["formControlName","isActive"],o,[4,"ngIf"],["class","mt-4",4,"ngIf"],[1,"mt-4"],["caption",r,1,"mb-3",3,"control"],["placeholder",c,"formControlName","width",1,"description-configuration__accordion-content__width-input",3,"valueChange"],["for","min",3,"show"],g,["type","info",3,"allowDismiss"],E]},template:function(t,i){if(1&t&&(e.ynx(0,0),e.TgZ(1,"nui-widget-editor-accordion",1),e.ALo(2,"async"),e.ALo(3,"nuiWidgetEditorAccordionFormState"),e.TgZ(4,"div",2),e._UZ(5,"nui-icon",3),e.ALo(6,"async"),e.ALo(7,"nuiFormHeaderIconPipe"),e.TgZ(8,"div",4)(9,"span",5),e.SDv(10,6),e.qZA(),e.TgZ(11,"div",7),e._uU(12),e.qZA()()(),e.TgZ(13,"div",8)(14,"div",9)(15,"nui-form-field",10),e._UZ(16,"nui-textbox",11),e.TgZ(17,"nui-validation-message",12),e.SDv(18,13),e.qZA()()(),e.TgZ(19,"nui-form-field",14)(20,"nui-checkbox",15),e.SDv(21,16),e.qZA()(),e.YNc(22,td,3,2,"ng-container",17),e.qZA()(),e.BQk()),2&t){let o;e.Q6J("formGroup",i.form),e.xp6(1),e.Q6J("state",e.lcZ(2,8,e.lcZ(3,10,i.form))),e.xp6(4),e.Q6J("icon",e.lcZ(6,12,e.xi3(7,14,i.form,"widget_list"))),e.xp6(6),e.Q6J("title",i.form.controls.label.value),e.xp6(1),e.hij(" ",i.form.controls.label.value," "),e.xp6(3),e.Q6J("control",i.form.controls.label),e.xp6(4),e.Q6J("control",i.form.controls.isActive),e.xp6(3),e.Q6J("ngIf",null==(o=i.form.get("isActive"))?null:o.value)}},directives:[p.JL,p.sg,De.J,d.oJW,d.hgI,d.XHW,p.JJ,p.u,d.CfE,d.bK4,s.O5,d.I5I,d.qqZ],pipes:[s.Ov,Fe.F,Ge.d],styles:[".description-configuration__accordion-content[_ngcontent-%COMP%]{padding:15px 15px 15px 46px}"],changeDetection:0}),n})();var Jn=l(50793);function id(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",14),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("displayValueContext",t.label)("value",t.componentType),e.xp6(1),e.hij(" ",t.label," ")}}function nd(n,a){}const od=function(){return["formReady"]};function rd(n,a){if(1&n){const t=e.EpF();e.ynx(0,15,16),e.NdJ("output",function(o){return e.CHM(t),e.oxw().onFormReady(o.payload)}),e.YNc(2,nd,0,0,"ng-template",17),e.NdJ("attached",function(o){return e.CHM(t),e.MAs(1).attached(o)}),e.BQk()}if(2&n){const t=e.MAs(1),i=e.oxw();e.Q6J("componentType",i.formatterConfigurator)("properties",i.formatterConfiguratorProps)("outputs",e.DdM(4,od)),e.xp6(2),e.Q6J("cdkPortalOutlet",t.portal)}}let Yn=(()=>{class n{constructor(t,i,o,r,c,g){var E,P,Z;this.formBuilder=t,this.changeDetector=i,this.configuratorHeading=o,this.eventBus=r,this.formattersRegistryCommon=c,this.tableFormattersRegistryService=g,this._dataFields=[],this.onDestroy$=new ie.x,this.providedFormatters=[],this._formatters=[],this.propertiesFormReady=new ie.x,this.subscribeToFormattersRegistry(),this.form=this.formBuilder.group({componentType:this.formBuilder.control(null===(P=null===(E=this.providedFormatters)||void 0===E?void 0:E[0])||void 0===P?void 0:P.componentType,p.kI.required),properties:this.formBuilder.control({},()=>{var U;return(null===(U=this.propertiesForm)||void 0===U?void 0:U.invalid)?{properties:!0}:null})}),null===(Z=this.form.get("componentType"))||void 0===Z||Z.valueChanges.pipe((0,_e.R)(this.onDestroy$)).subscribe(()=>this.createFormatterConfigurator()),this.form.valueChanges.pipe((0,_e.R)(this.onDestroy$)).subscribe(()=>{this.updateSubtitle(),this.onValueChange(),this.changeDetector.detectChanges()}),this.eventBus.subscribeUntil(ke.PF,this.onDestroy$,U=>{const{dataFields:ne}=ni()(U.payload.result)?U.payload:U.payload.result||{};this.dataFields=ne})}set formatters(t){!this.tableFormattersRegistryService.isEmpty||this.handleFormattersUpdate(t)}get formatters(){return this._formatters}set dataFields(t){this._dataFields=t,this.updateAvailableFormatters()}get dataFields(){return this._dataFields}get formatter(){var t;return null===(t=this.form)||void 0===t?void 0:t.value}ngOnInit(){Hi(this.formControl,()=>{this.form.markAllAsTouched(),this.propertiesForm.markAllAsTouched()})}ngOnDestroy(){this.onDestroy$.next(),this.onDestroy$.complete()}ngOnChanges(t){}registerOnChange(t){this.changeFn=t}registerOnTouched(t){this.touchFn=t}setDisabledState(t){}writeValue(t){this.input=t,this.form.patchValue(t,{emitEvent:!1}),this.createFormatterConfigurator(),this.changeDetector.markForCheck()}validate(t){return!this.form.valid||this.propertiesForm&&!this.propertiesForm.valid?{error:"error"}:null}getSelectedFormatterDefinition(){var t,i;if(this.providedFormatters.length>0){const o=null===(t=this.form.get("componentType"))||void 0===t?void 0:t.value;return null!==(i=this.providedFormatters.find(r=>r.componentType===o))&&void 0!==i?i:null}return null}getSelectedDataField(){var t,i;const o=this.form.controls.properties;if(o&&this.dataFields&&this.dataFields.length>0){const r=null===(t=o.value.dataFieldIds)||void 0===t?void 0:t.value;return null!==(i=this.dataFields.find(c=>c.id===r))&&void 0!==i?i:null}return null}ngDoCheck(){if(!this.form||!this.propertiesForm)return;const t=this.form.controls.properties;this.propertiesForm.touched&&t.untouched&&(t.markAsTouched(),this.changeDetector.markForCheck()),this.propertiesForm.untouched&&t.touched&&(t.markAsUntouched(),this.changeDetector.markForCheck())}onFormReady(t){this.propertiesFormReady.next(),this.propertiesForm=t;const i=this.form.controls.properties;i.markAsPristine(),this.propertiesForm.valueChanges.pipe((0,_e.R)(this.propertiesFormReady)).subscribe(()=>{i.setValue(this.propertiesForm.value),this.onValueChange()}),this.propertiesForm.patchValue(this.formatter.properties)}onValueChange(){var t;null===(t=this.changeFn)||void 0===t||t.call(this,this.form.value)}updateSubtitle(){var t,i;this.subtitleText=`${null===(t=this.getSelectedFormatterDefinition())||void 0===t?void 0:t.label}`,this.getSelectedDataField()&&(this.subtitleText=this.subtitleText.concat(`, ${null===(i=this.getSelectedDataField())||void 0===i?void 0:i.label}`))}createFormatterConfigurator(){var t,i,o,r;const c=this.providedFormatters.find(g=>{var E;return g.componentType===(null===(E=this.form.get("componentType"))||void 0===E?void 0:E.value)});this.formatterConfigurator=c?null!==(t=c.configurationComponent)&&void 0!==t?t:"ValueSelectorComponent":null,(null==c?void 0:c.componentType)!==(null===(i=this.formatter)||void 0===i?void 0:i.componentType)&&(null===(r=null===(o=this.formatter)||void 0===o?void 0:o.properties)||void 0===r?void 0:r.dataFieldIds)&&(this.formatter.properties.dataFieldIds={value:null}),this.formatterConfiguratorProps={dataFields:this.dataFields,formatter:this.formatter,formatterDefinition:c}}updateAvailableFormatters(){var t;if(!(null===(t=this._dataFields)||void 0===t?void 0:t.length)||!this.providedFormatters.length)return;const i={null:!0};this._dataFields.forEach(o=>i[o.dataType]=!0),this._formatters=this.providedFormatters.filter(o=>(o.dataTypes.value instanceof Array?o.dataTypes.value:[o.dataTypes.value]).some(c=>i[c])),this.form&&this.createFormatterConfigurator()}subscribeToFormattersRegistry(){this.handleFormattersUpdate(this.formattersRegistry.getItems()),this.formattersRegistry.stateChanged$.pipe((0,_e.R)(this.onDestroy$)).subscribe(t=>{this.handleFormattersUpdate(t)})}handleFormattersUpdate(t){t!==this.providedFormatters&&(this.providedFormatters=(null==t?void 0:t.length)>0?t:Jn.X,this.updateAvailableFormatters())}get formattersRegistry(){return this.formattersRegistryCommon||this.tableFormattersRegistryService}}return n.lateLoadKey="PresentationConfigurationV2Component",n.\u0275fac=function(t){return new(t||n)(e.Y36(p.qu),e.Y36(e.sBO),e.Y36(Qe.p),e.Y36(m.nY),e.Y36(m.m4,8),e.Y36(ge.C))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-presentation-configuration-v2"]],inputs:{formatters:"formatters",dataFieldIds:"dataFieldIds",formControl:"formControl"},features:[e._Bn([{provide:p.JU,useExisting:(0,e.Gpc)(()=>n),multi:!0},{provide:p.Cf,useExisting:(0,e.Gpc)(()=>n),multi:!0}],[{provide:p.gN,useExisting:p.sg}]),e.TTD],decls:20,vars:20,consts:function(){let a,t,i;return a=$localize`:␟3c991a92a6b04b4f5a42f0b72befa96a8d2e809c␟5065098939944125110:Property and formatting`,t=$localize`:␟7722a92a1fc887570b4f4d8a7bb916f067f32028␟7513076467032912668:Format`,i=$localize`:␟408b4f352f2fec5727e6df77cb926194384bbba0␟736196504450716827:Select Format`,[[3,"formGroup"],[3,"state"],["accordionHeader","",1,"d-flex","align-items-center","px-4","py-2"],[1,"align-self-start","pt-2",3,"icon"],[1,"d-flex","flex-column","ml-4","pt-1"],[1,"nui-text-label"],a,[1,"nui-text-secondary",3,"title"],[1,"presentation-configuration__accordion-content"],[1,"mb-4"],["caption",t,3,"control"],["placeholder",i,"formControlName","componentType",3,"popupViewportMargin"],[3,"displayValueContext","value",4,"ngFor","ngForOf"],["nuiComponentPortal","","componentId","formatterConfigurator",3,"componentType","properties","outputs","output",4,"ngIf"],[3,"displayValueContext","value"],["nuiComponentPortal","","componentId","formatterConfigurator",3,"componentType","properties","outputs","output"],["componentPortal","nuiComponentPortal"],[3,"cdkPortalOutlet","attached"]]},template:function(t,i){1&t&&(e.ynx(0,0),e.TgZ(1,"nui-widget-editor-accordion",1),e.ALo(2,"async"),e.ALo(3,"nuiWidgetEditorAccordionFormState"),e.TgZ(4,"div",2),e._UZ(5,"nui-icon",3),e.ALo(6,"async"),e.ALo(7,"nuiFormHeaderIconPipe"),e.TgZ(8,"div",4)(9,"span",5),e.SDv(10,6),e.qZA(),e.TgZ(11,"div",7),e._uU(12),e.qZA()()(),e.TgZ(13,"div",8)(14,"div",9)(15,"nui-form-field",10)(16,"nui-select-v2",11),e.ALo(17,"async"),e.YNc(18,id,2,3,"nui-select-v2-option",12),e.qZA()()(),e.YNc(19,rd,3,5,"ng-container",13),e.qZA()(),e.BQk()),2&t&&(e.Q6J("formGroup",i.form),e.xp6(1),e.Q6J("state",e.lcZ(2,9,e.lcZ(3,11,i.form))),e.xp6(4),e.Q6J("icon",e.lcZ(6,13,e.xi3(7,15,i.form,"customize"))),e.xp6(6),e.Q6J("title",i.subtitleText),e.xp6(1),e.hij(" ",i.subtitleText," "),e.xp6(3),e.Q6J("control",i.form.controls.componentType),e.xp6(1),e.Q6J("popupViewportMargin",e.lcZ(17,18,i.configuratorHeading.height$)),e.xp6(2),e.Q6J("ngForOf",i.formatters),e.xp6(1),e.Q6J("ngIf",i.formatterConfigurator))},directives:[p.JL,p.sg,De.J,d.oJW,d.hgI,d.j_n,p.JJ,p.u,s.sg,d.rLF,s.O5,L.$,z.Pl],pipes:[s.Ov,Fe.F,Ge.d],styles:[".presentation-configuration__accordion-content[_ngcontent-%COMP%]{padding:15px 15px 15px 46px}"],changeDetection:0}),n})(),Hn=(()=>{class n{constructor(t,i){this.formBuilder=t,this.changeDetector=i,this.destroy$=new ie.x,this.isWidthMessageDisplayed=!1,this.form=this.formBuilder.group({description:this.formBuilder.control({}),presentation:this.formBuilder.control({})}),this.form.valueChanges.pipe((0,_e.R)(this.destroy$)).subscribe(o=>{var r;const c=Object.assign(Object.assign({id:null===(r=this.input)||void 0===r?void 0:r.id},o.description),{formatter:o.presentation});this.changeFn(c)})}ngOnInit(){Hi(this.formControl,()=>{this.form.markAllAsTouched()})}registerOnChange(t){this.changeFn=t}registerOnTouched(t){}setDisabledState(t){}validate(t){return this.form.valid?null:{error:"error"}}writeValue(t){this.input=t,this.form.setValue({presentation:(null==t?void 0:t.formatter)||{},description:t},{emitEvent:!1}),this.changeDetector.markForCheck()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return n.lateLoadKey="TableColumnConfigurationComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(p.qu),e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-table-column-configuration"]],inputs:{formControl:"formControl",isWidthMessageDisplayed:"isWidthMessageDisplayed"},features:[e._Bn([{provide:p.JU,useExisting:(0,e.Gpc)(()=>n),multi:!0},{provide:p.Cf,useExisting:(0,e.Gpc)(()=>n),multi:!0}])],decls:3,vars:4,consts:[[3,"formGroup"],[3,"formControl","isWidthMessageDisplayed"],[3,"formControl"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"nui-description-configuration-v2",1)(2,"nui-presentation-configuration-v2",2),e.qZA()),2&t&&(e.Q6J("formGroup",i.form),e.xp6(1),e.Q6J("formControl",i.form.controls.description)("isWidthMessageDisplayed",i.isWidthMessageDisplayed),e.xp6(1),e.Q6J("formControl",i.form.controls.presentation))},directives:[p.JL,p.sg,Vn,p.JJ,p.oH,Yn],encapsulation:2}),n})();var sd=l(90377),Kn=l.n(sd),ad=l(61874);function ld(n,a){if(1&n&&e._UZ(0,"nui-drop-area",16),2&n){const t=e.oxw(3);e.Udp("height",t.draggedItemHeight,"px")}}function dd(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",17),e._UZ(2,"nui-icon",18),e.qZA(),e.BQk(),e.TgZ(3,"span",19),e.ALo(4,"nuiWidgetConfiguratorSectionHeader"),e._uU(5),e.ALo(6,"nuiWidgetConfiguratorSectionHeader"),e.qZA()),2&n){const t=e.oxw(),i=t.$implicit,o=t.index,r=e.oxw(2);e.xp6(3),e.Q6J("title",e.Dn7(4,2,null==i?null:i.value.label,o,r.columnLabel)),e.xp6(2),e.hij(" ",e.Dn7(6,6,null==i?null:i.value.label,o,r.columnLabel)," ")}}function cd(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",20)(1,"button",21),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().index;return e.oxw(2).removeItem(o)}),e.qZA()()}if(2&n){const t=e.oxw().index;e.xp6(1),e.MGl("id","table-widget-remove-column-btn-",t,"")}}function _d(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",10),e.NdJ("cdkDragStarted",function(o){return e.CHM(t),e.oxw(2).cdkDragStarted(o)}),e.YNc(1,ld,1,2,"nui-drop-area",11),e.YNc(2,dd,7,10,"ng-template",null,12,e.W1O),e.YNc(4,cd,2,1,"ng-template",null,13,e.W1O),e.TgZ(6,"nui-widget-configurator-section",14),e._UZ(7,"nui-table-column-configuration",15),e.qZA()()}if(2&n){const t=a.$implicit,i=e.MAs(3),o=e.MAs(5),r=e.oxw(2);e.xp6(6),e.Q6J("headerTextTemplate",i)("headerButtonsTemplate",o),e.xp6(1),e.Q6J("formControl",t)("isWidthMessageDisplayed",r.isWidthMessageDisplayed)}}function ud(n,a){1&n&&(e.TgZ(0,"div",22)(1,"nui-message",23)(2,"b"),e.SDv(3,24),e.qZA()()()),2&n&&(e.xp6(1),e.Q6J("allowDismiss",!1))}function pd(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",2),e.NdJ("cdkDropListDropped",function(o){return e.CHM(t),e.oxw().drop(o)}),e.TgZ(1,"div",3),e.YNc(2,_d,8,4,"div",4),e.YNc(3,ud,4,1,"div",5),e.ALo(4,"async"),e.TgZ(5,"button",6),e.NdJ("click",function(){return e.CHM(t),e.oxw().addColumn()}),e.SDv(6,7),e.qZA(),e.TgZ(7,"button",8),e.NdJ("click",function(){return e.CHM(t),e.oxw().onResetColumns()}),e.SDv(8,9),e.qZA()()()}if(2&n){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("ngForOf",t.columnForms)("ngForTrackBy",t.trackBy),e.xp6(1),e.Q6J("ngIf",e.lcZ(4,4,t.emptyColumns$)&&t.form.touched)}}let Qn=(()=>{class n{constructor(t,i,o,r,c,g,E){this.formBuilder=t,this.changeDetector=i,this.dialogService=o,this.pizzagnaService=r,this.dataSourceManager=c,this.tableFormatterRegistry=g,this.eventBus=E,this.columns=[],this.formReady=new e.vpe,this.dataSourceFields=[],this.isWidthMessageDisplayed=!1,this.columnLabel=$localize`Column`,this.onDestroy$=new ie.x,this.form=this.formBuilder.group({columns:this.formBuilder.array([])}),this.form.controls.columns.valueChanges.pipe((0,_e.R)(this.onDestroy$)).subscribe(P=>{this.isWidthMessageDisplayed=this.getWidthMessageDisplayed(P),this.changeDetector.markForCheck()}),this.eventBus.subscribeUntil(ke.gg,this.onDestroy$,P=>{!P.payload||(this.dataSource=P.payload,this.changeDetector.markForCheck())}),this.eventBus.subscribeUntil(ke.PF,this.onDestroy$,P=>{var Z,U,ne,ue;if(null===(Z=P.payload)||void 0===Z?void 0:Z.error)return;const{dataFields:le}=ni()(P.payload.result)?P.payload:P.payload.result||{};this.dataSourceFields=null!=le?le:[];const Oe=null===(ue=null===(ne=null===(U=this.dataSource)||void 0===U?void 0:U.features)||void 0===ne?void 0:ne.getFeatureConfig(m.ni.DisableTableColumnGeneration))||void 0===ue?void 0:ue.enabled,he=this.mergeColumns(this.dataSourceFields,this.getColumns());(null==he?void 0:he.length)||Oe?this.updateColumns(he):Oe||this.resetColumns(!1),this.changeDetector.markForCheck()}),c.error$.pipe((0,_e.R)(this.onDestroy$)).subscribe(P=>{this.dataSourceError=P,this.changeDetector.markForCheck()})}get columnForms(){return this.form.controls.columns.controls}ngOnInit(){var t,i,o;if(this.formReady.emit(this.form),this.template&&!(null===(t=this.tableFormatterRegistry.getItems())||void 0===t?void 0:t.length)){const r=null===(o=null===(i=this.template)||void 0===i?void 0:i[1].properties)||void 0===o?void 0:o.formatters;this.tableFormatterRegistry.addItems(r)}}ngOnChanges(t){t.columns&&this.updateColumns(this.columns,!1)}ngOnDestroy(){this.onDestroy$.next(),this.onDestroy$.complete()}getColumns(){return this.form.controls.columns.value}updateColumns(t,i=!0){const o=this.form.controls.columns;o.controls=t.map(r=>{const c=new p.NI(r);c.setParent(o);const g=o.controls.find(E=>E.value.id===r.id);return g&&(c.markAsTouched=g.markAsTouched),c}),o.updateValueAndValidity({emitEvent:i}),this.changeDetector.markForCheck()}trackBy(t,i){var o;return null===(o=null==i?void 0:i.value)||void 0===o?void 0:o.id}addColumn(){this.form.controls.columns.push(new p.NI({id:(0,d.VjN)("column"),label:"",isActive:!0,formatter:{}}))}onResetColumns(){var t;this.resetColumns(!!(null===(t=this.getColumns())||void 0===t?void 0:t.length))}resetColumns(t){const i=()=>{var o;const r=null===(o=this.dataSourceFields)||void 0===o?void 0:o.map(c=>({id:(0,d.VjN)("column"),formatter:{componentType:"RawFormatterComponent",properties:{dataFieldIds:{value:c.id}}},isActive:!0,label:c.label,width:void 0,sortable:c.sortable}));this.updateColumns(r)};t?this.dialogService.confirm({title:$localize`Are you sure?`,message:$localize`Resetting the columns will revert them to their default configurations. Do you wish to proceed?`,confirmText:$localize`Reset Columns`}).result.then(r=>{r&&i()},()=>{}):i()}mergeColumns(t,i){const o=t.map(r=>r.id);return i.filter(r=>{var c,g,E,P;return!!(null===(g=null===(c=r.formatter)||void 0===c?void 0:c.properties)||void 0===g?void 0:g.dataFieldIds)&&Kn()(null===(P=null===(E=r.formatter)||void 0===E?void 0:E.properties)||void 0===P?void 0:P.dataFieldIds).some(Z=>o.includes(Z))})}getWidthMessageDisplayed(t){let i=0;for(const o of t)if("number"!=typeof o.width&&i++,i>1)return!1;return!0}moveItem(t,i){const o=this.form.controls.columns,r=o.at(t);o.removeAt(t),o.insert(i,r),this.changeDetector.detectChanges()}removeItem(t){this.form.controls.columns.removeAt(t),this.changeDetector.detectChanges()}drop(t){this.moveItem(t.previousIndex,t.currentIndex)}cdkDragStarted(t){this.draggedItemHeight=t.source.element.nativeElement.offsetHeight}}return n.lateLoadKey="TableColumnsConfigurationV2Component",n.\u0275fac=function(t){return new(t||n)(e.Y36(p.qu),e.Y36(e.sBO),e.Y36(d.xAy),e.Y36(ce.p),e.Y36(ad.q),e.Y36(ge.C),e.Y36(m.nY))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-table-columns-configuration"]],inputs:{columns:"columns",componentId:"componentId",template:"template"},outputs:{formReady:"formReady"},features:[e.TTD],decls:2,vars:1,consts:function(){let a,t,i;return a=$localize`:␟5d48cb2ef826d59b1522d72e9909067bbffc0cd8␟4528805165676686479: Add new column `,t=$localize`:␟35328f1fffd2017d6248e5e862bef9e325aca7e9␟5405644315909491800: Reset columns `,i=$localize`:␟de46acf5ee4d137a30dbc57e48aef06379e6e500␟8256146955477966251:At least one column must be added.`,[[1,"nui-table-columns-configuration"],["cdkDropList","",3,"formGroup","cdkDropListDropped",4,"ngIf"],["cdkDropList","",3,"formGroup","cdkDropListDropped"],["formArrayName","columns"],["cdkDrag","","class","nui-table-columns-configuration__node-item",3,"cdkDragStarted",4,"ngFor","ngForOf","ngForTrackBy"],["class","pl-4 pr-4",4,"ngIf"],["nui-button","","icon","add","displayStyle","action","id","table-widget-add-indicator-btn","type","button",1,"ml-4","mb-4",3,"click"],a,["nui-button","","icon","reset","displayStyle","action","id","table-widget-reset-indicator-btn","type","button",1,"ml-4","mb-4",3,"click"],t,["cdkDrag","",1,"nui-table-columns-configuration__node-item",3,"cdkDragStarted"],["class","nui-table-columns-configuration__drop-area",3,"height",4,"cdkDragPlaceholder"],["headerText",""],["headerButtons",""],[1,"no-margin",3,"headerTextTemplate","headerButtonsTemplate"],[3,"formControl","isWidthMessageDisplayed"],[1,"nui-table-columns-configuration__drop-area"],["cdkDragHandle","",1,"nui-table-columns-configuration__drag-handler"],["icon","drag"],[1,"nui-table-columns-configuration__header-text",3,"title"],[1,"d-flex"],["nui-button","","type","button","icon","delete","displayStyle","action",3,"id","click"],[1,"pl-4","pr-4"],["type","critical",3,"allowDismiss"],i]},template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,pd,9,6,"div",1),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",!i.dataSourceError&&i.dataSourceFields.length))},directives:[s.O5,et.Wj,p.JL,p.sg,p.CE,s.sg,et.Zt,et.Hk,qt,et.Bh,d.oJW,d.r0F,He,Hn,p.JJ,p.oH,d.qqZ],pipes:[Wi,s.Ov],styles:[".nui-table-columns-configuration__header-text{white-space:nowrap;overflow:hidden;-ms-text-overflow:ellipsis;text-overflow:ellipsis}.nui-table-columns-configuration__drag-handler{cursor:move;display:flex}.nui-table-columns-configuration__node-item{background-color:var(--nui-color-bg-light,#fff);margin:15px}.nui-table-columns-configuration__node-item .widget-configurator-section{margin:0}.nui-table-columns-configuration__drop-area{margin:15px}.cdk-drag-preview{z-index:2000!important;opacity:.9;box-shadow:0 0 5px 0 var(--nui-shadow-color, rgba(17, 17, 17, .3))}\n"],encapsulation:2,changeDetection:0}),n})();function gd(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",19)(2,"nui-form-field",20)(3,"nui-textbox-number",21),e.NdJ("valueChange",function(){return e.CHM(t),e.oxw(2).stub()}),e.qZA(),e.TgZ(4,"nui-validation-message",22),e.SDv(5,23),e.qZA()()(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("control",t.form.controls.width),e.xp6(2),e.Q6J("show",t.form.controls.width.invalid)}}function hd(n,a){1&n&&(e.TgZ(0,"nui-message",24),e.tHW(1,25),e._UZ(2,"b"),e.N_p(),e.qZA()),2&n&&e.Q6J("allowDismiss",!1)}function md(n,a){if(1&n&&(e.ynx(0),e.YNc(1,gd,6,2,"ng-container",17),e.YNc(2,hd,3,1,"nui-message",18),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.isWidthMessageDisplayed),e.xp6(1),e.Q6J("ngIf",t.isWidthMessageDisplayed)}}let fd=(()=>{class n{constructor(t,i){this.formBuilder=t,this.changeDetector=i,this.formReady=new e.vpe,this.formDestroy=new e.vpe}ngOnInit(){var t;this.form=this.formBuilder.group({label:[this.label||null,[p.kI.required]],isActive:null===(t=this.isActive)||void 0===t||t,width:this.width||void 0}),this.formReady.emit(this.form)}ngOnChanges(t){var i,o,r;t.label&&(null===(i=this.form)||void 0===i||i.patchValue({label:t.label.currentValue})),t.isActive&&(null===(o=this.form)||void 0===o||o.patchValue({isActive:t.isActive.currentValue})),t.width&&(null===(r=this.form)||void 0===r||r.patchValue({width:t.width.currentValue}))}stub(){}ngOnDestroy(){this.formDestroy.emit(this.form)}}return n.lateLoadKey="DescriptionConfigurationComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(p.qu),e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-table-column-description-configuration"]],inputs:{label:"label",isActive:"isActive",width:"width",isWidthMessageDisplayed:"isWidthMessageDisplayed"},outputs:{formReady:"formReady",formDestroy:"formDestroy"},features:[e.TTD],decls:23,vars:17,consts:function(){let a,t,i,o,r,c,g,E;return a=$localize`:␟eec715de352a6b114713b30b640d319fa78207a0␟4902817035128594900:Description`,t=$localize`:␟863226cffd5b66a6fee9810a9282a5006d6ef576␟4077520913910941990:Label`,i=$localize`:␟c9a9da14b0f8c677efa737185f1232f8537bd2a6␟3224868488156254475: This field is required `,o=$localize`:␟49e97f1ac4309fd5992a9520d74fa732c4a77481␟5413084173448405143:Show this column`,r=$localize`:␟6b3f02f1feab94e0f0a6823f49a009fa7be7dfa9␟8419094197651631948:Column width (px)`,c=$localize`:␟455a91268699c6879146b5fe44595de6628e6d32␟4319439665214681027:Auto width`,g=$localize`:␟356aa3e61db78cca0742edfab898c6bf0c8051a6␟3835988025416576743: Minimum width of the column is 62px `,E=$localize`:␟ed094d9c3b5f802e6adca32349fb4756bfad4786␟5991148749044556035:${"\ufffd#2\ufffd"}:START_BOLD_TEXT:All columns can not have fixed width.${"\ufffd/#2\ufffd"}:CLOSE_BOLD_TEXT:`,[[3,"formGroup"],[3,"state"],["accordionHeader","",1,"d-flex","align-items-center","px-4","py-2"],[1,"align-self-start","pt-2",3,"icon"],[1,"d-flex","flex-column","ml-4","w-100","overflow-hidden","pt-1"],[1,"nui-text-label"],a,[1,"nui-text-secondary","nui-text-ellipsis",3,"title"],[1,"description-configuration__accordion-content"],[1,"mb-4"],["caption",t,1,"mb-3",3,"control"],["formControlName","label"],["for","required"],i,[3,"control"],["formControlName","isActive"],o,[4,"ngIf"],["type","info",3,"allowDismiss",4,"ngIf"],[1,"mt-4"],["caption",r,1,"mb-3",3,"control"],["placeholder",c,"formControlName","width",1,"description-configuration__accordion-content__width-input",3,"valueChange"],["for","min",3,"show"],g,["type","info",3,"allowDismiss"],E]},template:function(t,i){if(1&t&&(e.ynx(0,0),e.TgZ(1,"nui-widget-editor-accordion",1),e.ALo(2,"async"),e.ALo(3,"nuiWidgetEditorAccordionFormState"),e.TgZ(4,"div",2),e._UZ(5,"nui-icon",3),e.ALo(6,"async"),e.ALo(7,"nuiFormHeaderIconPipe"),e.TgZ(8,"div",4)(9,"span",5),e.SDv(10,6),e.qZA(),e.TgZ(11,"div",7),e._uU(12),e.qZA()()(),e.TgZ(13,"div",8)(14,"div",9)(15,"nui-form-field",10),e._UZ(16,"nui-textbox",11),e.TgZ(17,"nui-validation-message",12),e.SDv(18,13),e.qZA()()(),e.TgZ(19,"nui-form-field",14)(20,"nui-checkbox",15),e.SDv(21,16),e.qZA()(),e.YNc(22,md,3,2,"ng-container",17),e.qZA()(),e.BQk()),2&t){let o;e.Q6J("formGroup",i.form),e.xp6(1),e.Q6J("state",e.lcZ(2,8,e.lcZ(3,10,i.form))),e.xp6(4),e.Q6J("icon",e.lcZ(6,12,e.xi3(7,14,i.form,"widget_list"))),e.xp6(6),e.Q6J("title",i.form.controls.label.value),e.xp6(1),e.hij(" ",i.form.controls.label.value," "),e.xp6(3),e.Q6J("control",i.form.controls.label),e.xp6(4),e.Q6J("control",i.form.controls.isActive),e.xp6(3),e.Q6J("ngIf",null==(o=i.form.get("isActive"))?null:o.value)}},directives:[p.JL,p.sg,De.J,d.oJW,d.hgI,d.XHW,p.JJ,p.u,d.CfE,d.bK4,s.O5,d.I5I,d.qqZ],pipes:[s.Ov,Fe.F,Ge.d],styles:[".description-configuration__accordion-content[_ngcontent-%COMP%]{padding:15px 15px 15px 46px}"],changeDetection:0}),n})(),Ki=(()=>{class n{constructor(t,i,o,r){this.changeDetector=t,this.configuratorHeading=i,this.formBuilder=o,this.logger=r,this.formReady=new e.vpe,this.dropdownItems={}}ngOnChanges(t){t.formatterDefinition&&(this.mapDropdownItems(),this.initForm()),t.dataFields&&this.mapDropdownItems(),t.formatter&&this.updateForm()}mapDropdownItems(){this.dataFields?this.dropdownItems=Object.keys(this.formatterDefinition.dataTypes).reduce((t,i)=>{const o=this.formatterDefinition.dataTypes[i];return t[i]=o?this.dataFields.filter(r=>"string"==typeof o?r.dataType===o:o.includes(r.dataType)):this.dataFields,t},{}):this.logger.error("There are no dataFields defined for formatter:",this.formatterDefinition)}get dataFieldIds(){return this.form.get("dataFieldIds")}initForm(){const i=Object.keys(this.formatterDefinition.dataTypes||{}).reduce((o,r)=>{var c,g,E,P;return o[r]=[null!==(P=null===(E=null===(g=null===(c=this.formatter)||void 0===c?void 0:c.properties)||void 0===g?void 0:g.dataFieldIds)||void 0===E?void 0:E[r])&&void 0!==P?P:null,p.kI.required],o},{});this.form=this.formBuilder.group({dataFieldIds:this.formBuilder.group(i)}),this.addCustomFormControls(this.form),this.formReady.emit(this.form)}updateForm(){var t;this.form.patchValue(null!==(t=this.formatter.properties)&&void 0!==t?t:{},{onlySelf:!1,emitEvent:!1})}addCustomFormControls(t){}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(e.sBO),e.LFG(Qe.p),e.LFG(p.qu),e.LFG(d.mQy))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();function Td(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",13),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.label," ")}}function Cd(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",13),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.label," ")}}let Od=(()=>{class n extends Ki{constructor(t,i,o,r){super(t,i,o,r)}initForm(){this.form=this.formBuilder.group({dataFieldIds:this.formBuilder.group({link:[null,p.kI.required],value:[null,p.kI.required]}),targetSelf:[!1]}),this.formReady.emit(this.form)}}return n.lateLoadKey="LinkConfiguratorComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(Qe.p),e.Y36(p.qu),e.Y36(d.mQy))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-link-configurator"]],features:[e.qOj],decls:17,vars:6,consts:function(){let a,t,i,o,r;return a=$localize`:label field caption| the entity field to be selected for the
                    html label property␟0b86bb6b0b2a82f208239974d253b86395143503␟7152588193113320722:Label`,t=$localize`:␟8eb0e5b7a8ec1199d38c9e92ca26bd4b3aae7f2c␟8999046125839025839: This field is required `,i=$localize`:url field caption| the entity field to be selected for the
                    url html property␟ab9389f13cf14de62c26ae2d6d29351d72d8ca9e␟8752860715344063998:URL`,o=$localize`:␟8eb0e5b7a8ec1199d38c9e92ca26bd4b3aae7f2c␟8999046125839025839: This field is required `,r=$localize`:form field caption|switch configuring whether formatted link
                should open in new window/tab␟21e975dab4148f3f1b43017b9df1312910d25a21␟1433694158029413710:Open in the same window`,[[3,"formGroup"],["formGroupName","dataFieldIds"],[1,"mb-4"],["caption",a,1,"mb-3",3,"control"],["formControlName","value"],[3,"value",4,"ngFor","ngForOf"],["for","required"],t,["caption",i,1,"mb-3",3,"control"],["formControlName","link"],o,["caption",r,1,"mb-3",3,"control"],["id","nui-switch-target","formControlName","targetSelf"],[3,"value"]]},template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"nui-form-field",3)(4,"nui-select-v2",4),e.YNc(5,Td,2,2,"nui-select-v2-option",5),e.qZA(),e.TgZ(6,"nui-validation-message",6),e.SDv(7,7),e.qZA()()(),e.TgZ(8,"div")(9,"nui-form-field",8)(10,"nui-select-v2",9),e.YNc(11,Cd,2,2,"nui-select-v2-option",5),e.qZA(),e.TgZ(12,"nui-validation-message",6),e.SDv(13,10),e.qZA()()()(),e.TgZ(14,"div")(15,"nui-form-field",11),e._UZ(16,"nui-switch",12),e.qZA()()()),2&t&&(e.Q6J("formGroup",i.form),e.xp6(3),e.Q6J("control",i.dataFieldIds.controls.value),e.xp6(2),e.Q6J("ngForOf",i.dropdownItems.value),e.xp6(4),e.Q6J("control",i.dataFieldIds.controls.link),e.xp6(2),e.Q6J("ngForOf",i.dropdownItems.link),e.xp6(4),e.Q6J("control",i.form.controls.targetSelf))},directives:[p.JL,p.sg,p.x0,d.hgI,d.j_n,p.JJ,p.u,s.sg,d.rLF,d.CfE,d.qUD],encapsulation:2}),n})();function Id(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",8),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("displayValueContext",t.label)("value",t.id),e.xp6(1),e.hij(" ",t.label," ")}}function vd(n,a){if(1&n&&(e.TgZ(0,"div",1)(1,"div",2)(2,"nui-form-field",3)(3,"nui-select-v2",4),e.ALo(4,"async"),e.YNc(5,Id,2,3,"nui-select-v2-option",5),e.qZA(),e.TgZ(6,"nui-validation-message",6),e.SDv(7,7),e.qZA()()()()),2&n){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("control",t.dataFieldIds.controls.value),e.xp6(1),e.Q6J("popupViewportMargin",e.lcZ(4,4,t.configuratorHeading.height$)),e.xp6(2),e.Q6J("ngForOf",t.dropdownItems.value)}}let Ed=(()=>{class n extends Ki{constructor(t,i,o,r){super(t,i,o,r)}}return n.lateLoadKey="ValueSelectorComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(Qe.p),e.Y36(p.qu),e.Y36(d.mQy))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-value-selector"]],features:[e.qOj],decls:1,vars:1,consts:function(){let a,t,i;return a=$localize`:␟5049e204c14c648691ac775a64fb504467aeb549␟6555318547274416232:Value`,t=$localize`:␟25b479494f612322c149610b9b2e3cd4c782c313␟4594093405818643397:Select Value`,i=$localize`:␟b17406f843dc33feb81478ae8273dc1aae06bbf6␟2244196281006156184: This field is required `,[[3,"formGroup",4,"ngIf"],[3,"formGroup"],["formGroupName","dataFieldIds"],["caption",a,1,"mb-3",3,"control"],["formControlName","value","placeholder",t,3,"popupViewportMargin"],[3,"displayValueContext","value",4,"ngFor","ngForOf"],["for","required"],i,[3,"displayValueContext","value"]]},template:function(t,i){1&t&&e.YNc(0,vd,8,6,"div",0),2&t&&e.Q6J("ngIf",i.form)},directives:[s.O5,p.JL,p.sg,p.x0,d.hgI,d.j_n,p.JJ,p.u,s.sg,d.rLF,d.CfE],pipes:[s.Ov],encapsulation:2}),n})();var Sd=l(27501),Rd=l.n(Sd);function Nd(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",14),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("displayValueContext",t.label)("value",t.componentType),e.xp6(1),e.hij(" ",t.label," ")}}function Ad(n,a){}const yd=function(){return["formReady"]};function Md(n,a){if(1&n){const t=e.EpF();e.ynx(0,15,16),e.NdJ("output",function(o){return e.CHM(t),e.oxw().onFormReady(o.payload)}),e.YNc(2,Ad,0,0,"ng-template",17),e.NdJ("attached",function(o){return e.CHM(t),e.MAs(1).attached(o)}),e.BQk()}if(2&n){const t=e.MAs(1),i=e.oxw();e.Q6J("componentType",i.formatterConfigurator)("properties",i.formatterConfiguratorProps)("outputs",e.DdM(4,yd)),e.xp6(2),e.Q6J("cdkPortalOutlet",t.portal)}}let Xn=(()=>{class n{constructor(t,i,o,r,c){this.formBuilder=t,this.changeDetector=i,this.configuratorHeading=o,this.formattersRegistryCommon=r,this.tableFormattersRegistryService=c,this._providedFormatters=[],this._formatters=[],this._dataFields=[],this.formReady=new e.vpe,this.formDestroy=new e.vpe,this.formatterForm=this.formBuilder.group({}),this.formatterFormGroupName="formatter",this.onDestroy$=new ie.x,this.subscribeToFormattersRegistry()}set formatters(t){!this.tableFormattersRegistryService.isEmpty||this.handleFormattersUpdate(t)}get formatters(){return this._formatters}set dataFields(t){this._dataFields=t,this.updateAvailableFormatters()}get dataFields(){return this._dataFields}ngOnInit(){var t;this.formatterForm=this.formBuilder.group({componentType:[this.formatter&&this.formatter.componentType||this._providedFormatters&&this._providedFormatters.length>0&&this._providedFormatters[0].componentType,[p.kI.required]]}),this.form=this.formBuilder.group({[this.formatterFormGroupName]:this.formatterForm}),null===(t=this.formatterForm.get("componentType"))||void 0===t||t.valueChanges.pipe((0,_e.R)(this.onDestroy$)).subscribe(()=>this.createFormatterConfigurator()),this.createFormatterConfigurator(),this.formReady.emit(this.form),this.formatterForm.valueChanges.pipe((0,_e.R)(this.onDestroy$)).subscribe(()=>{this.updateSubtitle(),this.changeDetector.detectChanges()})}ngAfterViewInit(){}ngOnChanges(t){var i;if(t.dataFieldIds){const{currentValue:o,previousValue:r}=t.dataFieldIds;if(o&&o!==r){const c=o.map(g=>({id:g,label:Rd()(g)}));this.dataFields=c,this.updateSubtitle()}}t.formatter&&(null===(i=this.form)||void 0===i||i.patchValue({[this.formatterFormGroupName]:t.formatter.currentValue},{emitEvent:!1}),this.updateSubtitle()),t.dataFields&&0===t.dataFields.previousValue.length&&this.formatterForm&&this.updateSubtitle()}getSelectedFormatterDefinition(){var t,i;if(this._providedFormatters.length>0){const o=null===(t=this.formatterForm.get("componentType"))||void 0===t?void 0:t.value;return null!==(i=this._providedFormatters.find(r=>r.componentType===o))&&void 0!==i?i:null}return null}getSelectedDataField(){var t,i;const o=this.formatterForm.controls.properties;if(o&&this.dataFields&&this.dataFields.length>0){const r=null===(t=o.get("dataFieldIds"))||void 0===t?void 0:t.value.value;return null!==(i=this.dataFields.find(c=>c.id===r))&&void 0!==i?i:null}return null}onFormReady(t){this.form.get(this.formatterFormGroupName).setControl("properties",t)}updateSubtitle(){var t,i;this.subtitleText=`${null===(t=this.getSelectedFormatterDefinition())||void 0===t?void 0:t.label}`,this.getSelectedDataField()&&(this.subtitleText=this.subtitleText.concat(`, ${null===(i=this.getSelectedDataField())||void 0===i?void 0:i.label}`))}createFormatterConfigurator(){var t,i,o,r;const c=this._providedFormatters.find(g=>{var E;return g.componentType===(null===(E=this.formatterForm.get("componentType"))||void 0===E?void 0:E.value)});this.formatterConfigurator=c?null!==(t=c.configurationComponent)&&void 0!==t?t:"ValueSelectorComponent":null,(null==c?void 0:c.componentType)!==(null===(i=this.formatter)||void 0===i?void 0:i.componentType)&&(null===(r=null===(o=this.formatter)||void 0===o?void 0:o.properties)||void 0===r?void 0:r.dataFieldIds)&&(this.formatter.properties.dataFieldIds={value:null}),this.formatterConfiguratorProps={dataFields:this.dataFields,formatter:this.formatter,formatterDefinition:c}}updateAvailableFormatters(){if(!this._dataFields.length||!this._providedFormatters.length)return;const t={null:!0};this._dataFields.forEach(i=>t[i.dataType]=!0),this._formatters=this._providedFormatters.filter(i=>(i.dataTypes.value instanceof Array?i.dataTypes.value:[i.dataTypes.value]).some(r=>t[r])),this.formatterForm&&this.createFormatterConfigurator()}subscribeToFormattersRegistry(){this.handleFormattersUpdate(this.formattersRegistry.getItems()),this.formattersRegistry.stateChanged$.pipe((0,st.b)(this.handleFormattersUpdate.bind(this)),(0,_e.R)(this.onDestroy$)).subscribe()}handleFormattersUpdate(t){t!==this._providedFormatters&&(this._providedFormatters=t,this.updateAvailableFormatters())}get formattersRegistry(){return this.formattersRegistryCommon||this.tableFormattersRegistryService}ngOnDestroy(){this.formDestroy.emit(this.form),this.onDestroy$.next(),this.onDestroy$.complete()}}return n.lateLoadKey="PresentationConfigurationComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(p.qu),e.Y36(e.sBO),e.Y36(Qe.p),e.Y36(m.m4,8),e.Y36(ge.C))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-table-column-presentation-configuration"]],inputs:{formatter:"formatter",formatters:"formatters",dataFieldIds:"dataFieldIds",dataFields:"dataFields"},outputs:{formReady:"formReady",formDestroy:"formDestroy"},features:[e._Bn([],[{provide:p.gN,useExisting:p.sg}]),e.TTD],decls:20,vars:20,consts:function(){let a,t,i;return a=$localize`:␟3c991a92a6b04b4f5a42f0b72befa96a8d2e809c␟5065098939944125110:Property and formatting`,t=$localize`:␟7722a92a1fc887570b4f4d8a7bb916f067f32028␟7513076467032912668:Format`,i=$localize`:␟408b4f352f2fec5727e6df77cb926194384bbba0␟736196504450716827:Select Format`,[[3,"formGroup"],[3,"state"],["accordionHeader","",1,"d-flex","align-items-center","px-4","py-2"],[1,"align-self-start","pt-2",3,"icon"],[1,"d-flex","flex-column","ml-4","pt-1"],[1,"nui-text-label"],a,[1,"nui-text-secondary",3,"title"],[1,"presentation-configuration__accordion-content"],[1,"mb-4"],["caption",t,3,"control"],["placeholder",i,"formControlName","componentType",3,"popupViewportMargin"],[3,"displayValueContext","value",4,"ngFor","ngForOf"],["nuiComponentPortal","","componentId","formatterConfigurator",3,"componentType","properties","outputs","output",4,"ngIf"],[3,"displayValueContext","value"],["nuiComponentPortal","","componentId","formatterConfigurator",3,"componentType","properties","outputs","output"],["componentPortal","nuiComponentPortal"],[3,"cdkPortalOutlet","attached"]]},template:function(t,i){1&t&&(e.ynx(0,0),e.TgZ(1,"nui-widget-editor-accordion",1),e.ALo(2,"async"),e.ALo(3,"nuiWidgetEditorAccordionFormState"),e.TgZ(4,"div",2),e._UZ(5,"nui-icon",3),e.ALo(6,"async"),e.ALo(7,"nuiFormHeaderIconPipe"),e.TgZ(8,"div",4)(9,"span",5),e.SDv(10,6),e.qZA(),e.TgZ(11,"div",7),e._uU(12),e.qZA()()(),e.TgZ(13,"div",8)(14,"div",9)(15,"nui-form-field",10)(16,"nui-select-v2",11),e.ALo(17,"async"),e.YNc(18,Nd,2,3,"nui-select-v2-option",12),e.qZA()()(),e.YNc(19,Md,3,5,"ng-container",13),e.qZA()(),e.BQk()),2&t&&(e.Q6J("formGroup",i.formatterForm),e.xp6(1),e.Q6J("state",e.lcZ(2,9,e.lcZ(3,11,i.form))),e.xp6(4),e.Q6J("icon",e.lcZ(6,13,e.xi3(7,15,i.form,"customize"))),e.xp6(6),e.Q6J("title",i.subtitleText),e.xp6(1),e.hij(" ",i.subtitleText," "),e.xp6(3),e.Q6J("control",i.formatterForm.controls.componentType),e.xp6(1),e.Q6J("popupViewportMargin",e.lcZ(17,18,i.configuratorHeading.height$)),e.xp6(2),e.Q6J("ngForOf",i.formatters),e.xp6(1),e.Q6J("ngIf",i.formatterConfigurator))},directives:[p.JL,p.sg,De.J,d.oJW,d.hgI,d.j_n,p.JJ,p.u,s.sg,d.rLF,s.O5,L.$,z.Pl],pipes:[s.Ov,Fe.F,Ge.d],styles:[".presentation-configuration__accordion-content[_ngcontent-%COMP%]{padding:15px 15px 15px 46px}"],changeDetection:0}),n})();function Pd(n,a){1&n&&(e.TgZ(0,"div",6)(1,"nui-message",7),e.tHW(2,8),e._UZ(3,"b"),e.N_p(),e.qZA()()),2&n&&(e.xp6(1),e.Q6J("allowDismiss",!1))}let Dd=(()=>{class n{constructor(t,i,o,r,c){this.formBuilder=t,this.changeDetector=i,this.dialogService=o,this.pizzagnaService=r,this.eventBus=c,this.columns=[],this.formatters=[],this.dataFields=[],this.formReady=new e.vpe,this.onDestroy$=new ie.x,this.lastValidDataFields=[],this.eventBus.subscribeUntil(ke.gg,this.onDestroy$,g=>{!g.payload||(this.dataSource=g.payload)}),this.eventBus.subscribeUntil(ke.PF,this.onDestroy$,g=>{var E;const{dataFields:P}=ni()(g.payload.result)?g.payload:g.payload.result||{};if(P){let Z=this.pizzagnaService.pizzagna;Z=(0,d.zdu)(Z,`${m.xW.Data}.columns.properties.dataFields`,P);const ne=(null===(E=this.pizzagnaService.pizzagna[m.xW.Structure].columns.properties)||void 0===E?void 0:E.template).findIndex(he=>"presentation"===he.id);Z=(0,d.zdu)(Z,`${m.xW.Structure}.columns.properties.template[${ne}].properties.dataFields`,P),Z=Ht()(this.pizzagnaService.pizzagna,`${m.xW.Data}.columns.properties.columns`).map(he=>he.id).reduce((he,Se)=>(0,d.zdu)(he,`${m.xW.Data}.${Se}/presentation.properties.dataFields`,P),Z),this.pizzagnaService.updatePizzagna(Z),this.eventBus.getStream(T.M).next({payload:{path:"",value:Z}})}})}ngOnInit(){}ngOnChanges(t){var i,o,r;if(t.dataFields&&t.dataFields.currentValue){this.lastValidDataFields=t.dataFields.currentValue;const c=null===(r=null===(o=null===(i=this.dataSource)||void 0===i?void 0:i.features)||void 0===o?void 0:o.getFeatureConfig(m.ni.DisableTableColumnGeneration))||void 0===r?void 0:r.enabled,g=this.mergeColumns(t.dataFields.currentValue,this.columns);(null==g?void 0:g.length)||c?this.onItemsChange(g):c||this.resetColumns(!1),setTimeout(()=>this.changeDetector.markForCheck())}if(t.columns){const c=this.columns.map(g=>({id:g.id,children:{[`${g.id}/description`]:Object.assign({},g),[`${g.id}/presentation`]:Object.assign({},g)}}));this.pizzagnaService.createComponentsFromTemplateWithProperties("columns",c),setTimeout(()=>{var g,E,P;null===(g=this.form.get("columns"))||void 0===g||g.setValue([...null!==(P=null===(E=this.form.get("columns"))||void 0===E?void 0:E.value)&&void 0!==P?P:[]])})}}onFormReady(t){var i;this.form=this.formBuilder.group({columns:t,columnsOutput:{}}),this.emptyColumns$=this.form.valueChanges.pipe((0,It.U)(o=>0===o.columns.length)),this.formReady.emit(this.form),null===(i=this.form.get("columns"))||void 0===i||i.valueChanges.subscribe(o=>{var r;const c=o.map(g=>{var E,P;let Z={id:g.id};for(const U of Object.keys(g.properties))Z=Object.assign(Object.assign({},Z),g.properties[U]);return Z.sortable=null===(P=null===(E=this.lastValidDataFields)||void 0===E?void 0:E.find(U=>{var ne,ue,le;return U.id===(null===(le=null===(ue=null===(ne=Z.formatter)||void 0===ne?void 0:ne.properties)||void 0===ue?void 0:ue.dataFieldIds)||void 0===le?void 0:le.value)}))||void 0===P?void 0:P.sortable,Z});null===(r=this.form.get("columnsOutput"))||void 0===r||r.setValue(c)})}onItemsChange(t){const o=t.map(c=>c.id);this.pizzagnaService.createComponentsFromTemplate("columns",o),this.pizzagnaService.setProperty({componentId:this.componentId,pizzagnaKey:m.xW.Data,propertyPath:["columns"]},t)}addColumn(){this.onItemsChange([...this.columns,{id:(0,d.VjN)("column"),label:"",formatter:void 0}])}onResetColumns(){var t;this.resetColumns(!!(null===(t=this.columns)||void 0===t?void 0:t.length))}resetColumns(t){const i=()=>{const o=this.lastValidDataFields.map(r=>({id:(0,d.VjN)("column"),formatter:{componentType:"RawFormatterComponent",properties:{dataFieldIds:{value:r.id}}},isActive:!0,label:r.label,width:void 0,sortable:r.sortable}));this.onItemsChange(o)};t?this.dialogService.confirm({title:$localize`Are you sure?`,message:$localize`Resetting the columns will revert them to their default configurations. Do you wish to proceed?`,confirmText:$localize`Reset Columns`}).result.then(r=>{r&&i()},()=>{}):i()}mergeColumns(t,i){const o=t.map(r=>r.id);return i.filter(r=>{var c,g,E,P;return!!(null===(g=null===(c=r.formatter)||void 0===c?void 0:c.properties)||void 0===g?void 0:g.dataFieldIds)&&Kn()(null===(P=null===(E=r.formatter)||void 0===E?void 0:E.properties)||void 0===P?void 0:P.dataFieldIds).some(Z=>o.includes(Z))})}ngOnDestroy(){this.onDestroy$.next(),this.onDestroy$.complete()}}return n.lateLoadKey="TableColumnsConfigurationComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(p.qu),e.Y36(e.sBO),e.Y36(d.xAy),e.Y36(ce.p),e.Y36(m.nY))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-table-columns-configuration"]],inputs:{columns:"columns",formatters:"formatters",componentId:"componentId",dataFields:"dataFields",nodes:"nodes"},outputs:{formReady:"formReady"},features:[e.TTD],decls:7,vars:5,consts:function(){let a,t,i,o;return a=$localize`:␟e3c2715ed7f11ed4ac89f4153d8557f182a6918e␟763982378603811482:Column`,t=$localize`:␟71b3b6b8f687cdb01eafe73ac62da2e1e5b87af9␟5086057767318144098: Add new column
`,i=$localize`:␟74cee6ce69c809bb4e67d7cc9e16478a67f9e58d␟4978445162559740484: Reset columns
`,o=$localize`:␟67705586cab07e9ae4f2a9822320fa14e7fb60a7␟8157770720263764419:${"\ufffd#3\ufffd"}:START_BOLD_TEXT:At least one column must be added.${"\ufffd/#3\ufffd"}:CLOSE_BOLD_TEXT:`,[["headerPrefix",a,3,"items","nodes","itemsChange","formReady"],["class","pl-4 pr-4",4,"ngIf"],["nui-button","","icon","add","displayStyle","action","id","table-widget-add-indicator-btn","type","button",1,"ml-4","mb-4",3,"click"],t,["nui-button","","icon","reset","displayStyle","action","id","table-widget-reset-indicator-btn","type","button",1,"ml-4","mb-4",3,"click"],i,[1,"pl-4","pr-4"],["type","critical",3,"allowDismiss"],o]},template:function(t,i){1&t&&(e.TgZ(0,"nui-items-dynamic",0),e.NdJ("itemsChange",function(r){return i.onItemsChange(r)})("formReady",function(r){return i.onFormReady(r)}),e.qZA(),e.YNc(1,Pd,4,1,"div",1),e.ALo(2,"async"),e.TgZ(3,"button",2),e.NdJ("click",function(){return i.addColumn()}),e.SDv(4,3),e.qZA(),e.TgZ(5,"button",4),e.NdJ("click",function(){return i.onResetColumns()}),e.SDv(6,5),e.qZA()),2&t&&(e.Q6J("items",i.columns)("nodes",i.nodes),e.xp6(1),e.Q6J("ngIf",e.lcZ(2,3,i.emptyColumns$)&&i.form.touched))},directives:[ii,s.O5,d.qqZ,d.r0F],pipes:[s.Ov],encapsulation:2,changeDetection:0}),n})();function bd(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",18),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.label," ")}}function Fd(n,a){1&n&&(e.TgZ(0,"nui-message",19),e.tHW(1,20),e._UZ(2,"b"),e.N_p(),e.qZA()),2&n&&e.Q6J("allowDismiss",!1)}let jn=(()=>{class n{constructor(t,i,o){this.formBuilder=t,this.configuratorHeading=i,this.changeDetector=o,this.columns=[],this.formReady=new e.vpe,this.sortableColumns=[],this.onDestroy$=new ie.x}ngOnInit(){this.form=this.formBuilder.group({sorterConfiguration:this.formBuilder.group({sortBy:Ht()(this.sorterConfiguration,"sortBy",""),descendantSorting:Ht()(this.sorterConfiguration,"descendantSorting",!1)})}),this.form.valueChanges.pipe((0,_e.R)(this.onDestroy$)).subscribe(t=>{this.setAccordionSubtitleValues(t)}),this.formReady.emit(this.form)}ngOnChanges(t){var i,o,r,c;const g=null===(i=this.form.get("sorterConfiguration"))||void 0===i?void 0:i.get("sortBy"),E=null===(o=this.form.get("sorterConfiguration"))||void 0===o?void 0:o.get("descendantSorting");if(t.sorterConfiguration){const P=this.sortableColumns.find(Z=>{var U;return Z.id===(null===(U=this.sorterConfiguration)||void 0===U?void 0:U.sortBy)});null==g||g.setValue(null==P?void 0:P.id,{emitEvent:!1}),null==E||E.setValue(null===(r=this.sorterConfiguration)||void 0===r?void 0:r.descendantSorting,{emitEvent:!1})}if(t.columns){this.sortableColumns=this.columns.filter(Z=>{var U;return!!Z.formatter&&(null===(U=Z.sortable)||void 0===U||U)});const P=this.sortableColumns.find(Z=>{var U;return Z.id===(null===(U=this.sorterConfiguration)||void 0===U?void 0:U.sortBy)});null==g||g.setValue(null==P?void 0:P.id,{emitEvent:!1}),null==E||E.setValue(null===(c=this.sorterConfiguration)||void 0===c?void 0:c.descendantSorting,{emitEvent:!1}),0===this.sortableColumns.length?(null==g||g.disable(),null==E||E.disable()):(null==g||g.enable(),null==E||E.enable())}this.changeDetector.detectChanges()}setAccordionSubtitleValues(t){var i,o;if(t.sorterConfiguration){const r=null===(i=this.columns)||void 0===i?void 0:i.find(g=>g.id===t.sorterConfiguration.sortBy);if(!r)return this.selectedSortByValue=$localize`No sorting`,this.selectedSortOrderValue="",void(null===(o=this.form.get("sorterConfiguration"))||void 0===o||o.patchValue({sortBy:"",descendantSorting:""},{emitEvent:!1}));const c=t.sorterConfiguration.descendantSorting?$localize`Descending`:$localize`Ascending`;this.selectedSortByValue=r.label,this.selectedSortOrderValue=", "+c,this.changeDetector.detectChanges()}}ngOnDestroy(){this.onDestroy$.next(),this.onDestroy$.complete()}}return n.lateLoadKey="TableFiltersEditorComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(p.qu),e.Y36(Qe.p),e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-table-filters-editor-component"]],inputs:{sorterConfiguration:"sorterConfiguration",columns:"columns"},outputs:{formReady:"formReady"},features:[e.TTD],decls:20,vars:11,consts:function(){let a,t,i,o,r;return a=$localize`:␟2a63d63538326cdbebb382ee400f9c2ac4ba26eb␟2774613742044941352:Sorting`,t=$localize`:␟ec97f67072a83aaa972536b18d83179f6e4bbec9␟7699622144571229146:Sort by`,i=$localize`:␟e9d403d84c2efea04f713258598abc6dc8fab8bc␟270381191166569688:Select column`,o=$localize`:␟00c361649822cfeeb5fad8e44bf6c9b9fbcc9852␟7343210469772540594: Descending `,r=$localize`:␟73a7df661af2f227feac942adb7cec0474f2b208␟1677678378385679212:${"\ufffd#2\ufffd"}:START_BOLD_TEXT:No columns are sortable.${"\ufffd/#2\ufffd"}:CLOSE_BOLD_TEXT:`,[[3,"formGroup"],["accordionHeader","",1,"d-flex","align-items-center","px-4","py-2"],["icon","widget_pie-chart",1,"align-self-start","pt-2"],[1,"d-flex","flex-column","ml-4","pt-1"],[1,"nui-text-label"],a,[1,"nui-text-secondary",3,"title"],[1,"table-filters-configuration__accordion-content"],["formGroupName","sorterConfiguration",1,"d-flex","align-items-end"],["caption",t,1,"w-50",3,"control"],["placeholder",i,"formControlName","sortBy",1,"table-filters-configuration__accordion-content__sort-by-input",3,"popupViewportMargin"],[3,"value",4,"ngFor","ngForOf"],[1,"ml-2"],[3,"control"],["formControlName","descendantSorting"],o,[1,"p-5"],["type","info",3,"allowDismiss",4,"ngIf"],[3,"value"],["type","info",3,"allowDismiss"],r]},template:function(t,i){1&t&&(e.TgZ(0,"nui-widget-editor-accordion",0)(1,"div",1),e._UZ(2,"nui-icon",2),e.TgZ(3,"div",3)(4,"span",4),e.SDv(5,5),e.qZA(),e.TgZ(6,"div",6),e._uU(7),e.qZA()()(),e.TgZ(8,"div",7)(9,"div",8)(10,"nui-form-field",9)(11,"nui-select-v2",10),e.ALo(12,"async"),e.YNc(13,bd,2,2,"nui-select-v2-option",11),e.qZA()(),e.TgZ(14,"div",12)(15,"nui-form-field",13)(16,"nui-checkbox",14),e.SDv(17,15),e.qZA()()()()(),e.TgZ(18,"div",16),e.YNc(19,Fd,3,1,"nui-message",17),e.qZA()()),2&t&&(e.Q6J("formGroup",i.form),e.xp6(6),e.Q6J("title",i.selectedSortByValue+i.selectedSortOrderValue),e.xp6(1),e.AsE(" ",i.selectedSortByValue,"",i.selectedSortOrderValue," "),e.xp6(3),e.Q6J("control",i.form.controls.sortBy),e.xp6(1),e.Q6J("popupViewportMargin",e.lcZ(12,9,i.configuratorHeading.height$)),e.xp6(2),e.Q6J("ngForOf",i.sortableColumns),e.xp6(2),e.Q6J("control",i.form.controls.descendantSorting),e.xp6(4),e.Q6J("ngIf",!i.sortableColumns.length))},directives:[De.J,p.JL,p.sg,d.oJW,p.x0,d.hgI,d.j_n,p.JJ,p.u,s.sg,d.rLF,d.bK4,s.O5,d.qqZ],pipes:[s.Ov],styles:[".table-filters-configuration__accordion-content[_ngcontent-%COMP%]{padding:15px 15px 15px 46px}"],changeDetection:0}),n})();function xd(n,a){1&n&&(e.TgZ(0,"div",3)(1,"nui-message",4),e.tHW(2,5),e._UZ(3,"b"),e.N_p(),e.qZA()()),2&n&&(e.xp6(1),e.Q6J("allowDismiss",!1))}function Ld(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",6),e.NdJ("click",function(){return e.CHM(t),e.oxw().addSeries()}),e.SDv(1,7),e.qZA()}}let qn=(()=>{class n{constructor(t,i,o){this.pizzagnaService=t,this.changeDetector=i,this.eventBus=o,this.series=[],this.formReady=new e.vpe,this.destroy$=new ie.x}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}ngOnChanges(t){t.allSeries&&!t.allSeries.isFirstChange()&&(this.createSeriesConfigComponents(this.series),setTimeout(()=>this.changeDetector.markForCheck()))}onFormReady(t){this.form=t,this.formReady.emit(t),this.emptySeries$=this.form.valueChanges.pipe((0,It.U)(i=>0===i.length))}onItemsChange(t){this.createSeriesConfigComponents(t),this.pizzagnaService.setProperty({componentId:this.componentId,pizzagnaKey:m.xW.Data,propertyPath:["series"]},t)}isPossibleToAddSeries(){return(this.allSeries&&this.allSeries.length)>(this.series&&this.series.length)}addSeries(){this.onItemsChange([...this.series,{id:(0,d.VjN)("series"),selectedSeriesId:null}])}createSeriesConfigComponents(t){const o=t.map(r=>r.id);this.pizzagnaService.createComponentsFromTemplate("series",o)}}return n.lateLoadKey="TimeseriesSeriesCollectionConfigurationComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(ce.p),e.Y36(e.sBO),e.Y36(m.nY))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-timeseries-series-collection-configuration"]],inputs:{nodes:"nodes",componentId:"componentId",series:"series",availableSeries:"availableSeries",allSeries:"allSeries"},outputs:{formReady:"formReady"},features:[e.TTD],decls:4,vars:7,consts:function(){let a,t;return a=$localize`:␟46a7534407b391db85f57b5fd207e4288d7901c1␟4355007031052301783:${"\ufffd#3\ufffd"}:START_BOLD_TEXT:At least one series must be added.${"\ufffd/#3\ufffd"}:CLOSE_BOLD_TEXT:`,t=$localize`:␟6231821a0315549db22f614abdf9b5e9b036a0ca␟8188707268253933960: Add new series
`,[[3,"items","nodes","moveButtons","itemsChange","formReady"],["class","pl-4 pr-4",4,"ngIf"],["nui-button","","icon","add","displayStyle","action","type","button","class","ml-4 mb-4",3,"click",4,"ngIf"],[1,"pl-4","pr-4"],["type","critical",3,"allowDismiss"],a,["nui-button","","icon","add","displayStyle","action","type","button",1,"ml-4","mb-4",3,"click"],t]},template:function(t,i){1&t&&(e.TgZ(0,"nui-items-dynamic",0),e.NdJ("itemsChange",function(r){return i.onItemsChange(r)})("formReady",function(r){return i.onFormReady(r)}),e.qZA(),e.YNc(1,xd,4,1,"div",1),e.ALo(2,"async"),e.YNc(3,Ld,2,0,"button",2)),2&t&&(e.Q6J("items",i.series)("nodes",i.nodes)("moveButtons",!1),e.xp6(1),e.Q6J("ngIf",e.lcZ(2,5,i.emptySeries$)&&i.form.touched),e.xp6(2),e.Q6J("ngIf",i.isPossibleToAddSeries()))},directives:[ii,s.O5,d.qqZ,d.r0F],pipes:[s.Ov],encapsulation:2,changeDetection:0}),n})(),eo=(()=>{class n{constructor(t,i){this.formBuilder=t,this.changeDetector=i,this.formReady=new e.vpe,this.formDestroy=new e.vpe}ngOnInit(){this.form=this.formBuilder.group({label:[this.label,p.kI.required]}),this.formReady.emit(this.form)}ngOnChanges(t){if(t.label){const i=t.label.currentValue;i&&this.form.patchValue({label:i})}}ngOnDestroy(){this.formDestroy.emit(this.form)}}return n.lateLoadKey="TimeseriesTileDescriptionConfigurationComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(p.qu),e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-table-column-description-configuration"]],inputs:{label:"label"},outputs:{formReady:"formReady",formDestroy:"formDestroy"},features:[e.TTD],decls:20,vars:22,consts:function(){let a,t,i,o;return a=$localize`:␟eec715de352a6b114713b30b640d319fa78207a0␟4902817035128594900:Description`,t=$localize`:␟863226cffd5b66a6fee9810a9282a5006d6ef576␟4077520913910941990:Label`,i=$localize`:␟8f40d8c34a1e732d86581f53b3ed6ff4e1baf8b5␟725093659603391179:Set label`,o=$localize`:␟8eb0e5b7a8ec1199d38c9e92ca26bd4b3aae7f2c␟8999046125839025839: This field is required `,[[3,"formGroup"],[3,"state"],["accordionHeader","",1,"d-flex","align-items-center","px-4","py-2"],[1,"align-self-start","pt-2",3,"icon","iconColor"],[1,"d-flex","flex-column","ml-4","pt-1"],[1,"nui-text-label"],a,[1,"nui-text-secondary",3,"title"],[1,"timeseries-tile-description-configuration__accordion-content"],["caption",t,3,"control"],["formControlName","label","placeholder",i],["for","required"],o]},template:function(t,i){if(1&t&&(e.ynx(0,0),e.TgZ(1,"nui-widget-editor-accordion",1),e.ALo(2,"async"),e.ALo(3,"nuiWidgetEditorAccordionFormState"),e.TgZ(4,"div",2),e._UZ(5,"nui-icon",3),e.ALo(6,"async"),e.ALo(7,"nuiFormHeaderIconPipe"),e.ALo(8,"async"),e.ALo(9,"nuiFormHeaderIconPipe"),e.TgZ(10,"div",4)(11,"span",5),e.SDv(12,6),e.qZA(),e.TgZ(13,"div",7),e._uU(14),e.qZA()()(),e.TgZ(15,"div",8)(16,"nui-form-field",9),e._UZ(17,"nui-textbox",10),e.TgZ(18,"nui-validation-message",11),e.SDv(19,12),e.qZA()()()(),e.BQk()),2&t){let o,r;e.Q6J("formGroup",i.form),e.xp6(1),e.Q6J("state",e.lcZ(2,7,e.lcZ(3,9,i.form.get("label")))),e.xp6(4),e.Q6J("icon",e.lcZ(6,11,e.xi3(7,13,i.form.get("label"),"edit")))("iconColor",e.lcZ(8,16,e.Dn7(9,18,i.form.get("label"),"gray",""))),e.xp6(8),e.Q6J("title",null==(o=i.form.get("label"))?null:o.value),e.xp6(1),e.hij(" ",null==(r=i.form.get("label"))?null:r.value," "),e.xp6(2),e.Q6J("control",i.form.get("label"))}},directives:[p.JL,p.sg,De.J,d.oJW,d.hgI,d.XHW,p.JJ,p.u,d.CfE],pipes:[s.Ov,Fe.F,Ge.d],styles:[".timeseries-tile-description-configuration__accordion-content[_ngcontent-%COMP%]{padding:15px 15px 15px 46px}"],changeDetection:0}),n})();function wd(n,a){if(1&n&&(e.TgZ(0,"nui-select-v2-option",14),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.description," ")}}let to=(()=>{class n{constructor(t,i,o,r){this.changeDetector=t,this.configuratorHeading=i,this.formBuilder=o,this.pizzagnaService=r,this.formReady=new e.vpe,this.formDestroy=new e.vpe,this.destroy$=new ie.x}set selectedSeries(t){this._selectedSeries=t,t&&this.form.patchValue({id:t.id})}get selectedSeries(){return this._selectedSeries}ngOnInit(){this.form=this.formBuilder.group({id:[this.selectedSeriesId||null,[p.kI.required]]}),this.formReady.emit(this.form)}ngOnChanges(t){if(t.allSeries&&(this.selectedSeries=this.allSeries.find(i=>this.selectedSeriesId===i.id)),t.selectedSeriesId){if(!this.allSeries)return;this.selectedSeries=this.allSeries.find(i=>this.selectedSeriesId===i.id)}}onSelect(t){this.selectedSeriesId=t.id,this.selectedSeries=t,this.form.patchValue({id:t.id}),setTimeout(()=>{this.pizzagnaService.setProperty(`${m.xW.Data}.${this.componentId}.properties.selectedSeriesId`,t.id),this.changeDetector.markForCheck()})}ngOnDestroy(){this.formDestroy.emit(this.form),this.destroy$.next(),this.destroy$.complete()}}return n.lateLoadKey="TimeseriesTileIndicatorDataConfigurationComponent",n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(Qe.p),e.Y36(p.qu),e.Y36(ce.p))},n.\u0275cmp=e.Xpm({type:n,selectors:[["nui-timeseries-tile-indicator-data-configuration"]],inputs:{componentId:"componentId",selectedSeriesId:"selectedSeriesId",allSeries:"allSeries",availableSeries:"availableSeries"},outputs:{formReady:"formReady",formDestroy:"formDestroy"},features:[e.TTD],decls:21,vars:23,consts:function(){let a,t,i,o;return a=$localize`:␟f39271d40a9c081425a980174610625a267d18f7␟8676967573592446270:Indicator data`,t=$localize`:␟c5efb3039d96058120ee5d8148ceeb972d8d4e1f␟3385528249572340947:Series data`,i=$localize`:␟c5efb3039d96058120ee5d8148ceeb972d8d4e1f␟3385528249572340947:Series data`,o=$localize`:␟8eb0e5b7a8ec1199d38c9e92ca26bd4b3aae7f2c␟8999046125839025839: This field is required `,[[3,"formGroup"],[3,"state"],["accordionHeader","",1,"d-flex","align-items-center","px-4","py-2"],[1,"align-self-start","pt-2",3,"icon"],[1,"d-flex","flex-column","ml-4","pt-1"],[1,"nui-text-label"],a,[1,"nui-text-secondary",3,"title"],[1,"timeseries-tile-data-configuration__accordion-content"],["caption",t,3,"control"],["placeholder",i,3,"value","popupViewportMargin","valueSelected"],[3,"value",4,"ngFor","ngForOf"],["for","required"],o,[3,"value"]]},template:function(t,i){1&t&&(e.ynx(0,0),e.TgZ(1,"nui-widget-editor-accordion",1),e.ALo(2,"async"),e.ALo(3,"nuiWidgetEditorAccordionFormState"),e.TgZ(4,"div",2),e._UZ(5,"nui-icon",3),e.ALo(6,"async"),e.ALo(7,"nuiFormHeaderIconPipe"),e.TgZ(8,"div",4)(9,"span",5),e.SDv(10,6),e.qZA(),e.TgZ(11,"div",7),e._uU(12),e.qZA()()(),e.TgZ(13,"div",8)(14,"nui-form-field",9)(15,"nui-select-v2",10),e.NdJ("valueSelected",function(r){return i.onSelect(r)}),e.ALo(16,"async"),e.YNc(17,wd,2,2,"nui-select-v2-option",11),e.ALo(18,"nuiAddData"),e.qZA(),e.TgZ(19,"nui-validation-message",12),e.SDv(20,13),e.qZA()()()(),e.BQk()),2&t&&(e.Q6J("formGroup",i.form),e.xp6(1),e.Q6J("state",e.lcZ(2,9,e.lcZ(3,11,i.form.get("id")))),e.xp6(4),e.Q6J("icon",e.lcZ(6,13,e.xi3(7,15,i.form.get("id"),"database"))),e.xp6(6),e.Q6J("title",null==i.selectedSeries?null:i.selectedSeries.description),e.xp6(1),e.hij(" ",null==i.selectedSeries?null:i.selectedSeries.description," "),e.xp6(2),e.Q6J("control",i.form.get("id")),e.xp6(1),e.Q6J("value",i.selectedSeries)("popupViewportMargin",e.lcZ(16,18,i.configuratorHeading.height$)),e.xp6(2),e.Q6J("ngForOf",e.xi3(18,20,i.availableSeries,i.selectedSeries)))},directives:[p.JL,p.sg,De.J,d.oJW,d.hgI,d.j_n,s.sg,d.rLF,d.CfE],pipes:[s.Ov,Fe.F,Ge.d,ki],styles:[".timeseries-tile-data-configuration__accordion-content[_ngcontent-%COMP%]{padding:15px 15px 15px 46px}"],changeDetection:0}),n})();var Gd=l(4235),io=(l(73193),l(42971));let Ud=(()=>{class n{static getTextColor(t){return new h.kJ9(new h.jpW([t]),{light:"white",dark:"black"}).get(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();var no=l(94526);let oo=(()=>{class n{constructor(t,i){this.configuratorService=t,this.componentPortalService=i}open(t){if(!t.portalBundle){const i={portal:this.componentPortalService.createComponentPortal(Sn,null),attached:o=>{o.instance.cloneSelectionComponentType=t.widgetSelectionComponentType}};t.portalBundle=i}return this.configuratorService.open(t)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(io.J),e.LFG(no.$))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();var zd=l(67517);l(75675),l(41294),l(42911),l(27463),l(60167);const ro=[gn.n,St,Gd.P,Wt,An,Ft,Un,Ji,Mn,Wn,Bn,jn,Ln,qn,Dd,Qn,Hn,yn,wi,mn,Gi,fn,$i.C,ti,Od,Ed,ei.s,In,zi,Bt.a,Ui,Dn,xn,Rt,He,Da.b,Sn,fd,Vn,Xn,Yn,eo,to,Fn,Nn,$n,wn,Zn,ri,zn];let so=(()=>{class n{constructor(t){for(const i of ro.filter(o=>o.lateLoadKey))t.registerByLateLoadKey(i)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(xi.h))},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[io.J,Qe.p,va.e,zd.s,oo,Ud,cn,Dt],imports:[[C.Cl,A,p.UX,v.IX,et._t,z.eL,d.Gsl,un,d.Ts3,d.r$w,d.cnx,d.F__,d.ILf,d.YMY,d.C6o,d.Az_,d.s2z,d.qAs,d.CUE,d.LRI,d.uCA,d.Ld5,d.CND,d.a51,d.cJ5,d.gkT,d.grO,d.bGb,d.a$t,d.ZuS,d.sF0]]}),n})();l(16041),l(44994);const kd={[m.xW.Structure]:{[T.XM]:{id:T.XM,componentType:St.lateLoadKey,properties:{elementClass:"flex-grow-1 overflow-auto nui-scroll-shadows",nodes:["presentation","dataAndCalculations"]}},presentation:{id:"presentation",componentType:He.lateLoadKey,properties:{headerText:$localize`Presentation`,nodes:["titleAndDescription"]}},titleAndDescription:{id:"titleAndDescription",componentType:Rt.lateLoadKey,providers:{converter:{providerId:T.j4}}},dataAndCalculations:{id:"dataAndCalculations",componentType:He.lateLoadKey,properties:{headerText:$localize`Data and calculations`,nodes:["dataSource","grouping","entityFormatting"]}},dataSource:{id:"dataSource",componentType:Wt.lateLoadKey,properties:{dataSourceProviders:[]},providers:{[m.Mu.Converter]:{providerId:T.VX,properties:{formParts:[{previewPath:"/.providers.dataSource",keys:["providerId"]}]}}}},grouping:{id:"grouping",componentType:$n.lateLoadKey,properties:{groups:[],groupBy:[]},providers:{[m.Mu.Converter]:{providerId:T.VX,properties:{formParts:[{previewPath:`listWidget.providers.${m.Mu.Adapter}.properties`,keys:["groupBy","drillstate","groups"]}]}}}},entityFormatting:{id:"entityFormatting",componentType:wn.lateLoadKey,properties:{mappingKeys:["icon_status","capital","name","icon","url"],dataFieldIds:{icon:"icon",status:"icon_status",detailedUrl:"capital",label:"name",url:"url"}},providers:{[m.Mu.Converter]:{providerId:T.VX,properties:{formParts:[{previewPath:`listWidget.providers.${m.Mu.Adapter}.properties.componentsConfig.leaf.properties`,keys:["dataFieldIds"]}]}}}}}},Nt={id:"header",componentType:bi.lateLoadKey,properties:{editMode:!1}},xt={id:"loading",componentType:f.N.lateLoadKey,providers:{[m.Mu.LoadingAdapter]:{providerId:T.IG}}},tt={id:"body",componentType:Di.lateLoadKey,properties:{content:"bodyContent"}},Zd={[m.WE.Unknown]:qe.ErrorUnknown,[m.WE.Forbidden]:qe.ErrorForbidden,[m.WE.NotFound]:qe.ErrorNotFound},Vd={[qe.ErrorUnknown]:{id:qe.ErrorUnknown,componentType:R.lateLoadKey,properties:{image:"no-data-to-show",title:$localize`Whoops, something went wrong`,description:$localize`There was an unexpected error.`}},[qe.ErrorForbidden]:{id:qe.ErrorForbidden,componentType:R.lateLoadKey,properties:{image:"no-data-to-show",title:$localize`403 - Forbidden`,description:$localize`The requested action was forbidden.`}},[qe.ErrorNotFound]:{id:qe.ErrorNotFound,componentType:R.lateLoadKey,properties:{image:"no-data-to-show",title:$localize`404 - Not Found`,description:$localize`The requested resource could not be found.`}}};function At(n,a=T.Cz,t=Zd,i=Vd){return Object.assign({bodyContent:{id:"bodyContent",componentType:Pi.lateLoadKey,properties:{primaryContent:n,fallbackMap:t},providers:{[m.Mu.ContentFallbackAdapter]:{providerId:a}}}},i)}const Zt={providerId:T.GN};function ct(n=!1,a=0){return{providerId:T.tc,properties:{enabled:n,interval:a}}}const Jd={[m.xW.Structure]:Object.assign(Object.assign(Object.assign(Object.assign({[T.XM]:{id:T.XM,componentType:Re.lateLoadKey,properties:{nodes:["header","loading","search","body"]},providers:{[m.Mu.EventProxy]:Zt}},header:Nt,loading:xt,body:Object.assign(Object.assign({},tt),{properties:Object.assign(Object.assign({},tt.properties),{elementClass:"overflow-auto"})})},At("listWidget")),{search:{id:"search",componentType:Mi.lateLoadKey}}),At("mainContent")),{mainContent:{id:"mainContent",componentType:Re.lateLoadKey,properties:{nodes:["navigationBar","listWidget"]}},navigationBar:{id:"navigationBar",componentType:ht.lateLoadKey},listWidget:{id:"listWidget",componentType:_.lateLoadKey,providers:{},properties:{elementClass:"w-100 p-3"}}}),[m.xW.Configuration]:{[T.XM]:{id:T.XM},header:{properties:{title:$localize`Empty Custom Widget`}}}},Yd={paths:{widget:{[m.AC.Root]:T.XM},configurator:{[m.AC.Root]:T.XM,[m.AC.DataSourceProviders]:"dataSource.properties.dataSourceProviders"}},widget:Jd,configurator:kd},Hd={[m.xW.Structure]:{[T.XM]:{id:T.XM,componentType:St.lateLoadKey,properties:{elementClass:"flex-grow-1 overflow-auto nui-scroll-shadows",nodes:["presentation","customConfig"]}},presentation:{id:"presentation",componentType:He.lateLoadKey,properties:{headerText:$localize`Presentation`,nodes:["titleAndDescription"]}},titleAndDescription:{id:"titleAndDescription",componentType:Rt.lateLoadKey,providers:{converter:{providerId:T.j4}}},customConfig:{id:"customConfig",componentType:He.lateLoadKey,properties:{headerText:$localize`Custom Widget Configuration`,nodes:["embeddedContentSelection"]}},embeddedContentSelection:{id:"embeddedContentSelection",componentType:Ji.lateLoadKey,properties:{messageComponent:{componentType:Mn.lateLoadKey,properties:{emphasizeText:"Some content may not work as expected.",generalText:"Web pages embedded in a widget may not be able to open popup windows or may experience formatting problems.\n                                    If you supply your own HTML, dangerous content like scripts will be removed.",link:{href:"https://www.solarwinds.com/",target:"_blank",text:"Learn more about best practices for the HTML widget"},allowDismiss:!0}}},providers:{[m.Mu.Converter]:{providerId:T.VX,properties:{formParts:[{previewPath:"mainContent.properties",keys:["customEmbeddedContent","mode","messageComponent","sanitized"]}]}}}}}},Kd={[m.xW.Structure]:Object.assign(Object.assign({[T.XM]:{id:T.XM,componentType:Re.lateLoadKey,providers:{[m.Mu.Refresher]:ct(),[m.Mu.EventProxy]:Zt},properties:{nodes:["header","loading","body"]}},header:Nt,loading:xt,body:tt},At("mainContent")),{mainContent:{id:"mainContent",componentType:x.lateLoadKey,properties:{elementClass:"d-flex w-100 justify-content-center"}}}),[m.xW.Configuration]:{header:{properties:{title:$localize`Empty Embedded Content Widget`}}}},Qd={paths:{widget:{[m.AC.Root]:T.XM},configurator:{[m.AC.Root]:T.XM}},widget:Kd,configurator:Hd},si={id:"refresher",componentType:Fn.lateLoadKey,providers:{[m.Mu.Converter]:{providerId:T.VX,properties:{formParts:[{previewPath:`${T.XM}.providers.refresher.properties`,keys:["enabled","interval","overrideDefaultSettings"]}]}}},properties:{overrideDefaultSettings:!1}},Xd=[{componentType:Bt.a.lateLoadKey,label:$localize`Raw Formatter`,dataTypes:{value:null}},{componentType:ti.lateLoadKey,label:$localize`Si Units Formatter`,dataTypes:{value:null}},{componentType:$i.C.lateLoadKey,label:$localize`Icon`,dataTypes:{value:null}}],jd={[m.xW.Structure]:{[T.XM]:{id:T.XM,componentType:St.lateLoadKey,properties:{elementClass:"flex-grow-1 overflow-auto nui-scroll-shadows",nodes:["presentation","tiles"]},providers:{[m.Mu.FormattersRegistry]:{providerId:T.s6}}},presentation:{id:"presentation",componentType:He.lateLoadKey,properties:{headerText:$localize`Presentation`,nodes:["titleAndDescription","refresher"]}},titleAndDescription:{id:"titleAndDescription",componentType:Rt.lateLoadKey,providers:{converter:{providerId:T.j4}}},refresher:si,tiles:{id:"tiles",componentType:Un.lateLoadKey,properties:{template:[{id:"description",componentType:Dn.lateLoadKey,properties:{configurableUnits:!0,backgroundColors:[...Vi]},providers:{[m.Mu.Converter]:{providerId:T.YN,properties:{formParts:[{previewPath:"properties.widgetData",keys:["label","backgroundColor","units"]}]}}}},{id:"dataSource",componentType:Wt.lateLoadKey,properties:{dataSourceProviders:[],errorComponent:Ft.lateLoadKey},providers:{[m.Mu.Converter]:{providerId:T.YN,properties:{formParts:[{previewPath:"providers.dataSource",keys:["providerId","properties"]},{previewPath:"providers.adapter.properties.dataSource",keys:["properties"]}]}},[m.Mu.Broadcaster]:{providerId:T.m_,properties:{configs:[{trackOn:"component",key:"dataFieldIds",paths:["data.{parentComponentId}/formatting.properties.dataFieldIds"]}]}}}},{id:"thresholds",componentType:xn.lateLoadKey,providers:{[m.Mu.Converter]:{providerId:T.YN,properties:{formParts:[{previewPath:"providers.adapter.properties.thresholds",keys:["criticalThresholdValue","warningThresholdValue","showThresholds","reversedThresholds"]}]}}}},{id:"backgroundColorRules",componentType:Nn.lateLoadKey,properties:{backgroundColors:[...Vi]},providers:{[m.Mu.Converter]:{providerId:T.YN,properties:{formParts:[{previewPath:"providers.kpiColorPrioritizer.properties",keys:["rules"]}]}}}},{id:"formatting",componentType:Xn.lateLoadKey,providers:{[m.Mu.Converter]:{providerId:T.YN,properties:{formParts:[{previewPath:"properties.configuration.formatters.Value",keys:["formatter"]}]}}},properties:{formatter:{componentType:Bt.a.lateLoadKey,properties:{dataFieldIds:{value:"value"}}}}}]},providers:{[m.Mu.Converter]:{providerId:T.ns}}}}},qd={[m.xW.Structure]:Object.assign(Object.assign({[T.XM]:{id:T.XM,componentType:Re.lateLoadKey,providers:{[m.Mu.Refresher]:ct(),[m.Mu.EventProxy]:Zt},properties:{nodes:["header","loading","body"]}},header:Nt,loading:xt,body:Object.assign(Object.assign({},tt),{properties:Object.assign(Object.assign({},tt.properties),{elementClass:"overflow-hidden"})})},At("tiles",T.C)),{tiles:{id:"tiles",componentType:it.lateLoadKey,properties:{elementClass:"flex-grow-1 pt-2 px-3 pb-3 w-100",template:{componentType:j.lateLoadKey,providers:{[m.Mu.KpiColorPrioritizer]:{providerId:T.tS,properties:{}},[m.Mu.Adapter]:{providerId:T.u1,properties:{propertyPath:"widgetData"}}},properties:{elementClass:"flex-grow-1"}}}}}),[m.xW.Configuration]:{[T.XM]:{id:T.XM,providers:{[m.Mu.Refresher]:ct(!1,60)}},header:{properties:{title:$localize`Empty KPI Widget`}}}},ao="tiles.properties.template[0]",lo="tiles.properties.template[1]",tc={paths:{widget:{[m.AC.Root]:T.XM},configurator:{[m.AC.Root]:T.XM,[m.AC.DataSourceConfigComponentType]:`${lo}.componentType`,[m.AC.TileDescriptionConfigComponentType]:`${ao}.componentType`,[m.AC.DataSourceProviders]:`${lo}.properties.dataSourceProviders`,[m.AC.TileDescriptionBackgroundColors]:`${ao}.properties.backgroundColors`,[m.AC.TileBackgroundColorRulesBackgroundColors]:"tiles.properties.template[3].properties.backgroundColors"}},widget:qd,configurator:jd},ic={paths:{widget:{[m.AC.Root]:T.XM},configurator:{[m.AC.Root]:T.XM}},widget:{[m.xW.Structure]:{[T.XM]:{id:T.XM,componentType:Re.lateLoadKey,properties:{nodes:["header","body"]}},header:Nt,body:tt,bodyContent:{id:"bodyContent",componentType:In.lateLoadKey}},[m.xW.Configuration]:{header:{properties:{title:$localize`New Widget`}}}}},Qi=(n,a)=>{const t=(null==a?void 0:a.chartSeriesDataFieldId)||"data[0]";let i=n[0];return(null==a?void 0:a.activeMetricId)&&(i=n.find(o=>o.id===(null==a?void 0:a.activeMetricId)),i||console.warn(`No metric with id: ${null==a?void 0:a.activeMetricId} found. Taking first available.`)),Ht()(i,t)};Qi.aggregatorType="fieldMapper";var nc=l(7154),co=l.n(nc);const ai=(n,a)=>{var t;const i=n.map(Z=>Z.data[0]),{activeMetricId:o,base100:r}=a||{},c=co()(i);let g=i[0];o&&(g=null===(t=n.find(Z=>Z.id===o))||void 0===t?void 0:t.data[0],g||console.warn(`No metric with id: ${o} found. Taking first available.`));const E=g/c;let P=r?100*E:E;return P=Math.round(100*P)/100,P.toString()};ai.aggregatorType="percentageAggregator";const li=(n,a)=>{const{activeMetricId:t}=a||{};if(t){const i=n.find(o=>o.id===t);if(i)return i.data[0]}return co()(n.map(i=>i.data[0])).toString()};li.aggregatorType="sumAggregator";const oc=[{componentType:"",label:$localize`Raw Formatter`,dataTypes:{value:null}},{componentType:zi.lateLoadKey,label:$localize`Status With Icon`,dataTypes:{value:null}},{componentType:ei.s.lateLoadKey,label:$localize`Link`,dataTypes:{value:null}}],rc=[{componentType:Bt.a.lateLoadKey,label:$localize`Raw Formatter`,dataTypes:{value:null},properties:{elementClass:"nui-text-page"}},{componentType:ti.lateLoadKey,label:$localize`Si Units Formatter`,dataTypes:{value:null},properties:{elementClass:"nui-text-page"}},{componentType:Ui.lateLoadKey,label:$localize`Percentage Formatter`,dataTypes:{value:null},properties:{elementClass:"nui-text-page"}}],sc=[{aggregatorType:li.aggregatorType,label:"Sum Aggregator",fn:li,configurationComponent:ri.lateLoadKey},{aggregatorType:ai.aggregatorType,label:"Percentage Aggregator",fn:ai,properties:{base100:!0},configurationComponent:ri.lateLoadKey},{aggregatorType:Qi.aggregatorType,label:"Field Mapper Aggregator",fn:Qi,configurationComponent:zn.lateLoadKey}],ac={[m.xW.Structure]:{[T.XM]:{id:T.XM,componentType:St.lateLoadKey,properties:{elementClass:"flex-grow-1 overflow-auto nui-scroll-shadows",nodes:["presentation","dataAndCalculations"]},providers:{[m.Mu.FormattersRegistry]:{providerId:T.rf}}},presentation:{id:"presentation",componentType:He.lateLoadKey,properties:{headerText:"Presentation",nodes:["titleAndDescription","chartOptionsEditor"]}},titleAndDescription:{id:"titleAndDescription",componentType:Rt.lateLoadKey,providers:{[m.Mu.Converter]:{providerId:T.j4}}},chartOptionsEditor:{id:"chartOptionsEditor",componentType:Wn.lateLoadKey,properties:{chartOptions:{chartTypes:["PieChart","DonutChart","VerticalBarChart","HorizontalBarChart"],legendPlacementOptions:[{id:we.w.None,label:$localize`None`},{id:we.w.Right,label:$localize`Right`},{id:we.w.Bottom,label:$localize`Bottom`}],contentFormatters:[{componentType:fn.lateLoadKey,label:$localize`Raw`},{componentType:Gi.lateLoadKey,label:$localize`Sum`},{componentType:wi.lateLoadKey,label:$localize`Percentage`,configurationComponent:"DonutContentPercentageConfigurationComponent"}],legendFormatters:[{componentType:zi.lateLoadKey,label:$localize`Status With Icon`},{componentType:ei.s.lateLoadKey,label:$localize`Link`}]}},providers:{[m.Mu.Converter]:{providerId:T.dz}}},refresher:si,dataAndCalculations:{id:"dataAndCalculations",componentType:He.lateLoadKey,properties:{headerText:$localize`Data and Calculations`,nodes:["dataSource"]}},dataSource:{id:"dataSource",componentType:Wt.lateLoadKey,properties:{dataSourceProviders:[],errorComponent:Ft.lateLoadKey},providers:{[m.Mu.Converter]:{providerId:T.VX,properties:{formParts:[{previewPath:"chart.providers.dataSource",keys:["providerId","properties"]},{previewPath:"chart.providers.adapter.properties.dataSource",keys:["properties"]}]}},[m.Mu.Broadcaster]:{providerId:T.m_,properties:{configs:[{trackOn:"component",key:"dsOutput",paths:["data.chartOptionsEditor.properties.dsOutput"]}]}}}}}},lc={[m.xW.Structure]:Object.assign(Object.assign({[T.XM]:{id:T.XM,componentType:Re.lateLoadKey,properties:{nodes:["header","loading","body"]},providers:{[m.Mu.Refresher]:ct(),[m.Mu.EventProxy]:Zt}},header:Nt,loading:xt,body:Object.assign(Object.assign({},tt),{properties:Object.assign(Object.assign({},tt.properties),{elementClass:"overflow-auto"})})},At("chart")),{chart:{id:"chart",componentType:gi.lateLoadKey,providers:{[m.Mu.Adapter]:{providerId:T.bZ,properties:{componentId:"chart",propertyPath:"widgetData"}}},properties:{elementClass:"d-flex flex-grow-1 justify-content-center overflow-auto"}}}),[m.xW.Configuration]:{[T.XM]:{id:T.XM,providers:{[m.Mu.Refresher]:ct(!1,60)}},header:{properties:{title:$localize`Empty Proportional Widget`}}}},dc={paths:{widget:{[m.AC.Root]:T.XM},configurator:{[m.AC.Root]:T.XM,[m.AC.DataSourceConfigComponentType]:"dataSource.componentType",[m.AC.DataSourceProviders]:"dataSource.properties.dataSourceProviders",[m.AC.Formatters]:"chartOptionsEditor.properties.chartOptions.contentFormatters"}},widget:lc,configurator:ac},cc={[m.xW.Structure]:{[T.XM]:{id:T.XM,componentType:St.lateLoadKey,properties:{elementClass:"flex-grow-1 overflow-auto nui-scroll-shadows",nodes:["presentation","dataAndCalculations","columns"]},providers:{[m.Mu.FormattersRegistry]:{providerId:T.Hp},[m.Mu.DataSourceManager]:{providerId:T.Xh}}},presentation:{id:"presentation",componentType:He.lateLoadKey,properties:{headerText:$localize`Presentation`,nodes:["titleAndDescription","filters"]}},titleAndDescription:{id:"titleAndDescription",componentType:Rt.lateLoadKey,providers:{[m.Mu.Converter]:{providerId:T.j4}}},filters:{id:"filters",componentType:jn.lateLoadKey,providers:{[m.Mu.Converter]:{providerId:T.LU}}},refresher:si,dataAndCalculations:{id:"dataAndCalculations",componentType:He.lateLoadKey,properties:{headerText:$localize`Data and Calculations`,nodes:["dataSource"]}},dataSource:{id:"dataSource",componentType:Wt.lateLoadKey,properties:{dataSourceProviders:[],errorComponent:yn.lateLoadKey},providers:{[m.Mu.Converter]:{providerId:T.VX,properties:{formParts:[{previewPath:"table.providers.dataSource",keys:["providerId","properties"]},{previewPath:"table.providers.adapter.properties.dataSource",keys:["properties"]}]}}}},columns:{id:"columns",componentType:Qn.lateLoadKey,properties:{template:[{},{properties:{formatters:Jn.X}}]},providers:{[m.Mu.Converter]:{providerId:T.n5}}}}},_c={[m.xW.Structure]:Object.assign(Object.assign({[T.XM]:{id:T.XM,componentType:Re.lateLoadKey,providers:{[m.Mu.Refresher]:ct(),[m.Mu.EventProxy]:{providerId:T.GN,properties:{downstreams:[T.pV.id]}}},properties:{nodes:["header","loading","body"]}},header:Nt,loading:xt,body:Object.assign(Object.assign({},tt),{properties:Object.assign(Object.assign({},tt.properties),{elementClass:"overflow-auto"})})},At("table")),{table:{id:"table",componentType:fi.lateLoadKey,providers:{[m.Mu.Adapter]:{providerId:T.l5,properties:{componentId:"table",dataPath:"widgetData",dataFieldsPath:"dataFields",totalItemsPath:"totalItems"}},virtualViewportManager:{providerId:T.Vx}},properties:{elementClass:"flex-grow-1 mx-3 mb-3 mt-2",delayedMousePresenceDetectionEnabled:!0,configuration:{columns:[],scrollActivationDelayMs:500,headerTooltipsEnabled:!0}}}}),[m.xW.Configuration]:{[T.XM]:{id:T.XM,providers:{[m.Mu.Refresher]:ct(!1,60)}},header:{properties:{title:$localize`Empty Table Widget`}}}},uc={paths:{widget:{[m.AC.Root]:T.XM},configurator:{[m.AC.Root]:T.XM,[m.AC.DataSourceConfigComponentType]:"dataSource.componentType",[m.AC.DataSourceProviders]:"dataSource.properties.dataSourceProviders",[m.AC.Formatters]:"columns.properties.template[1].properties.formatters"}},widget:_c,configurator:cc},pc={[m.xW.Structure]:{[T.XM]:{id:T.XM,componentType:St.lateLoadKey,properties:{elementClass:"flex-grow-1 overflow-auto nui-scroll-shadows",nodes:["presentation","dataAndCalculations","series"]}},presentation:{id:"presentation",componentType:He.lateLoadKey,properties:{headerText:$localize`Presentation`,nodes:["titleAndDescription","timeseriesMetadata"]}},titleAndDescription:{id:"titleAndDescription",componentType:Rt.lateLoadKey,providers:{[m.Mu.Converter]:{providerId:T.j4}}},timeseriesMetadata:{id:"timeseriesMetadata",componentType:Ln.lateLoadKey,properties:{legendPlacements:[{id:we.w.None,label:$localize`None`},{id:we.w.Right,label:$localize`Right`},{id:we.w.Bottom,label:$localize`Bottom`}]},providers:{[m.Mu.Converter]:{providerId:T.dZ}}},refresher:si,dataAndCalculations:{id:"dataAndCalculations",componentType:He.lateLoadKey,properties:{headerText:$localize`Data and Calculations`,nodes:["dataSource"]}},dataSource:{id:"dataSource",componentType:Wt.lateLoadKey,properties:{dataSourceProviders:[],errorComponent:Ft.lateLoadKey},providers:{[m.Mu.Converter]:{providerId:T.VX,properties:{formParts:[{previewPath:"/.providers.dataSource",keys:["providerId","properties"]},{previewPath:"chart.providers.adapter.properties.dataSource",keys:["properties"]}]}}}},series:{id:"series",componentType:qn.lateLoadKey,providers:{[m.Mu.Converter]:{providerId:T.Ip}},properties:{template:[{id:"description",componentType:eo.lateLoadKey,providers:{[m.Mu.Converter]:{providerId:T.Es,properties:{formParts:[{previewPath:"chart.providers.adapter.properties.series",keys:["label"]}]}}}},{id:"indicatorData",componentType:to.lateLoadKey,providers:{[m.Mu.Converter]:{providerId:T.Gq}}}]}}}},gc={[m.xW.Structure]:Object.assign(Object.assign({[T.XM]:{id:T.XM,componentType:Re.lateLoadKey,providers:{[m.Mu.Refresher]:ct(),[m.Mu.EventProxy]:Zt},properties:{nodes:["header","loading","body"]}},header:Nt,loading:xt,body:Object.assign(Object.assign({},tt),{properties:Object.assign(Object.assign({},tt.properties),{elementClass:"overflow-auto"})})},At("mainContent")),{mainContent:{id:"mainContent",componentType:Re.lateLoadKey,properties:{nodes:["timeframeSelection","chart"]}},timeframeSelection:{id:"timeframeSelection",componentType:Ci.lateLoadKey},chart:{id:"chart",componentType:yi.lateLoadKey,properties:{elementClass:"d-flex flex-column justify-content-center h-100 overflow-auto",configuration:{preset:Pe.Line,scales:{y:{type:nt.Linear},x:{type:nt.Time}}}},providers:{[m.Mu.Adapter]:{providerId:T.R9,properties:{componentId:"chart",propertyPath:"widgetData",series:[]}}}}}),[m.xW.Configuration]:{[T.XM]:{id:T.XM,providers:{[m.Mu.Refresher]:ct(!1,60)}},header:{properties:{title:$localize`Empty Timeseries Widget`}}}},hc={paths:{widget:{[m.AC.Root]:T.XM},configurator:{[m.AC.Root]:T.XM,[m.AC.DataSourceConfigComponentType]:"dataSource.componentType",[m.AC.DataSourceProviders]:"dataSource.properties.dataSourceProviders"}},widget:gc,configurator:pc};var mc=l(29242);const fc=[x,j,Si,f.N,gi,Re,Ri,Ni,Ai,Oi,fi,sn.q,it,Ci,yi,Di,Pi,bi,R,_,Mt,gt,ht,Mi,Je];let Tc=(()=>{class n{constructor(t,i,o,r){t.registerWidgetType("kpi",1,tc),t.registerWidgetType("table",1,uc),t.registerWidgetType("proportional",1,dc),t.registerWidgetType("timeseries",1,hc),t.registerWidgetType("previewPlaceholder",1,ic),t.registerWidgetType("embedded-content",1,Qd),t.registerWidgetType("drilldown",1,Yd);for(const c of fc.filter(g=>g.lateLoadKey))i.registerByLateLoadKey(c);o.registerEvent(T.RG),o.registerEvent(T.y4),o.registerEvent(T.j7),o.registerEvent(T.Ef),o.registerEvent(T.MO),o.registerEvent(T.pV),o.registerEvent(T.Xi),o.registerEvent(T.M),o.registerEvent(T.re),o.registerEvent(T.xZ),o.registerEvent(T.N9),o.registerEvent(ke.PF),o.registerEvent(T.QD),r.addItems(Xd)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(H.x),e.LFG(xi.h),e.LFG(mc.o),e.LFG(ge.YX))},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[no.$,H.x,s.JJ,hi.g],imports:[[A,v.IX,d.Gsl,d.Az_,h.$y4,so,d.Ts3,d.sF0,d.r$w,un,d.cnx,d.BSv,d.hvO,d.l70,C.Cl,d.JhO,p.UX,d.ILf,d.VSN,d.a$t,d.lam,d.ZuS,d.w0o,d.S6I]]}),n})();var di=(()=>((di||(di={})).Value="Value",di))();function Cc(n,a,t){const i=a;return t.forEach((o,r)=>{if(0===o.data.length)return;let c=-1,g=-1;const E=a[r].data;E.length>0?(c=o.data.findIndex(U=>We()(U.x).isSame(E[0].x)),g=o.data.findIndex(U=>We()(U.x).isSame(E[E.length-1].x))):(c=o.data.findIndex(U=>We()(U.x).isAfter(n.startDatetime)),g=o.data.findIndex(U=>We()(U.x).isAfter(n.endDatetime))-1);const P=We()(n.startDatetime);(0===E.length||!P.isSame(E[0].x))&&P.isBetween(o.data[0].x,o.data[o.data.length-1].x)&&i[r].data.unshift(Object.assign(Object.assign({},o.data[c-1]),{x:n.startDatetime.toDate()}));const Z=We()(n.endDatetime);(0===E.length||!Z.isSame(E[E.length-1].x))&&Z.isBetween(o.data[0].x,o.data[o.data.length-1].x)&&i[r].data.push(Object.assign(Object.assign({},o.data[g]),{x:n.endDatetime.toDate()}))}),i}l(97674),l(26365),l(10948),l(42296),l(50271),l(38046);const Oc={presentation:{id:"presentation",componentType:He.lateLoadKey,properties:{headerText:"Presentation",nodes:["titleAndDescription","chartOptionsEditor","donutContentConfiguration"]}},chartOptionsEditor:{id:"chartOptionsEditor",componentType:Bn.lateLoadKey,properties:{chartTypes:[{id:"PieChart",label:$localize`Pie`},{id:"DonutChart",label:$localize`Donut`},{id:"VerticalBarChart",label:$localize`Vertical Bar`},{id:"HorizontalBarChart",label:$localize`Horizontal Bar`}],legendPlacementOptions:[{id:we.w.None,label:$localize`None`},{id:we.w.Right,label:$localize`Right`},{id:we.w.Bottom,label:$localize`Bottom`}]},providers:{[m.Mu.Converter]:{providerId:T.VX,properties:{formParts:[{previewPath:"chart.properties.configuration.chartOptions",keys:["type","legendPlacement","legendFormatter"]}]}},[m.Mu.Broadcaster]:{providerId:T.m_,properties:{configs:[{trackOn:"component",key:"chartTypeChanged$",paths:["data.donutContentConfiguration.properties.chartType"]}]}}}},donutContentConfiguration:{id:"donutContentConfiguration",componentType:Zn.lateLoadKey,providers:{[m.Mu.Converter]:{providerId:T.VX,properties:{formParts:[{previewPath:"chart.properties.configuration.chartOptions.donutContentConfig",keys:["formatter","aggregator"]}]}}}}}},84493:oe=>{oe.exports=function W(l,s){for(var d,O=-1,e=l.length;++O<e;){var R=s(l[O]);void 0!==R&&(d=void 0===d?R:d+R)}return d}},94133:(oe,W,l)=>{var s=l(42664),d=l(50686),O=l(80707);oe.exports=function e(R,N,A){var C=R.length;if(C<2)return C?O(R[0]):[];for(var p=-1,v=Array(C);++p<C;)for(var h=R[p],w=-1;++w<C;)w!=p&&(v[p]=s(v[p]||h,R[w],N,A));return O(d(v,1),N,A)}},38645:oe=>{oe.exports=function W(l,s,d){for(var O=-1,e=l.length,R=s.length,N={};++O<e;)d(N,l[O],O<R?s[O]:void 0);return N}},18680:(oe,W,l)=>{var s=l(42664),d=l(50686),O=l(23269),e=l(21330),R=O(function(N,A){return e(N)?s(N,d(A,1,e,!0)):[]});oe.exports=R},7154:(oe,W,l)=>{var s=l(84493),d=l(32608);oe.exports=function O(e){return e&&e.length?s(e,d):0}},10912:(oe,W,l)=>{var s=l(96517),d=l(84493);oe.exports=function O(e,R){return e&&e.length?d(e,s(R,2)):0}},68921:(oe,W,l)=>{var s=l(50686),d=l(23269),O=l(80707),e=l(21330),R=d(function(N){return O(s(N,1,e,!0))});oe.exports=R},19574:(oe,W,l)=>{var s=l(69779),d=l(23269),O=l(94133),e=l(21330),R=d(function(N){return O(s(N,e))});oe.exports=R},21617:(oe,W,l)=>{var s=l(89719),d=l(38645);oe.exports=function O(e,R){return d(e||[],R||[],s)}},33748:(oe,W,l)=>{"use strict";l.d(W,{IM:()=>Yt,IX:()=>Me,KY:()=>T,RU:()=>m,sm:()=>te,tQ:()=>b});var s=l(5e3),d=l(77579),O=l(78372),e=l(82722),R=l(63900),N=l(5963),A=l(69808);function C(K,u){if(1&K&&s._UZ(0,"div",3),2&K){const _=u.index,f=s.oxw();s.Q6J("ngStyle",f.gridRenderer.getGridColumnStyle(_))}}function p(K,u){if(1&K&&s._UZ(0,"div",4),2&K){const _=u.index,f=s.oxw();s.Q6J("ngStyle",f.gridRenderer.getGridRowStyle(_))}}const v=["*"];function h(K,u){if(1&K){const _=s.EpF();s.TgZ(0,"div",8),s.NdJ("mousedown",function(S){return s.CHM(_),s.oxw().resize.dragStartDelay(S)})("touchstart",function(S){return s.CHM(_),s.oxw().resize.dragStartDelay(S)}),s.qZA()}}function w(K,u){if(1&K){const _=s.EpF();s.TgZ(0,"div",9),s.NdJ("mousedown",function(S){return s.CHM(_),s.oxw().resize.dragStartDelay(S)})("touchstart",function(S){return s.CHM(_),s.oxw().resize.dragStartDelay(S)}),s.qZA()}}function M(K,u){if(1&K){const _=s.EpF();s.TgZ(0,"div",10),s.NdJ("mousedown",function(S){return s.CHM(_),s.oxw().resize.dragStartDelay(S)})("touchstart",function(S){return s.CHM(_),s.oxw().resize.dragStartDelay(S)}),s.qZA()}}function F(K,u){if(1&K){const _=s.EpF();s.TgZ(0,"div",11),s.NdJ("mousedown",function(S){return s.CHM(_),s.oxw().resize.dragStartDelay(S)})("touchstart",function(S){return s.CHM(_),s.oxw().resize.dragStartDelay(S)}),s.qZA()}}function G(K,u){if(1&K){const _=s.EpF();s.TgZ(0,"div",12),s.NdJ("mousedown",function(S){return s.CHM(_),s.oxw().resize.dragStartDelay(S)})("touchstart",function(S){return s.CHM(_),s.oxw().resize.dragStartDelay(S)}),s.qZA()}}function x(K,u){if(1&K){const _=s.EpF();s.TgZ(0,"div",13),s.NdJ("mousedown",function(S){return s.CHM(_),s.oxw().resize.dragStartDelay(S)})("touchstart",function(S){return s.CHM(_),s.oxw().resize.dragStartDelay(S)}),s.qZA()}}function y(K,u){if(1&K){const _=s.EpF();s.TgZ(0,"div",14),s.NdJ("mousedown",function(S){return s.CHM(_),s.oxw().resize.dragStartDelay(S)})("touchstart",function(S){return s.CHM(_),s.oxw().resize.dragStartDelay(S)}),s.qZA()}}function k(K,u){if(1&K){const _=s.EpF();s.TgZ(0,"div",15),s.NdJ("mousedown",function(S){return s.CHM(_),s.oxw().resize.dragStartDelay(S)})("touchstart",function(S){return s.CHM(_),s.oxw().resize.dragStartDelay(S)}),s.qZA()}}var b=(()=>{return(K=b||(b={})).Fit="fit",K.ScrollVertical="scrollVertical",K.ScrollHorizontal="scrollHorizontal",K.Fixed="fixed",K.VerticalFixed="verticalFixed",K.HorizontalFixed="horizontalFixed",b;var K})(),T=(()=>{return(K=T||(T={})).Always="always",K.OnDragAndResize="onDrag&Resize",K.None="none",T;var K})(),m=(()=>{return(K=m||(m={})).None="none",K.CompactUp="compactUp",K.CompactLeft="compactLeft",K.CompactUpAndLeft="compactUp&Left",K.CompactLeftAndUp="compactLeft&Up",K.CompactRight="compactRight",K.CompactUpAndRight="compactUp&Right",K.CompactRightAndUp="compactRight&Up",K.CompactDown="compactDown",K.CompactDownAndLeft="compactDown&Left",K.CompactLeftAndDown="compactLeft&Down",K.CompactDownAndRight="compactDown&Right",K.CompactRightAndDown="compactRight&Down",m;var K})(),L=(()=>{return(K=L||(L={})).LTR="ltr",K.RTL="rtl",L;var K})();class z{constructor(u){this.gridster=u}destroy(){this.gridster=null}checkCompact(){this.gridster.$options.compactType!==m.None&&(this.gridster.$options.compactType===m.CompactUp?this.checkCompactMovement("y",-1):this.gridster.$options.compactType===m.CompactLeft?this.checkCompactMovement("x",-1):this.gridster.$options.compactType===m.CompactUpAndLeft?(this.checkCompactMovement("y",-1),this.checkCompactMovement("x",-1)):this.gridster.$options.compactType===m.CompactLeftAndUp?(this.checkCompactMovement("x",-1),this.checkCompactMovement("y",-1)):this.gridster.$options.compactType===m.CompactRight?this.checkCompactMovement("x",1):this.gridster.$options.compactType===m.CompactUpAndRight?(this.checkCompactMovement("y",-1),this.checkCompactMovement("x",1)):this.gridster.$options.compactType===m.CompactRightAndUp?(this.checkCompactMovement("x",1),this.checkCompactMovement("y",-1)):this.gridster.$options.compactType===m.CompactDown?this.checkCompactMovement("y",1):this.gridster.$options.compactType===m.CompactDownAndLeft?(this.checkCompactMovement("y",1),this.checkCompactMovement("x",-1)):this.gridster.$options.compactType===m.CompactDownAndRight?(this.checkCompactMovement("y",1),this.checkCompactMovement("x",1)):this.gridster.$options.compactType===m.CompactLeftAndDown?(this.checkCompactMovement("x",-1),this.checkCompactMovement("y",1)):this.gridster.$options.compactType===m.CompactRightAndDown&&(this.checkCompactMovement("x",1),this.checkCompactMovement("y",1)))}checkCompactItem(u){this.gridster.$options.compactType!==m.None&&(this.gridster.$options.compactType===m.CompactUp?this.moveTillCollision(u,"y",-1):this.gridster.$options.compactType===m.CompactLeft?this.moveTillCollision(u,"x",-1):this.gridster.$options.compactType===m.CompactUpAndLeft?(this.moveTillCollision(u,"y",-1),this.moveTillCollision(u,"x",-1)):this.gridster.$options.compactType===m.CompactLeftAndUp?(this.moveTillCollision(u,"x",-1),this.moveTillCollision(u,"y",-1)):this.gridster.$options.compactType===m.CompactUpAndRight?(this.moveTillCollision(u,"y",-1),this.moveTillCollision(u,"x",1)):this.gridster.$options.compactType===m.CompactDown?this.moveTillCollision(u,"y",1):this.gridster.$options.compactType===m.CompactDownAndLeft?(this.moveTillCollision(u,"y",1),this.moveTillCollision(u,"x",-1)):this.gridster.$options.compactType===m.CompactLeftAndDown?(this.moveTillCollision(u,"x",-1),this.moveTillCollision(u,"y",1)):this.gridster.$options.compactType===m.CompactDownAndRight?(this.moveTillCollision(u,"y",1),this.moveTillCollision(u,"x",1)):this.gridster.$options.compactType===m.CompactRightAndDown&&(this.moveTillCollision(u,"x",1),this.moveTillCollision(u,"y",1)))}checkCompactMovement(u,_){let f=!1;this.gridster.grid.forEach(S=>{!1!==S.$item.compactEnabled&&this.moveTillCollision(S.$item,u,_)&&(f=!0,S.item[u]=S.$item[u],S.itemChanged())}),f&&this.checkCompact()}moveTillCollision(u,_,f){return u[_]+=f,this.gridster.checkCollision(u)?(u[_]-=f,!1):(this.moveTillCollision(u,_,f),!0)}}const X={gridType:b.Fit,scale:1,fixedColWidth:250,fixedRowHeight:250,keepFixedHeightInMobile:!1,keepFixedWidthInMobile:!1,setGridSize:!1,compactType:m.None,mobileBreakpoint:640,useBodyForBreakpoint:!1,allowMultiLayer:!1,defaultLayerIndex:0,maxLayerIndex:2,baseLayerIndex:1,minCols:1,maxCols:100,minRows:1,maxRows:100,defaultItemCols:1,defaultItemRows:1,maxItemCols:50,maxItemRows:50,minItemCols:1,minItemRows:1,minItemArea:1,maxItemArea:2500,addEmptyRowsCount:0,rowHeightRatio:1,margin:10,outerMargin:!0,outerMarginTop:null,outerMarginRight:null,outerMarginBottom:null,outerMarginLeft:null,useTransformPositioning:!0,scrollSensitivity:10,scrollSpeed:20,initCallback:void 0,destroyCallback:void 0,gridSizeChangedCallback:void 0,itemChangeCallback:void 0,itemResizeCallback:void 0,itemInitCallback:void 0,itemRemovedCallback:void 0,itemValidateCallback:void 0,enableEmptyCellClick:!1,enableEmptyCellContextMenu:!1,enableEmptyCellDrop:!1,enableEmptyCellDrag:!1,enableOccupiedCellDrop:!1,emptyCellClickCallback:void 0,emptyCellContextMenuCallback:void 0,emptyCellDropCallback:void 0,emptyCellDragCallback:void 0,emptyCellDragMaxCols:50,emptyCellDragMaxRows:50,ignoreMarginInRow:!1,draggable:{delayStart:0,enabled:!1,ignoreContentClass:"gridster-item-content",ignoreContent:!1,dragHandleClass:"drag-handler",stop:void 0,start:void 0,dropOverItems:!1,dropOverItemsCallback:void 0},resizable:{delayStart:0,enabled:!1,handles:{s:!0,e:!0,n:!0,w:!0,se:!0,ne:!0,sw:!0,nw:!0},stop:void 0,start:void 0},swap:!0,swapWhileDragging:!1,pushItems:!1,disablePushOnDrag:!1,disablePushOnResize:!1,pushDirections:{north:!0,east:!0,south:!0,west:!0},pushResizeItems:!1,displayGrid:T.OnDragAndResize,disableWindowResize:!1,disableWarnings:!1,scrollToNewItems:!1,disableScrollHorizontal:!1,disableScrollVertical:!1,enableBoundaryControl:!1,disableAutoPositionOnConflict:!1,dirType:L.LTR};class q{static merge(u,_,f){for(const S in _)void 0!==_[S]&&f.hasOwnProperty(S)&&(u[S]="object"==typeof _[S]?q.merge(u[S],_[S],f[S]):_[S]);return u}static checkTouchEvent(u){void 0===u.clientX&&u.touches&&(u.touches&&u.touches.length?(u.clientX=u.touches[0].clientX,u.clientY=u.touches[0].clientY):u.changedTouches&&u.changedTouches.length&&(u.clientX=u.changedTouches[0].clientX,u.clientY=u.changedTouches[0].clientY))}static checkContentClassForEvent(u,_){if(u.$options.draggable.ignoreContent){if(!q.checkDragHandleClass(_.target,_.currentTarget,u.$options.draggable.dragHandleClass,u.$options.draggable.ignoreContentClass))return!0}else if(q.checkContentClass(_.target,_.currentTarget,u.$options.draggable.ignoreContentClass))return!0;return!1}static checkContentClassForEmptyCellClickEvent(u,_){return q.checkContentClass(_.target,_.currentTarget,u.$options.draggable.ignoreContentClass)||q.checkContentClass(_.target,_.currentTarget,u.$options.draggable.dragHandleClass)}static checkDragHandleClass(u,_,f,S){if(!u||u===_)return!1;if(u.hasAttribute("class")){const V=u.getAttribute("class").split(" ");if(V.indexOf(f)>-1)return!0;if(V.indexOf(S)>-1)return!1}return q.checkDragHandleClass(u.parentNode,_,f,S)}static checkContentClass(u,_,f){return!(!u||u===_)&&(!!(u.hasAttribute("class")&&u.getAttribute("class").split(" ").indexOf(f)>-1)||q.checkContentClass(u.parentNode,_,f))}static compareItems(u,_){return u.y>_.y?-1:u.y<_.y?1:u.x>_.x?-1:1}}class re{constructor(u){this.gridster=u,this.emptyCellClickCb=_=>{if(!this.gridster||this.gridster.movingItem||q.checkContentClassForEmptyCellClickEvent(this.gridster,_))return;const f=this.getValidItemFromEvent(_);!f||(this.gridster.options.emptyCellClickCallback&&this.gridster.options.emptyCellClickCallback(_,f),this.gridster.cdRef.markForCheck())},this.emptyCellContextMenuCb=_=>{if(this.gridster.movingItem||q.checkContentClassForEmptyCellClickEvent(this.gridster,_))return;_.preventDefault(),_.stopPropagation();const f=this.getValidItemFromEvent(_);!f||(this.gridster.options.emptyCellContextMenuCallback&&this.gridster.options.emptyCellContextMenuCallback(_,f),this.gridster.cdRef.markForCheck())},this.emptyCellDragDrop=_=>{const f=this.getValidItemFromEvent(_);!f||(this.gridster.options.emptyCellDropCallback&&this.gridster.options.emptyCellDropCallback(_,f),this.gridster.cdRef.markForCheck())},this.emptyCellDragOver=_=>{_.preventDefault(),_.stopPropagation();const f=this.getValidItemFromEvent(_);f?(_.dataTransfer&&(_.dataTransfer.dropEffect="move"),this.gridster.movingItem=f):(_.dataTransfer&&(_.dataTransfer.dropEffect="none"),this.gridster.movingItem=null),this.gridster.previewStyle()},this.emptyCellMouseDown=_=>{if(q.checkContentClassForEmptyCellClickEvent(this.gridster,_))return;_.preventDefault(),_.stopPropagation();const f=this.getValidItemFromEvent(_);!f||1!==_.buttons&&!(_ instanceof TouchEvent)||(this.initialItem=f,this.gridster.movingItem=f,this.gridster.previewStyle(),this.gridster.zone.runOutsideAngular(()=>{this.removeWindowMousemoveListenerFn=this.gridster.renderer.listen("window","mousemove",this.emptyCellMouseMove),this.removeWindowTouchmoveListenerFn=this.gridster.renderer.listen("window","touchmove",this.emptyCellMouseMove)}),this.removeWindowMouseupListenerFn=this.gridster.renderer.listen("window","mouseup",this.emptyCellMouseUp),this.removeWindowTouchendListenerFn=this.gridster.renderer.listen("window","touchend",this.emptyCellMouseUp))},this.emptyCellMouseMove=_=>{_.preventDefault(),_.stopPropagation();const f=this.getValidItemFromEvent(_,this.initialItem);!f||(this.gridster.movingItem=f,this.gridster.previewStyle())},this.emptyCellMouseUp=_=>{this.removeWindowMousemoveListenerFn(),this.removeWindowTouchmoveListenerFn(),this.removeWindowMouseupListenerFn(),this.removeWindowTouchendListenerFn();const f=this.getValidItemFromEvent(_,this.initialItem);f&&(this.gridster.movingItem=f),this.gridster.options.emptyCellDragCallback&&this.gridster.movingItem&&this.gridster.options.emptyCellDragCallback(_,this.gridster.movingItem),setTimeout(()=>{this.initialItem=null,this.gridster&&(this.gridster.movingItem=null,this.gridster.previewStyle())}),this.gridster.cdRef.markForCheck()}}destroy(){this.gridster.previewStyle&&this.gridster.previewStyle(),this.gridster.movingItem=null,this.initialItem=this.gridster=null,this.removeDocumentDragendListenerFn&&(this.removeDocumentDragendListenerFn(),this.removeDocumentDragendListenerFn=null)}updateOptions(){this.gridster.$options.enableEmptyCellClick&&!this.removeEmptyCellClickListenerFn&&this.gridster.options.emptyCellClickCallback?(this.removeEmptyCellClickListenerFn=this.gridster.renderer.listen(this.gridster.el,"click",this.emptyCellClickCb),this.removeEmptyCellTouchendListenerFn=this.gridster.renderer.listen(this.gridster.el,"touchend",this.emptyCellClickCb)):!this.gridster.$options.enableEmptyCellClick&&this.removeEmptyCellClickListenerFn&&this.removeEmptyCellTouchendListenerFn&&(this.removeEmptyCellClickListenerFn(),this.removeEmptyCellTouchendListenerFn(),this.removeEmptyCellClickListenerFn=null,this.removeEmptyCellTouchendListenerFn=null),this.gridster.$options.enableEmptyCellContextMenu&&!this.removeEmptyCellContextMenuListenerFn&&this.gridster.options.emptyCellContextMenuCallback?this.removeEmptyCellContextMenuListenerFn=this.gridster.renderer.listen(this.gridster.el,"contextmenu",this.emptyCellContextMenuCb):!this.gridster.$options.enableEmptyCellContextMenu&&this.removeEmptyCellContextMenuListenerFn&&(this.removeEmptyCellContextMenuListenerFn(),this.removeEmptyCellContextMenuListenerFn=null),this.gridster.$options.enableEmptyCellDrop&&!this.removeEmptyCellDropListenerFn&&this.gridster.options.emptyCellDropCallback?(this.removeEmptyCellDropListenerFn=this.gridster.renderer.listen(this.gridster.el,"drop",this.emptyCellDragDrop),this.gridster.zone.runOutsideAngular(()=>{this.removeEmptyCellDragoverListenerFn=this.gridster.renderer.listen(this.gridster.el,"dragover",this.emptyCellDragOver)}),this.removeDocumentDragendListenerFn=this.gridster.renderer.listen("document","dragend",()=>{this.gridster.movingItem=null,this.gridster.previewStyle()})):!this.gridster.$options.enableEmptyCellDrop&&this.removeEmptyCellDropListenerFn&&this.removeEmptyCellDragoverListenerFn&&this.removeDocumentDragendListenerFn&&(this.removeEmptyCellDropListenerFn(),this.removeEmptyCellDragoverListenerFn(),this.removeDocumentDragendListenerFn(),this.removeEmptyCellDragoverListenerFn=null,this.removeEmptyCellDropListenerFn=null,this.removeDocumentDragendListenerFn=null),this.gridster.$options.enableEmptyCellDrag&&!this.removeEmptyCellMousedownListenerFn&&this.gridster.options.emptyCellDragCallback?(this.removeEmptyCellMousedownListenerFn=this.gridster.renderer.listen(this.gridster.el,"mousedown",this.emptyCellMouseDown),this.removeEmptyCellTouchstartListenerFn=this.gridster.renderer.listen(this.gridster.el,"touchstart",this.emptyCellMouseDown)):!this.gridster.$options.enableEmptyCellDrag&&this.removeEmptyCellMousedownListenerFn&&this.removeEmptyCellTouchstartListenerFn&&(this.removeEmptyCellMousedownListenerFn(),this.removeEmptyCellTouchstartListenerFn(),this.removeEmptyCellMousedownListenerFn=null,this.removeEmptyCellTouchstartListenerFn=null)}getPixelsX(u,_){const f=this.gridster.options.scale;return f?(u.clientX-_.left)/f+this.gridster.el.scrollLeft-this.gridster.gridRenderer.getLeftMargin():u.clientX+this.gridster.el.scrollLeft-_.left-this.gridster.gridRenderer.getLeftMargin()}getPixelsY(u,_){const f=this.gridster.options.scale;return f?(u.clientY-_.top)/f+this.gridster.el.scrollTop-this.gridster.gridRenderer.getTopMargin():u.clientY+this.gridster.el.scrollTop-_.top-this.gridster.gridRenderer.getTopMargin()}getValidItemFromEvent(u,_){u.preventDefault(),u.stopPropagation(),q.checkTouchEvent(u);const f=this.gridster.el.getBoundingClientRect(),S=this.getPixelsX(u,f),V=this.getPixelsY(u,f),H={x:this.gridster.pixelsToPositionX(S,Math.floor,!0),y:this.gridster.pixelsToPositionY(V,Math.floor,!0),cols:this.gridster.$options.defaultItemCols,rows:this.gridster.$options.defaultItemRows};if(_&&(H.cols=Math.min(Math.abs(_.x-H.x)+1,this.gridster.$options.emptyCellDragMaxCols),H.rows=Math.min(Math.abs(_.y-H.y)+1,this.gridster.$options.emptyCellDragMaxRows),_.x<H.x?H.x=_.x:_.x-H.x>this.gridster.$options.emptyCellDragMaxCols-1&&(H.x=this.gridster.movingItem?this.gridster.movingItem.x:0),_.y<H.y?H.y=_.y:_.y-H.y>this.gridster.$options.emptyCellDragMaxRows-1&&(H.y=this.gridster.movingItem?this.gridster.movingItem.y:0)),this.gridster.$options.enableOccupiedCellDrop||!this.gridster.checkCollision(H))return H}}class de{constructor(u){this.gridster=u}destroy(){this.gridster=null}updateItem(u,_,f){if(this.gridster.mobile)this.clearCellPosition(f,u),f.setStyle(u,"height",this.gridster.$options.keepFixedHeightInMobile?(_.rows-1)*this.gridster.$options.margin+_.rows*this.gridster.$options.fixedRowHeight+"px":_.rows*this.gridster.curWidth/_.cols+"px"),f.setStyle(u,"width",this.gridster.$options.keepFixedWidthInMobile?this.gridster.$options.fixedColWidth+"px":""),f.setStyle(u,"margin-bottom",this.gridster.$options.margin+"px"),f.setStyle(u,L.LTR?"margin-right":"margin-left","");else{const S=Math.round(this.gridster.curColWidth*_.x),V=Math.round(this.gridster.curRowHeight*_.y),H=this.gridster.curColWidth*_.cols-this.gridster.$options.margin,ge=this.gridster.curRowHeight*_.rows-this.gridster.$options.margin;this.setCellPosition(f,u,S,V),f.setStyle(u,"width",H+"px"),f.setStyle(u,"height",ge+"px");let Ce=null,fe=null;this.gridster.$options.outerMargin&&(this.gridster.rows===_.rows+_.y&&(Ce=null!==this.gridster.$options.outerMarginBottom?this.gridster.$options.outerMarginBottom+"px":this.gridster.$options.margin+"px"),this.gridster.columns===_.cols+_.x&&(fe=null!==this.gridster.$options.outerMarginBottom?this.gridster.$options.outerMarginRight+"px":this.gridster.$options.margin+"px")),f.setStyle(u,"margin-bottom",Ce),f.setStyle(u,L.LTR?"margin-right":"margin-left",fe)}}updateGridster(){let u="",_="",f="",S="";if(this.gridster.$options.gridType===b.Fit)u=b.Fit,_=b.ScrollVertical,f=b.ScrollHorizontal,S=b.Fixed;else if(this.gridster.$options.gridType===b.ScrollVertical)this.gridster.curRowHeight=this.gridster.curColWidth*this.gridster.$options.rowHeightRatio,u=b.ScrollVertical,_=b.Fit,f=b.ScrollHorizontal,S=b.Fixed;else if(this.gridster.$options.gridType===b.ScrollHorizontal){const V=this.gridster.$options.rowHeightRatio;this.gridster.curColWidth=this.gridster.curRowHeight*(V>=1?V:V+1),u=b.ScrollHorizontal,_=b.Fit,f=b.ScrollVertical,S=b.Fixed}else this.gridster.$options.gridType===b.Fixed?(this.gridster.curColWidth=this.gridster.$options.fixedColWidth+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),this.gridster.curRowHeight=this.gridster.$options.fixedRowHeight+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),u=b.Fixed,_=b.Fit,f=b.ScrollVertical,S=b.ScrollHorizontal):this.gridster.$options.gridType===b.VerticalFixed?(this.gridster.curRowHeight=this.gridster.$options.fixedRowHeight+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),u=b.ScrollVertical,_=b.Fit,f=b.ScrollHorizontal,S=b.Fixed):this.gridster.$options.gridType===b.HorizontalFixed&&(this.gridster.curColWidth=this.gridster.$options.fixedColWidth+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),u=b.ScrollHorizontal,_=b.Fit,f=b.ScrollVertical,S=b.Fixed);this.gridster.mobile||this.gridster.$options.setGridSize&&this.gridster.$options.gridType!==b.Fit?this.gridster.renderer.removeClass(this.gridster.el,u):this.gridster.renderer.addClass(this.gridster.el,u),this.gridster.renderer.removeClass(this.gridster.el,_),this.gridster.renderer.removeClass(this.gridster.el,f),this.gridster.renderer.removeClass(this.gridster.el,S)}getGridColumnStyle(u){return Object.assign(Object.assign({},this.getLeftPosition(this.gridster.curColWidth*u)),{width:this.gridster.curColWidth-this.gridster.$options.margin+"px",height:this.gridster.gridRows.length*this.gridster.curRowHeight-this.gridster.$options.margin+"px"})}getGridRowStyle(u){return Object.assign(Object.assign({},this.getTopPosition(this.gridster.curRowHeight*u)),{width:this.gridster.gridColumns.length*this.gridster.curColWidth-this.gridster.$options.margin+"px",height:this.gridster.curRowHeight-this.gridster.$options.margin+"px"})}getLeftPosition(u){const _=this.gridster.$options.dirType===L.RTL?-u:u;return this.gridster.$options.useTransformPositioning?{transform:"translateX("+_+"px)"}:{left:this.getLeftMargin()+_+"px"}}getTopPosition(u){return this.gridster.$options.useTransformPositioning?{transform:"translateY("+u+"px)"}:{top:this.getTopMargin()+u+"px"}}clearCellPosition(u,_){this.gridster.$options.useTransformPositioning?u.setStyle(_,"transform",""):(u.setStyle(_,"top",""),u.setStyle(_,"left",""))}setCellPosition(u,_,f,S){const V=this.gridster.$options.dirType===L.RTL?-f:f;this.gridster.$options.useTransformPositioning?u.setStyle(_,"transform","translate3d("+V+"px, "+S+"px, 0)"):(u.setStyle(_,"left",this.getLeftMargin()+V+"px"),u.setStyle(_,"top",this.getTopMargin()+S+"px"))}getLeftMargin(){return this.gridster.$options.outerMargin?null!==this.gridster.$options.outerMarginLeft?this.gridster.$options.outerMarginLeft:this.gridster.$options.margin:0}getTopMargin(){return this.gridster.$options.outerMargin?null!==this.gridster.$options.outerMarginTop?this.gridster.$options.outerMarginTop:this.gridster.$options.margin:0}}let Y,j,ie,Te,Ee,ze,Ve,Re,ot,pe=(()=>{class K{constructor(_,f){this.renderer=f,this.el=_.nativeElement}ngOnInit(){this.sub=this.previewStyle$.subscribe(_=>this.previewStyle(_))}ngOnDestroy(){this.sub.unsubscribe()}previewStyle(_){_?(this.renderer.setStyle(this.el,"display","block"),this.gridRenderer.updateItem(this.el,_,this.renderer)):this.renderer.setStyle(this.el,"display","")}}return K.\u0275fac=function(_){return new(_||K)(s.Y36(s.SBq),s.Y36(s.Qsj))},K.\u0275cmp=s.Xpm({type:K,selectors:[["gridster-preview"]],inputs:{previewStyle$:"previewStyle$",gridRenderer:"gridRenderer"},decls:0,vars:0,template:function(_,f){},styles:["gridster-preview{position:absolute;display:none;background:rgba(0,0,0,.15)}\n"],encapsulation:2}),K})(),te=(()=>{class K{constructor(_,f,S,V){this.renderer=f,this.cdRef=S,this.zone=V,this.columns=0,this.rows=0,this.gridColumns=[],this.gridRows=[],this.previewStyle$=new s.vpe,this.calculateLayout$=new d.x,this.resize$=new d.x,this.destroy$=new d.x,this.optionsChanged=()=>{this.setOptions();let ge,H=this.grid.length-1;for(;H>=0;H--)ge=this.grid[H],ge.updateOptions();this.calculateLayout()},this.onResize=()=>{this.el.clientWidth&&(this.options.setGridSize&&(this.renderer.setStyle(this.el,"width",""),this.renderer.setStyle(this.el,"height","")),this.setGridSize(),this.calculateLayout())},this.getNextPossiblePosition=(H,ge={})=>{-1===H.cols&&(H.cols=this.$options.defaultItemCols),-1===H.rows&&(H.rows=this.$options.defaultItemRows),this.setGridDimensions();let fe,Ce=ge.y||0;for(;Ce<this.rows;Ce++)for(H.y=Ce,fe=ge.x||0;fe<this.columns;fe++)if(H.x=fe,!this.checkCollision(H))return!0;const Ie=this.$options.maxRows>=this.rows+H.rows;return this.rows<=this.columns&&Ie||!(this.$options.maxCols>=this.columns+H.cols)?!!Ie&&(H.y=this.rows,H.x=0,!0):(H.x=this.columns,H.y=0,!0)},this.getFirstPossiblePosition=H=>{const ge=Object.assign({},H);return this.getNextPossiblePosition(ge),ge},this.getLastPossiblePosition=H=>{let ge={y:0,x:0};ge=this.grid.reduce((fe,Ie)=>{const xe={y:Ie.$item.y+Ie.$item.rows-1,x:Ie.$item.x+Ie.$item.cols-1};return 1===q.compareItems(fe,xe)?xe:fe},ge);const Ce=Object.assign({},H);return this.getNextPossiblePosition(Ce,ge),Ce},this.el=_.nativeElement,this.$options=JSON.parse(JSON.stringify(X)),this.mobile=!1,this.curWidth=0,this.curHeight=0,this.grid=[],this.curColWidth=0,this.curRowHeight=0,this.dragInProgress=!1,this.emptyCell=new re(this),this.compact=new z(this),this.gridRenderer=new de(this)}static checkCollisionTwoItemsForSwaping(_,f){return _.x+(1===_.cols?0:1)<f.x+f.cols&&_.x+_.cols>f.x+(1===f.cols?0:1)&&_.y+(1===_.rows?0:1)<f.y+f.rows&&_.y+_.rows>f.y+(1===f.rows?0:1)}checkCollisionTwoItems(_,f){if(!(_.x<f.x+f.cols&&_.x+_.cols>f.x&&_.y<f.y+f.rows&&_.y+_.rows>f.y))return!1;if(!this.$options.allowMultiLayer)return!0;const V=this.$options.defaultLayerIndex;return(void 0===_.layerIndex?V:_.layerIndex)===(void 0===f.layerIndex?V:f.layerIndex)}ngOnInit(){this.options.initCallback&&this.options.initCallback(this),this.calculateLayout$.pipe((0,O.b)(0),(0,e.R)(this.destroy$)).subscribe(()=>this.calculateLayout()),this.resize$.pipe((0,R.w)(()=>(0,N.H)(100)),(0,e.R)(this.destroy$)).subscribe(()=>this.resize())}ngOnChanges(_){_.options&&(this.setOptions(),this.options.api={optionsChanged:this.optionsChanged,resize:this.onResize,getNextPossiblePosition:this.getNextPossiblePosition,getFirstPossiblePosition:this.getFirstPossiblePosition,getLastPossiblePosition:this.getLastPossiblePosition,getItemComponent:f=>this.getItemComponent(f)},this.columns=this.$options.minCols,this.rows=this.$options.minRows+this.$options.addEmptyRowsCount,this.setGridSize(),this.calculateLayout())}resize(){let _,f;"fit"!==this.$options.gridType||this.mobile?(f=this.el.clientWidth,_=this.el.clientHeight):(f=this.el.offsetWidth,_=this.el.offsetHeight),(f!==this.curWidth||_!==this.curHeight)&&this.checkIfToResize()&&this.onResize()}setOptions(){this.$options=q.merge(this.$options,this.options,this.$options),this.$options.disableWindowResize||this.windowResize?this.$options.disableWindowResize&&this.windowResize&&(this.windowResize(),this.windowResize=null):this.windowResize=this.renderer.listen("window","resize",this.onResize),this.emptyCell.updateOptions()}ngOnDestroy(){this.destroy$.next(),this.previewStyle$.complete(),this.windowResize&&this.windowResize(),this.options&&this.options.destroyCallback&&this.options.destroyCallback(this),this.options&&this.options.api&&(this.options.api.resize=void 0,this.options.api.optionsChanged=void 0,this.options.api.getNextPossiblePosition=void 0,this.options.api=void 0),this.emptyCell.destroy(),this.emptyCell=null,this.compact.destroy(),this.compact=null}checkIfToResize(){const _=this.el.clientWidth,f=this.el.offsetWidth,S=this.el.scrollWidth,V=this.el.clientHeight,H=this.el.offsetHeight,ge=this.el.scrollHeight;return!(_<f&&ge>H&&ge-H<f-_||V<H&&S>f&&S-f<H-V)}checkIfMobile(){return this.$options.useBodyForBreakpoint?this.$options.mobileBreakpoint>document.body.clientWidth:this.$options.mobileBreakpoint>this.curWidth}setGridSize(){const _=this.el;let f,S;this.$options.setGridSize||this.$options.gridType===b.Fit&&!this.mobile?(f=_.offsetWidth,S=_.offsetHeight):(f=_.clientWidth,S=_.clientHeight),this.curWidth=f,this.curHeight=S}setGridDimensions(){this.setGridSize(),!this.mobile&&this.checkIfMobile()?(this.mobile=!this.mobile,this.renderer.addClass(this.el,"mobile")):this.mobile&&!this.checkIfMobile()&&(this.mobile=!this.mobile,this.renderer.removeClass(this.el,"mobile"));let V,_=this.$options.minRows,f=this.$options.minCols,S=this.grid.length-1;for(;S>=0;S--)V=this.grid[S],V.notPlaced||(_=Math.max(_,V.$item.y+V.$item.rows),f=Math.max(f,V.$item.x+V.$item.cols));_+=this.$options.addEmptyRowsCount,(this.columns!==f||this.rows!==_)&&(this.columns=f,this.rows=_,this.options.gridSizeChangedCallback&&this.options.gridSizeChangedCallback(this))}calculateLayout(){if(this.compact&&this.compact.checkCompact(),this.setGridDimensions(),this.$options.outerMargin){let S=-this.$options.margin;null!==this.$options.outerMarginLeft?(S+=this.$options.outerMarginLeft,this.renderer.setStyle(this.el,"padding-left",this.$options.outerMarginLeft+"px")):(S+=this.$options.margin,this.renderer.setStyle(this.el,"padding-left",this.$options.margin+"px")),null!==this.$options.outerMarginRight?(S+=this.$options.outerMarginRight,this.renderer.setStyle(this.el,"padding-right",this.$options.outerMarginRight+"px")):(S+=this.$options.margin,this.renderer.setStyle(this.el,"padding-right",this.$options.margin+"px")),this.curColWidth=(this.curWidth-S)/this.columns;let V=-this.$options.margin;null!==this.$options.outerMarginTop?(V+=this.$options.outerMarginTop,this.renderer.setStyle(this.el,"padding-top",this.$options.outerMarginTop+"px")):(V+=this.$options.margin,this.renderer.setStyle(this.el,"padding-top",this.$options.margin+"px")),null!==this.$options.outerMarginBottom?(V+=this.$options.outerMarginBottom,this.renderer.setStyle(this.el,"padding-bottom",this.$options.outerMarginBottom+"px")):(V+=this.$options.margin,this.renderer.setStyle(this.el,"padding-bottom",this.$options.margin+"px")),this.curRowHeight=(this.curHeight-V)/this.rows*this.$options.rowHeightRatio}else this.curColWidth=(this.curWidth+this.$options.margin)/this.columns,this.curRowHeight=(this.curHeight+this.$options.margin)/this.rows*this.$options.rowHeightRatio,this.renderer.setStyle(this.el,"padding-left","0px"),this.renderer.setStyle(this.el,"padding-right","0px"),this.renderer.setStyle(this.el,"padding-top","0px"),this.renderer.setStyle(this.el,"padding-bottom","0px");this.gridRenderer.updateGridster(),this.$options.setGridSize?(this.renderer.addClass(this.el,"gridSize"),this.mobile||(this.renderer.setStyle(this.el,"width",this.columns*this.curColWidth+this.$options.margin+"px"),this.renderer.setStyle(this.el,"height",this.rows*this.curRowHeight+this.$options.margin+"px"))):(this.renderer.removeClass(this.el,"gridSize"),this.renderer.setStyle(this.el,"width",""),this.renderer.setStyle(this.el,"height","")),this.updateGrid();let f,_=this.grid.length-1;for(;_>=0;_--)f=this.grid[_],f.setSize(),f.drag.toggle(),f.resize.toggle();this.resize$.next()}updateGrid(){"always"!==this.$options.displayGrid||this.mobile?"onDrag&Resize"===this.$options.displayGrid&&this.dragInProgress?this.renderer.addClass(this.el,"display-grid"):("none"===this.$options.displayGrid||!this.dragInProgress||this.mobile)&&this.renderer.removeClass(this.el,"display-grid"):this.renderer.addClass(this.el,"display-grid"),this.setGridDimensions(),this.gridColumns.length=K.getNewArrayLength(this.columns,this.curWidth,this.curColWidth),this.gridRows.length=K.getNewArrayLength(this.rows,this.curHeight,this.curRowHeight),this.cdRef.markForCheck()}addItem(_){void 0===_.$item.cols&&(_.$item.cols=this.$options.defaultItemCols,_.item.cols=_.$item.cols,_.itemChanged()),void 0===_.$item.rows&&(_.$item.rows=this.$options.defaultItemRows,_.item.rows=_.$item.rows,_.itemChanged()),-1===_.$item.x||-1===_.$item.y?this.autoPositionItem(_):this.checkCollision(_.$item)&&(this.$options.disableWarnings||(_.notPlaced=!0,console.warn("Can't be placed in the bounds of the dashboard, trying to auto position!/n"+JSON.stringify(_.item,["cols","rows","x","y"]))),this.$options.disableAutoPositionOnConflict?_.notPlaced=!0:this.autoPositionItem(_)),this.grid.push(_),this.calculateLayout$.next()}removeItem(_){this.grid.splice(this.grid.indexOf(_),1),this.calculateLayout$.next(),this.options.itemRemovedCallback&&this.options.itemRemovedCallback(_.item,_)}checkCollision(_){let f=!1;if(this.options.itemValidateCallback&&(f=!this.options.itemValidateCallback(_)),!f&&this.checkGridCollision(_)&&(f=!0),!f){const S=this.findItemWithItem(_);S&&(f=S)}return f}checkGridCollision(_){const $e=_.cols*_.rows;return!(_.y>-1&&_.x>-1&&_.cols+_.x<=this.$options.maxCols&&_.rows+_.y<=this.$options.maxRows&&_.cols<=(void 0===_.maxItemCols?this.$options.maxItemCols:_.maxItemCols)&&_.cols>=(void 0===_.minItemCols?this.$options.minItemCols:_.minItemCols)&&_.rows<=(void 0===_.maxItemRows?this.$options.maxItemRows:_.maxItemRows)&&_.rows>=(void 0===_.minItemRows?this.$options.minItemRows:_.minItemRows)&&(void 0===_.minItemArea?this.$options.minItemArea:_.minItemArea)<=$e&&(void 0===_.maxItemArea?this.$options.maxItemArea:_.maxItemArea)>=$e)}findItemWithItem(_){let S,f=0;for(;f<this.grid.length;f++)if(S=this.grid[f],S.$item!==_&&this.checkCollisionTwoItems(S.$item,_))return S;return!1}findItemsWithItem(_){const f=[];let V,S=0;for(;S<this.grid.length;S++)V=this.grid[S],V.$item!==_&&this.checkCollisionTwoItems(V.$item,_)&&f.push(V);return f}autoPositionItem(_){this.getNextPossiblePosition(_.$item)?(_.notPlaced=!1,_.item.x=_.$item.x,_.item.y=_.$item.y,_.itemChanged()):(_.notPlaced=!0,this.$options.disableWarnings||console.warn("Can't be placed in the bounds of the dashboard!/n"+JSON.stringify(_.item,["cols","rows","x","y"])))}pixelsToPositionX(_,f,S){const V=f(_/this.curColWidth);return S?V:Math.max(V,0)}pixelsToPositionY(_,f,S){const V=f(_/this.curRowHeight);return S?V:Math.max(V,0)}positionXToPixels(_){return _*this.curColWidth}positionYToPixels(_){return _*this.curRowHeight}getItemComponent(_){return this.grid.find(f=>f.item===_)}checkCollisionForSwaping(_){let f=!1;if(this.options.itemValidateCallback&&(f=!this.options.itemValidateCallback(_)),!f&&this.checkGridCollision(_)&&(f=!0),!f){const S=this.findItemWithItemForSwapping(_);S&&(f=S)}return f}findItemWithItemForSwapping(_){let S,f=this.grid.length-1;for(;f>-1;f--)if(S=this.grid[f],S.$item!==_&&K.checkCollisionTwoItemsForSwaping(S.$item,_))return S;return!1}previewStyle(_=!1){this.movingItem?(this.compact&&_&&this.compact.checkCompactItem(this.movingItem),this.previewStyle$.next(this.movingItem)):this.previewStyle$.next(null)}static getNewArrayLength(_,f,S){const V=Math.max(_,Math.floor(f/S));return V<0?0:Number.isFinite(V)?Math.floor(V):0}}return K.\u0275fac=function(_){return new(_||K)(s.Y36(s.SBq),s.Y36(s.Qsj),s.Y36(s.sBO),s.Y36(s.R0b))},K.\u0275cmp=s.Xpm({type:K,selectors:[["gridster"]],inputs:{options:"options"},features:[s.TTD],ngContentSelectors:v,decls:4,vars:4,consts:[["class","gridster-column",3,"ngStyle",4,"ngFor","ngForOf"],["class","gridster-row",3,"ngStyle",4,"ngFor","ngForOf"],[1,"gridster-preview",3,"gridRenderer","previewStyle$"],[1,"gridster-column",3,"ngStyle"],[1,"gridster-row",3,"ngStyle"]],template:function(_,f){1&_&&(s.F$t(),s.YNc(0,C,1,1,"div",0),s.YNc(1,p,1,1,"div",1),s.Hsn(2),s._UZ(3,"gridster-preview",2)),2&_&&(s.Q6J("ngForOf",f.gridColumns),s.xp6(1),s.Q6J("ngForOf",f.gridRows),s.xp6(2),s.Q6J("gridRenderer",f.gridRenderer)("previewStyle$",f.previewStyle$))},directives:[pe,A.sg,A.PC],styles:["gridster{position:relative;box-sizing:border-box;background:grey;width:100%;height:100%;-webkit-user-select:none;user-select:none;display:block}gridster.fit{overflow-x:hidden;overflow-y:hidden}gridster.scrollVertical{overflow-x:hidden;overflow-y:auto}gridster.scrollHorizontal{overflow-x:auto;overflow-y:hidden}gridster.fixed{overflow:auto}gridster.mobile{overflow-x:hidden;overflow-y:auto}gridster.mobile gridster-item{position:relative}gridster.gridSize{height:initial;width:initial}gridster.gridSize.fit{height:100%;width:100%}gridster .gridster-column,gridster .gridster-row{position:absolute;display:none;transition:.3s;box-sizing:border-box}gridster.display-grid .gridster-column,gridster.display-grid .gridster-row{display:block}gridster .gridster-column{border-left:1px solid white;border-right:1px solid white}gridster .gridster-row{border-top:1px solid white;border-bottom:1px solid white}\n"],encapsulation:2}),K})();class ae{constructor(u){this.iteration=0,this.pushedItems=[],this.pushedItemsTemp=[],this.pushedItemsTempPath=[],this.pushedItemsPath=[],this.gridsterItem=u,this.gridster=u.gridster,this.tryPattern={fromEast:[this.tryWest,this.trySouth,this.tryNorth,this.tryEast],fromWest:[this.tryEast,this.trySouth,this.tryNorth,this.tryWest],fromNorth:[this.trySouth,this.tryEast,this.tryWest,this.tryNorth],fromSouth:[this.tryNorth,this.tryEast,this.tryWest,this.trySouth]},this.fromSouth="fromSouth",this.fromNorth="fromNorth",this.fromEast="fromEast",this.fromWest="fromWest"}destroy(){this.gridster=this.gridsterItem=null}pushItems(u,_){if(this.gridster.$options.pushItems&&!_){this.pushedItemsOrder=[],this.iteration=0;const f=this.push(this.gridsterItem,u);return f||this.restoreTempItems(),this.pushedItemsOrder=[],this.pushedItemsTemp=[],this.pushedItemsTempPath=[],f}return!1}restoreTempItems(){let u=this.pushedItemsTemp.length-1;for(;u>-1;u--)this.removeFromTempPushed(this.pushedItemsTemp[u])}restoreItems(){let u=0;const _=this.pushedItems.length;let f;for(;u<_;u++)f=this.pushedItems[u],f.$item.x=f.item.x||0,f.$item.y=f.item.y||0,f.setSize();this.pushedItems=[],this.pushedItemsPath=[]}setPushedItems(){let u=0;const _=this.pushedItems.length;let f;for(;u<_;u++)f=this.pushedItems[u],f.checkItemChanges(f.$item,f.item);this.pushedItems=[],this.pushedItemsPath=[]}checkPushBack(){let u=this.pushedItems.length-1,_=!1;for(;u>-1;u--)this.checkPushedItem(this.pushedItems[u],u)&&(_=!0);_&&this.checkPushBack()}push(u,_){if(this.iteration>100)return console.warn("max iteration reached"),!1;if(this.gridster.checkGridCollision(u.$item)||""===_)return!1;const f=this.gridster.findItemsWithItem(u.$item),S=_===this.fromNorth||_===this.fromWest;f.sort((fe,Ie)=>S?Ie.$item.y-fe.$item.y||Ie.$item.x-fe.$item.x:fe.$item.y-Ie.$item.y||fe.$item.x-Ie.$item.x);let H,V=0,ge=!0;const Ce=[];for(;V<f.length;V++){if(H=f[V],H===this.gridsterItem)continue;if(!H.canBeDragged()){ge=!1;break}const fe=this.pushedItemsTemp.indexOf(H);if(fe>-1&&this.pushedItemsTempPath[fe].length>10){ge=!1;break}if(this.tryPattern[_][0].call(this,H,u))this.pushedItemsOrder.push(H),Ce.push(H);else if(this.tryPattern[_][1].call(this,H,u))this.pushedItemsOrder.push(H),Ce.push(H);else if(this.tryPattern[_][2].call(this,H,u))this.pushedItemsOrder.push(H),Ce.push(H);else{if(!this.tryPattern[_][3].call(this,H,u)){ge=!1;break}this.pushedItemsOrder.push(H),Ce.push(H)}}if(!ge&&(V=this.pushedItemsOrder.lastIndexOf(Ce[0]),V>-1)){let fe=this.pushedItemsOrder.length-1;for(;fe>=V;fe--)H=this.pushedItemsOrder[fe],this.pushedItemsOrder.pop(),this.removeFromTempPushed(H),this.removeFromPushedItem(H)}return this.iteration++,ge}trySouth(u,_){return!!this.gridster.$options.pushDirections.south&&(this.addToTempPushed(u),u.$item.y=_.$item.y+_.$item.rows,this.push(u,this.fromNorth)?(u.setSize(),this.addToPushed(u),!0):(this.removeFromTempPushed(u),!1))}tryNorth(u,_){return!!this.gridster.$options.pushDirections.north&&(this.addToTempPushed(u),u.$item.y=_.$item.y-u.$item.rows,this.push(u,this.fromSouth)?(u.setSize(),this.addToPushed(u),!0):(this.removeFromTempPushed(u),!1))}tryEast(u,_){return!!this.gridster.$options.pushDirections.east&&(this.addToTempPushed(u),u.$item.x=_.$item.x+_.$item.cols,this.push(u,this.fromWest)?(u.setSize(),this.addToPushed(u),!0):(this.removeFromTempPushed(u),!1))}tryWest(u,_){return!!this.gridster.$options.pushDirections.west&&(this.addToTempPushed(u),u.$item.x=_.$item.x-u.$item.cols,this.push(u,this.fromEast)?(u.setSize(),this.addToPushed(u),!0):(this.removeFromTempPushed(u),!1))}addToTempPushed(u){let _=this.pushedItemsTemp.indexOf(u);-1===_&&(_=this.pushedItemsTemp.push(u)-1,this.pushedItemsTempPath[_]=[]),this.pushedItemsTempPath[_].push({x:u.$item.x,y:u.$item.y})}removeFromTempPushed(u){const _=this.pushedItemsTemp.indexOf(u),f=this.pushedItemsTempPath[_].pop();!f||(u.$item.x=f.x,u.$item.y=f.y,u.setSize(),this.pushedItemsTempPath[_].length||(this.pushedItemsTemp.splice(_,1),this.pushedItemsTempPath.splice(_,1)))}addToPushed(u){if(this.pushedItems.indexOf(u)<0)this.pushedItems.push(u),this.pushedItemsPath.push([{x:u.item.x||0,y:u.item.y||0},{x:u.$item.x,y:u.$item.y}]);else{const _=this.pushedItems.indexOf(u);this.pushedItemsPath[_].push({x:u.$item.x,y:u.$item.y})}}removeFromPushed(u){u>-1&&(this.pushedItems.splice(u,1),this.pushedItemsPath.splice(u,1))}removeFromPushedItem(u){const _=this.pushedItems.indexOf(u);_>-1&&(this.pushedItemsPath[_].pop(),this.pushedItemsPath.length||(this.pushedItems.splice(_,1),this.pushedItemsPath.splice(_,1)))}checkPushedItem(u,_){const f=this.pushedItemsPath[_];let V,H,ge,S=f.length-2,Ce=!1;for(;S>-1;S--)V=f[S],H=u.$item.x,ge=u.$item.y,u.$item.x=V.x,u.$item.y=V.y,this.gridster.findItemWithItem(u.$item)?(u.$item.x=H,u.$item.y=ge):(u.setSize(),f.splice(S+1,f.length-S-1),Ce=!0);return f.length<2&&this.removeFromPushed(_),Ce}}function mt(K,u,_,f,S,V,H,ge,Ce,fe){Y=K.$options.scrollSensitivity,j=K.$options.scrollSpeed,ie=K.el,Te=Ce,Ee=fe;const Ie=ie.offsetWidth,Ke=ie.scrollLeft,Je=ie.scrollTop,$e=_-Je,Ye=ie.offsetHeight+Je-_-S,{clientX:rt,clientY:Be}=V;if(!K.$options.disableScrollVertical)if(H.clientY<Be&&Ye<Y){if(pt(),Te&&Ee&&!Ee.south||ot)return;ot=ft(1,ge,H)}else if(H.clientY>Be&&Je>0&&$e<Y){if(Ot(),Te&&Ee&&!Ee.north||Re)return;Re=ft(-1,ge,H)}else H.clientY!==Be&&ut();const lt=u-Ke;if(!K.$options.disableScrollHorizontal)if(H.clientX<rt&&Ke+Ie-u-f<=Y){if(Ct(),Te&&Ee&&!Ee.east||ze)return;ze=Ae(1,ge,H)}else if(H.clientX>rt&&Ke>0&&lt<Y){if(Tt(),Te&&Ee&&!Ee.west||Ve)return;Ve=Ae(-1,ge,H)}else H.clientX!==rt&&_t()}function ft(K,u,_){let f=_.clientY;return window.setInterval(()=>{(!ie||-1===K&&ie.scrollTop-j<0)&&ut(),ie.scrollTop+=K*j,f+=K*j,u({clientX:_.clientX,clientY:f})},50)}function Ae(K,u,_){let f=_.clientX;return window.setInterval(()=>{(!ie||-1===K&&ie.scrollLeft-j<0)&&_t(),ie.scrollLeft+=K*j,f+=K*j,u({clientX:f,clientY:_.clientY})},50)}function it(){_t(),ut(),ie=null}function _t(){Tt(),Ct()}function ut(){pt(),Ot()}function Tt(){ze&&(clearInterval(ze),ze=0)}function Ct(){Ve&&(clearInterval(Ve),Ve=0)}function Ot(){ot&&(clearInterval(ot),ot=0)}function pt(){Re&&(clearInterval(Re),Re=0)}class gt{constructor(u){this.gridsterItem=u,this.gridster=u.gridster}destroy(){this.gridster=this.gridsterItem=this.swapedItem=null}swapItems(){this.gridster.$options.swap&&(this.checkSwapBack(),this.checkSwap(this.gridsterItem))}checkSwapBack(){if(this.swapedItem){const u=this.swapedItem.$item.x,_=this.swapedItem.$item.y;this.swapedItem.$item.x=this.swapedItem.item.x||0,this.swapedItem.$item.y=this.swapedItem.item.y||0,this.gridster.checkCollision(this.swapedItem.$item)?(this.swapedItem.$item.x=u,this.swapedItem.$item.y=_):(this.swapedItem.setSize(),this.gridsterItem.$item.x=this.gridsterItem.item.x||0,this.gridsterItem.$item.y=this.gridsterItem.item.y||0,this.swapedItem=void 0)}}restoreSwapItem(){this.swapedItem&&(this.swapedItem.$item.x=this.swapedItem.item.x||0,this.swapedItem.$item.y=this.swapedItem.item.y||0,this.swapedItem.setSize(),this.swapedItem=void 0)}setSwapItem(){this.swapedItem&&(this.swapedItem.checkItemChanges(this.swapedItem.$item,this.swapedItem.item),this.swapedItem=void 0)}checkSwap(u){let _;if(_=this.gridster.$options.swapWhileDragging?this.gridster.checkCollisionForSwaping(u.$item):this.gridster.checkCollision(u.$item),_&&!0!==_&&_.canBeDragged()){const f=_,S=f.$item.x,V=f.$item.y,H=u.$item.x,ge=u.$item.y,Ce=H-S,fe=ge-V;f.$item.x=u.item.x-Ce,f.$item.y=u.item.y-fe,u.$item.x=f.item.x+Ce,u.$item.y=f.item.y+fe,this.gridster.checkCollision(f.$item)||this.gridster.checkCollision(u.$item)?(u.$item.x=H,u.$item.y=ge,f.$item.x=S,f.$item.y=V):(f.setSize(),this.swapedItem=f,this.gridster.$options.swapWhileDragging&&(this.gridsterItem.checkItemChanges(this.gridsterItem.$item,this.gridsterItem.item),this.setSwapItem()))}}}var be=(()=>{return(K=be||(be={})).UP="UP",K.DOWN="DOWN",K.LEFT="LEFT",K.RIGHT="RIGHT",be;var K})();class yt{constructor(u,_,f){this.zone=f,this.collision=!1,this.dragMove=S=>{S.stopPropagation(),S.preventDefault(),q.checkTouchEvent(S);let V=this.getDirections(S);this.gridster.options.enableBoundaryControl&&(V.includes(be.UP)&&this.gridsterItem.el.getBoundingClientRect().top<=this.gridster.el.getBoundingClientRect().top+this.margin&&(V=V.filter(H=>H!=be.UP),S=new MouseEvent(S.type,{clientX:S.clientX,clientY:this.lastMouse.clientY})),V.includes(be.LEFT)&&this.gridsterItem.el.getBoundingClientRect().left<=this.gridster.el.getBoundingClientRect().left+this.margin&&(V=V.filter(H=>H!=be.LEFT),S=new MouseEvent(S.type,{clientX:this.lastMouse.clientX,clientY:S.clientY})),V.includes(be.RIGHT)&&this.gridsterItem.el.getBoundingClientRect().right>=this.gridster.el.getBoundingClientRect().right-this.margin&&(V=V.filter(H=>H!=be.RIGHT),S=new MouseEvent(S.type,{clientX:this.lastMouse.clientX,clientY:S.clientY})),V.includes(be.DOWN)&&this.gridsterItem.el.getBoundingClientRect().bottom>=this.gridster.el.getBoundingClientRect().bottom-this.margin&&(V=V.filter(H=>H!=be.DOWN),S=new MouseEvent(S.type,{clientX:S.clientX,clientY:this.lastMouse.clientY}))),V.length&&(this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,mt(this.gridster,this.left,this.top,this.width,this.height,S,this.lastMouse,this.calculateItemPositionFromMousePosition),this.calculateItemPositionFromMousePosition(S))},this.calculateItemPositionFromMousePosition=S=>{this.gridster.options.scale?this.calculateItemPositionWithScale(S,this.gridster.options.scale):this.calculateItemPositionWithoutScale(S),this.calculateItemPosition(),this.lastMouse.clientX=S.clientX,this.lastMouse.clientY=S.clientY,this.zone.run(()=>{this.gridster.updateGrid()})},this.dragStop=S=>{S.stopPropagation(),S.preventDefault(),it(),this.cancelOnBlur(),this.mousemove(),this.mouseup(),this.mouseleave(),this.touchmove(),this.touchend(),this.touchcancel(),this.gridsterItem.renderer.removeClass(this.gridsterItem.el,"gridster-item-moving"),this.gridster.dragInProgress=!1,this.gridster.updateGrid(),this.path=[],this.gridster.options.draggable&&this.gridster.options.draggable.stop?Promise.resolve(this.gridster.options.draggable.stop(this.gridsterItem.item,this.gridsterItem,S)).then(this.makeDrag,this.cancelDrag):this.makeDrag(),setTimeout(()=>{this.gridster&&(this.gridster.movingItem=null,this.gridster.previewStyle(!0))})},this.cancelDrag=()=>{this.gridsterItem.$item.x=this.gridsterItem.item.x||0,this.gridsterItem.$item.y=this.gridsterItem.item.y||0,this.gridsterItem.setSize(),this.push&&this.push.restoreItems(),this.swap&&this.swap.restoreSwapItem(),this.push&&(this.push.destroy(),this.push=null),this.swap&&(this.swap.destroy(),this.swap=null)},this.makeDrag=()=>{this.gridster.$options.draggable.dropOverItems&&this.gridster.options.draggable&&this.gridster.options.draggable.dropOverItemsCallback&&this.collision&&!0!==this.collision&&this.collision.$item&&this.gridster.options.draggable.dropOverItemsCallback(this.gridsterItem.item,this.collision.item,this.gridster),this.collision=!1,this.gridsterItem.setSize(),this.gridsterItem.checkItemChanges(this.gridsterItem.$item,this.gridsterItem.item),this.push&&this.push.setPushedItems(),this.swap&&this.swap.setSwapItem(),this.push&&(this.push.destroy(),this.push=null),this.swap&&(this.swap.destroy(),this.swap=null)},this.dragStartDelay=S=>{if(S.target.classList.contains("gridster-item-resizable-handler")||q.checkContentClassForEvent(this.gridster,S))return;if(q.checkTouchEvent(S),!this.gridster.$options.draggable.delayStart)return void this.dragStart(S);const H=setTimeout(()=>{this.dragStart(S),$e()},this.gridster.$options.draggable.delayStart),ge=this.gridsterItem.renderer.listen("document","mouseup",$e),Ce=this.gridsterItem.renderer.listen("document","mouseleave",$e),fe=this.gridsterItem.renderer.listen("window","blur",$e),Ie=this.gridsterItem.renderer.listen("document","touchmove",function Je(Ye){q.checkTouchEvent(Ye),(Math.abs(Ye.clientX-S.clientX)>9||Math.abs(Ye.clientY-S.clientY)>9)&&$e()}),xe=this.gridsterItem.renderer.listen("document","touchend",$e),Ke=this.gridsterItem.renderer.listen("document","touchcancel",$e);function $e(){clearTimeout(H),fe(),ge(),Ce(),Ie(),xe(),Ke()}},this.gridsterItem=u,this.gridster=_,this.lastMouse={clientX:0,clientY:0},this.path=[]}destroy(){this.gridster.previewStyle&&this.gridster.previewStyle(!0),this.gridsterItem=this.gridster=this.collision=null,this.mousedown&&(this.mousedown(),this.touchstart())}dragStart(u){u.which&&1!==u.which||(this.gridster.options.draggable&&this.gridster.options.draggable.start&&this.gridster.options.draggable.start(this.gridsterItem.item,this.gridsterItem,u),u.stopPropagation(),u.preventDefault(),this.zone.runOutsideAngular(()=>{this.mousemove=this.gridsterItem.renderer.listen("document","mousemove",this.dragMove),this.touchmove=this.gridster.renderer.listen(this.gridster.el,"touchmove",this.dragMove)}),this.mouseup=this.gridsterItem.renderer.listen("document","mouseup",this.dragStop),this.mouseleave=this.gridsterItem.renderer.listen("document","mouseleave",this.dragStop),this.cancelOnBlur=this.gridsterItem.renderer.listen("window","blur",this.dragStop),this.touchend=this.gridsterItem.renderer.listen("document","touchend",this.dragStop),this.touchcancel=this.gridsterItem.renderer.listen("document","touchcancel",this.dragStop),this.gridsterItem.renderer.addClass(this.gridsterItem.el,"gridster-item-moving"),this.margin=this.gridster.$options.margin,this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,this.left=this.gridsterItem.left-this.margin,this.top=this.gridsterItem.top-this.margin,this.originalClientX=u.clientX,this.originalClientY=u.clientY,this.width=this.gridsterItem.width,this.height=this.gridsterItem.height,this.diffLeft=this.gridster.$options.dirType===L.RTL?u.clientX-this.gridster.el.scrollWidth+this.gridsterItem.left:u.clientX+this.offsetLeft-this.margin-this.left,this.diffTop=u.clientY+this.offsetTop-this.margin-this.top,this.gridster.movingItem=this.gridsterItem.$item,this.gridster.previewStyle(!0),this.push=new ae(this.gridsterItem),this.swap=new gt(this.gridsterItem),this.gridster.dragInProgress=!0,this.gridster.updateGrid(),this.path.push({x:this.gridsterItem.item.x||0,y:this.gridsterItem.item.y||0}))}calculateItemPositionWithScale(u,_){this.left=this.gridster.$options.dirType===L.RTL?this.gridster.el.scrollWidth-this.originalClientX+(u.clientX-this.originalClientX)/_+this.diffLeft:this.originalClientX+(u.clientX-this.originalClientX)/_+this.offsetLeft-this.diffLeft,this.top=this.originalClientY+(u.clientY-this.originalClientY)/_+this.offsetTop-this.diffTop}calculateItemPositionWithoutScale(u){this.left=this.gridster.$options.dirType===L.RTL?this.gridster.el.scrollWidth-u.clientX+this.diffLeft:u.clientX+this.offsetLeft-this.diffLeft,this.top=u.clientY+this.offsetTop-this.diffTop}calculateItemPosition(){if(this.gridster.movingItem=this.gridsterItem.$item,this.positionX=this.gridster.pixelsToPositionX(this.left,Math.round),this.positionY=this.gridster.pixelsToPositionY(this.top,Math.round),this.positionXBackup=this.gridsterItem.$item.x,this.positionYBackup=this.gridsterItem.$item.y,this.gridsterItem.$item.x=this.positionX,this.gridster.checkGridCollision(this.gridsterItem.$item)&&(this.gridsterItem.$item.x=this.positionXBackup),this.gridsterItem.$item.y=this.positionY,this.gridster.checkGridCollision(this.gridsterItem.$item)&&(this.gridsterItem.$item.y=this.positionYBackup),this.gridster.gridRenderer.setCellPosition(this.gridsterItem.renderer,this.gridsterItem.el,this.left,this.top),this.positionXBackup!==this.gridsterItem.$item.x||this.positionYBackup!==this.gridsterItem.$item.y){const u=this.path[this.path.length-1];let _="";u.x<this.gridsterItem.$item.x?_=this.push.fromWest:u.x>this.gridsterItem.$item.x?_=this.push.fromEast:u.y<this.gridsterItem.$item.y?_=this.push.fromNorth:u.y>this.gridsterItem.$item.y&&(_=this.push.fromSouth),this.push.pushItems(_,this.gridster.$options.disablePushOnDrag),this.swap.swapItems(),this.collision=this.gridster.checkCollision(this.gridsterItem.$item),this.collision?(this.gridsterItem.$item.x=this.positionXBackup,this.gridsterItem.$item.y=this.positionYBackup,this.gridster.$options.draggable.dropOverItems&&!0!==this.collision&&this.collision.$item&&(this.gridster.movingItem=null)):this.path.push({x:this.gridsterItem.$item.x,y:this.gridsterItem.$item.y}),this.push.checkPushBack()}this.gridster.previewStyle(!0)}toggle(){const u=this.gridsterItem.canBeDragged();!this.enabled&&u?(this.enabled=!this.enabled,this.mousedown=this.gridsterItem.renderer.listen(this.gridsterItem.el,"mousedown",this.dragStartDelay),this.touchstart=this.gridsterItem.renderer.listen(this.gridsterItem.el,"touchstart",this.dragStartDelay)):this.enabled&&!u&&(this.enabled=!this.enabled,this.mousedown(),this.touchstart())}getDirections(u){const _=[];return this.lastMouse.clientY>u.clientY&&_.push(be.UP),this.lastMouse.clientY<u.clientY&&_.push(be.DOWN),this.lastMouse.clientX<u.clientX&&_.push(be.RIGHT),this.lastMouse.clientX>u.clientX&&_.push(be.LEFT),_}}class Jt{constructor(u){this.pushedItems=[],this.pushedItemsPath=[],this.gridsterItem=u,this.gridster=u.gridster,this.tryPattern={fromEast:this.tryWest,fromWest:this.tryEast,fromNorth:this.trySouth,fromSouth:this.tryNorth},this.fromSouth="fromSouth",this.fromNorth="fromNorth",this.fromEast="fromEast",this.fromWest="fromWest"}destroy(){this.gridster=this.gridsterItem=null}pushItems(u){return!!this.gridster.$options.pushResizeItems&&this.push(this.gridsterItem,u)}restoreItems(){let u=0;const _=this.pushedItems.length;let f;for(;u<_;u++)f=this.pushedItems[u],f.$item.x=f.item.x||0,f.$item.y=f.item.y||0,f.$item.cols=f.item.cols||1,f.$item.row=f.item.row||1,f.setSize();this.pushedItems=[],this.pushedItemsPath=[]}setPushedItems(){let u=0;const _=this.pushedItems.length;let f;for(;u<_;u++)f=this.pushedItems[u],f.checkItemChanges(f.$item,f.item);this.pushedItems=[],this.pushedItemsPath=[]}checkPushBack(){let u=this.pushedItems.length-1,_=!1;for(;u>-1;u--)this.checkPushedItem(this.pushedItems[u],u)&&(_=!0);_&&this.checkPushBack()}push(u,_){const f=this.gridster.checkCollision(u.$item);if(f&&!0!==f&&f!==this.gridsterItem&&f.canBeResized()){if(this.tryPattern[_].call(this,f,u,_))return!0}else if(!1===f)return!0;return!1}trySouth(u,_,f){const S=u.$item.y,V=u.$item.rows;return u.$item.y=_.$item.y+_.$item.rows,u.$item.rows=V+S-u.$item.y,this.gridster.checkCollisionTwoItems(u.$item,_.$item)||this.gridster.checkGridCollision(u.$item)?(u.$item.y=S,u.$item.rows=V,!1):(u.setSize(),this.addToPushed(u),this.push(_,f),!0)}tryNorth(u,_,f){const S=u.$item.rows;return u.$item.rows=_.$item.y-u.$item.y,this.gridster.checkCollisionTwoItems(u.$item,_.$item)||this.gridster.checkGridCollision(u.$item)?(u.$item.rows=S,!1):(u.setSize(),this.addToPushed(u),this.push(_,f),!0)}tryEast(u,_,f){const S=u.$item.x,V=u.$item.cols;return u.$item.x=_.$item.x+_.$item.cols,u.$item.cols=V+S-u.$item.x,this.gridster.checkCollisionTwoItems(u.$item,_.$item)||this.gridster.checkGridCollision(u.$item)?(u.$item.x=S,u.$item.cols=V,!1):(u.setSize(),this.addToPushed(u),this.push(_,f),!0)}tryWest(u,_,f){const S=u.$item.cols;return u.$item.cols=_.$item.x-u.$item.x,this.gridster.checkCollisionTwoItems(u.$item,_.$item)||this.gridster.checkGridCollision(u.$item)?(u.$item.cols=S,!1):(u.setSize(),this.addToPushed(u),this.push(_,f),!0)}addToPushed(u){if(this.pushedItems.indexOf(u)<0)this.pushedItems.push(u),this.pushedItemsPath.push([{x:u.item.x||0,y:u.item.y||0,cols:u.item.cols||0,rows:u.item.rows||0},{x:u.$item.x,y:u.$item.y,cols:u.$item.cols,rows:u.$item.rows}]);else{const _=this.pushedItems.indexOf(u);this.pushedItemsPath[_].push({x:u.$item.x,y:u.$item.y,cols:u.$item.cols,rows:u.$item.rows})}}removeFromPushed(u){u>-1&&(this.pushedItems.splice(u,1),this.pushedItemsPath.splice(u,1))}checkPushedItem(u,_){const f=this.pushedItemsPath[_];let V,H,ge,Ce,fe,S=f.length-2;for(;S>-1;S--)V=f[S],H=u.$item.x,ge=u.$item.y,Ce=u.$item.cols,fe=u.$item.rows,u.$item.x=V.x,u.$item.y=V.y,u.$item.cols=V.cols,u.$item.rows=V.rows,this.gridster.findItemWithItem(u.$item)?(u.$item.x=H,u.$item.y=ge,u.$item.cols=Ce,u.$item.rows=fe):(u.setSize(),f.splice(S+1,f.length-1-S));return f.length<2&&(this.removeFromPushed(_),!0)}}class Mt{constructor(u,_,f){this.zone=f,this.directionFunction=null,this.dragMove=S=>{if(null===this.directionFunction)throw new Error("The `directionFunction` has not been set before calling `dragMove`.");S.stopPropagation(),S.preventDefault(),q.checkTouchEvent(S),this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,mt(this.gridster,this.left,this.top,this.width,this.height,S,this.lastMouse,this.directionFunction,!0,this.resizeEventScrollType);const V=this.gridster.options.scale||1;this.directionFunction({clientX:this.originalClientX+(S.clientX-this.originalClientX)/V,clientY:this.originalClientY+(S.clientY-this.originalClientY)/V}),this.lastMouse.clientX=S.clientX,this.lastMouse.clientY=S.clientY,this.zone.run(()=>{this.gridster.updateGrid()})},this.dragStop=S=>{S.stopPropagation(),S.preventDefault(),it(),this.mousemove(),this.mouseup(),this.mouseleave(),this.cancelOnBlur(),this.touchmove(),this.touchend(),this.touchcancel(),this.gridster.dragInProgress=!1,this.gridster.updateGrid(),this.gridster.options.resizable&&this.gridster.options.resizable.stop?Promise.resolve(this.gridster.options.resizable.stop(this.gridsterItem.item,this.gridsterItem,S)).then(this.makeResize,this.cancelResize):this.makeResize(),setTimeout(()=>{this.gridsterItem.renderer.removeClass(this.gridsterItem.el,"gridster-item-resizing"),this.gridster&&(this.gridster.movingItem=null,this.gridster.previewStyle())})},this.cancelResize=()=>{this.gridsterItem.$item.cols=this.gridsterItem.item.cols||1,this.gridsterItem.$item.rows=this.gridsterItem.item.rows||1,this.gridsterItem.$item.x=this.gridsterItem.item.x||0,this.gridsterItem.$item.y=this.gridsterItem.item.y||0,this.gridsterItem.setSize(),this.push.restoreItems(),this.pushResize.restoreItems(),this.push.destroy(),this.push=null,this.pushResize.destroy(),this.pushResize=null},this.makeResize=()=>{this.gridsterItem.setSize(),this.gridsterItem.checkItemChanges(this.gridsterItem.$item,this.gridsterItem.item),this.push.setPushedItems(),this.pushResize.setPushedItems(),this.push.destroy(),this.push=null,this.pushResize.destroy(),this.pushResize=null},this.handleNorth=S=>{if(this.top=S.clientY+this.offsetTop-this.diffTop,this.height=this.bottom-this.top,this.minHeight>this.height&&(this.height=this.minHeight,this.top=this.bottom-this.minHeight),this.newPosition=this.gridster.pixelsToPositionY(this.top+this.margin,Math.floor),this.gridsterItem.$item.y!==this.newPosition){if(this.itemBackup[1]=this.gridsterItem.$item.y,this.itemBackup[3]=this.gridsterItem.$item.rows,this.gridsterItem.$item.rows+=this.gridsterItem.$item.y-this.newPosition,this.gridsterItem.$item.y=this.newPosition,this.pushResize.pushItems(this.pushResize.fromSouth),this.push.pushItems(this.push.fromSouth,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item))return this.gridsterItem.$item.y=this.itemBackup[1],this.gridsterItem.$item.rows=this.itemBackup[3],this.setItemTop(this.gridster.positionYToPixels(this.gridsterItem.$item.y)),void this.setItemHeight(this.gridster.positionYToPixels(this.gridsterItem.$item.rows)-this.margin);this.gridster.previewStyle(),this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemTop(this.top),this.setItemHeight(this.height)},this.handleWest=S=>{if(this.left=(this.gridster.$options.dirType===L.RTL?this.originalClientX+(this.originalClientX-S.clientX):S.clientX)+this.offsetLeft-this.diffLeft,this.width=this.right-this.left,this.minWidth>this.width&&(this.width=this.minWidth,this.left=this.right-this.minWidth),this.newPosition=this.gridster.pixelsToPositionX(this.left+this.margin,Math.floor),this.gridsterItem.$item.x!==this.newPosition){if(this.itemBackup[0]=this.gridsterItem.$item.x,this.itemBackup[2]=this.gridsterItem.$item.cols,this.gridsterItem.$item.cols+=this.gridsterItem.$item.x-this.newPosition,this.gridsterItem.$item.x=this.newPosition,this.pushResize.pushItems(this.pushResize.fromEast),this.push.pushItems(this.push.fromEast,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item))return this.gridsterItem.$item.x=this.itemBackup[0],this.gridsterItem.$item.cols=this.itemBackup[2],this.setItemLeft(this.gridster.positionXToPixels(this.gridsterItem.$item.x)),void this.setItemWidth(this.gridster.positionXToPixels(this.gridsterItem.$item.cols)-this.margin);this.gridster.previewStyle(),this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemLeft(this.left),this.setItemWidth(this.width)},this.handleSouth=S=>{if(this.height=S.clientY+this.offsetTop-this.diffBottom-this.top,this.minHeight>this.height&&(this.height=this.minHeight),this.bottom=this.top+this.height,this.newPosition=this.gridster.pixelsToPositionY(this.bottom,Math.ceil),this.gridsterItem.$item.y+this.gridsterItem.$item.rows!==this.newPosition){if(this.itemBackup[3]=this.gridsterItem.$item.rows,this.gridsterItem.$item.rows=this.newPosition-this.gridsterItem.$item.y,this.pushResize.pushItems(this.pushResize.fromNorth),this.push.pushItems(this.push.fromNorth,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item))return this.gridsterItem.$item.rows=this.itemBackup[3],void this.setItemHeight(this.gridster.positionYToPixels(this.gridsterItem.$item.rows)-this.margin);this.gridster.previewStyle(),this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemHeight(this.height)},this.handleEast=S=>{if(this.width=(this.gridster.$options.dirType===L.RTL?this.originalClientX+(this.originalClientX-S.clientX):S.clientX)+this.offsetLeft-this.diffRight-this.left,this.minWidth>this.width&&(this.width=this.minWidth),this.right=this.left+this.width,this.newPosition=this.gridster.pixelsToPositionX(this.right,Math.ceil),this.gridsterItem.$item.x+this.gridsterItem.$item.cols!==this.newPosition){if(this.itemBackup[2]=this.gridsterItem.$item.cols,this.gridsterItem.$item.cols=this.newPosition-this.gridsterItem.$item.x,this.pushResize.pushItems(this.pushResize.fromWest),this.push.pushItems(this.push.fromWest,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item))return this.gridsterItem.$item.cols=this.itemBackup[2],void this.setItemWidth(this.gridster.positionXToPixels(this.gridsterItem.$item.cols)-this.margin);this.gridster.previewStyle(),this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemWidth(this.width)},this.handleNorthWest=S=>{this.handleNorth(S),this.handleWest(S)},this.handleNorthEast=S=>{this.handleNorth(S),this.handleEast(S)},this.handleSouthWest=S=>{this.handleSouth(S),this.handleWest(S)},this.handleSouthEast=S=>{this.handleSouth(S),this.handleEast(S)},this.gridsterItem=u,this.gridster=_,this.lastMouse={clientX:0,clientY:0},this.itemBackup=[0,0,0,0],this.resizeEventScrollType={west:!1,east:!1,north:!1,south:!1}}destroy(){var u;null===(u=this.gridster)||void 0===u||u.previewStyle(),this.gridster=this.gridsterItem=null}dragStart(u){if(u.which&&1!==u.which)return;this.gridster.options.resizable&&this.gridster.options.resizable.start&&this.gridster.options.resizable.start(this.gridsterItem.item,this.gridsterItem,u),u.stopPropagation(),u.preventDefault(),this.zone.runOutsideAngular(()=>{this.mousemove=this.gridsterItem.renderer.listen("document","mousemove",this.dragMove),this.touchmove=this.gridster.renderer.listen(this.gridster.el,"touchmove",this.dragMove)}),this.mouseup=this.gridsterItem.renderer.listen("document","mouseup",this.dragStop),this.mouseleave=this.gridsterItem.renderer.listen("document","mouseleave",this.dragStop),this.cancelOnBlur=this.gridsterItem.renderer.listen("window","blur",this.dragStop),this.touchend=this.gridsterItem.renderer.listen("document","touchend",this.dragStop),this.touchcancel=this.gridsterItem.renderer.listen("document","touchcancel",this.dragStop),this.gridsterItem.renderer.addClass(this.gridsterItem.el,"gridster-item-resizing"),this.lastMouse.clientX=u.clientX,this.lastMouse.clientY=u.clientY,this.left=this.gridsterItem.left,this.top=this.gridsterItem.top,this.originalClientX=u.clientX,this.originalClientY=u.clientY,this.width=this.gridsterItem.width,this.height=this.gridsterItem.height,this.bottom=this.gridsterItem.top+this.gridsterItem.height,this.right=this.gridsterItem.left+this.gridsterItem.width,this.margin=this.gridster.$options.margin,this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,this.diffLeft=u.clientX+this.offsetLeft-this.left,this.diffRight=u.clientX+this.offsetLeft-this.right,this.diffTop=u.clientY+this.offsetTop-this.top,this.diffBottom=u.clientY+this.offsetTop-this.bottom,this.minHeight=this.gridster.positionYToPixels(this.gridsterItem.$item.minItemRows||this.gridster.$options.minItemRows)-this.margin,this.minWidth=this.gridster.positionXToPixels(this.gridsterItem.$item.minItemCols||this.gridster.$options.minItemCols)-this.margin,this.gridster.movingItem=this.gridsterItem.$item,this.gridster.previewStyle(),this.push=new ae(this.gridsterItem),this.pushResize=new Jt(this.gridsterItem),this.gridster.dragInProgress=!0,this.gridster.updateGrid();const{classList:_}=u.target;_.contains("handle-n")?(this.resizeEventScrollType.north=!0,this.directionFunction=this.handleNorth):_.contains("handle-w")?this.gridster.$options.dirType===L.RTL?(this.resizeEventScrollType.east=!0,this.directionFunction=this.handleEast):(this.resizeEventScrollType.west=!0,this.directionFunction=this.handleWest):_.contains("handle-s")?(this.resizeEventScrollType.south=!0,this.directionFunction=this.handleSouth):_.contains("handle-e")?this.gridster.$options.dirType===L.RTL?(this.resizeEventScrollType.west=!0,this.directionFunction=this.handleWest):(this.resizeEventScrollType.east=!0,this.directionFunction=this.handleEast):_.contains("handle-nw")?this.gridster.$options.dirType===L.RTL?(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleNorthEast):(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleNorthWest):_.contains("handle-ne")?this.gridster.$options.dirType===L.RTL?(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleNorthWest):(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleNorthEast):_.contains("handle-sw")?this.gridster.$options.dirType===L.RTL?(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleSouthEast):(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleSouthWest):_.contains("handle-se")&&(this.gridster.$options.dirType===L.RTL?(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleSouthWest):(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleSouthEast))}toggle(){this.resizeEnabled=this.gridsterItem.canBeResized()}dragStartDelay(u){if(q.checkTouchEvent(u),!this.gridster.$options.resizable.delayStart)return void this.dragStart(u);const _=setTimeout(()=>{this.dragStart(u),Ie()},this.gridster.$options.resizable.delayStart),{cancelMouse:f,cancelMouseLeave:S,cancelOnBlur:V,cancelTouchMove:H,cancelTouchEnd:ge,cancelTouchCancel:Ce}=this.zone.runOutsideAngular(()=>({cancelMouse:this.gridsterItem.renderer.listen("document","mouseup",Ie),cancelMouseLeave:this.gridsterItem.renderer.listen("document","mouseleave",Ie),cancelOnBlur:this.gridsterItem.renderer.listen("window","blur",Ie),cancelTouchMove:this.gridsterItem.renderer.listen("document","touchmove",fe),cancelTouchEnd:this.gridsterItem.renderer.listen("document","touchend",Ie),cancelTouchCancel:this.gridsterItem.renderer.listen("document","touchcancel",Ie)}));function fe(xe){q.checkTouchEvent(xe),(Math.abs(xe.clientX-u.clientX)>9||Math.abs(xe.clientY-u.clientY)>9)&&Ie()}function Ie(){clearTimeout(_),V(),f(),S(),H(),ge(),Ce()}}setItemTop(u){this.gridster.gridRenderer.setCellPosition(this.gridsterItem.renderer,this.gridsterItem.el,this.left,u)}setItemLeft(u){this.gridster.gridRenderer.setCellPosition(this.gridsterItem.renderer,this.gridsterItem.el,u,this.top)}setItemHeight(u){this.gridsterItem.renderer.setStyle(this.gridsterItem.el,"height",u+"px")}setItemWidth(u){this.gridsterItem.renderer.setStyle(this.gridsterItem.el,"width",u+"px")}}let Yt=(()=>{class K{constructor(_,f,S,V){this.renderer=S,this.zone=V,this.itemInit=new s.vpe,this.itemChange=new s.vpe,this.itemResize=new s.vpe,this.el=_.nativeElement,this.$item={cols:-1,rows:-1,x:-1,y:-1},this.gridster=f,this.drag=new yt(this,f,this.zone),this.resize=new Mt(this,f,this.zone)}get zIndex(){return this.getLayerIndex()+this.gridster.$options.baseLayerIndex}ngOnInit(){this.gridster.addItem(this)}ngOnChanges(_){_.item&&(this.updateOptions(),this.init||this.gridster.calculateLayout$.next()),_.item&&_.item.previousValue&&this.setSize()}updateOptions(){this.$item=q.merge(this.$item,this.item,{cols:void 0,rows:void 0,x:void 0,y:void 0,layerIndex:void 0,dragEnabled:void 0,resizeEnabled:void 0,compactEnabled:void 0,maxItemRows:void 0,minItemRows:void 0,maxItemCols:void 0,minItemCols:void 0,maxItemArea:void 0,minItemArea:void 0})}ngOnDestroy(){this.gridster.removeItem(this),this.drag.destroy(),this.resize.destroy(),this.gridster=this.drag=this.resize=null}setSize(){this.renderer.setStyle(this.el,"display",this.notPlaced?"":"block"),this.gridster.gridRenderer.updateItem(this.el,this.$item,this.renderer),this.updateItemSize()}updateItemSize(){const f=this.$item.x*this.gridster.curColWidth,S=this.$item.cols*this.gridster.curColWidth-this.gridster.$options.margin,V=this.$item.rows*this.gridster.curRowHeight-this.gridster.$options.margin;this.top=this.$item.y*this.gridster.curRowHeight,this.left=f,!this.init&&S>0&&V>0&&(this.init=!0,this.item.initCallback&&this.item.initCallback(this.item,this),this.gridster.options.itemInitCallback&&this.gridster.options.itemInitCallback(this.item,this),this.itemInit.next({item:this.item,itemComponent:this}),this.gridster.$options.scrollToNewItems&&this.el.scrollIntoView(!1)),(S!==this.width||V!==this.height)&&(this.width=S,this.height=V,this.gridster.options.itemResizeCallback&&this.gridster.options.itemResizeCallback(this.item,this),this.itemResize.next({item:this.item,itemComponent:this}))}itemChanged(){this.gridster.options.itemChangeCallback&&this.gridster.options.itemChangeCallback(this.item,this),this.itemChange.next({item:this.item,itemComponent:this})}checkItemChanges(_,f){_.rows===f.rows&&_.cols===f.cols&&_.x===f.x&&_.y===f.y||(this.gridster.checkCollision(this.$item)?(this.$item.x=f.x||0,this.$item.y=f.y||0,this.$item.cols=f.cols||1,this.$item.rows=f.rows||1,this.setSize()):(this.item.cols=this.$item.cols,this.item.rows=this.$item.rows,this.item.x=this.$item.x,this.item.y=this.$item.y,this.gridster.calculateLayout$.next(),this.itemChanged()))}canBeDragged(){const _=this.gridster.$options.draggable.enabled;return!this.gridster.mobile&&_&&(void 0===this.$item.dragEnabled?_:this.$item.dragEnabled)}canBeResized(){const _=this.gridster.$options.resizable.enabled;return!this.gridster.mobile&&_&&(void 0===this.$item.resizeEnabled?_:this.$item.resizeEnabled)}bringToFront(_){if(_&&_<=0)return;const f=this.getLayerIndex(),S=this.gridster.$options.maxLayerIndex;if(f<S){const V=_?f+_:S;this.item.layerIndex=this.$item.layerIndex=V>S?S:V}}sendToBack(_){if(_&&_<=0)return;const f=this.getLayerIndex();if(f>0){const S=_?f-_:0;this.item.layerIndex=this.$item.layerIndex=S<0?0:S}}getLayerIndex(){return void 0!==this.item.layerIndex?this.item.layerIndex:void 0!==this.gridster.$options.defaultLayerIndex?this.gridster.$options.defaultLayerIndex:0}}return K.\u0275fac=function(_){return new(_||K)(s.Y36(s.SBq),s.Y36(te),s.Y36(s.Qsj),s.Y36(s.R0b))},K.\u0275cmp=s.Xpm({type:K,selectors:[["gridster-item"]],hostVars:2,hostBindings:function(_,f){2&_&&s.Udp("z-index",f.zIndex)},inputs:{item:"item"},outputs:{itemInit:"itemInit",itemChange:"itemChange",itemResize:"itemResize"},features:[s.TTD],ngContentSelectors:v,decls:9,vars:8,consts:[["class","gridster-item-resizable-handler handle-s",3,"mousedown","touchstart",4,"ngIf"],["class","gridster-item-resizable-handler handle-e",3,"mousedown","touchstart",4,"ngIf"],["class","gridster-item-resizable-handler handle-n",3,"mousedown","touchstart",4,"ngIf"],["class","gridster-item-resizable-handler handle-w",3,"mousedown","touchstart",4,"ngIf"],["class","gridster-item-resizable-handler handle-se",3,"mousedown","touchstart",4,"ngIf"],["class","gridster-item-resizable-handler handle-ne",3,"mousedown","touchstart",4,"ngIf"],["class","gridster-item-resizable-handler handle-sw",3,"mousedown","touchstart",4,"ngIf"],["class","gridster-item-resizable-handler handle-nw",3,"mousedown","touchstart",4,"ngIf"],[1,"gridster-item-resizable-handler","handle-s",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-e",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-n",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-w",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-se",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-ne",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-sw",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-nw",3,"mousedown","touchstart"]],template:function(_,f){1&_&&(s.F$t(),s.Hsn(0),s.YNc(1,h,1,0,"div",0),s.YNc(2,w,1,0,"div",1),s.YNc(3,M,1,0,"div",2),s.YNc(4,F,1,0,"div",3),s.YNc(5,G,1,0,"div",4),s.YNc(6,x,1,0,"div",5),s.YNc(7,y,1,0,"div",6),s.YNc(8,k,1,0,"div",7)),2&_&&(s.xp6(1),s.Q6J("ngIf",f.gridster.$options.resizable.handles.s&&f.resize.resizeEnabled),s.xp6(1),s.Q6J("ngIf",f.gridster.$options.resizable.handles.e&&f.resize.resizeEnabled),s.xp6(1),s.Q6J("ngIf",f.gridster.$options.resizable.handles.n&&f.resize.resizeEnabled),s.xp6(1),s.Q6J("ngIf",f.gridster.$options.resizable.handles.w&&f.resize.resizeEnabled),s.xp6(1),s.Q6J("ngIf",f.gridster.$options.resizable.handles.se&&f.resize.resizeEnabled),s.xp6(1),s.Q6J("ngIf",f.gridster.$options.resizable.handles.ne&&f.resize.resizeEnabled),s.xp6(1),s.Q6J("ngIf",f.gridster.$options.resizable.handles.sw&&f.resize.resizeEnabled),s.xp6(1),s.Q6J("ngIf",f.gridster.$options.resizable.handles.nw&&f.resize.resizeEnabled))},directives:[A.O5],styles:["gridster-item{box-sizing:border-box;z-index:1;position:absolute;overflow:hidden;transition:.3s;display:none;background:white;-webkit-user-select:text;user-select:text}gridster-item.gridster-item-moving{cursor:move}gridster-item.gridster-item-resizing,gridster-item.gridster-item-moving{transition:0s;z-index:2;box-shadow:0 0 5px 5px #0003,0 6px 10px #00000024,0 1px 18px #0000001f}.gridster-item-resizable-handler{position:absolute;z-index:2}.gridster-item-resizable-handler.handle-n{cursor:ns-resize;height:10px;right:0;top:0;left:0}.gridster-item-resizable-handler.handle-e{cursor:ew-resize;width:10px;bottom:0;right:0;top:0}.gridster-item-resizable-handler.handle-s{cursor:ns-resize;height:10px;right:0;bottom:0;left:0}.gridster-item-resizable-handler.handle-w{cursor:ew-resize;width:10px;left:0;top:0;bottom:0}.gridster-item-resizable-handler.handle-ne{cursor:ne-resize;width:10px;height:10px;right:0;top:0}.gridster-item-resizable-handler.handle-nw{cursor:nw-resize;width:10px;height:10px;left:0;top:0}.gridster-item-resizable-handler.handle-se{cursor:se-resize;width:0;height:0;right:0;bottom:0;border-style:solid;border-width:0 0 10px 10px;border-color:transparent}.gridster-item-resizable-handler.handle-sw{cursor:sw-resize;width:10px;height:10px;left:0;bottom:0}gridster-item:hover .gridster-item-resizable-handler.handle-se{border-color:transparent transparent #ccc}\n"],encapsulation:2}),K})(),Me=(()=>{class K{}return K.\u0275fac=function(_){return new(_||K)},K.\u0275mod=s.oAB({type:K}),K.\u0275inj=s.cJS({imports:[[A.ez]]}),K})()}}]);