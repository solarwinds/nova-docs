import{a as b,b as l,c as I}from"./chunk-OSU7EEFV.js";import{a as c,b as A}from"./chunk-GOLPZZWO.js";import{e as Z}from"./chunk-TKIYSYOM.js";import{a as m,b as D}from"./chunk-3MBCD3IG.js";import{a as p,b as f}from"./chunk-G4Q7ZVU3.js";import{a as Re,b as Oe}from"./chunk-VRLMZINP.js";import{a as L,h as Pe,j as We,k as Me}from"./chunk-32WL3UDE.js";import{a as h}from"./chunk-V2MEVMRQ.js";import"./chunk-DJYT3VBJ.js";import"./chunk-GQDQT2QR.js";import"./chunk-ZT7A7TZF.js";import"./chunk-F7CIRBPD.js";import"./chunk-K3YJT5MO.js";import"./chunk-4HXDNOXI.js";import"./chunk-WPL4APHO.js";import"./chunk-3OQ7M4HB.js";import"./chunk-IYRXTWZX.js";import"./chunk-SIB66IPC.js";import"./chunk-E6WOVQK3.js";import"./chunk-4VFLXTDB.js";import"./chunk-CNSYS4BF.js";import"./chunk-OZALKHRQ.js";import"./chunk-YP3CNFHO.js";import"./chunk-VAZJ6DY4.js";import"./chunk-JTLDSCSU.js";import"./chunk-FHSFZ6IZ.js";import"./chunk-7ELEEN5W.js";import"./chunk-DQ2U65MU.js";import"./chunk-6QRNUDBT.js";import"./chunk-LEQI7TWI.js";import{a as B}from"./chunk-QWK7WHL2.js";import"./chunk-ZKE5BQF3.js";import"./chunk-43BP6LOQ.js";import{a as Ee}from"./chunk-LTNK7SWM.js";import{a as G}from"./chunk-4RLLEQLT.js";import"./chunk-GHZ6RIMD.js";import"./chunk-IXIAG2WE.js";import{a as $}from"./chunk-RODZF2WM.js";import"./chunk-RA3JVS4W.js";import"./chunk-CGOWT33R.js";import"./chunk-DIZWAMYX.js";import"./chunk-AMXUNQ4T.js";import{A as x,Aa as V,Ja as O,b as Be,c as R,ca as j,ea as s,ha as a,ia as Ae,ka as g}from"./chunk-USCLQP7P.js";import"./chunk-V76TIQNF.js";import{Bc as K,Ed as _e,Hc as Se,Ic as ve,Ld as be,_b as Ve,pc as Ce,pd as Te,te as Ie,ue as De,vb as je,wd as ye,yd as we}from"./chunk-NZZJTGI5.js";import{L as fe,n as F}from"./chunk-NEOTMEUH.js";import{Aa as P,Ac as U,Bc as ge,Ha as W,Ia as te,Nc as he,Pb as ne,Rb as v,Sa as ie,Ta as re,X as q,Xb as u,Yb as T,ab as oe,bc as se,gc as ae,h as w,kc as _,na as J,rc as de,sc as pe,tc as le,uc as me,va as Y,vc as ce,wa as ee,xc as ue,yb as S,yc as z,zb as d,zc as M}from"./chunk-NNMBFNDY.js";import"./chunk-JISDZD7Z.js";import{a as C,b as E,g as k}from"./chunk-T555DFTC.js";var ke=k(Ve()),ze=k(je());var Le={widget1:{cols:6,rows:6,y:0,x:0},widget2:{cols:6,rows:6,y:0,x:6},widget3:{cols:7,rows:6,y:6,x:0},widget4:{cols:5,rows:6,y:6,x:7}},y=[{id:"widget1",type:"kpi",pizzagna:{[g.Configuration]:{header:{properties:{title:"KPI Widget!",subtitle:"A bunch of number boxes"}},tiles:{properties:{nodes:["kpi1","kpi2"]}},kpi1:{id:"kpi1",componentType:B.lateLoadKey,providers:{[a.DataSource]:{providerId:p.providerId},[a.Adapter]:{providerId:x,properties:{componentId:"kpi1",propertyPath:"widgetData",thresholds:{showThresholds:!0,warningThresholdValue:5,criticalThresholdValue:8}}}},properties:{elementClass:"flex-grow-1",widgetData:{id:"totalStorage",value:0,label:"Total storage"}}},kpi2:{id:"kpi2",componentType:B.lateLoadKey,providers:{[a.DataSource]:{providerId:f.providerId},[a.Adapter]:{providerId:x,properties:{componentId:"kpi2",propertyPath:"widgetData",thresholds:{warningThresholdValue:120,criticalThresholdValue:150}}}},properties:{elementClass:"flex-grow-1",widgetData:{id:"downloadSpeed",value:0,label:"Download speed"}}}}}},{id:"widget2",type:"proportional",pizzagna:{[g.Configuration]:{header:{properties:{title:"Proportional Widget!",subtitle:"Proportional widget with legend formatters"}},chart:{providers:{[a.DataSource]:{providerId:l.providerId}},properties:{configuration:{chartOptions:{type:Ee.PieChart,legendPlacement:V.Right,legendFormatter:{componentType:G.lateLoadKey}}}}}}}},{id:"widget3",type:"timeseries",pizzagna:{[g.Configuration]:{[R]:{providers:{[a.DataSource]:{providerId:c.providerId}}},header:{properties:{title:"Timeseries Widget!",subtitle:"Basic timeseries widget"}},chart:{providers:{[a.Adapter]:{properties:{series:[{id:"series-1",label:"Average CPU Load",selectedSeriesId:"series-1"},{id:"series-2",label:"Average CPU Load",selectedSeriesId:"series-2"},{id:"series-3",label:"Average CPU Load",selectedSeriesId:"series-3"}]}}},properties:{configuration:{legendPlacement:V.Right,enableZoom:!0,leftAxisLabel:"Utilization (%)"}}},timeframeSelection:{properties:{timeframe:{startDatetime:Z().subtract(7,"day").format(),endDatetime:Z().format(),selectedPresetId:null}}}}}},{id:"widget4",type:"table",pizzagna:{[g.Configuration]:{header:{properties:{title:"Table Widget!",subtitle:"Basic table widget"}},table:{providers:{[a.DataSource]:{providerId:m.providerId}},properties:{configuration:{columns:[{id:"column1",label:"No",isActive:!0,formatter:{componentType:$.lateLoadKey,properties:{dataFieldIds:{value:"position"}}}},{id:"column2",label:"Name",isActive:!0,formatter:{componentType:$.lateLoadKey,properties:{dataFieldIds:{value:"name"}}}},{id:"column3",label:"Location",isActive:!0,formatter:{componentType:G.lateLoadKey,properties:{dataFieldIds:{value:"firstUrlLabel",link:"firstUrl"}}}}],sorterConfiguration:{descendantSorting:!0,sortBy:"column1"},hasVirtualScroll:!0}}}}}}];function Ge(r,Ke){if(r&1&&(u(0,"div",3)(1,"div",4),ce(2),T()()),r&2){let t=Ke.item;S(2),ue(" ",t.title," ")}}var X=(()=>{class r{static{this.lateLoadKey="AcmeCloneSelectionComponent"}constructor(t){this.widgetTypesService=t,this.widgetSelected=new oe,this.widgetItems=[]}ngOnInit(){let t=new F;this.widgetItems=y.map(i=>({title:t.transform(i.type),widget:this.widgetTypesService.mergeWithWidgetType(i)})),this.onSelect([this.widgetItems[0]]),y.forEach(i=>{this.addUnconfiguredWidgetWithConfigLayer(i)})}addUnconfiguredWidgetWithConfigLayer(t){let i=new F().transform(t.type);this.widgetItems.push({title:`Unconfigured ${i} With Config Layer`,widget:E(C({},(0,ke.default)(this.widgetTypesService.mergeWithWidgetType(t))),{id:`unconfiguredWithConfigLayer${i}`,metadata:{needsConfiguration:!0}})}),(0,ze.default)(this.widgetItems[this.widgetItems.length-1].widget.pizzagna,`${g.Configuration}.header.properties.title`,`Unconfigured ${i} With Config Layer`)}onSelect(t){this.widgetSelected.emit(t[0].widget),this.widgetSelection=t}static{this.\u0275fac=function(i){return new(i||r)(d(h))}}static{this.\u0275cmp=W({type:r,selectors:[["acme-clone-selection"]],outputs:{widgetSelected:"widgetSelected"},decls:4,vars:3,consts:[["widgetClonerItem",""],[1,"nui-widget-cloner"],["selectionMode","singleWithRequiredSelection",3,"selectionChange","itemsSource","selection","repeatItemTemplateRef"],[1,"nui-widget-cloner__item","d-flex","pt-2","pb-2","align-items-center"],[1,"text-info","ml-3"]],template:function(i,e){if(i&1){let o=se();u(0,"div",1)(1,"nui-repeat",2),_("selectionChange",function(xe){return ie(o),re(e.onSelect(xe))}),T()(),ne(2,Ge,3,1,"ng-template",null,0,he)}if(i&2){let o=me(3);S(),v("itemsSource",e.widgetItems)("selection",e.widgetSelection)("repeatItemTemplateRef",o)}},dependencies:[ye],styles:[".nui-widget-cloner__item[_ngcontent-%COMP%]{height:60px}"]})}}return r})();var Ue=k(Be());var N=(()=>{class r{constructor(t){this.toastService=t,this.allowSubmit=!0,this.allowRemoval=!0,this.trySubmit=i=>{let e=new w;return setTimeout(()=>{if(this.allowSubmit)e.next(i);else{let o=$localize`Submit failed.`;this.toastService.error({title:o}),e.error(o)}},1e3),e.asObservable()},this.tryRemove=i=>{let e=new w;return setTimeout(()=>{if(this.allowRemoval)e.next(i);else{let o=$localize`Widget removal failed.`;this.toastService.error({title:o}),e.error(o)}},200),e.asObservable()},this.toastService.setConfig({timeOut:2e3})}static{this.\u0275fac=function(i){return new(i||r)(P(be))}}static{this.\u0275prov=Y({token:r,factory:r.\u0275fac})}}return r})();var Fe=(()=>{class r{constructor(t,i,e,o,n){this.providerRegistry=t,this.submitHandler=i,this.themeSwitcherService=e,this.widgetTypesService=o,this.widgetClonerService=n,this.destroy$=new w,this.dashboard={positions:{},widgets:{}},this.gridsterConfig={minCols:12,maxCols:12,minRows:12},this.editMode=!1,this.dsError=!1,this.providerRegistry.setProviders({[p.providerId]:{provide:s,useClass:p,deps:[]},[f.providerId]:{provide:s,useClass:f,deps:[]},[b.providerId]:{provide:s,useClass:b,deps:[]},[l.providerId]:{provide:s,useClass:l,deps:[]},[I.providerId]:{provide:s,useClass:I,deps:[]},[m.providerId]:{provide:s,useClass:m,deps:[K,j]},[D.providerId]:{provide:s,useClass:D,deps:[K,j]},[c.providerId]:{provide:s,useClass:c,deps:[]},[A.providerId]:{provide:s,useClass:A,deps:[]}})}ngOnInit(){let t=y.map(e=>E(C({},e),{pizzagna:C(C({},this.widgetTypesService.getWidgetType(e.type,e.version).widget),e.pizzagna)})),i=(0,Ue.default)(t,e=>e.id);this.dashboard={positions:Le,widgets:i}}onDsErrorChange(t){p.mockError=t,c.mockError=t,m.mockError=t,l.mockError=t}onCloneWidget(){let t={dashboardComponent:this.dashboardComponent,trySubmit:this.submitHandler.trySubmit,widgetSelectionComponentType:X};this.widgetClonerService.open(t).pipe(q(1),J(this.destroy$)).subscribe()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static{this.\u0275fac=function(i){return new(i||r)(d(O),d(N),d(Ie),d(h),d(Pe))}}static{this.\u0275cmp=W({type:r,selectors:[["acme-dashboard"]],viewQuery:function(i,e){if(i&1&&de(L,7),i&2){let o;pe(o=le())&&(e.dashboardComponent=o.first)}},features:[ge([N])],decls:5,vars:6,consts:()=>{let t;return t=$localize`:␟489801ff09de9b4a6ca8b6e05a475fa1ca00d98e␟5813529530812520031: Create Widget Clone
`,[t,["type","button","nui-button","",1,"mb-3","ml-4","nui-widget-cloner-test-button",3,"click"],[3,"editModeChange","dsErrorChange","editMode","dsError"],[1,"dashboard"],[3,"dashboardChange","gridsterConfigChange","nuiWidgetEditor","dashboard","gridsterConfig","editMode"]]},template:function(i,e){i&1&&(u(0,"button",1),_("click",function(){return e.onCloneWidget()}),ae(1,0),T(),u(2,"dashboard-test-harness",2),U("editModeChange",function(n){return M(e.editMode,n)||(e.editMode=n),n}),_("dsErrorChange",function(n){return e.onDsErrorChange(n)}),u(3,"div",3)(4,"nui-dashboard",4),U("dashboardChange",function(n){return M(e.dashboard,n)||(e.dashboard=n),n})("gridsterConfigChange",function(n){return M(e.gridsterConfig,n)||(e.gridsterConfig=n),n}),T()()()),i&2&&(S(2),z("editMode",e.editMode),v("dsError",e.dsError),S(2),v("nuiWidgetEditor",e.submitHandler),z("dashboard",e.dashboard)("gridsterConfig",e.gridsterConfig),v("editMode",e.editMode))},dependencies:[Re,L,We,Ce],styles:[".dashboard[_ngcontent-%COMP%]{height:725px;width:1000px}"]})}}return r})();var Ze=[{path:"",component:Fe,data:{srlc:{hideIndicator:!0}}}],Xt=(()=>{class r{constructor(t){this.widgetTypesService=t;let i=this.widgetTypesService.getWidgetType("proportional",1);delete i.widget.structure[R].providers?.refresher,this.setDataSourceProviders("table",[m.providerId,D.providerId]),this.setDataSourceProviders("kpi",[p.providerId,f.providerId]),this.setDataSourceProviders("proportional",[b.providerId,l.providerId,I.providerId]),this.setDataSourceProviders("timeseries",[c.providerId,A.providerId])}setDataSourceProviders(t,i){let e=this.widgetTypesService.getWidgetType(t,1);this.widgetTypesService.setNode(e,"configurator",Ae.DataSourceProviders,i)}static{this.\u0275fac=function(i){return new(i||r)(P(h))}}static{this.\u0275mod=te({type:r})}static{this.\u0275inj=ee({providers:[O],imports:[Oe,Me,_e,ve,De,Te,Se,we,fe.forChild(Ze)]})}}return r})();export{Xt as ConfiguratorTestModule};
