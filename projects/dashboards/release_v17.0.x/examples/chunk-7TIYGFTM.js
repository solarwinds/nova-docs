import{a as Ce,d as he,e as Ee,j as Se}from"./chunk-32WL3UDE.js";import{a as pe}from"./chunk-V2MEVMRQ.js";import{a as Me,c as Oe}from"./chunk-43BP6LOQ.js";import{a as ge}from"./chunk-LTNK7SWM.js";import{a as fe}from"./chunk-DIZWAMYX.js";import{Aa as _e,Ja as me,Ka as Te,ea as ce,ha as ue,ia as b,ka as le}from"./chunk-USCLQP7P.js";import{$c as ne,Ba as Y,Jd as se,Yc as oe,id as re,lc as ee,ma as K,md as ae,nc as te,oa as B,pa as Z,pc as ie,ua as q,va as J,xe as de,ya as Q}from"./chunk-NZZJTGI5.js";import{e as j,f as k,l as G,z as H}from"./chunk-NEOTMEUH.js";import{$b as z,$c as N,Aa as X,Ac as D,Ha as h,Jc as A,Kb as W,Kc as I,Pb as T,Ra as x,Rb as d,Sa as E,Ta as M,Xb as a,Yb as r,_b as $,bc as y,gc as O,h as R,kc as V,lc as C,na as U,pa as g,va as w,vc as p,xc as _,yb as n,yc as f,zb as u,zc as S}from"./chunk-NNMBFNDY.js";import{i as L}from"./chunk-T555DFTC.js";function Re(i,m){if(i&1&&(a(0,"nui-select-v2-option",10),p(1),r()),i&2){let e=m.$implicit;d("value",e==null?null:e.id),n(),_(" ",e==null?null:e.name," ")}}function ye(i,m){if(i&1&&(a(0,"nui-select-v2-option",10),p(1),r()),i&2){let e=m.$implicit;d("value",e),n(),_(" ",e," ")}}var P=".dashboard[_ngcontent-%COMP%]{height:400px}.custom-formatter-configurator__icon-select-template[_ngcontent-%COMP%]{height:20px}";function De(i,m){if(i&1){let e=y();a(0,"button",6),V("click",function(){E(e);let t=C();return M(t.reInitializeDashboard())}),p(1," Restore Widget "),r()}}function Ae(i,m){if(i&1){let e=y();a(0,"nui-dashboard",7),D("dashboardChange",function(t){E(e);let s=C();return S(s.dashboard,t)||(s.dashboard=t),M(t)})("gridsterConfigChange",function(t){E(e);let s=C();return S(s.gridsterConfig,t)||(s.gridsterConfig=t),M(t)}),r()}if(i&2){let e=C();f("dashboard",e.dashboard),d("editMode",e.editMode),f("gridsterConfig",e.gridsterConfig)}}var l=function(i){return i.Days="Day(s)",i.Weeks="Week(s)",i.Hours="Hour(s)",i}(l||{}),F=(()=>{class i{static{this.lateLoadKey="CustomDonutContentFormatterComponent"}constructor(e){this.changeDetector=e,this.units=l.Days,this.destroy$=new R}ngOnChanges(e){(e.properties||!this.properties)&&(this.currentMetricData=this.data.find(o=>o.id===this.properties?.currentMetric)?.data[0]||this.data[0].data[0],this.units=this.properties?.units||this.units),this.setContentValue()}ngOnInit(){this.chartAssist.chartAssistSubject.pipe(g(e=>this.emphasizedSeriesData=this.data.find(o=>o.id===e.payload.seriesId)),g(()=>this.setContentValue()),g(()=>this.setMetricValue()),U(this.destroy$)).subscribe()}getConvertedData(e){switch(this.units){case l.Weeks:return this.emphasizedSeriesData?this.convertToWeeks(e):this.convertToWeeks(this.currentMetricData);case l.Hours:return this.emphasizedSeriesData?this.convertToHours(e):this.convertToHours(this.currentMetricData);default:return this.emphasizedSeriesData?e:this.currentMetricData}}setContentValue(){this.chartContent=this.getConvertedData(this.emphasizedSeriesData?.data[0])}setMetricValue(){this.chartMetric=this.emphasizedSeriesData?this.data.find(e=>this.getConvertedData(e.data[0])===this.getConvertedData(this.emphasizedSeriesData?.data[0]))?.id:this.properties?.currentMetric||this.data[0].id}convertToWeeks(e){return e?Number((e/7).toFixed(2)):0}convertToHours(e){return e?Number((e*24).toFixed(2)):0}static{this.\u0275fac=function(o){return new(o||i)(u(N))}}static{this.\u0275cmp=h({type:i,selectors:[["custom-donut-content-formatter"]],hostAttrs:[1,"d-flex","flex-column","align-items-center"],inputs:{data:"data",chartAssist:"chartAssist",properties:"properties"},features:[x],decls:7,vars:3,consts:[[1,"nui-text-panel"],[1,"nui-text-page"],[1,"nui-text-secondary"]],template:function(o,t){o&1&&($(0),a(1,"div",0),p(2),r(),a(3,"div",1),p(4),r(),a(5,"div",2),p(6),r(),z()),o&2&&(n(2),_(" ",t.chartMetric||(t.properties==null?null:t.properties.currentMetric)||t.data[0].id," "),n(2),_(" ",t.chartContent," "),n(2),_(" ",t.units," "))},styles:[P]})}}return i})(),Ne=(()=>{class i extends he{static{this.lateLoadKey="CustomFormatterConfiguratorComponent"}constructor(e,o,t,s,c){super(e,o,t),this.iconService=s,this.configuratorHeading=c,this.availableUnits=[l.Days,l.Hours,l.Weeks]}addCustomFormControls(e){e.addControl("units",this.formBuilder.control(l.Days,K.required))}static{this.\u0275fac=function(o){return new(o||i)(u(N),u(Y),u(ee),u(te),u(fe))}}static{this.\u0275cmp=h({type:i,selectors:[["custom-donut-content-formatter-configurator"]],features:[W],decls:15,vars:13,consts:()=>{let e;e=$localize`:␟447ffd4cbfd3d8c3ca8dd216c0a82ecadc24a7de␟4196232656388343089:Metrics`;let o;o=$localize`:␟be537f4ddb09e1a2856314f2cbe84063ab6b4170␟9074327260054432941:Units`;let t;t=$localize`:␟c9a9da14b0f8c677efa737185f1232f8537bd2a6␟3224868488156254475: This field is required `;let s;return s=$localize`:␟c9a9da14b0f8c677efa737185f1232f8537bd2a6␟3224868488156254475: This field is required `,[t,s,[3,"formGroup"],[1,"mt-4"],["caption",e,1,"mb-3",3,"control"],["formControlName","currentMetric",3,"formControl","popupViewportMargin"],[3,"value",4,"ngFor","ngForOf"],["for","required"],["caption",o,1,"mb-3",3,"control"],["formControlName","units",3,"formControl","popupViewportMargin"],[3,"value"]]},template:function(o,t){o&1&&(a(0,"div",2)(1,"div",3)(2,"nui-form-field",4)(3,"nui-select-v2",5),A(4,"async"),T(5,Re,2,2,"nui-select-v2-option",6),r(),a(6,"nui-validation-message",7),O(7,0),r()()(),a(8,"div",3)(9,"nui-form-field",8)(10,"nui-select-v2",9),A(11,"async"),T(12,ye,2,2,"nui-select-v2-option",6),r(),a(13,"nui-validation-message",7),O(14,1),r()()()()),o&2&&(d("formGroup",t.form),n(2),d("control",t.currentMetric),n(),d("formControl",t.currentMetric)("popupViewportMargin",I(4,9,t.configuratorHeading.height$)),n(2),d("ngForOf",t.dsOutput==null?null:t.dsOutput.result),n(4),d("control",t.form.controls.units),n(),d("formControl",t.form.controls.units)("popupViewportMargin",I(11,11,t.configuratorHeading.height$)),n(2),d("ngForOf",t.availableUnits))},dependencies:[j,se,ae,ne,re,B,Z,q,J,Q,G],styles:[P]})}}return i})(),Qe=(()=>{class i{constructor(e,o,t,s){this.widgetTypesService=e,this.providerRegistry=o,this.componentRegistry=t,this.changeDetectorRef=s,this.editMode=!1,this.gridsterConfig={},this.componentRegistry.registerByLateLoadKey(Ne),this.componentRegistry.registerByLateLoadKey(F);let c=this.widgetTypesService.getWidgetType("proportional",1),ve=[{componentType:Oe.lateLoadKey,label:$localize`Sum`},{componentType:Me.lateLoadKey,label:$localize`Percentage`,configurationComponent:Ee.lateLoadKey},{componentType:F.lateLoadKey,label:$localize`Custom`,configurationComponent:Ne.lateLoadKey}];this.widgetTypesService.setNode(c,"configurator",b.Formatters,ve),this.widgetTypesService.setNode(c,"configurator",b.DataSourceProviders,[v.providerId]),this.providerRegistry.setProviders({[v.providerId]:{provide:ce,useClass:v,deps:[]}})}ngOnInit(){this.initializeDashboard()}reInitializeDashboard(){this.dashboard=void 0,this.changeDetectorRef.detectChanges(),this.initializeDashboard()}initializeDashboard(){let e=be,o={[e.id]:this.widgetTypesService.mergeWithWidgetType(e)},t={[e.id]:{cols:12,rows:6,y:0,x:0}};this.dashboard={positions:t,widgets:o}}static{this.\u0275fac=function(o){return new(o||i)(u(pe),u(me),u(Te),u(N))}}static{this.\u0275cmp=h({type:i,selectors:[["custom-donut-content-formatter-example"]],decls:6,vars:3,consts:()=>{let e;return e=$localize`:␟18d630a3c524dbab6dc528571782a939a7bc95b1␟861097914887003123: Edit Mode `,[e,[1,"mb-2","d-flex","align-items-center"],[1,"ml-3","py-2",3,"valueChange","value"],["type","button","displayStyle","action","nui-button","",3,"click",4,"ngIf"],[1,"w-100","dashboard"],["nuiWidgetEditor","",3,"dashboard","editMode","gridsterConfig","dashboardChange","gridsterConfigChange",4,"ngIf"],["type","button","displayStyle","action","nui-button","",3,"click"],["nuiWidgetEditor","",3,"dashboardChange","gridsterConfigChange","dashboard","editMode","gridsterConfig"]]},template:function(o,t){o&1&&(a(0,"div",1)(1,"nui-switch",2),D("valueChange",function(c){return S(t.editMode,c)||(t.editMode=c),c}),O(2,0),r(),T(3,De,2,0,"button",3),r(),a(4,"div",4),T(5,Ae,1,3,"nui-dashboard",5),r()),o&2&&(n(),f("value",t.editMode),n(2),d("ngIf",!(t.dashboard!=null&&t.dashboard.widgets.proportionalWidgetId)),n(2),d("ngIf",t.dashboard))},dependencies:[k,ie,Ce,Se,oe],styles:[P]})}}return i})(),Ie=[{id:"Down",name:"Down",data:[Math.round(Math.random()*100)]},{id:"Critical",name:"Critical",data:[Math.round(Math.random()*100)]},{id:"Warning",name:"Warning",data:[Math.round(Math.random()*100)]},{id:"Unknown",name:"Unknown",data:[Math.round(Math.random()*100)]},{id:"Up",name:"Up",data:[Math.round(Math.random()*100)]},{id:"Unmanaged",name:"Unmanaged",data:[Math.round(Math.random()*100)]}],v=(()=>{class i extends de{static{this.providerId="StatusesExampleDatasource"}constructor(e){super(),this.http=e,this.busy=new R}getFilteredData(){return L(this,null,function*(){return this.busy.next(!0),new Promise(e=>{setTimeout(()=>{e({result:Ie}),this.busy.next(!1)},1e3)})})}ngOnDestroy(){this.outputsSubject.complete()}static{this.\u0275fac=function(o){return new(o||i)(X(H))}}static{this.\u0275prov=w({token:i,factory:i.\u0275fac})}}return i})(),be={id:"proportionalWidgetId",type:"proportional",pizzagna:{[le.Configuration]:{header:{properties:{title:"Proportional Widget!",subtitle:"Proportional widget with legend formatters"}},chart:{providers:{[ue.DataSource]:{providerId:v.providerId}},properties:{configuration:{interactive:!0,chartOptions:{type:ge.DonutChart,legendPlacement:_e.Right,contentFormatter:{componentType:F.lateLoadKey,properties:{currentMetric:"Down",units:l.Weeks}}},chartColors:["var(--nui-color-chart-eight)","var(--nui-color-chart-nine)","var(--nui-color-chart-ten)"]}}}}}};export{l as a,F as b,Ne as c,Qe as d,Ie as e,v as f,be as g};
