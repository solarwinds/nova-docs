import{a as f,h as re,j as oe}from"./chunk-2PYN5BKZ.js";import{a as D}from"./chunk-32FRYE2I.js";import{a as ne}from"./chunk-ALWGDNZ2.js";import{A as te,Ja as ie,c as ee,ea as h,ha as C,ia as O,ka as R}from"./chunk-UNYFFDYX.js";import{Ec as J,Ld as Y,Yc as q,pc as V,wd as Z,xe as M}from"./chunk-3HSEZOBQ.js";import{z as c}from"./chunk-NEOTMEUH.js";import{Aa as g,Ac as W,Bc as H,Ha as y,Nc as Q,Pb as z,Rb as T,Sa as j,Ta as L,X as P,Xb as a,Yb as d,ab as x,bc as U,ca as w,gc as b,h as p,i as _,kc as I,na as N,rc as F,sc as G,tc as K,uc as $,va as l,vc as B,wc as X,yb as u,yc as E,zb as s,zc as m}from"./chunk-NNMBFNDY.js";import{i as v}from"./chunk-T555DFTC.js";function le(i,ce){if(i&1&&(a(0,"div",3)(1,"div",4),B(2),d()()),i&2){let t=ce.item;u(2),X(t.name)}}var ae=".dashboard[_ngcontent-%COMP%]{height:800px}.nui-widget-cloner__item[_ngcontent-%COMP%]{height:60px}",ue=(()=>{class i{constructor(t){this.widgetTypesService=t,this.widgetSelected=new x,this.widgetItems=[]}ngOnInit(){this.widgetItems=[{name:"Fully Configured KPI Widget",widget:this.widgetTypesService.mergeWithWidgetType(de)},{name:"Unconfigured Proportional Widget",widget:this.widgetTypesService.mergeWithWidgetType(ge)}]}onSelect(t){this.widgetSelected.emit(t[0].widget),this.widgetSelection=t}static{this.\u0275fac=function(e){return new(e||i)(s(D))}}static{this.\u0275cmp=y({type:i,selectors:[["widget-template-selection"]],outputs:{widgetSelected:"widgetSelected"},decls:4,vars:3,consts:[["widgetClonerItem",""],[1,"nui-widget-cloner"],["selectionMode","singleWithRequiredSelection",3,"selectionChange","itemsSource","selection","repeatItemTemplateRef"],[1,"nui-widget-cloner__item","d-flex","pt-2","pb-2","align-items-center"],[1,"text-info","ml-3"]],template:function(e,n){if(e&1){let r=U();a(0,"div",1)(1,"nui-repeat",2),I("selectionChange",function(pe){return j(r),L(n.onSelect(pe))}),d()(),z(2,le,3,1,"ng-template",null,0,Q)}if(e&2){let r=$(3);u(),T("itemsSource",n.widgetItems)("selection",n.widgetSelection)("repeatItemTemplateRef",r)}},dependencies:[Z],styles:[ae]})}}return i})(),se=(()=>{class i{constructor(t){this.toastService=t,this.persistenceSucceeded=!0,this.trySubmit=e=>{let n=new p;return e.id||(e.id=J()),setTimeout(()=>{if(this.persistenceSucceeded)n.next(e),this.toastService.success({title:$localize`Submit succeeded.`});else{let r=$localize`Submit failed.`;this.toastService.error({title:r}),n.error(r)}n.complete()},1e3),n.asObservable()},this.tryRemove=e=>{let n=new p;return setTimeout(()=>{if(this.persistenceSucceeded)n.next(e),this.toastService.success({title:$localize`Removal success`});else{let r=$localize`Removal failed.`;this.toastService.error({title:r}),n.error(r)}n.complete()},1e3),n.asObservable()},this.toastService.setConfig({timeOut:2e3})}static{this.\u0275fac=function(e){return new(e||i)(g(Y))}}static{this.\u0275prov=l({token:i,factory:i.\u0275fac})}}return i})(),Pe=(()=>{class i{constructor(t,e,n,r){this.widgetTypesService=t,this.providerRegistry=e,this.persistenceHandler=n,this.widgetClonerService=r,this.gridsterConfig={defaultItemCols:3,defaultItemRows:5},this.editMode=!1,this.destroy$=new p}ngOnInit(){let t=this.widgetTypesService.getWidgetType("kpi",1),e=this.widgetTypesService.getWidgetType("proportional",1);this.widgetTypesService.setNode(e,"configurator",O.DataSourceProviders,[A.providerId]),this.widgetTypesService.setNode(t,"configurator",O.DataSourceProviders,[S.providerId,k.providerId]),this.providerRegistry.setProviders({[S.providerId]:{provide:h,useClass:S,deps:[c]},[k.providerId]:{provide:h,useClass:k,deps:[c]},[A.providerId]:{provide:h,useClass:A,deps:[]}}),this.initializeDashboard()}onCreateWidget(){let t={dashboardComponent:this.dashboardComponent,trySubmit:this.persistenceHandler.trySubmit,widgetSelectionComponentType:ue};this.widgetClonerService.open(t).pipe(P(1),N(this.destroy$)).subscribe()}initializeDashboard(){let t=de,e={[t.id]:this.widgetTypesService.mergeWithWidgetType(t)},n={[t.id]:{cols:3,rows:5,y:0,x:0}};this.dashboard={positions:n,widgets:e}}static{this.\u0275fac=function(e){return new(e||i)(s(D),s(ie),s(se),s(re))}}static{this.\u0275cmp=y({type:i,selectors:[["widget-creation"]],viewQuery:function(e,n){if(e&1&&F(f,7),e&2){let r;G(r=K())&&(n.dashboardComponent=r.first)}},features:[H([se])],decls:7,vars:5,consts:()=>{let t;t=$localize`:␟8c375764db42f5d736fb56d01b8052c006ccc8e2␟6407712033679505505:Edit Mode`;let e;return e=$localize`:␟bd773f8bf007ab93f7e28768edbf74c97381dff0␟5534056112042972153: Create Widget `,[t,e,[1,"my-3","d-flex","align-items-center"],[1,"ml-3",3,"valueChange","value"],["type","button","nui-button","",1,"ml-4",3,"click"],[1,"w-100","dashboard"],[3,"dashboardChange","gridsterConfigChange","dashboard","gridsterConfig","editMode","nuiWidgetEditor"]]},template:function(e,n){e&1&&(a(0,"div",2)(1,"nui-switch",3),W("valueChange",function(o){return m(n.editMode,o)||(n.editMode=o),o}),b(2,0),d(),a(3,"button",4),I("click",function(){return n.onCreateWidget()}),b(4,1),d()(),a(5,"div",5)(6,"nui-dashboard",6),W("dashboardChange",function(o){return m(n.dashboard,o)||(n.dashboard=o),o})("gridsterConfigChange",function(o){return m(n.gridsterConfig,o)||(n.gridsterConfig=o),o}),d()()),e&2&&(u(),E("value",n.editMode),u(5),E("dashboard",n.dashboard)("gridsterConfig",n.gridsterConfig),T("editMode",n.editMode)("nuiWidgetEditor",n.persistenceHandler))},dependencies:[f,oe,q,V],styles:[ae]})}}return i})(),A=(()=>{class i{constructor(){this.outputsSubject=new p}static{this.providerId="RandomCitiesProportionalDataSource"}applyFilters(){setTimeout(()=>{this.outputsSubject.next({result:this.getRandomProportionalWidgetData()})},1e3)}ngOnDestroy(){this.outputsSubject.complete()}getRandomProportionalWidgetData(){return[{id:"Down",name:"Down",data:[Math.round(Math.random()*100)],icon:"status_down",link:"https://en.wikipedia.org/wiki/Brno",value:"Brno"},{id:"Critical",name:"Critical",data:[Math.round(Math.random()*100)],icon:"status_critical",link:"https://en.wikipedia.org/wiki/Kyiv",value:"Kyiv"},{id:"Warning",name:"Warning",data:[Math.round(Math.random()*100)],icon:"status_warning",link:"https://en.wikipedia.org/wiki/Austin",value:"Austin"},{id:"Unknown",name:"Unknown",data:[Math.round(Math.random()*100)],icon:"status_unknown",link:"https://en.wikipedia.org/wiki/Lisbon",value:"Lisbon"},{id:"Up",name:"Up",data:[Math.round(Math.random()*100)],icon:"status_up",link:"https://en.wikipedia.org/wiki/Sydney",value:"Sydney"},{id:"Unmanaged",name:"Unmanaged",data:[Math.round(Math.random()*100)],icon:"status_unmanaged",link:"https://en.wikipedia.org/wiki/Nur-Sultan",value:"Nur-Sultan"}]}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275prov=l({token:i,factory:i.\u0275fac})}}return i})(),S=(()=>{class i extends M{static{this.providerId="AverageRatingKpiDataSource"}constructor(t){super(),this.http=t,this.busy=new _(!1)}getFilteredData(){return v(this,null,function*(){return this.busy.next(!0),new Promise(t=>{this.http.get("https://www.googleapis.com/books/v1/volumes/5MQFrgEACAAJ").pipe(w(()=>this.busy.next(!1))).subscribe({next:e=>{t({result:{value:e.volumeInfo.averageRating}})},error:e=>{t({result:null,error:{type:e.status}})}})})})}ngOnDestroy(){this.outputsSubject.complete()}static{this.\u0275fac=function(e){return new(e||i)(g(c))}}static{this.\u0275prov=l({token:i,factory:i.\u0275fac})}}return i})(),k=(()=>{class i extends M{static{this.providerId="RatingsCountKpiDataSource"}constructor(t){super(),this.http=t,this.busy=new _(!1)}getFilteredData(){return v(this,null,function*(){return this.busy.next(!0),new Promise(t=>{this.http.get("https://www.googleapis.com/books/v1/volumes/5MQFrgEACAAJ").pipe(w(()=>this.busy.next(!1))).subscribe({next:e=>{t({result:{value:e.volumeInfo.ratingsCount}})},error:e=>{t({result:null,error:{type:e.status}})}})})})}ngOnDestroy(){this.outputsSubject.complete()}static{this.\u0275fac=function(e){return new(e||i)(g(c))}}static{this.\u0275prov=l({token:i,factory:i.\u0275fac})}}return i})(),de={id:"widget1",type:"kpi",pizzagna:{[R.Configuration]:{[ee]:{providers:{[C.Refresher]:{properties:{interval:60*10,enabled:!0}}}},header:{properties:{title:"Harry Potter and the Sorcerer's Stone",subtitle:"By J. K. Rowling"}},tiles:{properties:{nodes:["kpi1"]}},kpi1:{id:"kpi1",componentType:ne.lateLoadKey,properties:{widgetData:{units:"out of 5 Stars",label:"Average Rating"}},providers:{[C.DataSource]:{providerId:S.providerId},[C.Adapter]:{providerId:te,properties:{componentId:"kpi1",propertyPath:"widgetData"}}}}}}},ge={id:"widget2",type:"proportional",metadata:{needsConfiguration:!0},pizzagna:{[R.Configuration]:{header:{properties:{title:"*New Proportional Widget*"}}}}};export{ue as a,se as b,Pe as c,A as d,S as e,k as f};
