import{c as de}from"./chunk-MWCS5XML.js";import{a as Te,c as z,d as Ie,e as B,f as W,h as Oe}from"./chunk-N7RPTMOT.js";import{D as ae,N as b,c as V,ca as Ne,ha as m,ka as pe,ta as se,za as me}from"./chunk-JTZX6I73.js";import{$c as h,Ba as U,Jd as P,ma as ie,md as $,oa as y,oc as _e,pa as L,pc as le,va as D,wa as ne,xa as re,ya as v}from"./chunk-DKNPFPFG.js";import{e as A,f as oe,l as M}from"./chunk-TBX5YZGF.js";import{$b as w,Ha as f,Hc as u,Ic as C,Nb as T,Pb as n,Qa as R,Ra as x,Sa as Y,Vb as r,Wb as l,Xb as E,Yb as ee,Zb as te,Zc as F,_a as G,ec as N,h as Q,ic as X,jc as S,na as g,tc as I,vc as O,wb as _,xb as c}from"./chunk-FGVILFLG.js";import{g as Ce}from"./chunk-T555DFTC.js";function Fe(o,a){if(o&1&&(r(0,"nui-select-v2-option",22),I(1),l()),o&2){let e=a.$implicit;n("value",e),_(),O(" ",e," ")}}function Ae(o,a){if(o&1&&(r(0,"nui-select-v2-option",22),I(1),l()),o&2){let e=a.$implicit;n("value",e),_(),O(" ",e," ")}}function Me(o,a){if(o&1&&(r(0,"nui-select-v2-option",22),I(1),l()),o&2){let e=a.$implicit;n("value",e),_(),O(" ",e," ")}}function ye(o,a){if(o&1&&(r(0,"nui-select-v2-option",22),I(1),l()),o&2){let e=a.$implicit;n("value",e),_(),O(" ",e," ")}}function Le(o,a){if(o&1&&(r(0,"nui-select-v2-option",22),I(1),l()),o&2){let e=a.$implicit;n("value",e),_(),O(" ",e," ")}}var ce=(()=>{class o{static{this.lateLoadKey="EntityFormattingComponent"}constructor(e,i){this.changeDetector=e,this.formBuilder=i,this.formReady=new G,this.form=this.formBuilder.group({dataFieldIds:this.formBuilder.group({icon:"",status:"",detailedUrl:"",label:"",url:""})})}ngOnInit(){this.formReady.emit(this.form)}ngOnChanges(e){e.dataFieldIds&&this.getFieldMappingsControl.setValue(e.dataFieldIds.currentValue)}get getFieldMappingsControl(){return this.form.get("dataFieldIds")}static{this.\u0275fac=function(i){return new(i||o)(c(F),c(U))}}static{this.\u0275cmp=f({type:o,selectors:[["nui-entity-formatting-configuration"]],inputs:{mappingKeys:"mappingKeys",dataFieldIds:"dataFieldIds"},outputs:{formReady:"formReady"},features:[R],decls:46,vars:17,consts:()=>{let e;e=$localize`:␟42daf87f19836ef3d1b8f58a5cf93e2c43b82c1c␟8325381706328570325:Select Item`;let i;i=$localize`:␟42daf87f19836ef3d1b8f58a5cf93e2c43b82c1c␟8325381706328570325:Select Item`;let t;t=$localize`:␟42daf87f19836ef3d1b8f58a5cf93e2c43b82c1c␟8325381706328570325:Select Item`;let p;p=$localize`:␟42daf87f19836ef3d1b8f58a5cf93e2c43b82c1c␟8325381706328570325:Select Item`;let d;d=$localize`:␟42daf87f19836ef3d1b8f58a5cf93e2c43b82c1c␟8325381706328570325:Select Item`;let k;k=$localize`:␟38ddd26fc749a9c493e70c642d321c868c47f178␟5252376970414591923:Entity formatting`;let j;j=$localize`:␟14688213d67b2f0e553d66f8255281db245502fb␟3074987902485823708:Icon`;let Z;Z=$localize`:␟81b97b8ea996ad1e4f9fca8415021850214884b1␟5611592591303869712:Status`;let H;H=$localize`:␟06ae2001bf7ffd3cbe977e0c4ce0951f660ca197␟4936125302941310356:Details URL`;let q;q=$localize`:␟863226cffd5b66a6fee9810a9282a5006d6ef576␟4077520913910941990:Label`;let J;return J=$localize`:␟ec044db4c57a4750f8bec4371dc39e94f2e26d46␟994779223497739731:Label URL`,[k,j,Z,H,q,J,[3,"formGroup","state"],["accordionHeader","",1,"d-flex","align-items-center","px-4","py-2"],["iconColor","gray",1,"align-self-start","pt-2",3,"icon"],[1,"d-flex","flex-column","ml-4","pt-1"],[1,"nui-text-label"],["title","Show status icon",1,"nui-text-secondary"],["formGroupName","dataFieldIds",1,"entity-formatting__accordion-content"],[1,"mb-3"],[1,"d-flex","flex-grow-1"],[1,"d-flex","flex-grow-1",3,"control"],["placeholder",e,"formControlName","icon"],[3,"value",4,"ngFor","ngForOf"],["placeholder",i,"formControlName","status"],["placeholder",t,"formControlName","detailedUrl"],["placeholder",p,"formControlName","label"],["placeholder",d,"formControlName","url"],[3,"value"]]},template:function(i,t){i&1&&(r(0,"nui-widget-editor-accordion",6),u(1,"nuiWidgetEditorAccordionFormState"),u(2,"async"),r(3,"div",7),E(4,"nui-icon",8),r(5,"div",9)(6,"span",10),N(7,0),l(),r(8,"div",11),I(9," Show status icon "),l()()(),r(10,"div",12)(11,"div",13)(12,"label",10),N(13,1),l(),r(14,"div",14)(15,"nui-form-field",15)(16,"nui-select-v2",16),T(17,Fe,2,2,"nui-select-v2-option",17),l()()()(),r(18,"div",13)(19,"label",10),N(20,2),l(),r(21,"div",14)(22,"nui-form-field",15)(23,"nui-select-v2",18),T(24,Ae,2,2,"nui-select-v2-option",17),l()()()(),r(25,"div",13)(26,"label",10),N(27,3),l(),r(28,"div",14)(29,"nui-form-field",15)(30,"nui-select-v2",19),T(31,Me,2,2,"nui-select-v2-option",17),l()()()(),r(32,"div",13)(33,"label",10),N(34,4),l(),r(35,"div",14)(36,"nui-form-field",15)(37,"nui-select-v2",20),T(38,ye,2,2,"nui-select-v2-option",17),l()()()(),r(39,"div",13)(40,"label",10),N(41,5),l(),r(42,"div",14)(43,"nui-form-field",15)(44,"nui-select-v2",21),T(45,Le,2,2,"nui-select-v2-option",17),l()()()()()()),i&2&&(n("formGroup",t.form)("state",C(2,15,C(1,13,t.form))),_(4),n("icon","tag"),_(11),n("control",t.getFieldMappingsControl.get("icon")),_(2),n("ngForOf",t.mappingKeys),_(5),n("control",t.getFieldMappingsControl.get("status")),_(2),n("ngForOf",t.mappingKeys),_(5),n("control",t.getFieldMappingsControl.get("detailedUrl")),_(2),n("ngForOf",t.mappingKeys),_(5),n("control",t.getFieldMappingsControl.get("label")),_(2),n("ngForOf",t.mappingKeys),_(5),n("control",t.getFieldMappingsControl.get("url")),_(2),n("ngForOf",t.mappingKeys))},dependencies:[A,y,L,D,v,ne,_e,P,$,h,B,M,W],styles:[".entity-formatting__accordion-content[_ngcontent-%COMP%]{padding:15px 15px 15px 46px}"]})}}return o})();var K=Ce(me());function De(o,a){o&1&&(r(0,"label",16),N(1,0),l())}function ve(o,a){o&1&&(r(0,"label",17),N(1,1),l())}function Ue(o,a){if(o&1&&(r(0,"nui-select-v2-option",18),I(1),l()),o&2){let e=a.$implicit;n("value",e),_(),O(" ",e," ")}}function he(o,a){if(o&1){let e=w();ee(0),T(1,De,2,0,"label",8)(2,ve,2,0,"label",9),r(3,"div",10)(4,"nui-form-field",11)(5,"nui-select-v2",12),T(6,Ue,2,2,"nui-select-v2-option",13),l()(),r(7,"div",14)(8,"button",15),X("click",function(){let t=x(e).index,p=S();return Y(p.removeRule(t))}),l()()(),te()}if(o&2){let e=a.$implicit,i=a.index,t=S();_(),n("ngIf",i!==0),_(),n("ngIf",i===0),_(2),n("control",e),_(),n("formControlName",i),_(),n("ngForOf",t.selectData[i])}}function $e(o,a){if(o&1){let e=w();r(0,"button",19),X("click",function(){x(e);let t=S();return Y(t.addGrouping())}),N(1,2),l()}}var ue=(()=>{class o{static{this.lateLoadKey="DrilldownConfiguratorComponent"}constructor(e,i,t){this.changeDetector=e,this.formBuilder=i,this.eventBus=t,this.formReady=new G,this.form=this.formBuilder.group({groups:[],groupBy:this.formBuilder.array([]),drillstate:[void 0]}),this.destroy$=new Q}get getGroupByControl(){return this.form.get("groupBy")}get getDrillStateControl(){return this.form.get("drillstate")}get getGroupsControl(){return this.form.get("groups")}ngOnInit(){this.eventBus.getStream(se).pipe(g(this.destroy$)).subscribe(e=>this.onDataSourceCreated(e)),this.getGroupByControl.valueChanges.pipe(g(this.destroy$)).subscribe(()=>this.fillGroupsOptions()),this.fillGroupsOptions(),this.formReady.emit(this.form)}ngOnChanges(e){e.groups&&this.getGroupsControl.setValue(e.groups.currentValue),e.groupBy&&!e.groupBy.firstChange&&(this.getGroupByControl.clear(),this.groupBy.forEach(i=>this.getGroupByControl.push(this.createControl(i))),this.fillGroupsOptions())}createControl(e){return this.formBuilder.control(e||"",ie.required)}addGrouping(){let e=this.createControl();this.getGroupByControl.push(e),this.fillGroupsOptions();let i=this.getGroupByControl.controls.length-1;e.setValue(this.selectData[i][0])}removeRule(e){this.getGroupByControl.removeAt(e),this.fillGroupsOptions()}isAddRestricted(){return this.selectData.some(e=>e.length===1)}getSubtitle(){let e=this.getGroupByControl.controls.map((i,t)=>`${t===0?"By":"then"} ${i.value}`).join(", ");return this.getGroupByControl?.value.length===0?$localize`No groups`:$localize`${e}`}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}onDataSourceCreated(e){e?.payload?.dataFieldsConfig?.dataFields$?.pipe(g(this.destroy$)).subscribe(i=>{if(i){let t=i.map(d=>d.id);((0,K.default)(this.groups,t).length||!this.groups?.length)&&(this.groups=t,this.getGroupsControl.setValue(t),this.getGroupByControl.clear(),this.getDrillStateControl.setValue([]),this.fillGroupsOptions())}})}fillGroupsOptions(){this.selectData=[];let e=this.getGroupByControl.value;this.getGroupByControl.controls.forEach((i,t)=>{this.selectData[t]=[];let p=(0,K.default)(this.groups,e);e[t]&&this.selectData[t].push(e[t]),this.selectData[t]=[...this.selectData[t],...p]})}static{this.\u0275fac=function(i){return new(i||o)(c(F),c(U),c(Ne))}}static{this.\u0275cmp=f({type:o,selectors:[["nui-grouping-configuration"]],inputs:{groups:"groups",groupBy:"groupBy"},outputs:{formReady:"formReady"},features:[R],decls:7,vars:10,consts:()=>{let e;e=$localize`:␟42daf87f19836ef3d1b8f58a5cf93e2c43b82c1c␟8325381706328570325:Select Item`;let i;i=$localize`:␟e2feaa48e92bd996631d6a90911db46fe38cd1a3␟4620310062886462675:Then`;let t;t=$localize`:␟788a575e9f2466abeee0e51ab8f77e9cf19243de␟3653048554215358825:Group by`;let p;return p=$localize`:␟b8c2733945af01b52afbf8d2c9993bd9abda4c94␟3960498895552401303: Add another level `,[i,t,p,[3,"formGroup","state"],["headerTitle","Grouping",3,"headerIcon","subtitle"],["formArrayName","groupBy",1,"grouping-configuration__accordion-content"],[4,"ngFor","ngForOf"],["nui-button","","icon","add","displayStyle","action","type","button",3,"click",4,"ngIf"],["class","d-flex nui-text-secondary mb-1",4,"ngIf"],["class","d-flex nui-text-panel mb-2",4,"ngIf"],[1,"d-flex","flex-row","flex-grow-1","mb-4"],[1,"d-flex","flex-grow-1",3,"control"],["placeholder",e,3,"formControlName"],[3,"value",4,"ngFor","ngForOf"],[1,"justify-content-center"],["nui-button","","icon","delete","displayStyle","action","type","button",3,"click"],[1,"d-flex","nui-text-secondary","mb-1"],[1,"d-flex","nui-text-panel","mb-2"],[3,"value"],["nui-button","","icon","add","displayStyle","action","type","button",3,"click"]]},template:function(i,t){i&1&&(r(0,"nui-widget-editor-accordion",3),u(1,"nuiWidgetEditorAccordionFormState"),u(2,"async"),E(3,"nui-widget-editor-accordion-header",4),r(4,"div",5),T(5,he,9,5,"ng-container",6)(6,$e,2,0,"button",7),l()()),i&2&&(n("formGroup",t.form)("state",C(2,8,C(1,6,t.form))),_(3),n("headerIcon","tag")("subtitle",t.getSubtitle()),_(2),n("ngForOf",t.getGroupByControl.controls),_(),n("ngIf",!t.isAddRestricted()))},dependencies:[A,oe,y,L,D,v,re,P,le,$,h,B,Ie,M,W],styles:[".grouping-configuration__accordion-content[_ngcontent-%COMP%]{padding:15px 15px 15px 46px}"],changeDetection:0})}}return o})();var st={[pe.Structure]:{[V]:{id:V,componentType:Te.lateLoadKey,properties:{elementClass:"flex-grow-1 overflow-auto nui-scroll-shadows",nodes:["presentation","dataAndCalculations"]}},presentation:{id:"presentation",componentType:z.lateLoadKey,properties:{headerText:$localize`Presentation`,nodes:["titleAndDescription"]}},titleAndDescription:{id:"titleAndDescription",componentType:Oe.lateLoadKey,providers:{converter:{providerId:ae}}},dataAndCalculations:{id:"dataAndCalculations",componentType:z.lateLoadKey,properties:{headerText:$localize`Data and calculations`,nodes:["dataSource","grouping","entityFormatting"]}},dataSource:{id:"dataSource",componentType:de.lateLoadKey,properties:{dataSourceProviders:[]},providers:{[m.Converter]:{providerId:b,properties:{formParts:[{previewPath:"/.providers.dataSource",keys:["providerId"]}]}}}},grouping:{id:"grouping",componentType:ue.lateLoadKey,properties:{groups:[],groupBy:[]},providers:{[m.Converter]:{providerId:b,properties:{formParts:[{previewPath:`listWidget.providers.${m.Adapter}.properties`,keys:["groupBy","drillstate","groups"]}]}}}},entityFormatting:{id:"entityFormatting",componentType:ce.lateLoadKey,properties:{mappingKeys:["icon_status","capital","name","icon","url"],dataFieldIds:{icon:"icon",status:"icon_status",detailedUrl:"capital",label:"name",url:"url"}},providers:{[m.Converter]:{providerId:b,properties:{formParts:[{previewPath:`listWidget.providers.${m.Adapter}.properties.componentsConfig.leaf.properties`,keys:["dataFieldIds"]}]}}}}}};export{ce as a,ue as b,st as c};
