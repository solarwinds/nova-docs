import{a as Q,j as U}from"./chunk-2PYN5BKZ.js";import{a as H}from"./chunk-32FRYE2I.js";import{a as s}from"./chunk-ALWGDNZ2.js";import{A as a,Ja as J,U as X,b as ee,ea as E,ha as o,ia as G,ka as W}from"./chunk-UNYFFDYX.js";import{Yc as Y,pc as F,xe as D}from"./chunk-3HSEZOBQ.js";import{f as V,z as p}from"./chunk-NEOTMEUH.js";import{$c as j,A as M,Aa as T,Ac as A,Ha as B,Pb as K,Rb as I,Sa as _,Ta as v,X as O,Xb as c,Yb as d,Z as P,bc as R,ca as b,gc as N,i as y,kc as L,lc as l,va as f,vc as z,yb as C,yc as w,zb as S,zc as k}from"./chunk-NNMBFNDY.js";import{g as $,i as m}from"./chunk-T555DFTC.js";var q=$(ee());function te(i,Z){if(i&1){let e=R();c(0,"button",6),L("click",function(){_(e);let r=l();return v(r.reInitializeDashboard())}),z(1," Restore Widget "),d()}}function ie(i,Z){if(i&1){let e=R();c(0,"nui-dashboard",7),A("dashboardChange",function(r){_(e);let n=l();return k(n.dashboard,r)||(n.dashboard=r),v(r)})("gridsterConfigChange",function(r){_(e);let n=l();return k(n.gridsterConfig,r)||(n.gridsterConfig=r),v(r)}),d()}if(i&2){let e=l();w("dashboard",e.dashboard),I("editMode",e.editMode),w("gridsterConfig",e.gridsterConfig)}}var u=(()=>{class i extends D{static{this.providerId="AverageRatingKpiDataSource"}constructor(e){super(),this.http=e,this.busy=new y(!1)}getFilteredData(){return m(this,null,function*(){return this.busy.next(!0),new Promise(e=>{this.http.get("https://www.googleapis.com/books/v1/volumes/5MQFrgEACAAJ").pipe(b(()=>this.busy.next(!1))).subscribe({next:t=>{e({result:{value:t.volumeInfo.averageRating}})},error:t=>{e({result:null,error:{type:t.status}})}})})})}ngOnDestroy(){this.outputsSubject.complete()}static{this.\u0275fac=function(t){return new(t||i)(T(p))}}static{this.\u0275prov=f({token:i,factory:i.\u0275fac})}}return i})(),g=(()=>{class i extends D{static{this.providerId="RatingsCountKpiDataSource"}constructor(e){super(),this.http=e,this.busy=new y(!1)}getFilteredData(){return m(this,null,function*(){return this.busy.next(!0),new Promise(e=>{this.http.get("https://www.googleapis.com/books/v1/volumes/5MQFrgEACAAJ").pipe(P(2e3),b(()=>this.busy.next(!1))).subscribe({next:t=>{e({result:{value:t.volumeInfo.ratingsCount}})},error:t=>{e({result:null,error:{type:t.status}})}})})})}ngOnDestroy(){this.outputsSubject.complete()}static{this.\u0275fac=function(t){return new(t||i)(T(p))}}static{this.\u0275prov=f({token:i,factory:i.\u0275fac})}}return i})(),h=(()=>{class i extends D{static{this.providerId="MockKpiDataSource"}constructor(){super(),this.busy=new y(!1)}getFilteredData(){return m(this,null,function*(){return this.busy.next(!0),new Promise(e=>{M(3381342).pipe(P(5e3),O(1),b(()=>this.busy.next(!1))).subscribe({next:t=>{e({result:{value:t}})}})})})}ngOnDestroy(){this.outputsSubject.complete()}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275prov=f({token:i,factory:i.\u0275fac})}}return i})(),fe=(()=>{class i{constructor(e,t,r){this.widgetTypesService=e,this.providerRegistry=t,this.changeDetectorRef=r,this.gridsterConfig={},this.editMode=!1}ngOnInit(){this.setupDashboard(),this.initializeDashboard()}setupDashboard(){let e=this.widgetTypesService.getWidgetType("kpi",1);this.widgetTypesService.setNode(e,"configurator",G.DataSourceProviders,[u.providerId,g.providerId,h.providerId]),this.providerRegistry.setProviders({[u.providerId]:{provide:E,useClass:u,deps:[p]},[g.providerId]:{provide:E,useClass:g,deps:[p]},[h.providerId]:{provide:E,useClass:h,deps:[]}})}reInitializeDashboard(){this.dashboard=void 0,this.changeDetectorRef.detectChanges(),this.initializeDashboard()}initializeDashboard(){let e=re.map(n=>this.widgetTypesService.mergeWithWidgetType(n)),t=(0,q.default)(e,n=>n.id),r={kpiWidgetId:{cols:3,rows:6,y:0,x:0},kpiWidgetId2:{cols:3,rows:6,y:0,x:0}};this.dashboard={positions:r,widgets:t}}static{this.\u0275fac=function(t){return new(t||i)(S(H),S(J),S(j))}}static{this.\u0275cmp=B({type:i,selectors:[["kpi-sync-broker-example"]],decls:6,vars:3,consts:()=>{let e;return e=$localize`:␟18d630a3c524dbab6dc528571782a939a7bc95b1␟861097914887003123: Edit Mode `,[e,[1,"mb-2","d-flex","align-items-center"],[1,"ml-3","py-2",3,"valueChange","value"],["type","button","displayStyle","action","nui-button","",3,"click",4,"ngIf"],[1,"w-100","dashboard"],["nuiWidgetEditor","",3,"dashboard","editMode","gridsterConfig","dashboardChange","gridsterConfigChange",4,"ngIf"],["type","button","displayStyle","action","nui-button","",3,"click"],["nuiWidgetEditor","",3,"dashboardChange","gridsterConfigChange","dashboard","editMode","gridsterConfig"]]},template:function(t,r){t&1&&(c(0,"div",1)(1,"nui-switch",2),A("valueChange",function(x){return k(r.editMode,x)||(r.editMode=x),x}),N(2,0),d(),K(3,te,2,0,"button",3),d(),c(4,"div",4),K(5,ie,1,3,"nui-dashboard",5),d()),t&2&&(C(),w("value",r.editMode),C(2),I("ngIf",!(r.dashboard!=null&&r.dashboard.widgets.kpiWidgetId)),C(2),I("ngIf",r.dashboard))},dependencies:[F,V,Q,U,Y],styles:[".dashboard[_ngcontent-%COMP%]{height:400px}"]})}}return i})(),re=[{id:"kpiWidgetId",type:"kpi",pizzagna:{[W.Configuration]:{header:{properties:{title:"NO Sync Broker",subtitle:"Values sizes are being not synced"}},tiles:{properties:{nodes:["kpi1","kpi2","kpi3"]}},kpi1:{id:"kpi1",componentType:s.lateLoadKey,properties:{widgetData:{units:"out of 5 Stars",label:"Average Rating",backgroundColor:"lightpink"}},providers:{[o.DataSource]:{providerId:u.providerId},[o.Adapter]:{providerId:a,properties:{componentId:"kpi1",propertyPath:"widgetData"}}}},kpi2:{id:"kpi2",componentType:s.lateLoadKey,properties:{widgetData:{label:"Another label which might be a pretty long one",units:"Which comes from somewhere",backgroundColor:"skyblue"}},providers:{[o.DataSource]:{providerId:g.providerId},[o.Adapter]:{providerId:a,properties:{componentId:"kpi2",propertyPath:"widgetData"}}}},kpi3:{id:"kpi3",componentType:s.lateLoadKey,properties:{widgetData:{label:"Random",units:"Data"}},providers:{[o.DataSource]:{providerId:h.providerId},[o.Adapter]:{providerId:a,properties:{componentId:"kpi3",propertyPath:"widgetData"}}}}}}},{id:"kpiWidgetId2",type:"kpi",pizzagna:{[W.Configuration]:{header:{properties:{title:"WITH Sync Broker",subtitle:"Now the values of label, units, and value are being synced"}},tiles:{properties:{nodes:["kpi4","kpi5","kpi6"]},providers:{kpiScaleSyncBroker:{providerId:X,properties:{scaleSyncConfig:[{id:"value"},{id:"label"},{id:"units"}]}}}},kpi4:{id:"kpi4",componentType:s.lateLoadKey,properties:{widgetData:{units:"out of 5 Stars",label:"Average Rating",backgroundColor:"lightpink"}},providers:{[o.DataSource]:{providerId:u.providerId},[o.Adapter]:{providerId:a,properties:{componentId:"kpi4",propertyPath:"widgetData"}}}},kpi5:{id:"kpi5",componentType:s.lateLoadKey,properties:{widgetData:{label:"Another label which might be a pretty long one",units:"Which comes from somewhere",backgroundColor:"skyblue"}},providers:{[o.DataSource]:{providerId:g.providerId},[o.Adapter]:{providerId:a,properties:{componentId:"kpi5",propertyPath:"widgetData"}}}},kpi6:{id:"kpi6",componentType:s.lateLoadKey,properties:{widgetData:{label:"Random",units:"Data"}},providers:{[o.DataSource]:{providerId:h.providerId},[o.Adapter]:{providerId:a,properties:{componentId:"kpi6",propertyPath:"widgetData"}}}}}}}];export{u as a,g as b,h as c,fe as d};
