import{a as fp,b as hp}from"./chunk-JTZX6I73.js";import{A as kd,C as Ld,Cc as du,D as Rd,E as Pd,F as Nd,Gc as pu,H as ko,Hc as mu,I as Gr,J as Od,Jb as Zd,K as Lo,Kb as Jd,M as Fd,N as Bd,Q as zd,Rb as fu,T as Ro,Tb as tp,U as Po,Ub as ep,Wb as np,Xb as rp,Y as Hd,Yb as ip,Z as $d,Zb as op,_ as Vd,_b as sp,ac as ap,b as yd,c as bd,ca as Ud,d as To,f as wd,fa as Yd,gc as up,h as _d,ha as qd,i as su,ib as Gd,j as Sd,jb as Wd,jc as cp,k as Do,kc as lp,l as Cd,lc as hu,ld as gu,n as Ad,o as au,p as uu,q as Ed,r as Md,s as Io,sb as lu,t as cu,tb as Xd,u as Td,wb as jd,x as Dd,z as Id,zb as Qd}from"./chunk-DKNPFPFG.js";import{d as iu,f as qr,j as ou}from"./chunk-TBX5YZGF.js";import{A as bo,Aa as Xa,Cc as Mo,Eb as tu,F as Va,Ga as ja,Ha as Se,Ia as Ka,Ja as Qa,Lc as Ur,Nb as Ce,Ob as eu,Pb as Nt,Q as Ua,Qa as en,Qb as _o,Rb as nn,Ta as Za,Vb as dt,Wb as pt,Xb as So,Za as Ja,Zc as Yr,_a as wo,h as ht,i as tn,ic as nu,jc as Ae,kc as Dn,lc as Ot,ma as Ya,na as tt,pc as Co,qc as Ao,rc as Eo,sc as In,tc as kn,ua as qa,va as Vr,vc as Ln,wa as Ga,wb as Tt,xb as Pt,ya as Wa,zc as ru}from"./chunk-FGVILFLG.js";import{a as Kd}from"./chunk-JISDZD7Z.js";import{a as Wt,b as Xt,f as rt,g as F}from"./chunk-T555DFTC.js";var Vo=rt((K1,Su)=>{var bp=Xd(),wp=Sd();function _p(t,e,n){(n!==void 0&&!wp(t[e],n)||n===void 0&&!(e in t))&&bp(t,e,n)}Su.exports=_p});var Uo=rt((Q1,Cu)=>{function Sp(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}Cu.exports=Sp});var Eu=rt((Z1,Au)=>{var Cp=Zd(),Ap=fu();function Ep(t){return Cp(t,Ap(t))}Au.exports=Ep});var Lu=rt((J1,ku)=>{var Mu=Vo(),Mp=np(),Tp=ip(),Dp=Qd(),Ip=op(),Tu=Ad(),Du=au(),kp=cu(),Lp=Id(),Rp=su(),Pp=To(),Np=up(),Op=kd(),Iu=Uo(),Fp=Eu();function Bp(t,e,n,r,i,o,s){var a=Iu(t,n),u=Iu(e,n),c=s.get(u);if(c){Mu(t,n,c);return}var l=o?o(a,u,n+"",t,e,s):void 0,f=l===void 0;if(f){var h=Du(u),d=!h&&Lp(u),g=!h&&!d&&Op(u);l=u,h||d||g?Du(a)?l=a:kp(a)?l=Dp(a):d?(f=!1,l=Mp(u,!0)):g?(f=!1,l=Tp(u,!0)):l=[]:Np(u)||Tu(u)?(l=a,Tu(a)?l=Fp(a):(!Pp(a)||Rp(a))&&(l=Ip(u))):f=!1}f&&(s.set(u,l),i(l,u,r,o,s),s.delete(u)),Mu(t,n,l)}ku.exports=Bp});var Yo=rt((tb,Pu)=>{var zp=Dd(),Hp=Vo(),$p=Pd(),Vp=Lu(),Up=To(),Yp=fu(),qp=Uo();function Ru(t,e,n,r,i){t!==e&&$p(e,function(o,s){if(i||(i=new zp),Up(o))Vp(t,e,s,n,Ru,r,i);else{var a=r?r(qp(t,s),o,s+"",t,e,i):void 0;a===void 0&&(a=o),Hp(t,s,a)}},Yp)}Pu.exports=Ru});var Bu=rt((eb,Fu)=>{var Gp=Yo(),Nu=To();function Ou(t,e,n,r,i,o){return Nu(t)&&Nu(e)&&(o.set(e,t),Gp(t,e,void 0,Ou,o),o.delete(e)),t}Fu.exports=Ou});var Hu=rt((nb,zu)=>{var Wp=Yo(),Xp=Jd(),jp=Xp(function(t,e,n,r){Wp(t,e,n,r)});zu.exports=jp});var Vu=rt((rb,$u)=>{var Kp=Md(),Qp=Io(),Zp=Bu(),Jp=Hu(),tm=Qp(function(t){return t.push(void 0,Zp),Kp(Jp,void 0,t)});$u.exports=tm});var nh=rt((BP,eh)=>{var cv=Cd(),lv=Lo(),fv=tp(),hv=rp();function dv(t,e){if(t==null)return{};var n=cv(hv(t),function(r){return[r]});return e=lv(e),fv(t,n,function(r,i){return e(r,i[0])})}eh.exports=dv});var ch=rt((nN,uh)=>{function Cv(t,e,n){var r;return n(t,function(i,o,s){if(e(i,o,s))return r=o,!1}),r}uh.exports=Cv});var fh=rt((rN,lh)=>{var Av=ch(),Ev=Nd(),Mv=Lo();function Tv(t,e){return Av(t,Mv(e,3),Ev)}lh.exports=Tv});var ph=rt((iN,dh)=>{var Dv=uu(),Iv=cp(),kv=Io(),hh=jd(),Lv=kv(function(t,e){if(t==null)return[];var n=e.length;return n>1&&hh(t,e[0],e[1])?e=[]:n>2&&hh(e[0],e[1],e[2])&&(e=[e[0]]),Iv(t,Dv(e,1),[])});dh.exports=Lv});var ra=rt((oN,mh)=>{var Rv=Do();function Pv(t,e){for(var n=t.length;n--&&Rv(e,t[n],0)>-1;);return n}mh.exports=Pv});var ia=rt((sN,gh)=>{var Nv=Do();function Ov(t,e){for(var n=-1,r=t.length;++n<r&&Nv(e,t[n],0)>-1;);return n}gh.exports=Ov});var yh=rt((aN,vh)=>{var Fv=ko(),Bv=bd(),zv=Ro(),Hv=ra(),$v=ia(),xh=Po(),Vv=Gr();function Uv(t,e,n){if(t=Vv(t),t&&(n||e===void 0))return Bv(t);if(!t||!(e=Fv(e)))return t;var r=xh(t),i=xh(e),o=$v(r,i),s=Hv(r,i)+1;return zv(r,o,s).join("")}vh.exports=Uv});var _h=rt((uN,wh)=>{var Yv=ko(),qv=Ro(),Gv=ra(),bh=Po(),Wv=Gr(),Xv=yd();function jv(t,e,n){if(t=Wv(t),t&&(n||e===void 0))return t.slice(0,Xv(t)+1);if(!t||!(e=Yv(e)))return t;var r=bh(t),i=Gv(r,bh(e))+1;return qv(r,0,i).join("")}wh.exports=jv});var Ah=rt((cN,Ch)=>{var Kv=ko(),Qv=Ro(),Zv=ia(),Sh=Po(),Jv=Gr(),ty=/^\s+/;function ey(t,e,n){if(t=Jv(t),t&&(n||e===void 0))return t.replace(ty,"");if(!t||!(e=Kv(e)))return t;var r=Sh(t),i=Zv(r,Sh(e));return Qv(r,i).join("")}Ch.exports=ey});var Mh=rt((lN,Eh)=>{var ny=Do(),ry=wd(),iy=Math.max;function oy(t,e,n){var r=t==null?0:t.length;if(!r)return-1;var i=n==null?0:ry(n);return i<0&&(i=iy(r+i,0)),ny(t,e,i)}Eh.exports=oy});var Ih=rt((fN,Dh)=>{var sy=uu(),ay=Lo(),uy=Io(),cy=Fd(),Th=cu(),ly=Td(),fy=uy(function(t){var e=ly(t);return Th(e)&&(e=void 0),cy(sy(t,1,Th,!0),ay(e,2))});Dh.exports=fy});var I=F(Rd(),1);var No=Math.PI,Oo=2*No,Ee=1e-6,dp=Oo-Ee;function Fo(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function xu(){return new Fo}Fo.prototype=xu.prototype={constructor:Fo,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var o=this._x1,s=this._y1,a=n-t,u=r-e,c=o-t,l=s-e,f=c*c+l*l;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(f>Ee)if(!(Math.abs(l*a-u*c)>Ee)||!i)this._+="L"+(this._x1=t)+","+(this._y1=e);else{var h=n-o,d=r-s,g=a*a+u*u,m=h*h+d*d,p=Math.sqrt(g),v=Math.sqrt(f),y=i*Math.tan((No-Math.acos((g+f-m)/(2*p*v)))/2),x=y/v,_=y/p;Math.abs(x-1)>Ee&&(this._+="L"+(t+x*c)+","+(e+x*l)),this._+="A"+i+","+i+",0,0,"+ +(l*h>c*d)+","+(this._x1=t+_*a)+","+(this._y1=e+_*u)}},arc:function(t,e,n,r,i,o){t=+t,e=+e,n=+n,o=!!o;var s=n*Math.cos(r),a=n*Math.sin(r),u=t+s,c=e+a,l=1^o,f=o?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+u+","+c:(Math.abs(this._x1-u)>Ee||Math.abs(this._y1-c)>Ee)&&(this._+="L"+u+","+c),n&&(f<0&&(f=f%Oo+Oo),f>dp?this._+="A"+n+","+n+",0,1,"+l+","+(t-s)+","+(e-a)+"A"+n+","+n+",0,1,"+l+","+(this._x1=u)+","+(this._y1=c):f>Ee&&(this._+="A"+n+","+n+",0,"+ +(f>=No)+","+l+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var Me=xu;function H(t){return function(){return t}}var Bo=Math.abs,ut=Math.atan2,le=Math.cos,vu=Math.max,Wr=Math.min,Ft=Math.sin,Te=Math.sqrt,bt=1e-12,rn=Math.PI,Rn=rn/2,on=2*rn;function yu(t){return t>1?0:t<-1?rn:Math.acos(t)}function zo(t){return t>=1?Rn:t<=-1?-Rn:Math.asin(t)}function pp(t){return t.innerRadius}function mp(t){return t.outerRadius}function gp(t){return t.startAngle}function xp(t){return t.endAngle}function vp(t){return t&&t.padAngle}function yp(t,e,n,r,i,o,s,a){var u=n-t,c=r-e,l=s-i,f=a-o,h=f*u-l*c;if(!(h*h<bt))return h=(l*(e-o)-f*(t-i))/h,[t+h*u,e+h*c]}function Xr(t,e,n,r,i,o,s){var a=t-n,u=e-r,c=(s?o:-o)/Te(a*a+u*u),l=c*u,f=-c*a,h=t+l,d=e+f,g=n+l,m=r+f,p=(h+g)/2,v=(d+m)/2,y=g-h,x=m-d,_=y*y+x*x,T=i-o,D=h*m-g*d,S=(x<0?-1:1)*Te(vu(0,T*T*_-D*D)),R=(D*x-y*S)/_,M=(-D*y-x*S)/_,L=(D*x+y*S)/_,C=(-D*y+x*S)/_,w=R-p,A=M-v,J=L-p,U=C-v;return w*w+A*A>J*J+U*U&&(R=L,M=C),{cx:R,cy:M,x01:-l,y01:-f,x11:R*(i/T-1),y11:M*(i/T-1)}}function jr(){var t=pp,e=mp,n=H(0),r=null,i=gp,o=xp,s=vp,a=null;function u(){var c,l,f=+t.apply(this,arguments),h=+e.apply(this,arguments),d=i.apply(this,arguments)-Rn,g=o.apply(this,arguments)-Rn,m=Bo(g-d),p=g>d;if(a||(a=c=Me()),h<f&&(l=h,h=f,f=l),!(h>bt))a.moveTo(0,0);else if(m>on-bt)a.moveTo(h*le(d),h*Ft(d)),a.arc(0,0,h,d,g,!p),f>bt&&(a.moveTo(f*le(g),f*Ft(g)),a.arc(0,0,f,g,d,p));else{var v=d,y=g,x=d,_=g,T=m,D=m,S=s.apply(this,arguments)/2,R=S>bt&&(r?+r.apply(this,arguments):Te(f*f+h*h)),M=Wr(Bo(h-f)/2,+n.apply(this,arguments)),L=M,C=M,w,A;if(R>bt){var J=zo(R/f*Ft(S)),U=zo(R/h*Ft(S));(T-=J*2)>bt?(J*=p?1:-1,x+=J,_-=J):(T=0,x=_=(d+g)/2),(D-=U*2)>bt?(U*=p?1:-1,v+=U,y-=U):(D=0,v=y=(d+g)/2)}var Y=h*le(v),nt=h*Ft(v),q=f*le(_),B=f*Ft(_);if(M>bt){var K=h*le(y),Q=h*Ft(y),Qt=f*le(x),qt=f*Ft(x),lt;if(m<rn&&(lt=yp(Y,nt,Qt,qt,K,Q,q,B))){var Gt=Y-lt[0],ce=nt-lt[1],Lt=K-lt[0],Rt=Q-lt[1],E=1/Ft(yu((Gt*Lt+ce*Rt)/(Te(Gt*Gt+ce*ce)*Te(Lt*Lt+Rt*Rt)))/2),P=Te(lt[0]*lt[0]+lt[1]*lt[1]);L=Wr(M,(f-P)/(E-1)),C=Wr(M,(h-P)/(E+1))}}D>bt?C>bt?(w=Xr(Qt,qt,Y,nt,h,C,p),A=Xr(K,Q,q,B,h,C,p),a.moveTo(w.cx+w.x01,w.cy+w.y01),C<M?a.arc(w.cx,w.cy,C,ut(w.y01,w.x01),ut(A.y01,A.x01),!p):(a.arc(w.cx,w.cy,C,ut(w.y01,w.x01),ut(w.y11,w.x11),!p),a.arc(0,0,h,ut(w.cy+w.y11,w.cx+w.x11),ut(A.cy+A.y11,A.cx+A.x11),!p),a.arc(A.cx,A.cy,C,ut(A.y11,A.x11),ut(A.y01,A.x01),!p))):(a.moveTo(Y,nt),a.arc(0,0,h,v,y,!p)):a.moveTo(Y,nt),!(f>bt)||!(T>bt)?a.lineTo(q,B):L>bt?(w=Xr(q,B,K,Q,f,-L,p),A=Xr(Y,nt,Qt,qt,f,-L,p),a.lineTo(w.cx+w.x01,w.cy+w.y01),L<M?a.arc(w.cx,w.cy,L,ut(w.y01,w.x01),ut(A.y01,A.x01),!p):(a.arc(w.cx,w.cy,L,ut(w.y01,w.x01),ut(w.y11,w.x11),!p),a.arc(0,0,f,ut(w.cy+w.y11,w.cx+w.x11),ut(A.cy+A.y11,A.cx+A.x11),p),a.arc(A.cx,A.cy,L,ut(A.y11,A.x11),ut(A.y01,A.x01),!p))):a.arc(0,0,f,_,x,p)}if(a.closePath(),c)return a=null,c+""||null}return u.centroid=function(){var c=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,l=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-rn/2;return[le(l)*c,Ft(l)*c]},u.innerRadius=function(c){return arguments.length?(t=typeof c=="function"?c:H(+c),u):t},u.outerRadius=function(c){return arguments.length?(e=typeof c=="function"?c:H(+c),u):e},u.cornerRadius=function(c){return arguments.length?(n=typeof c=="function"?c:H(+c),u):n},u.padRadius=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:H(+c),u):r},u.startAngle=function(c){return arguments.length?(i=typeof c=="function"?c:H(+c),u):i},u.endAngle=function(c){return arguments.length?(o=typeof c=="function"?c:H(+c),u):o},u.padAngle=function(c){return arguments.length?(s=typeof c=="function"?c:H(+c),u):s},u.context=function(c){return arguments.length?(a=c??null,u):a},u}function bu(t){this._context=t}bu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function fe(t){return new bu(t)}function Kr(t){return t[0]}function Qr(t){return t[1]}function sn(){var t=Kr,e=Qr,n=H(!0),r=null,i=fe,o=null;function s(a){var u,c=a.length,l,f=!1,h;for(r==null&&(o=i(h=Me())),u=0;u<=c;++u)!(u<c&&n(l=a[u],u,a))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+t(l,u,a),+e(l,u,a));if(h)return o=null,h+""||null}return s.x=function(a){return arguments.length?(t=typeof a=="function"?a:H(+a),s):t},s.y=function(a){return arguments.length?(e=typeof a=="function"?a:H(+a),s):e},s.defined=function(a){return arguments.length?(n=typeof a=="function"?a:H(!!a),s):n},s.curve=function(a){return arguments.length?(i=a,r!=null&&(o=i(r)),s):i},s.context=function(a){return arguments.length?(a==null?r=o=null:o=i(r=a),s):r},s}function Ho(){var t=Kr,e=null,n=H(0),r=Qr,i=H(!0),o=null,s=fe,a=null;function u(l){var f,h,d,g=l.length,m,p=!1,v,y=new Array(g),x=new Array(g);for(o==null&&(a=s(v=Me())),f=0;f<=g;++f){if(!(f<g&&i(m=l[f],f,l))===p)if(p=!p)h=f,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),d=f-1;d>=h;--d)a.point(y[d],x[d]);a.lineEnd(),a.areaEnd()}p&&(y[f]=+t(m,f,l),x[f]=+n(m,f,l),a.point(e?+e(m,f,l):y[f],r?+r(m,f,l):x[f]))}if(v)return a=null,v+""||null}function c(){return sn().defined(i).curve(s).context(o)}return u.x=function(l){return arguments.length?(t=typeof l=="function"?l:H(+l),e=null,u):t},u.x0=function(l){return arguments.length?(t=typeof l=="function"?l:H(+l),u):t},u.x1=function(l){return arguments.length?(e=l==null?null:typeof l=="function"?l:H(+l),u):e},u.y=function(l){return arguments.length?(n=typeof l=="function"?l:H(+l),r=null,u):n},u.y0=function(l){return arguments.length?(n=typeof l=="function"?l:H(+l),u):n},u.y1=function(l){return arguments.length?(r=l==null?null:typeof l=="function"?l:H(+l),u):r},u.lineX0=u.lineY0=function(){return c().x(t).y(n)},u.lineY1=function(){return c().x(t).y(r)},u.lineX1=function(){return c().x(e).y(n)},u.defined=function(l){return arguments.length?(i=typeof l=="function"?l:H(!!l),u):i},u.curve=function(l){return arguments.length?(s=l,o!=null&&(a=s(o)),u):s},u.context=function(l){return arguments.length?(l==null?o=a=null:a=s(o=l),u):o},u}function wu(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function _u(t){return t}function $o(){var t=_u,e=wu,n=null,r=H(0),i=H(on),o=H(0);function s(a){var u,c=a.length,l,f,h=0,d=new Array(c),g=new Array(c),m=+r.apply(this,arguments),p=Math.min(on,Math.max(-on,i.apply(this,arguments)-m)),v,y=Math.min(Math.abs(p)/c,o.apply(this,arguments)),x=y*(p<0?-1:1),_;for(u=0;u<c;++u)(_=g[d[u]=u]=+t(a[u],u,a))>0&&(h+=_);for(e!=null?d.sort(function(T,D){return e(g[T],g[D])}):n!=null&&d.sort(function(T,D){return n(a[T],a[D])}),u=0,f=h?(p-c*x)/h:0;u<c;++u,m=v)l=d[u],_=g[l],v=m+(_>0?_*f:0)+x,g[l]={data:a[l],index:u,value:_,startAngle:m,endAngle:v,padAngle:y};return g}return s.value=function(a){return arguments.length?(t=typeof a=="function"?a:H(+a),s):t},s.sortValues=function(a){return arguments.length?(e=a,n=null,s):e},s.sort=function(a){return arguments.length?(n=a,e=null,s):n},s.startAngle=function(a){return arguments.length?(r=typeof a=="function"?a:H(+a),s):r},s.endAngle=function(a){return arguments.length?(i=typeof a=="function"?a:H(+a),s):i},s.padAngle=function(a){return arguments.length?(o=typeof a=="function"?a:H(+a),s):o},s}var ae=F(Vu(),1);function Bt(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Pn(t){return t.length===1&&(t=em(t)),{left:function(e,n,r,i){for(r==null&&(r=0),i==null&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)<0?r=o+1:i=o}return r},right:function(e,n,r,i){for(r==null&&(r=0),i==null&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)>0?i=o:r=o+1}return r}}}function em(t){return function(e,n){return Bt(t(e),n)}}var Uu=Pn(Bt),Yu=Uu.right,nm=Uu.left,Dt=Yu;function It(t){return t===null?NaN:+t}function qo(t,e){var n=t.length,r=0,i=-1,o=0,s,a,u=0;if(e==null)for(;++i<n;)isNaN(s=It(t[i]))||(a=s-o,o+=a/++r,u+=a*(s-o));else for(;++i<n;)isNaN(s=It(e(t[i],i,t)))||(a=s-o,o+=a/++r,u+=a*(s-o));if(r>1)return u/(r-1)}function qu(t,e){var n=qo(t,e);return n&&Math.sqrt(n)}function Nn(t,e){var n=t.length,r=-1,i,o,s;if(e==null){for(;++r<n;)if((i=t[r])!=null&&i>=i)for(o=s=i;++r<n;)(i=t[r])!=null&&(o>i&&(o=i),s<i&&(s=i))}else for(;++r<n;)if((i=e(t[r],r,t))!=null&&i>=i)for(o=s=i;++r<n;)(i=e(t[r],r,t))!=null&&(o>i&&(o=i),s<i&&(s=i));return[o,s]}var Gu=Array.prototype,rm=Gu.slice,im=Gu.map;function De(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,o=new Array(i);++r<i;)o[r]=t+r*n;return o}var Go=Math.sqrt(50),Wo=Math.sqrt(10),Xo=Math.sqrt(2);function Zr(t,e,n){var r,i=-1,o,s,a;if(e=+e,t=+t,n=+n,t===e&&n>0)return[t];if((r=e<t)&&(o=t,t=e,e=o),(a=an(t,e,n))===0||!isFinite(a))return[];if(a>0)for(t=Math.ceil(t/a),e=Math.floor(e/a),s=new Array(o=Math.ceil(e-t+1));++i<o;)s[i]=(t+i)*a;else for(t=Math.floor(t*a),e=Math.ceil(e*a),s=new Array(o=Math.ceil(t-e+1));++i<o;)s[i]=(t-i)/a;return r&&s.reverse(),s}function an(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=Go?10:o>=Wo?5:o>=Xo?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=Go?10:o>=Wo?5:o>=Xo?2:1)}function Jt(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=Go?i*=10:o>=Wo?i*=5:o>=Xo&&(i*=2),e<t?-i:i}function On(t,e,n){if(n==null&&(n=It),!!(r=t.length)){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,o=Math.floor(i),s=+n(t[o],o,t),a=+n(t[o+1],o+1,t);return s+(a-s)*(i-o)}}function he(t,e){var n=t.length,r=-1,i,o;if(e==null){for(;++r<n;)if((i=t[r])!=null&&i>=i)for(o=i;++r<n;)(i=t[r])!=null&&i>o&&(o=i)}else for(;++r<n;)if((i=e(t[r],r,t))!=null&&i>=i)for(o=i;++r<n;)(i=e(t[r],r,t))!=null&&i>o&&(o=i);return o}function om(t,e){var n=t.length,r=n,i=-1,o,s=0;if(e==null)for(;++i<n;)isNaN(o=It(t[i]))?--r:s+=o;else for(;++i<n;)isNaN(o=It(e(t[i],i,t)))?--r:s+=o;if(r)return s/r}function sm(t,e){var n=t.length,r=-1,i,o=[];if(e==null)for(;++r<n;)isNaN(i=It(t[r]))||o.push(i);else for(;++r<n;)isNaN(i=It(e(t[r],r,t)))||o.push(i);return On(o.sort(Bt),.5)}function de(t,e){var n=t.length,r=-1,i,o;if(e==null){for(;++r<n;)if((i=t[r])!=null&&i>=i)for(o=i;++r<n;)(i=t[r])!=null&&o>i&&(o=i)}else for(;++r<n;)if((i=e(t[r],r,t))!=null&&i>=i)for(o=i;++r<n;)(i=e(t[r],r,t))!=null&&o>i&&(o=i);return o}var Jr=Array.prototype.slice;function Xu(t){return t}var ti=1,ei=2,jo=3,Fn=4,ju=1e-6;function um(t){return"translate("+(t+.5)+",0)"}function cm(t){return"translate(0,"+(t+.5)+")"}function lm(t){return function(e){return+t(e)}}function fm(t){var e=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(e=Math.round(e)),function(n){return+t(n)+e}}function hm(){return!this.__axis}function ni(t,e){var n=[],r=null,i=null,o=6,s=6,a=3,u=t===ti||t===Fn?-1:1,c=t===Fn||t===ei?"x":"y",l=t===ti||t===jo?um:cm;function f(h){var d=r??(e.ticks?e.ticks.apply(e,n):e.domain()),g=i??(e.tickFormat?e.tickFormat.apply(e,n):Xu),m=Math.max(o,0)+a,p=e.range(),v=+p[0]+.5,y=+p[p.length-1]+.5,x=(e.bandwidth?fm:lm)(e.copy()),_=h.selection?h.selection():h,T=_.selectAll(".domain").data([null]),D=_.selectAll(".tick").data(d,e).order(),S=D.exit(),R=D.enter().append("g").attr("class","tick"),M=D.select("line"),L=D.select("text");T=T.merge(T.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),D=D.merge(R),M=M.merge(R.append("line").attr("stroke","currentColor").attr(c+"2",u*o)),L=L.merge(R.append("text").attr("fill","currentColor").attr(c,u*m).attr("dy",t===ti?"0em":t===jo?"0.71em":"0.32em")),h!==_&&(T=T.transition(h),D=D.transition(h),M=M.transition(h),L=L.transition(h),S=S.transition(h).attr("opacity",ju).attr("transform",function(C){return isFinite(C=x(C))?l(C):this.getAttribute("transform")}),R.attr("opacity",ju).attr("transform",function(C){var w=this.parentNode.__axis;return l(w&&isFinite(w=w(C))?w:x(C))})),S.remove(),T.attr("d",t===Fn||t==ei?s?"M"+u*s+","+v+"H0.5V"+y+"H"+u*s:"M0.5,"+v+"V"+y:s?"M"+v+","+u*s+"V0.5H"+y+"V"+u*s:"M"+v+",0.5H"+y),D.attr("opacity",1).attr("transform",function(C){return l(x(C))}),M.attr(c+"2",u*o),L.attr(c,u*m).text(g),_.filter(hm).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===ei?"start":t===Fn?"end":"middle"),_.each(function(){this.__axis=x})}return f.scale=function(h){return arguments.length?(e=h,f):e},f.ticks=function(){return n=Jr.call(arguments),f},f.tickArguments=function(h){return arguments.length?(n=h==null?[]:Jr.call(h),f):n.slice()},f.tickValues=function(h){return arguments.length?(r=h==null?null:Jr.call(h),f):r&&r.slice()},f.tickFormat=function(h){return arguments.length?(i=h,f):i},f.tickSize=function(h){return arguments.length?(o=s=+h,f):o},f.tickSizeInner=function(h){return arguments.length?(o=+h,f):o},f.tickSizeOuter=function(h){return arguments.length?(s=+h,f):s},f.tickPadding=function(h){return arguments.length?(a=+h,f):a},f}function Ko(t){return ni(ti,t)}function Bn(t){return ni(ei,t)}function ri(t){return ni(jo,t)}function ii(t){return ni(Fn,t)}var dm={value:function(){}};function Qu(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new oi(n)}function oi(t){this._=t}function pm(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}oi.prototype=Qu.prototype={constructor:oi,on:function(t,e){var n=this._,r=pm(t+"",n),i,o=-1,s=r.length;if(arguments.length<2){for(;++o<s;)if((i=(t=r[o]).type)&&(i=mm(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<s;)if(i=(t=r[o]).type)n[i]=Ku(n[i],t.name,e);else if(e==null)for(i in n)n[i]=Ku(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new oi(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],r=0,i=o.length;r<i;++r)o[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};function mm(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function Ku(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=dm,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var zn=Qu;var si="http://www.w3.org/1999/xhtml",Qo={svg:"http://www.w3.org/2000/svg",xhtml:si,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function te(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Qo.hasOwnProperty(e)?{space:Qo[e],local:t}:t}function gm(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===si&&e.documentElement.namespaceURI===si?e.createElement(t):e.createElementNS(n,t)}}function xm(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function ai(t){var e=te(t);return(e.local?xm:gm)(e)}function vm(){}function Ie(t){return t==null?vm:function(){return this.querySelector(t)}}function Zu(t){typeof t!="function"&&(t=Ie(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],s=o.length,a=r[i]=new Array(s),u,c,l=0;l<s;++l)(u=o[l])&&(c=t.call(u,u.__data__,l,o))&&("__data__"in u&&(c.__data__=u.__data__),a[l]=c);return new et(r,this._parents)}function ym(){return[]}function Hn(t){return t==null?ym:function(){return this.querySelectorAll(t)}}function Ju(t){typeof t!="function"&&(t=Hn(t));for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var s=e[o],a=s.length,u,c=0;c<a;++c)(u=s[c])&&(r.push(t.call(u,u.__data__,c,s)),i.push(u));return new et(r,i)}function $n(t){return function(){return this.matches(t)}}function tc(t){typeof t!="function"&&(t=$n(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],s=o.length,a=r[i]=[],u,c=0;c<s;++c)(u=o[c])&&t.call(u,u.__data__,c,o)&&a.push(u);return new et(r,this._parents)}function ui(t){return new Array(t.length)}function ec(){return new et(this._enter||this._groups.map(ui),this._parents)}function Vn(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Vn.prototype={constructor:Vn,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function nc(t){return function(){return t}}var rc="$";function bm(t,e,n,r,i,o){for(var s=0,a,u=e.length,c=o.length;s<c;++s)(a=e[s])?(a.__data__=o[s],r[s]=a):n[s]=new Vn(t,o[s]);for(;s<u;++s)(a=e[s])&&(i[s]=a)}function wm(t,e,n,r,i,o,s){var a,u,c={},l=e.length,f=o.length,h=new Array(l),d;for(a=0;a<l;++a)(u=e[a])&&(h[a]=d=rc+s.call(u,u.__data__,a,e),d in c?i[a]=u:c[d]=u);for(a=0;a<f;++a)d=rc+s.call(t,o[a],a,o),(u=c[d])?(r[a]=u,u.__data__=o[a],c[d]=null):n[a]=new Vn(t,o[a]);for(a=0;a<l;++a)(u=e[a])&&c[h[a]]===u&&(i[a]=u)}function ic(t,e){if(!t)return d=new Array(this.size()),c=-1,this.each(function(D){d[++c]=D}),d;var n=e?wm:bm,r=this._parents,i=this._groups;typeof t!="function"&&(t=nc(t));for(var o=i.length,s=new Array(o),a=new Array(o),u=new Array(o),c=0;c<o;++c){var l=r[c],f=i[c],h=f.length,d=t.call(l,l&&l.__data__,c,r),g=d.length,m=a[c]=new Array(g),p=s[c]=new Array(g),v=u[c]=new Array(h);n(l,f,m,p,v,d,e);for(var y=0,x=0,_,T;y<g;++y)if(_=m[y]){for(y>=x&&(x=y+1);!(T=p[x])&&++x<g;);_._next=T||null}}return s=new et(s,r),s._enter=a,s._exit=u,s}function oc(){return new et(this._exit||this._groups.map(ui),this._parents)}function sc(t,e,n){var r=this.enter(),i=this,o=this.exit();return r=typeof t=="function"?t(r):r.append(t+""),e!=null&&(i=e(i)),n==null?o.remove():n(o),r&&i?r.merge(i).order():i}function ac(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),s=new Array(r),a=0;a<o;++a)for(var u=e[a],c=n[a],l=u.length,f=s[a]=new Array(l),h,d=0;d<l;++d)(h=u[d]||c[d])&&(f[d]=h);for(;a<r;++a)s[a]=e[a];return new et(s,this._parents)}function uc(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,o=r[i],s;--i>=0;)(s=r[i])&&(o&&s.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(s,o),o=s);return this}function cc(t){t||(t=_m);function e(f,h){return f&&h?t(f.__data__,h.__data__):!f-!h}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var s=n[o],a=s.length,u=i[o]=new Array(a),c,l=0;l<a;++l)(c=s[l])&&(u[l]=c);u.sort(e)}return new et(i,this._parents).order()}function _m(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function lc(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function fc(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t}function hc(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var s=r[i];if(s)return s}return null}function dc(){var t=0;return this.each(function(){++t}),t}function pc(){return!this.node()}function mc(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],o=0,s=i.length,a;o<s;++o)(a=i[o])&&t.call(a,a.__data__,o,i);return this}function Sm(t){return function(){this.removeAttribute(t)}}function Cm(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Am(t,e){return function(){this.setAttribute(t,e)}}function Em(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Mm(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Tm(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function gc(t,e){var n=te(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Cm:Sm:typeof e=="function"?n.local?Tm:Mm:n.local?Em:Am)(n,e))}function ci(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Dm(t){return function(){this.style.removeProperty(t)}}function Im(t,e,n){return function(){this.style.setProperty(t,e,n)}}function km(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function xc(t,e,n){return arguments.length>1?this.each((e==null?Dm:typeof e=="function"?km:Im)(t,e,n??"")):pe(this.node(),t)}function pe(t,e){return t.style.getPropertyValue(e)||ci(t).getComputedStyle(t,null).getPropertyValue(e)}function Lm(t){return function(){delete this[t]}}function Rm(t,e){return function(){this[t]=e}}function Pm(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function vc(t,e){return arguments.length>1?this.each((e==null?Lm:typeof e=="function"?Pm:Rm)(t,e)):this.node()[t]}function yc(t){return t.trim().split(/^|\s+/)}function Zo(t){return t.classList||new bc(t)}function bc(t){this._node=t,this._names=yc(t.getAttribute("class")||"")}bc.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function wc(t,e){for(var n=Zo(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function _c(t,e){for(var n=Zo(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Nm(t){return function(){wc(this,t)}}function Om(t){return function(){_c(this,t)}}function Fm(t,e){return function(){(e.apply(this,arguments)?wc:_c)(this,t)}}function Sc(t,e){var n=yc(t+"");if(arguments.length<2){for(var r=Zo(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?Fm:e?Nm:Om)(n,e))}function Bm(){this.textContent=""}function zm(t){return function(){this.textContent=t}}function Hm(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Cc(t){return arguments.length?this.each(t==null?Bm:(typeof t=="function"?Hm:zm)(t)):this.node().textContent}function $m(){this.innerHTML=""}function Vm(t){return function(){this.innerHTML=t}}function Um(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function Ac(t){return arguments.length?this.each(t==null?$m:(typeof t=="function"?Um:Vm)(t)):this.node().innerHTML}function Ym(){this.nextSibling&&this.parentNode.appendChild(this)}function Ec(){return this.each(Ym)}function qm(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Mc(){return this.each(qm)}function Tc(t){var e=typeof t=="function"?t:ai(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Gm(){return null}function Dc(t,e){var n=typeof t=="function"?t:ai(t),r=e==null?Gm:typeof e=="function"?e:Ie(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Wm(){var t=this.parentNode;t&&t.removeChild(this)}function Ic(){return this.each(Wm)}function Xm(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function jm(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function kc(t){return this.select(t?jm:Xm)}function Lc(t){return arguments.length?this.property("__data__",t):this.node().__data__}var Pc={},k=null;typeof document<"u"&&(Rc=document.documentElement,"onmouseenter"in Rc||(Pc={mouseenter:"mouseover",mouseleave:"mouseout"}));var Rc;function Km(t,e,n){return t=Nc(t,e,n),function(r){var i=r.relatedTarget;(!i||i!==this&&!(i.compareDocumentPosition(this)&8))&&t.call(this,r)}}function Nc(t,e,n){return function(r){var i=k;k=r;try{t.call(this,this.__data__,e,n)}finally{k=i}}}function Qm(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Zm(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,o;n<i;++n)o=e[n],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.capture):e[++r]=o;++r?e.length=r:delete this.__on}}}function Jm(t,e,n){var r=Pc.hasOwnProperty(t.type)?Km:Nc;return function(i,o,s){var a=this.__on,u,c=r(e,o,s);if(a){for(var l=0,f=a.length;l<f;++l)if((u=a[l]).type===t.type&&u.name===t.name){this.removeEventListener(u.type,u.listener,u.capture),this.addEventListener(u.type,u.listener=c,u.capture=n),u.value=e;return}}this.addEventListener(t.type,c,n),u={type:t.type,name:t.name,value:e,listener:c,capture:n},a?a.push(u):this.__on=[u]}}function Oc(t,e,n){var r=Qm(t+""),i,o=r.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var u=0,c=a.length,l;u<c;++u)for(i=0,l=a[u];i<o;++i)if((s=r[i]).type===l.type&&s.name===l.name)return l.value}return}for(a=e?Jm:Zm,n==null&&(n=!1),i=0;i<o;++i)this.each(a(r[i],e,n));return this}function Jo(t,e,n,r){var i=k;t.sourceEvent=k,k=t;try{return e.apply(n,r)}finally{k=i}}function Fc(t,e,n){var r=ci(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function tg(t,e){return function(){return Fc(this,t,e)}}function eg(t,e){return function(){return Fc(this,t,e.apply(this,arguments))}}function Bc(t,e){return this.each((typeof e=="function"?eg:tg)(t,e))}var ts=[null];function et(t,e){this._groups=t,this._parents=e}function zc(){return new et([[document.documentElement]],ts)}et.prototype=zc.prototype={constructor:et,select:Zu,selectAll:Ju,filter:tc,data:ic,enter:ec,exit:oc,join:sc,merge:ac,order:uc,sort:cc,call:lc,nodes:fc,node:hc,size:dc,empty:pc,each:mc,attr:gc,style:xc,property:vc,classed:Sc,text:Cc,html:Ac,raise:Ec,lower:Mc,append:Tc,insert:Dc,remove:Ic,clone:kc,datum:Lc,on:Oc,dispatch:Bc};var Et=zc;function O(t){return typeof t=="string"?new et([[document.querySelector(t)]],[document.documentElement]):new et([[t]],ts)}var ng=0;function Un(){return new es}function es(){this._="@"+(++ng).toString(36)}es.prototype=Un.prototype={constructor:es,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};function li(){for(var t=k,e;e=t.sourceEvent;)t=e;return t}function fi(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}function Yn(t){var e=li();return e.changedTouches&&(e=e.changedTouches[0]),fi(t,e)}function ns(t,e,n){arguments.length<3&&(n=e,e=li().changedTouches);for(var r=0,i=e?e.length:0,o;r<i;++r)if((o=e[r]).identifier===n)return fi(t,o);return null}function hi(){k.preventDefault(),k.stopImmediatePropagation()}function rs(t){var e=t.document.documentElement,n=O(t).on("dragstart.drag",hi,!0);"onselectstart"in e?n.on("selectstart.drag",hi,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function is(t,e){var n=t.document.documentElement,r=O(t).on("dragstart.drag",null);e&&(r.on("click.drag",hi,!0),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function di(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function os(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Wn(){}var qn=.7,gi=1/qn,un="\\s*([+-]?\\d+)\\s*",Gn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",jt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",rg=/^#([0-9a-f]{3,8})$/,ig=new RegExp(`^rgb\\(${un},${un},${un}\\)$`),og=new RegExp(`^rgb\\(${jt},${jt},${jt}\\)$`),sg=new RegExp(`^rgba\\(${un},${un},${un},${Gn}\\)$`),ag=new RegExp(`^rgba\\(${jt},${jt},${jt},${Gn}\\)$`),ug=new RegExp(`^hsl\\(${Gn},${jt},${jt}\\)$`),cg=new RegExp(`^hsla\\(${Gn},${jt},${jt},${Gn}\\)$`),Hc={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};di(Wn,Ht,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:$c,formatHex:$c,formatHex8:lg,formatHsl:fg,formatRgb:Vc,toString:Vc});function $c(){return this.rgb().formatHex()}function lg(){return this.rgb().formatHex8()}function fg(){return Xc(this).formatHsl()}function Vc(){return this.rgb().formatRgb()}function Ht(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=rg.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Uc(e):n===3?new Ct(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?pi(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?pi(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=ig.exec(t))?new Ct(e[1],e[2],e[3],1):(e=og.exec(t))?new Ct(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=sg.exec(t))?pi(e[1],e[2],e[3],e[4]):(e=ag.exec(t))?pi(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=ug.exec(t))?Gc(e[1],e[2]/100,e[3]/100,1):(e=cg.exec(t))?Gc(e[1],e[2]/100,e[3]/100,e[4]):Hc.hasOwnProperty(t)?Uc(Hc[t]):t==="transparent"?new Ct(NaN,NaN,NaN,0):null}function Uc(t){return new Ct(t>>16&255,t>>8&255,t&255,1)}function pi(t,e,n,r){return r<=0&&(t=e=n=NaN),new Ct(t,e,n,r)}function hg(t){return t instanceof Wn||(t=Ht(t)),t?(t=t.rgb(),new Ct(t.r,t.g,t.b,t.opacity)):new Ct}function $t(t,e,n,r){return arguments.length===1?hg(t):new Ct(t,e,n,r??1)}function Ct(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}di(Ct,$t,os(Wn,{brighter(t){return t=t==null?gi:Math.pow(gi,t),new Ct(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?qn:Math.pow(qn,t),new Ct(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Ct(Le(this.r),Le(this.g),Le(this.b),xi(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Yc,formatHex:Yc,formatHex8:dg,formatRgb:qc,toString:qc}));function Yc(){return`#${ke(this.r)}${ke(this.g)}${ke(this.b)}`}function dg(){return`#${ke(this.r)}${ke(this.g)}${ke(this.b)}${ke((isNaN(this.opacity)?1:this.opacity)*255)}`}function qc(){let t=xi(this.opacity);return`${t===1?"rgb(":"rgba("}${Le(this.r)}, ${Le(this.g)}, ${Le(this.b)}${t===1?")":`, ${t})`}`}function xi(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Le(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function ke(t){return t=Le(t),(t<16?"0":"")+t.toString(16)}function Gc(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new zt(t,e,n,r)}function Xc(t){if(t instanceof zt)return new zt(t.h,t.s,t.l,t.opacity);if(t instanceof Wn||(t=Ht(t)),!t)return new zt;if(t instanceof zt)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),s=NaN,a=o-i,u=(o+i)/2;return a?(e===o?s=(n-r)/a+(n<r)*6:n===o?s=(r-e)/a+2:s=(e-n)/a+4,a/=u<.5?o+i:2-o-i,s*=60):a=u>0&&u<1?0:s,new zt(s,a,u,t.opacity)}function jc(t,e,n,r){return arguments.length===1?Xc(t):new zt(t,e,n,r??1)}function zt(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}di(zt,jc,os(Wn,{brighter(t){return t=t==null?gi:Math.pow(gi,t),new zt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?qn:Math.pow(qn,t),new zt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Ct(ss(t>=240?t-240:t+120,i,r),ss(t,i,r),ss(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new zt(Wc(this.h),mi(this.s),mi(this.l),xi(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let t=xi(this.opacity);return`${t===1?"hsl(":"hsla("}${Wc(this.h)}, ${mi(this.s)*100}%, ${mi(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Wc(t){return t=(t||0)%360,t<0?t+360:t}function mi(t){return Math.max(0,Math.min(1,t||0))}function ss(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function as(t,e,n,r,i){var o=t*t,s=o*t;return((1-3*t+3*o-s)*e+(4-6*o+3*s)*n+(1+3*t+3*o-3*s)*r+s*i)/6}function Kc(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],s=r>0?t[r-1]:2*i-o,a=r<e-1?t[r+2]:2*o-i;return as((n-r/e)*e,s,i,o,a)}}function Qc(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],o=t[r%e],s=t[(r+1)%e],a=t[(r+2)%e];return as((n-r/e)*e,i,o,s,a)}}function Xn(t){return function(){return t}}function pg(t,e){return function(n){return t+n*e}}function mg(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function Zc(t){return(t=+t)==1?vi:function(e,n){return n-e?mg(e,n,t):Xn(isNaN(e)?n:e)}}function vi(t,e){var n=e-t;return n?pg(t,n):Xn(isNaN(t)?e:t)}var Re=function t(e){var n=Zc(e);function r(i,o){var s=n((i=$t(i)).r,(o=$t(o)).r),a=n(i.g,o.g),u=n(i.b,o.b),c=vi(i.opacity,o.opacity);return function(l){return i.r=s(l),i.g=a(l),i.b=u(l),i.opacity=c(l),i+""}}return r.gamma=t,r}(1);function Jc(t){return function(e){var n=e.length,r=new Array(n),i=new Array(n),o=new Array(n),s,a;for(s=0;s<n;++s)a=$t(e[s]),r[s]=a.r||0,i[s]=a.g||0,o[s]=a.b||0;return r=t(r),i=t(i),o=t(o),a.opacity=1,function(u){return a.r=r(u),a.g=i(u),a.b=o(u),a+""}}}var gg=Jc(Kc),xg=Jc(Qc);function tl(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=t[i]*(1-o)+e[i]*o;return r}}function el(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function nl(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),o=new Array(n),s;for(s=0;s<r;++s)i[s]=ee(t[s],e[s]);for(;s<n;++s)o[s]=e[s];return function(a){for(s=0;s<r;++s)o[s]=i[s](a);return o}}function rl(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function ct(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function il(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=ee(t[i],e[i]):r[i]=e[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var cs=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,us=new RegExp(cs.source,"g");function vg(t){return function(){return t}}function yg(t){return function(e){return t(e)+""}}function jn(t,e){var n=cs.lastIndex=us.lastIndex=0,r,i,o,s=-1,a=[],u=[];for(t=t+"",e=e+"";(r=cs.exec(t))&&(i=us.exec(e));)(o=i.index)>n&&(o=e.slice(n,o),a[s]?a[s]+=o:a[++s]=o),(r=r[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,u.push({i:s,x:ct(r,i)})),n=us.lastIndex;return n<e.length&&(o=e.slice(n),a[s]?a[s]+=o:a[++s]=o),a.length<2?u[0]?yg(u[0].x):vg(e):(e=u.length,function(c){for(var l=0,f;l<e;++l)a[(f=u[l]).i]=f.x(c);return a.join("")})}function ee(t,e){var n=typeof e,r;return e==null||n==="boolean"?Xn(e):(n==="number"?ct:n==="string"?(r=Ht(e))?(e=r,Re):jn:e instanceof Ht?Re:e instanceof Date?rl:el(e)?tl:Array.isArray(e)?nl:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?il:ct)(t,e)}function ls(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var ol=180/Math.PI,yi={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function fs(t,e,n,r,i,o){var s,a,u;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(u=t*n+e*r)&&(n-=t*u,r-=e*u),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,u/=a),t*r<e*n&&(t=-t,e=-e,u=-u,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*ol,skewX:Math.atan(u)*ol,scaleX:s,scaleY:a}}var Kn,hs,sl,bi;function al(t){return t==="none"?yi:(Kn||(Kn=document.createElement("DIV"),hs=document.documentElement,sl=document.defaultView),Kn.style.transform=t,t=sl.getComputedStyle(hs.appendChild(Kn),null).getPropertyValue("transform"),hs.removeChild(Kn),t=t.slice(7,-1).split(","),fs(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}function ul(t){return t==null?yi:(bi||(bi=document.createElementNS("http://www.w3.org/2000/svg","g")),bi.setAttribute("transform",t),(t=bi.transform.baseVal.consolidate())?(t=t.matrix,fs(t.a,t.b,t.c,t.d,t.e,t.f)):yi)}function cl(t,e,n,r){function i(c){return c.length?c.pop()+" ":""}function o(c,l,f,h,d,g){if(c!==f||l!==h){var m=d.push("translate(",null,e,null,n);g.push({i:m-4,x:ct(c,f)},{i:m-2,x:ct(l,h)})}else(f||h)&&d.push("translate("+f+e+h+n)}function s(c,l,f,h){c!==l?(c-l>180?l+=360:l-c>180&&(c+=360),h.push({i:f.push(i(f)+"rotate(",null,r)-2,x:ct(c,l)})):l&&f.push(i(f)+"rotate("+l+r)}function a(c,l,f,h){c!==l?h.push({i:f.push(i(f)+"skewX(",null,r)-2,x:ct(c,l)}):l&&f.push(i(f)+"skewX("+l+r)}function u(c,l,f,h,d,g){if(c!==f||l!==h){var m=d.push(i(d)+"scale(",null,",",null,")");g.push({i:m-4,x:ct(c,f)},{i:m-2,x:ct(l,h)})}else(f!==1||h!==1)&&d.push(i(d)+"scale("+f+","+h+")")}return function(c,l){var f=[],h=[];return c=t(c),l=t(l),o(c.translateX,c.translateY,l.translateX,l.translateY,f,h),s(c.rotate,l.rotate,f,h),a(c.skewX,l.skewX,f,h),u(c.scaleX,c.scaleY,l.scaleX,l.scaleY,f,h),c=l=null,function(d){for(var g=-1,m=h.length,p;++g<m;)f[(p=h[g]).i]=p.x(d);return f.join("")}}}var ds=cl(al,"px, ","px)","deg)"),ps=cl(ul,", ",")",")");var cn=0,Zn=0,Qn=0,fl=1e3,wi,Jn,_i=0,Pe=0,Si=0,tr=typeof performance=="object"&&performance.now?performance:Date,hl=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function ln(){return Pe||(hl(bg),Pe=tr.now()+Si)}function bg(){Pe=0}function er(){this._call=this._time=this._next=null}er.prototype=Ci.prototype={constructor:er,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?ln():+n)+(e==null?0:+e),!this._next&&Jn!==this&&(Jn?Jn._next=this:wi=this,Jn=this),this._call=t,this._time=n,ms()},stop:function(){this._call&&(this._call=null,this._time=1/0,ms())}};function Ci(t,e,n){var r=new er;return r.restart(t,e,n),r}function dl(){ln(),++cn;for(var t=wi,e;t;)(e=Pe-t._time)>=0&&t._call.call(null,e),t=t._next;--cn}function ll(){Pe=(_i=tr.now())+Si,cn=Zn=0;try{dl()}finally{cn=0,_g(),Pe=0}}function wg(){var t=tr.now(),e=t-_i;e>fl&&(Si-=e,_i=t)}function _g(){for(var t,e=wi,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:wi=n);Jn=t,ms(r)}function ms(t){if(!cn){Zn&&(Zn=clearTimeout(Zn));var e=t-Pe;e>24?(t<1/0&&(Zn=setTimeout(ll,t-tr.now()-Si)),Qn&&(Qn=clearInterval(Qn))):(Qn||(_i=tr.now(),Qn=setInterval(wg,fl)),cn=1,hl(ll))}}function Ai(t,e,n){var r=new er;return e=e==null?0:+e,r.restart(function(i){r.stop(),t(i+e)},e,n),r}var Sg=zn("start","end","cancel","interrupt"),Cg=[],ml=0,gs=1,Mi=2,Ei=3,pl=4,Ti=5,nr=6;function me(t,e,n,r,i,o){var s=t.__transition;if(!s)t.__transition={};else if(n in s)return;Ag(t,n,{name:e,index:r,group:i,on:Sg,tween:Cg,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:ml})}function rr(t,e){var n=it(t,e);if(n.state>ml)throw new Error("too late; already scheduled");return n}function wt(t,e){var n=it(t,e);if(n.state>Ei)throw new Error("too late; already running");return n}function it(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Ag(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=Ci(o,0,n.time);function o(c){n.state=gs,n.timer.restart(s,n.delay,n.time),n.delay<=c&&s(c-n.delay)}function s(c){var l,f,h,d;if(n.state!==gs)return u();for(l in r)if(d=r[l],d.name===n.name){if(d.state===Ei)return Ai(s);d.state===pl?(d.state=nr,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete r[l]):+l<e&&(d.state=nr,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete r[l])}if(Ai(function(){n.state===Ei&&(n.state=pl,n.timer.restart(a,n.delay,n.time),a(c))}),n.state=Mi,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Mi){for(n.state=Ei,i=new Array(h=n.tween.length),l=0,f=-1;l<h;++l)(d=n.tween[l].value.call(t,t.__data__,n.index,n.group))&&(i[++f]=d);i.length=f+1}}function a(c){for(var l=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(u),n.state=Ti,1),f=-1,h=i.length;++f<h;)i[f].call(t,l);n.state===Ti&&(n.on.call("end",t,t.__data__,n.index,n.group),u())}function u(){n.state=nr,n.timer.stop(),delete r[e];for(var c in r)return;delete t.__transition}}function Ne(t,e){var n=t.__transition,r,i,o=!0,s;if(n){e=e==null?null:e+"";for(s in n){if((r=n[s]).name!==e){o=!1;continue}i=r.state>Mi&&r.state<Ti,r.state=nr,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[s]}o&&delete t.__transition}}function gl(t){return this.each(function(){Ne(this,t)})}function Eg(t,e){var n,r;return function(){var i=wt(this,t),o=i.tween;if(o!==n){r=n=o;for(var s=0,a=r.length;s<a;++s)if(r[s].name===e){r=r.slice(),r.splice(s,1);break}}i.tween=r}}function Mg(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var o=wt(this,t),s=o.tween;if(s!==r){i=(r=s).slice();for(var a={name:e,value:n},u=0,c=i.length;u<c;++u)if(i[u].name===e){i[u]=a;break}u===c&&i.push(a)}o.tween=i}}function xl(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=it(this.node(),n).tween,i=0,o=r.length,s;i<o;++i)if((s=r[i]).name===t)return s.value;return null}return this.each((e==null?Eg:Mg)(n,t,e))}function fn(t,e,n){var r=t._id;return t.each(function(){var i=wt(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return it(i,r).value[e]}}function Di(t,e){var n;return(typeof e=="number"?ct:e instanceof Ht?Re:(n=Ht(e))?(e=n,Re):jn)(t,e)}function Tg(t){return function(){this.removeAttribute(t)}}function Dg(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ig(t,e,n){var r,i=n+"",o;return function(){var s=this.getAttribute(t);return s===i?null:s===r?o:o=e(r=s,n)}}function kg(t,e,n){var r,i=n+"",o;return function(){var s=this.getAttributeNS(t.space,t.local);return s===i?null:s===r?o:o=e(r=s,n)}}function Lg(t,e,n){var r,i,o;return function(){var s,a=n(this),u;return a==null?void this.removeAttribute(t):(s=this.getAttribute(t),u=a+"",s===u?null:s===r&&u===i?o:(i=u,o=e(r=s,a)))}}function Rg(t,e,n){var r,i,o;return function(){var s,a=n(this),u;return a==null?void this.removeAttributeNS(t.space,t.local):(s=this.getAttributeNS(t.space,t.local),u=a+"",s===u?null:s===r&&u===i?o:(i=u,o=e(r=s,a)))}}function vl(t,e){var n=te(t),r=n==="transform"?ps:Di;return this.attrTween(t,typeof e=="function"?(n.local?Rg:Lg)(n,r,fn(this,"attr."+t,e)):e==null?(n.local?Dg:Tg)(n):(n.local?kg:Ig)(n,r,e))}function Pg(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Ng(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Og(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&Ng(t,o)),n}return i._value=e,i}function Fg(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&Pg(t,o)),n}return i._value=e,i}function yl(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=te(t);return this.tween(n,(r.local?Og:Fg)(r,e))}function Bg(t,e){return function(){rr(this,t).delay=+e.apply(this,arguments)}}function zg(t,e){return e=+e,function(){rr(this,t).delay=e}}function bl(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Bg:zg)(e,t)):it(this.node(),e).delay}function Hg(t,e){return function(){wt(this,t).duration=+e.apply(this,arguments)}}function $g(t,e){return e=+e,function(){wt(this,t).duration=e}}function wl(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Hg:$g)(e,t)):it(this.node(),e).duration}function Vg(t,e){if(typeof e!="function")throw new Error;return function(){wt(this,t).ease=e}}function _l(t){var e=this._id;return arguments.length?this.each(Vg(e,t)):it(this.node(),e).ease}function Sl(t){typeof t!="function"&&(t=$n(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],s=o.length,a=r[i]=[],u,c=0;c<s;++c)(u=o[c])&&t.call(u,u.__data__,c,o)&&a.push(u);return new mt(r,this._parents,this._name,this._id)}function Cl(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),s=new Array(r),a=0;a<o;++a)for(var u=e[a],c=n[a],l=u.length,f=s[a]=new Array(l),h,d=0;d<l;++d)(h=u[d]||c[d])&&(f[d]=h);for(;a<r;++a)s[a]=e[a];return new mt(s,this._parents,this._name,this._id)}function Ug(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Yg(t,e,n){var r,i,o=Ug(e)?rr:wt;return function(){var s=o(this,t),a=s.on;a!==r&&(i=(r=a).copy()).on(e,n),s.on=i}}function Al(t,e){var n=this._id;return arguments.length<2?it(this.node(),n).on.on(t):this.each(Yg(n,t,e))}function qg(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function El(){return this.on("end.remove",qg(this._id))}function Ml(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Ie(t));for(var r=this._groups,i=r.length,o=new Array(i),s=0;s<i;++s)for(var a=r[s],u=a.length,c=o[s]=new Array(u),l,f,h=0;h<u;++h)(l=a[h])&&(f=t.call(l,l.__data__,h,a))&&("__data__"in l&&(f.__data__=l.__data__),c[h]=f,me(c[h],e,n,h,c,it(l,n)));return new mt(o,this._parents,e,n)}function Tl(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Hn(t));for(var r=this._groups,i=r.length,o=[],s=[],a=0;a<i;++a)for(var u=r[a],c=u.length,l,f=0;f<c;++f)if(l=u[f]){for(var h=t.call(l,l.__data__,f,u),d,g=it(l,n),m=0,p=h.length;m<p;++m)(d=h[m])&&me(d,e,n,m,h,g);o.push(h),s.push(l)}return new mt(o,s,e,n)}var Gg=Et.prototype.constructor;function Dl(){return new Gg(this._groups,this._parents)}function Wg(t,e){var n,r,i;return function(){var o=pe(this,t),s=(this.style.removeProperty(t),pe(this,t));return o===s?null:o===n&&s===r?i:i=e(n=o,r=s)}}function Il(t){return function(){this.style.removeProperty(t)}}function Xg(t,e,n){var r,i=n+"",o;return function(){var s=pe(this,t);return s===i?null:s===r?o:o=e(r=s,n)}}function jg(t,e,n){var r,i,o;return function(){var s=pe(this,t),a=n(this),u=a+"";return a==null&&(u=a=(this.style.removeProperty(t),pe(this,t))),s===u?null:s===r&&u===i?o:(i=u,o=e(r=s,a))}}function Kg(t,e){var n,r,i,o="style."+e,s="end."+o,a;return function(){var u=wt(this,t),c=u.on,l=u.value[o]==null?a||(a=Il(e)):void 0;(c!==n||i!==l)&&(r=(n=c).copy()).on(s,i=l),u.on=r}}function kl(t,e,n){var r=(t+="")=="transform"?ds:Di;return e==null?this.styleTween(t,Wg(t,r)).on("end.style."+t,Il(t)):typeof e=="function"?this.styleTween(t,jg(t,r,fn(this,"style."+t,e))).each(Kg(this._id,t)):this.styleTween(t,Xg(t,r,e),n).on("end.style."+t,null)}function Qg(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function Zg(t,e,n){var r,i;function o(){var s=e.apply(this,arguments);return s!==i&&(r=(i=s)&&Qg(t,s,n)),r}return o._value=e,o}function Ll(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,Zg(t,e,n??""))}function Jg(t){return function(){this.textContent=t}}function t0(t){return function(){var e=t(this);this.textContent=e??""}}function Rl(t){return this.tween("text",typeof t=="function"?t0(fn(this,"text",t)):Jg(t==null?"":t+""))}function e0(t){return function(e){this.textContent=t.call(this,e)}}function n0(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&e0(i)),e}return r._value=t,r}function Pl(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,n0(t))}function Nl(){for(var t=this._name,e=this._id,n=Ii(),r=this._groups,i=r.length,o=0;o<i;++o)for(var s=r[o],a=s.length,u,c=0;c<a;++c)if(u=s[c]){var l=it(u,e);me(u,t,n,c,s,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new mt(r,this._parents,t,n)}function Ol(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(o,s){var a={value:s},u={value:function(){--i===0&&o()}};n.each(function(){var c=wt(this,r),l=c.on;l!==t&&(e=(t=l).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(u)),c.on=e})})}var r0=0;function mt(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function dn(t){return Et().transition(t)}function Ii(){return++r0}var hn=Et.prototype;mt.prototype=dn.prototype={constructor:mt,select:Ml,selectAll:Tl,filter:Sl,merge:Cl,selection:Dl,transition:Nl,call:hn.call,nodes:hn.nodes,node:hn.node,size:hn.size,empty:hn.empty,each:hn.each,on:Al,attr:vl,attrTween:yl,style:kl,styleTween:Ll,text:Rl,textTween:Pl,remove:El,tween:xl,delay:bl,duration:wl,ease:_l,end:Ol};function ki(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var xs={time:null,delay:0,duration:250,ease:ki};function i0(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return xs.time=ln(),xs;return n}function Fl(t){var e,n;t instanceof mt?(e=t._id,t=t._name):(e=Ii(),(n=xs).time=ln(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var s=r[o],a=s.length,u,c=0;c<a;++c)(u=s[c])&&me(u,t,e,c,s,n||i0(u,e));return new mt(r,this._parents,t,e)}Et.prototype.interrupt=gl;Et.prototype.transition=Fl;function Li(t){return function(){return t}}function Bl(t,e,n){this.target=t,this.type=e,this.selection=n}function vs(){k.stopImmediatePropagation()}function Ri(){k.preventDefault(),k.stopImmediatePropagation()}var zl={name:"drag"},ys={name:"space"},pn={name:"handle"},mn={name:"center"};function Hl(t){return[+t[0],+t[1]]}function _s(t){return[Hl(t[0]),Hl(t[1])]}function o0(t){return function(e){return ns(e,k.touches,t)}}var Pi={name:"x",handles:["w","e"].map(ir),input:function(t,e){return t==null?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},bs={name:"y",handles:["n","s"].map(ir),input:function(t,e){return t==null?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},RM={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(ir),input:function(t){return t==null?null:_s(t)},output:function(t){return t}},ne={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},$l={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},Vl={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},s0={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},a0={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function ir(t){return{type:t}}function u0(){return!k.ctrlKey&&!k.button}function c0(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function l0(){return navigator.maxTouchPoints||"ontouchstart"in this}function ws(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function f0(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function Ni(){return h0(Pi)}function h0(t){var e=c0,n=u0,r=l0,i=!0,o=zn("start","brush","end"),s=6,a;function u(p){var v=p.property("__brush",m).selectAll(".overlay").data([ir("overlay")]);v.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",ne.overlay).merge(v).each(function(){var x=ws(this).extent;O(this).attr("x",x[0][0]).attr("y",x[0][1]).attr("width",x[1][0]-x[0][0]).attr("height",x[1][1]-x[0][1])}),p.selectAll(".selection").data([ir("selection")]).enter().append("rect").attr("class","selection").attr("cursor",ne.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var y=p.selectAll(".handle").data(t.handles,function(x){return x.type});y.exit().remove(),y.enter().append("rect").attr("class",function(x){return"handle handle--"+x.type}).attr("cursor",function(x){return ne[x.type]}),p.each(c).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",h).filter(r).on("touchstart.brush",h).on("touchmove.brush",d).on("touchend.brush touchcancel.brush",g).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}u.move=function(p,v){p.selection?p.on("start.brush",function(){l(this,arguments).beforestart().start()}).on("interrupt.brush end.brush",function(){l(this,arguments).end()}).tween("brush",function(){var y=this,x=y.__brush,_=l(y,arguments),T=x.selection,D=t.input(typeof v=="function"?v.apply(this,arguments):v,x.extent),S=ee(T,D);function R(M){x.selection=M===1&&D===null?null:S(M),c.call(y),_.brush()}return T!==null&&D!==null?R:R(1)}):p.each(function(){var y=this,x=arguments,_=y.__brush,T=t.input(typeof v=="function"?v.apply(y,x):v,_.extent),D=l(y,x).beforestart();Ne(y),_.selection=T===null?null:T,c.call(y),D.start().brush().end()})},u.clear=function(p){u.move(p,null)};function c(){var p=O(this),v=ws(this).selection;v?(p.selectAll(".selection").style("display",null).attr("x",v[0][0]).attr("y",v[0][1]).attr("width",v[1][0]-v[0][0]).attr("height",v[1][1]-v[0][1]),p.selectAll(".handle").style("display",null).attr("x",function(y){return y.type[y.type.length-1]==="e"?v[1][0]-s/2:v[0][0]-s/2}).attr("y",function(y){return y.type[0]==="s"?v[1][1]-s/2:v[0][1]-s/2}).attr("width",function(y){return y.type==="n"||y.type==="s"?v[1][0]-v[0][0]+s:s}).attr("height",function(y){return y.type==="e"||y.type==="w"?v[1][1]-v[0][1]+s:s})):p.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function l(p,v,y){var x=p.__brush.emitter;return x&&(!y||!x.clean)?x:new f(p,v,y)}function f(p,v,y){this.that=p,this.args=v,this.state=p.__brush,this.active=0,this.clean=y}f.prototype={beforestart:function(){return++this.active===1&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting?(this.starting=!1,this.emit("start")):this.emit("brush"),this},brush:function(){return this.emit("brush"),this},end:function(){return--this.active===0&&(delete this.state.emitter,this.emit("end")),this},emit:function(p){Jo(new Bl(u,p,t.output(this.state.selection)),o.apply,o,[p,this.that,this.args])}};function h(){if(a&&!k.touches||!n.apply(this,arguments))return;var p=this,v=k.target.__data__.type,y=(i&&k.metaKey?v="overlay":v)==="selection"?zl:i&&k.altKey?mn:pn,x=t===bs?null:s0[v],_=t===Pi?null:a0[v],T=ws(p),D=T.extent,S=T.selection,R=D[0][0],M,L,C=D[0][1],w,A,J=D[1][0],U,Y,nt=D[1][1],q,B,K=0,Q=0,Qt,qt=x&&_&&i&&k.shiftKey,lt,Gt,ce=k.touches?o0(k.changedTouches[0].identifier):Yn,Lt=ce(p),Rt=Lt,E=l(p,arguments,!0).beforestart();v==="overlay"?(S&&(Qt=!0),T.selection=S=[[M=t===bs?R:Lt[0],w=t===Pi?C:Lt[1]],[U=t===bs?J:M,q=t===Pi?nt:w]]):(M=S[0][0],w=S[0][1],U=S[1][0],q=S[1][1]),L=M,A=w,Y=U,B=q;var P=O(p).attr("pointer-events","none"),N=P.selectAll(".overlay").attr("cursor",ne[v]);if(k.touches)E.moved=at,E.ended=ft;else{var b=O(k.view).on("mousemove.brush",at,!0).on("mouseup.brush",ft,!0);i&&b.on("keydown.brush",vt,!0).on("keyup.brush",Zt,!0),rs(k.view)}vs(),Ne(p),c.call(p),E.start();function at(){var yt=ce(p);qt&&!lt&&!Gt&&(Math.abs(yt[0]-Rt[0])>Math.abs(yt[1]-Rt[1])?Gt=!0:lt=!0),Rt=yt,Qt=!0,Ri(),z()}function z(){var yt;switch(K=Rt[0]-Lt[0],Q=Rt[1]-Lt[1],y){case ys:case zl:{x&&(K=Math.max(R-M,Math.min(J-U,K)),L=M+K,Y=U+K),_&&(Q=Math.max(C-w,Math.min(nt-q,Q)),A=w+Q,B=q+Q);break}case pn:{x<0?(K=Math.max(R-M,Math.min(J-M,K)),L=M+K,Y=U):x>0&&(K=Math.max(R-U,Math.min(J-U,K)),L=M,Y=U+K),_<0?(Q=Math.max(C-w,Math.min(nt-w,Q)),A=w+Q,B=q):_>0&&(Q=Math.max(C-q,Math.min(nt-q,Q)),A=w,B=q+Q);break}case mn:{x&&(L=Math.max(R,Math.min(J,M-K*x)),Y=Math.max(R,Math.min(J,U+K*x))),_&&(A=Math.max(C,Math.min(nt,w-Q*_)),B=Math.max(C,Math.min(nt,q+Q*_)));break}}Y<L&&(x*=-1,yt=M,M=U,U=yt,yt=L,L=Y,Y=yt,v in $l&&N.attr("cursor",ne[v=$l[v]])),B<A&&(_*=-1,yt=w,w=q,q=yt,yt=A,A=B,B=yt,v in Vl&&N.attr("cursor",ne[v=Vl[v]])),T.selection&&(S=T.selection),lt&&(L=S[0][0],Y=S[1][0]),Gt&&(A=S[0][1],B=S[1][1]),(S[0][0]!==L||S[0][1]!==A||S[1][0]!==Y||S[1][1]!==B)&&(T.selection=[[L,A],[Y,B]],c.call(p),E.brush())}function ft(){if(vs(),k.touches){if(k.touches.length)return;a&&clearTimeout(a),a=setTimeout(function(){a=null},500)}else is(k.view,Qt),b.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);P.attr("pointer-events","all"),N.attr("cursor",ne.overlay),T.selection&&(S=T.selection),f0(S)&&(T.selection=null,c.call(p)),E.end()}function vt(){switch(k.keyCode){case 16:{qt=x&&_;break}case 18:{y===pn&&(x&&(U=Y-K*x,M=L+K*x),_&&(q=B-Q*_,w=A+Q*_),y=mn,z());break}case 32:{(y===pn||y===mn)&&(x<0?U=Y-K:x>0&&(M=L-K),_<0?q=B-Q:_>0&&(w=A-Q),y=ys,N.attr("cursor",ne.selection),z());break}default:return}Ri()}function Zt(){switch(k.keyCode){case 16:{qt&&(lt=Gt=qt=!1,z());break}case 18:{y===mn&&(x<0?U=Y:x>0&&(M=L),_<0?q=B:_>0&&(w=A),y=pn,z());break}case 32:{y===ys&&(k.altKey?(x&&(U=Y-K*x,M=L+K*x),_&&(q=B-Q*_,w=A+Q*_),y=mn):(x<0?U=Y:x>0&&(M=L),_<0?q=B:_>0&&(w=A),y=pn),N.attr("cursor",ne[v]),z());break}default:return}Ri()}}function d(){l(this,arguments).moved()}function g(){l(this,arguments).ended()}function m(){var p=this.__brush||{selection:null};return p.extent=_s(e.apply(this,arguments)),p.dim=t,p}return u.extent=function(p){return arguments.length?(e=typeof p=="function"?p:Li(_s(p)),u):e},u.filter=function(p){return arguments.length?(n=typeof p=="function"?p:Li(!!p),u):n},u.touchable=function(p){return arguments.length?(r=typeof p=="function"?p:Li(!!p),u):r},u.handleSize=function(p){return arguments.length?(s=+p,u):s},u.keyModifiers=function(p){return arguments.length?(i=!!p,u):i},u.on=function(){var p=o.on.apply(o,arguments);return p===o?u:p},u}var Ul=Math.PI,d0=Ul/2,p0=Ul*2;var m0=Array.prototype.slice;var Mt="$";function Oi(){}Oi.prototype=Yl.prototype={constructor:Oi,has:function(t){return Mt+t in this},get:function(t){return this[Mt+t]},set:function(t,e){return this[Mt+t]=e,this},remove:function(t){var e=Mt+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===Mt&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===Mt&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===Mt&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===Mt&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===Mt&&++t;return t},empty:function(){for(var t in this)if(t[0]===Mt)return!1;return!0},each:function(t){for(var e in this)e[0]===Mt&&t(this[e],e.slice(1),this)}};function Yl(t,e){var n=new Oi;if(t instanceof Oi)t.each(function(a,u){n.set(u,a)});else if(Array.isArray(t)){var r=-1,i=t.length,o;if(e==null)for(;++r<i;)n.set(r,t[r]);else for(;++r<i;)n.set(e(o=t[r],r,t),o)}else if(t)for(var s in t)n.set(s,t[s]);return n}var re=Yl;function Fi(){}var Oe=re.prototype;Fi.prototype=g0.prototype={constructor:Fi,has:Oe.has,add:function(t){return t+="",this[Mt+t]=t,this},remove:Oe.remove,clear:Oe.clear,values:Oe.keys,size:Oe.size,empty:Oe.empty,each:Oe.each};function g0(t,e){var n=new Fi;if(t instanceof Fi)t.each(function(o){n.add(o)});else if(t){var r=-1,i=t.length;if(e==null)for(;++r<i;)n.add(t[r]);else for(;++r<i;)n.add(e(t[r],r,t))}return n}var x0=Array.prototype,ql=x0.slice;var dD=Math.PI*(3-Math.sqrt(5));function Wl(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Fe(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Kt(t){return t=Fe(Math.abs(t)),t?t[1]:NaN}function Xl(t,e){return function(n,r){for(var i=n.length,o=[],s=0,a=t[0],u=0;i>0&&a>0&&(u+a+1>r&&(a=Math.max(1,r-u)),o.push(n.substring(i-=a,i+a)),!((u+=a+1)>r));)a=t[s=(s+1)%t.length];return o.reverse().join(e)}}function jl(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var _0=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ge(t){if(!(e=_0.exec(t)))throw new Error("invalid format: "+t);var e;return new Bi({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}ge.prototype=Bi.prototype;function Bi(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Bi.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Kl(t){t:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var Ss;function Ql(t,e){var n=Fe(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(Ss=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=r.length;return o===s?r:o>s?r+new Array(o-s+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Fe(t,Math.max(0,e+o-1))[0]}function Cs(t,e){var n=Fe(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var As={"%":function(t,e){return(t*100).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:Wl,e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return Cs(t*100,e)},r:Cs,s:Ql,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function Es(t){return t}var Zl=Array.prototype.map,Jl=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function tf(t){var e=t.grouping===void 0||t.thousands===void 0?Es:Xl(Zl.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?Es:jl(Zl.call(t.numerals,String)),s=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"-":t.minus+"",u=t.nan===void 0?"NaN":t.nan+"";function c(f){f=ge(f);var h=f.fill,d=f.align,g=f.sign,m=f.symbol,p=f.zero,v=f.width,y=f.comma,x=f.precision,_=f.trim,T=f.type;T==="n"?(y=!0,T="g"):As[T]||(x===void 0&&(x=12),_=!0,T="g"),(p||h==="0"&&d==="=")&&(p=!0,h="0",d="=");var D=m==="$"?n:m==="#"&&/[boxX]/.test(T)?"0"+T.toLowerCase():"",S=m==="$"?r:/[%p]/.test(T)?s:"",R=As[T],M=/[defgprs%]/.test(T);x=x===void 0?6:/[gprs]/.test(T)?Math.max(1,Math.min(21,x)):Math.max(0,Math.min(20,x));function L(C){var w=D,A=S,J,U,Y;if(T==="c")A=R(C)+A,C="";else{C=+C;var nt=C<0||1/C<0;if(C=isNaN(C)?u:R(Math.abs(C),x),_&&(C=Kl(C)),nt&&+C==0&&g!=="+"&&(nt=!1),w=(nt?g==="("?g:a:g==="-"||g==="("?"":g)+w,A=(T==="s"?Jl[8+Ss/3]:"")+A+(nt&&g==="("?")":""),M){for(J=-1,U=C.length;++J<U;)if(Y=C.charCodeAt(J),48>Y||Y>57){A=(Y===46?i+C.slice(J+1):C.slice(J))+A,C=C.slice(0,J);break}}}y&&!p&&(C=e(C,1/0));var q=w.length+C.length+A.length,B=q<v?new Array(v-q+1).join(h):"";switch(y&&p&&(C=e(B+C,B.length?v-A.length:1/0),B=""),d){case"<":C=w+C+A+B;break;case"=":C=w+B+C+A;break;case"^":C=B.slice(0,q=B.length>>1)+w+C+A+B.slice(q);break;default:C=B+w+C+A;break}return o(C)}return L.toString=function(){return f+""},L}function l(f,h){var d=c((f=ge(f),f.type="f",f)),g=Math.max(-8,Math.min(8,Math.floor(Kt(h)/3)))*3,m=Math.pow(10,-g),p=Jl[8+g/3];return function(v){return d(m*v)+p}}return{format:c,formatPrefix:l}}var zi,Hi,$i;Ms({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function Ms(t){return zi=tf(t),Hi=zi.format,$i=zi.formatPrefix,zi}function Ts(t){return Math.max(0,-Kt(Math.abs(t)))}function Ds(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Kt(e)/3)))*3-Kt(Math.abs(t)))}function Is(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Kt(e)-Kt(t))+1}function kt(){return Math.random()}var S0=function t(e){function n(r,i){return r=r==null?0:+r,i=i==null?1:+i,arguments.length===1?(i=r,r=0):i-=r,function(){return e()*i+r}}return n.source=t,n}(kt);var ks=function t(e){function n(r,i){var o,s;return r=r==null?0:+r,i=i==null?1:+i,function(){var a;if(o!=null)a=o,o=null;else do o=e()*2-1,a=e()*2-1,s=o*o+a*a;while(!s||s>1);return r+i*a*Math.sqrt(-2*Math.log(s)/s)}}return n.source=t,n}(kt);var C0=function t(e){function n(){var r=ks.source(e).apply(this,arguments);return function(){return Math.exp(r())}}return n.source=t,n}(kt);var Ls=function t(e){function n(r){return function(){for(var i=0,o=0;o<r;++o)i+=e();return i}}return n.source=t,n}(kt);var A0=function t(e){function n(r){var i=Ls.source(e)(r);return function(){return i()/r}}return n.source=t,n}(kt);var E0=function t(e){function n(r){return function(){return-Math.log(1-e())/r}}return n.source=t,n}(kt);function _t(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}var ef=Array.prototype,sr=ef.map,xe=ef.slice;var Rs={name:"implicit"};function ar(){var t=re(),e=[],n=[],r=Rs;function i(o){var s=o+"",a=t.get(s);if(!a){if(r!==Rs)return r;t.set(s,a=e.push(o))}return n[(a-1)%n.length]}return i.domain=function(o){if(!arguments.length)return e.slice();e=[],t=re();for(var s=-1,a=o.length,u,c;++s<a;)t.has(c=(u=o[s])+"")||t.set(c,e.push(u));return i},i.range=function(o){return arguments.length?(n=xe.call(o),i):n.slice()},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return ar(e,n).unknown(r)},_t.apply(i,arguments),i}function Be(){var t=ar().unknown(void 0),e=t.domain,n=t.range,r=[0,1],i,o,s=!1,a=0,u=0,c=.5;delete t.unknown;function l(){var f=e().length,h=r[1]<r[0],d=r[h-0],g=r[1-h];i=(g-d)/Math.max(1,f-a+u*2),s&&(i=Math.floor(i)),d+=(g-d-i*(f-a))*c,o=i*(1-a),s&&(d=Math.round(d),o=Math.round(o));var m=De(f).map(function(p){return d+i*p});return n(h?m.reverse():m)}return t.domain=function(f){return arguments.length?(e(f),l()):e()},t.range=function(f){return arguments.length?(r=[+f[0],+f[1]],l()):r.slice()},t.rangeRound=function(f){return r=[+f[0],+f[1]],s=!0,l()},t.bandwidth=function(){return o},t.step=function(){return i},t.round=function(f){return arguments.length?(s=!!f,l()):s},t.padding=function(f){return arguments.length?(a=Math.min(1,u=+f),l()):a},t.paddingInner=function(f){return arguments.length?(a=Math.min(1,f),l()):a},t.paddingOuter=function(f){return arguments.length?(u=+f,l()):u},t.align=function(f){return arguments.length?(c=Math.max(0,Math.min(1,f)),l()):c},t.copy=function(){return Be(e(),r).round(s).paddingInner(a).paddingOuter(u).align(c)},_t.apply(l(),arguments)}function nf(t){return function(){return t}}function Ps(t){return+t}var rf=[0,1];function At(t){return t}function Ns(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:nf(isNaN(e)?NaN:.5)}function of(t){var e=t[0],n=t[t.length-1],r;return e>n&&(r=e,e=n,n=r),function(i){return Math.max(e,Math.min(n,i))}}function M0(t,e,n){var r=t[0],i=t[1],o=e[0],s=e[1];return i<r?(r=Ns(i,r),o=n(s,o)):(r=Ns(r,i),o=n(o,s)),function(a){return o(r(a))}}function T0(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),s=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<r;)i[s]=Ns(t[s],t[s+1]),o[s]=n(e[s],e[s+1]);return function(a){var u=Dt(t,a,1,r)-1;return o[u](i[u](a))}}function ze(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Vi(){var t=rf,e=rf,n=ee,r,i,o,s=At,a,u,c;function l(){return a=Math.min(t.length,e.length)>2?T0:M0,u=c=null,f}function f(h){return isNaN(h=+h)?o:(u||(u=a(t.map(r),e,n)))(r(s(h)))}return f.invert=function(h){return s(i((c||(c=a(e,t.map(r),ct)))(h)))},f.domain=function(h){return arguments.length?(t=sr.call(h,Ps),s===At||(s=of(t)),l()):t.slice()},f.range=function(h){return arguments.length?(e=xe.call(h),l()):e.slice()},f.rangeRound=function(h){return e=xe.call(h),n=ls,l()},f.clamp=function(h){return arguments.length?(s=h?of(t):At,f):s!==At},f.interpolate=function(h){return arguments.length?(n=h,l()):n},f.unknown=function(h){return arguments.length?(o=h,f):o},function(h,d){return r=h,i=d,l()}}function ur(t,e){return Vi()(t,e)}function Os(t,e,n,r){var i=Jt(t,e,n),o;switch(r=ge(r??",f"),r.type){case"s":{var s=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(o=Ds(i,s))&&(r.precision=o),$i(r,s)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=Is(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=Ts(i))&&(r.precision=o-(r.type==="%")*2);break}}return Hi(r)}function He(t){var e=t.domain;return t.ticks=function(n){var r=e();return Zr(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return Os(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,o=r.length-1,s=r[i],a=r[o],u;return a<s&&(u=s,s=a,a=u,u=i,i=o,o=u),u=an(s,a,n),u>0?(s=Math.floor(s/u)*u,a=Math.ceil(a/u)*u,u=an(s,a,n)):u<0&&(s=Math.ceil(s*u)/u,a=Math.floor(a*u)/u,u=an(s,a,n)),u>0?(r[i]=Math.floor(s/u)*u,r[o]=Math.ceil(a/u)*u,e(r)):u<0&&(r[i]=Math.ceil(s*u)/u,r[o]=Math.floor(a*u)/u,e(r)),t},t}function cr(){var t=ur(At,At);return t.copy=function(){return ze(t,cr())},_t.apply(t,arguments),He(t)}function Fs(t,e){t=t.slice();var n=0,r=t.length-1,i=t[n],o=t[r],s;return o<i&&(s=n,n=r,r=s,s=i,i=o,o=s),t[n]=e.floor(i),t[r]=e.ceil(o),t}var Bs=new Date,zs=new Date;function j(t,e,n,r){function i(o){return t(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=function(o){return t(o=new Date(+o)),o},i.ceil=function(o){return t(o=new Date(o-1)),e(o,1),t(o),o},i.round=function(o){var s=i(o),a=i.ceil(o);return o-s<a-o?s:a},i.offset=function(o,s){return e(o=new Date(+o),s==null?1:Math.floor(s)),o},i.range=function(o,s,a){var u=[],c;if(o=i.ceil(o),a=a==null?1:Math.floor(a),!(o<s)||!(a>0))return u;do u.push(c=new Date(+o)),e(o,a),t(o);while(c<o&&o<s);return u},i.filter=function(o){return j(function(s){if(s>=s)for(;t(s),!o(s);)s.setTime(s-1)},function(s,a){if(s>=s)if(a<0)for(;++a<=0;)for(;e(s,-1),!o(s););else for(;--a>=0;)for(;e(s,1),!o(s););})},n&&(i.count=function(o,s){return Bs.setTime(+o),zs.setTime(+s),t(Bs),t(zs),Math.floor(n(Bs,zs))},i.every=function(o){return o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?function(s){return r(s)%o===0}:function(s){return i.count(0,s)%o===0}):i}),i}var Ui=j(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});Ui.every=function(t){return t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?j(function(e){e.setTime(Math.floor(e/t)*t)},function(e,n){e.setTime(+e+n*t)},function(e,n){return(n-e)/t}):Ui};var Yi=Ui,sf=Ui.range;var $e=1e3,ie=6e4,Hs=36e5,qi=864e5,Gi=6048e5;var af=j(function(t){t.setTime(t-t.getMilliseconds())},function(t,e){t.setTime(+t+e*$e)},function(t,e){return(e-t)/$e},function(t){return t.getUTCSeconds()}),Wi=af,uf=af.range;var cf=j(function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*$e)},function(t,e){t.setTime(+t+e*ie)},function(t,e){return(e-t)/ie},function(t){return t.getMinutes()}),lr=cf,D0=cf.range;var lf=j(function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*$e-t.getMinutes()*ie)},function(t,e){t.setTime(+t+e*Hs)},function(t,e){return(e-t)/Hs},function(t){return t.getHours()}),$s=lf,I0=lf.range;var ff=j(function(t){t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*ie)/qi},function(t){return t.getDate()-1}),ve=ff,k0=ff.range;function Ve(t){return j(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(e,n){e.setDate(e.getDate()+n*7)},function(e,n){return(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*ie)/Gi})}var Ue=Ve(0),gn=Ve(1),hf=Ve(2),df=Ve(3),ye=Ve(4),pf=Ve(5),mf=Ve(6),gf=Ue.range,L0=gn.range,R0=hf.range,P0=df.range,N0=ye.range,O0=pf.range,F0=mf.range;var xf=j(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12},function(t){return t.getMonth()}),fr=xf,B0=xf.range;var Vs=j(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});Vs.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:j(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)})};var Vt=Vs,z0=Vs.range;var vf=j(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/qi},function(t){return t.getUTCDate()-1}),Xi=vf,H0=vf.range;function Ye(t){return j(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCDate(e.getUTCDate()+n*7)},function(e,n){return(n-e)/Gi})}var hr=Ye(0),xn=Ye(1),yf=Ye(2),bf=Ye(3),be=Ye(4),wf=Ye(5),_f=Ye(6),Sf=hr.range,$0=xn.range,V0=yf.range,U0=bf.range,Y0=be.range,q0=wf.range,G0=_f.range;var Us=j(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});Us.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:j(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})};var qe=Us,W0=Us.range;function Ys(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function qs(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function dr(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function Gs(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,s=t.shortDays,a=t.months,u=t.shortMonths,c=pr(i),l=mr(i),f=pr(o),h=mr(o),d=pr(s),g=mr(s),m=pr(a),p=mr(a),v=pr(u),y=mr(u),x={a:nt,A:q,b:B,B:K,c:null,d:Df,e:Df,f:gx,g:Ex,G:Tx,H:dx,I:px,j:mx,L:Pf,m:xx,M:vx,p:Q,q:Qt,Q:Lf,s:Rf,S:yx,u:bx,U:wx,V:_x,w:Sx,W:Cx,x:null,X:null,y:Ax,Y:Mx,Z:Dx,"%":kf},_={a:qt,A:lt,b:Gt,B:ce,c:null,d:If,e:If,f:Rx,g:Ux,G:qx,H:Ix,I:kx,j:Lx,L:Of,m:Px,M:Nx,p:Lt,q:Rt,Q:Lf,s:Rf,S:Ox,u:Fx,U:Bx,V:zx,w:Hx,W:$x,x:null,X:null,y:Vx,Y:Yx,Z:Gx,"%":kf},T={a:L,A:C,b:w,B:A,c:J,d:Mf,e:Mf,f:cx,g:Ef,G:Af,H:Tf,I:Tf,j:ox,L:ux,m:ix,M:sx,p:M,q:rx,Q:fx,s:hx,S:ax,u:Z0,U:J0,V:tx,w:Q0,W:ex,x:U,X:Y,y:Ef,Y:Af,Z:nx,"%":lx};x.x=D(n,x),x.X=D(r,x),x.c=D(e,x),_.x=D(n,_),_.X=D(r,_),_.c=D(e,_);function D(E,P){return function(N){var b=[],at=-1,z=0,ft=E.length,vt,Zt,yt;for(N instanceof Date||(N=new Date(+N));++at<ft;)E.charCodeAt(at)===37&&(b.push(E.slice(z,at)),(Zt=Cf[vt=E.charAt(++at)])!=null?vt=E.charAt(++at):Zt=vt==="e"?" ":"0",(yt=P[vt])&&(vt=yt(N,Zt)),b.push(vt),z=at+1);return b.push(E.slice(z,at)),b.join("")}}function S(E,P){return function(N){var b=dr(1900,void 0,1),at=R(b,E,N+="",0),z,ft;if(at!=N.length)return null;if("Q"in b)return new Date(b.Q);if("s"in b)return new Date(b.s*1e3+("L"in b?b.L:0));if(P&&!("Z"in b)&&(b.Z=0),"p"in b&&(b.H=b.H%12+b.p*12),b.m===void 0&&(b.m="q"in b?b.q:0),"V"in b){if(b.V<1||b.V>53)return null;"w"in b||(b.w=1),"Z"in b?(z=qs(dr(b.y,0,1)),ft=z.getUTCDay(),z=ft>4||ft===0?xn.ceil(z):xn(z),z=Xi.offset(z,(b.V-1)*7),b.y=z.getUTCFullYear(),b.m=z.getUTCMonth(),b.d=z.getUTCDate()+(b.w+6)%7):(z=Ys(dr(b.y,0,1)),ft=z.getDay(),z=ft>4||ft===0?gn.ceil(z):gn(z),z=ve.offset(z,(b.V-1)*7),b.y=z.getFullYear(),b.m=z.getMonth(),b.d=z.getDate()+(b.w+6)%7)}else("W"in b||"U"in b)&&("w"in b||(b.w="u"in b?b.u%7:"W"in b?1:0),ft="Z"in b?qs(dr(b.y,0,1)).getUTCDay():Ys(dr(b.y,0,1)).getDay(),b.m=0,b.d="W"in b?(b.w+6)%7+b.W*7-(ft+5)%7:b.w+b.U*7-(ft+6)%7);return"Z"in b?(b.H+=b.Z/100|0,b.M+=b.Z%100,qs(b)):Ys(b)}}function R(E,P,N,b){for(var at=0,z=P.length,ft=N.length,vt,Zt;at<z;){if(b>=ft)return-1;if(vt=P.charCodeAt(at++),vt===37){if(vt=P.charAt(at++),Zt=T[vt in Cf?P.charAt(at++):vt],!Zt||(b=Zt(E,N,b))<0)return-1}else if(vt!=N.charCodeAt(b++))return-1}return b}function M(E,P,N){var b=c.exec(P.slice(N));return b?(E.p=l[b[0].toLowerCase()],N+b[0].length):-1}function L(E,P,N){var b=d.exec(P.slice(N));return b?(E.w=g[b[0].toLowerCase()],N+b[0].length):-1}function C(E,P,N){var b=f.exec(P.slice(N));return b?(E.w=h[b[0].toLowerCase()],N+b[0].length):-1}function w(E,P,N){var b=v.exec(P.slice(N));return b?(E.m=y[b[0].toLowerCase()],N+b[0].length):-1}function A(E,P,N){var b=m.exec(P.slice(N));return b?(E.m=p[b[0].toLowerCase()],N+b[0].length):-1}function J(E,P,N){return R(E,e,P,N)}function U(E,P,N){return R(E,n,P,N)}function Y(E,P,N){return R(E,r,P,N)}function nt(E){return s[E.getDay()]}function q(E){return o[E.getDay()]}function B(E){return u[E.getMonth()]}function K(E){return a[E.getMonth()]}function Q(E){return i[+(E.getHours()>=12)]}function Qt(E){return 1+~~(E.getMonth()/3)}function qt(E){return s[E.getUTCDay()]}function lt(E){return o[E.getUTCDay()]}function Gt(E){return u[E.getUTCMonth()]}function ce(E){return a[E.getUTCMonth()]}function Lt(E){return i[+(E.getUTCHours()>=12)]}function Rt(E){return 1+~~(E.getUTCMonth()/3)}return{format:function(E){var P=D(E+="",x);return P.toString=function(){return E},P},parse:function(E){var P=S(E+="",!1);return P.toString=function(){return E},P},utcFormat:function(E){var P=D(E+="",_);return P.toString=function(){return E},P},utcParse:function(E){var P=S(E+="",!0);return P.toString=function(){return E},P}}}var Cf={"-":"",_:" ",0:"0"},ot=/^\s*\d+/,X0=/^%/,j0=/[\\^$*+?|[\]().{}]/g;function $(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function K0(t){return t.replace(j0,"\\$&")}function pr(t){return new RegExp("^(?:"+t.map(K0).join("|")+")","i")}function mr(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function Q0(t,e,n){var r=ot.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Z0(t,e,n){var r=ot.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function J0(t,e,n){var r=ot.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function tx(t,e,n){var r=ot.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function ex(t,e,n){var r=ot.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function Af(t,e,n){var r=ot.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Ef(t,e,n){var r=ot.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function nx(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function rx(t,e,n){var r=ot.exec(e.slice(n,n+1));return r?(t.q=r[0]*3-3,n+r[0].length):-1}function ix(t,e,n){var r=ot.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function Mf(t,e,n){var r=ot.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function ox(t,e,n){var r=ot.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function Tf(t,e,n){var r=ot.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function sx(t,e,n){var r=ot.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function ax(t,e,n){var r=ot.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function ux(t,e,n){var r=ot.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function cx(t,e,n){var r=ot.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function lx(t,e,n){var r=X0.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function fx(t,e,n){var r=ot.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function hx(t,e,n){var r=ot.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function Df(t,e){return $(t.getDate(),e,2)}function dx(t,e){return $(t.getHours(),e,2)}function px(t,e){return $(t.getHours()%12||12,e,2)}function mx(t,e){return $(1+ve.count(Vt(t),t),e,3)}function Pf(t,e){return $(t.getMilliseconds(),e,3)}function gx(t,e){return Pf(t,e)+"000"}function xx(t,e){return $(t.getMonth()+1,e,2)}function vx(t,e){return $(t.getMinutes(),e,2)}function yx(t,e){return $(t.getSeconds(),e,2)}function bx(t){var e=t.getDay();return e===0?7:e}function wx(t,e){return $(Ue.count(Vt(t)-1,t),e,2)}function Nf(t){var e=t.getDay();return e>=4||e===0?ye(t):ye.ceil(t)}function _x(t,e){return t=Nf(t),$(ye.count(Vt(t),t)+(Vt(t).getDay()===4),e,2)}function Sx(t){return t.getDay()}function Cx(t,e){return $(gn.count(Vt(t)-1,t),e,2)}function Ax(t,e){return $(t.getFullYear()%100,e,2)}function Ex(t,e){return t=Nf(t),$(t.getFullYear()%100,e,2)}function Mx(t,e){return $(t.getFullYear()%1e4,e,4)}function Tx(t,e){var n=t.getDay();return t=n>=4||n===0?ye(t):ye.ceil(t),$(t.getFullYear()%1e4,e,4)}function Dx(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+$(e/60|0,"0",2)+$(e%60,"0",2)}function If(t,e){return $(t.getUTCDate(),e,2)}function Ix(t,e){return $(t.getUTCHours(),e,2)}function kx(t,e){return $(t.getUTCHours()%12||12,e,2)}function Lx(t,e){return $(1+Xi.count(qe(t),t),e,3)}function Of(t,e){return $(t.getUTCMilliseconds(),e,3)}function Rx(t,e){return Of(t,e)+"000"}function Px(t,e){return $(t.getUTCMonth()+1,e,2)}function Nx(t,e){return $(t.getUTCMinutes(),e,2)}function Ox(t,e){return $(t.getUTCSeconds(),e,2)}function Fx(t){var e=t.getUTCDay();return e===0?7:e}function Bx(t,e){return $(hr.count(qe(t)-1,t),e,2)}function Ff(t){var e=t.getUTCDay();return e>=4||e===0?be(t):be.ceil(t)}function zx(t,e){return t=Ff(t),$(be.count(qe(t),t)+(qe(t).getUTCDay()===4),e,2)}function Hx(t){return t.getUTCDay()}function $x(t,e){return $(xn.count(qe(t)-1,t),e,2)}function Vx(t,e){return $(t.getUTCFullYear()%100,e,2)}function Ux(t,e){return t=Ff(t),$(t.getUTCFullYear()%100,e,2)}function Yx(t,e){return $(t.getUTCFullYear()%1e4,e,4)}function qx(t,e){var n=t.getUTCDay();return t=n>=4||n===0?be(t):be.ceil(t),$(t.getUTCFullYear()%1e4,e,4)}function Gx(){return"+0000"}function kf(){return"%"}function Lf(t){return+t}function Rf(t){return Math.floor(+t/1e3)}var vn,ji,Bf,zf,Hf;Ws({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Ws(t){return vn=Gs(t),ji=vn.format,Bf=vn.parse,zf=vn.utcFormat,Hf=vn.utcParse,vn}var gr=1e3,xr=gr*60,vr=xr*60,yr=vr*24,Wx=yr*7,$f=yr*30,Xs=yr*365;function Xx(t){return new Date(t)}function jx(t){return t instanceof Date?+t:+new Date(+t)}function js(t,e,n,r,i,o,s,a,u){var c=ur(At,At),l=c.invert,f=c.domain,h=u(".%L"),d=u(":%S"),g=u("%I:%M"),m=u("%I %p"),p=u("%a %d"),v=u("%b %d"),y=u("%B"),x=u("%Y"),_=[[s,1,gr],[s,5,5*gr],[s,15,15*gr],[s,30,30*gr],[o,1,xr],[o,5,5*xr],[o,15,15*xr],[o,30,30*xr],[i,1,vr],[i,3,3*vr],[i,6,6*vr],[i,12,12*vr],[r,1,yr],[r,2,2*yr],[n,1,Wx],[e,1,$f],[e,3,3*$f],[t,1,Xs]];function T(S){return(s(S)<S?h:o(S)<S?d:i(S)<S?g:r(S)<S?m:e(S)<S?n(S)<S?p:v:t(S)<S?y:x)(S)}function D(S,R,M,L){if(S==null&&(S=10),typeof S=="number"){var C=Math.abs(M-R)/S,w=Pn(function(A){return A[2]}).right(_,C);w===_.length?(L=Jt(R/Xs,M/Xs,S),S=t):w?(w=_[C/_[w-1][2]<_[w][2]/C?w-1:w],L=w[1],S=w[0]):(L=Math.max(Jt(R,M,S),1),S=a)}return L==null?S:S.every(L)}return c.invert=function(S){return new Date(l(S))},c.domain=function(S){return arguments.length?f(sr.call(S,jx)):f().map(Xx)},c.ticks=function(S,R){var M=f(),L=M[0],C=M[M.length-1],w=C<L,A;return w&&(A=L,L=C,C=A),A=D(S,L,C,R),A=A?A.range(L,C+1):[],w?A.reverse():A},c.tickFormat=function(S,R){return R==null?T:u(R)},c.nice=function(S,R){var M=f();return(S=D(S,M[0],M[M.length-1],R))?f(Fs(M,S)):c},c.copy=function(){return ze(c,js(t,e,n,r,i,o,s,a,u))},c}function Ks(){return _t.apply(js(Vt,fr,Ue,ve,$s,lr,Wi,Yi,ji).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Qs(){this._=null}function yn(t){t.U=t.C=t.L=t.R=t.P=t.N=null}Qs.prototype={constructor:Qs,insert:function(t,e){var n,r,i;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=Uf(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)r=n.U,n===r.L?(i=r.R,i&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.R&&(br(this,n),t=n,n=t.U),n.C=!1,r.C=!0,wr(this,r))):(i=r.L,i&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.L&&(wr(this,n),t=n,n=t.U),n.C=!1,r.C=!0,br(this,r))),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e=t.U,n,r=t.L,i=t.R,o,s;if(r?i?o=Uf(i):o=r:o=i,e?e.L===t?e.L=o:e.R=o:this._=o,r&&i?(s=o.C,o.C=t.C,o.L=r,r.U=o,o!==i?(e=o.U,o.U=t.U,t=o.R,e.L=t,o.R=i,i.U=o):(o.U=e,e=o,t=o.R)):(s=t.C,t=o),t&&(t.U=e),!s){if(t&&t.C){t.C=!1;return}do{if(t===this._)break;if(t===e.L){if(n=e.R,n.C&&(n.C=!1,e.C=!0,br(this,e),n=e.R),n.L&&n.L.C||n.R&&n.R.C){(!n.R||!n.R.C)&&(n.L.C=!1,n.C=!0,wr(this,n),n=e.R),n.C=e.C,e.C=n.R.C=!1,br(this,e),t=this._;break}}else if(n=e.L,n.C&&(n.C=!1,e.C=!0,wr(this,e),n=e.L),n.L&&n.L.C||n.R&&n.R.C){(!n.L||!n.L.C)&&(n.R.C=!1,n.C=!0,br(this,n),n=e.L),n.C=e.C,e.C=n.L.C=!1,wr(this,e),t=this._;break}n.C=!0,t=e,e=e.U}while(!t.C);t&&(t.C=!1)}}};function br(t,e){var n=e,r=e.R,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function wr(t,e){var n=e,r=e.L,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function Uf(t){for(;t.L;)t=t.L;return t}var Zs=Qs;function bn(t,e,n,r){var i=[null,null],o=st.push(i)-1;return i.left=t,i.right=e,n&&_r(i,t,e,n),r&&_r(i,e,t,r),St[t.index].halfedges.push(o),St[e.index].halfedges.push(o),i}function wn(t,e,n){var r=[e,n];return r.left=t,r}function _r(t,e,n,r){!t[0]&&!t[1]?(t[0]=r,t.left=e,t.right=n):t.left===n?t[1]=r:t[0]=r}function tv(t,e,n,r,i){var o=t[0],s=t[1],a=o[0],u=o[1],c=s[0],l=s[1],f=0,h=1,d=c-a,g=l-u,m;if(m=e-a,!(!d&&m>0)){if(m/=d,d<0){if(m<f)return;m<h&&(h=m)}else if(d>0){if(m>h)return;m>f&&(f=m)}if(m=r-a,!(!d&&m<0)){if(m/=d,d<0){if(m>h)return;m>f&&(f=m)}else if(d>0){if(m<f)return;m<h&&(h=m)}if(m=n-u,!(!g&&m>0)){if(m/=g,g<0){if(m<f)return;m<h&&(h=m)}else if(g>0){if(m>h)return;m>f&&(f=m)}if(m=i-u,!(!g&&m<0)){if(m/=g,g<0){if(m>h)return;m>f&&(f=m)}else if(g>0){if(m<f)return;m<h&&(h=m)}return!(f>0)&&!(h<1)||(f>0&&(t[0]=[a+f*d,u+f*g]),h<1&&(t[1]=[a+h*d,u+h*g])),!0}}}}}function ev(t,e,n,r,i){var o=t[1];if(o)return!0;var s=t[0],a=t.left,u=t.right,c=a[0],l=a[1],f=u[0],h=u[1],d=(c+f)/2,g=(l+h)/2,m,p;if(h===l){if(d<e||d>=r)return;if(c>f){if(!s)s=[d,n];else if(s[1]>=i)return;o=[d,i]}else{if(!s)s=[d,i];else if(s[1]<n)return;o=[d,n]}}else if(m=(c-f)/(h-l),p=g-m*d,m<-1||m>1)if(c>f){if(!s)s=[(n-p)/m,n];else if(s[1]>=i)return;o=[(i-p)/m,i]}else{if(!s)s=[(i-p)/m,i];else if(s[1]<n)return;o=[(n-p)/m,n]}else if(l<h){if(!s)s=[e,m*e+p];else if(s[0]>=r)return;o=[r,m*r+p]}else{if(!s)s=[r,m*r+p];else if(s[0]<e)return;o=[e,m*e+p]}return t[0]=s,t[1]=o,!0}function Yf(t,e,n,r){for(var i=st.length,o;i--;)(!ev(o=st[i],t,e,n,r)||!tv(o,t,e,n,r)||!(Math.abs(o[0][0]-o[1][0])>G||Math.abs(o[0][1]-o[1][1])>G))&&delete st[i]}function qf(t){return St[t.index]={site:t,halfedges:[]}}function nv(t,e){var n=t.site,r=e.left,i=e.right;return n===i&&(i=r,r=n),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(n===r?(r=e[1],i=e[0]):(r=e[0],i=e[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function Js(t,e){return e[+(e.left!==t.site)]}function rv(t,e){return e[+(e.left===t.site)]}function Gf(){for(var t=0,e=St.length,n,r,i,o;t<e;++t)if((n=St[t])&&(o=(r=n.halfedges).length)){var s=new Array(o),a=new Array(o);for(i=0;i<o;++i)s[i]=i,a[i]=nv(n,st[r[i]]);for(s.sort(function(u,c){return a[c]-a[u]}),i=0;i<o;++i)a[i]=r[s[i]];for(i=0;i<o;++i)r[i]=a[i]}}function Wf(t,e,n,r){var i=St.length,o,s,a,u,c,l,f,h,d,g,m,p,v=!0;for(o=0;o<i;++o)if(s=St[o]){for(a=s.site,c=s.halfedges,u=c.length;u--;)st[c[u]]||c.splice(u,1);for(u=0,l=c.length;u<l;)g=rv(s,st[c[u]]),m=g[0],p=g[1],f=Js(s,st[c[++u%l]]),h=f[0],d=f[1],(Math.abs(m-h)>G||Math.abs(p-d)>G)&&(c.splice(u,0,st.push(wn(a,g,Math.abs(m-t)<G&&r-p>G?[t,Math.abs(h-t)<G?d:r]:Math.abs(p-r)<G&&n-m>G?[Math.abs(d-r)<G?h:n,r]:Math.abs(m-n)<G&&p-e>G?[n,Math.abs(h-n)<G?d:e]:Math.abs(p-e)<G&&m-t>G?[Math.abs(d-e)<G?h:t,e]:null))-1),++l);l&&(v=!1)}if(v){var y,x,_,T=1/0;for(o=0,v=null;o<i;++o)(s=St[o])&&(a=s.site,y=a[0]-t,x=a[1]-e,_=y*y+x*x,_<T&&(T=_,v=s));if(v){var D=[t,e],S=[t,r],R=[n,r],M=[n,e];v.halfedges.push(st.push(wn(a=v.site,D,S))-1,st.push(wn(a,S,R))-1,st.push(wn(a,R,M))-1,st.push(wn(a,M,D))-1)}}for(o=0;o<i;++o)(s=St[o])&&(s.halfedges.length||delete St[o])}var Xf=[],Ki;function iv(){yn(this),this.x=this.y=this.arc=this.site=this.cy=null}function Ge(t){var e=t.P,n=t.N;if(!(!e||!n)){var r=e.site,i=t.site,o=n.site;if(r!==o){var s=i[0],a=i[1],u=r[0]-s,c=r[1]-a,l=o[0]-s,f=o[1]-a,h=2*(u*f-c*l);if(!(h>=-jf)){var d=u*u+c*c,g=l*l+f*f,m=(f*d-c*g)/h,p=(u*g-l*d)/h,v=Xf.pop()||new iv;v.arc=t,v.site=i,v.x=m+s,v.y=(v.cy=p+a)+Math.sqrt(m*m+p*p),t.circle=v;for(var y=null,x=_n._;x;)if(v.y<x.y||v.y===x.y&&v.x<=x.x)if(x.L)x=x.L;else{y=x.P;break}else if(x.R)x=x.R;else{y=x;break}_n.insert(y,v),y||(Ki=v)}}}}function We(t){var e=t.circle;e&&(e.P||(Ki=e.N),_n.remove(e),Xf.push(e),yn(e),t.circle=null)}var Qf=[];function ov(){yn(this),this.edge=this.site=this.circle=null}function Kf(t){var e=Qf.pop()||new ov;return e.site=t,e}function ta(t){We(t),Xe.remove(t),Qf.push(t),yn(t)}function Zf(t){var e=t.circle,n=e.x,r=e.cy,i=[n,r],o=t.P,s=t.N,a=[t];ta(t);for(var u=o;u.circle&&Math.abs(n-u.circle.x)<G&&Math.abs(r-u.circle.cy)<G;)o=u.P,a.unshift(u),ta(u),u=o;a.unshift(u),We(u);for(var c=s;c.circle&&Math.abs(n-c.circle.x)<G&&Math.abs(r-c.circle.cy)<G;)s=c.N,a.push(c),ta(c),c=s;a.push(c),We(c);var l=a.length,f;for(f=1;f<l;++f)c=a[f],u=a[f-1],_r(c.edge,u.site,c.site,i);u=a[0],c=a[l-1],c.edge=bn(u.site,c.site,null,i),Ge(u),Ge(c)}function Jf(t){for(var e=t[0],n=t[1],r,i,o,s,a=Xe._;a;)if(o=th(a,n)-e,o>G)a=a.L;else if(s=e-sv(a,n),s>G){if(!a.R){r=a;break}a=a.R}else{o>-G?(r=a.P,i=a):s>-G?(r=a,i=a.N):r=i=a;break}qf(t);var u=Kf(t);if(Xe.insert(r,u),!(!r&&!i)){if(r===i){We(r),i=Kf(r.site),Xe.insert(u,i),u.edge=i.edge=bn(r.site,u.site),Ge(r),Ge(i);return}if(!i){u.edge=bn(r.site,u.site);return}We(r),We(i);var c=r.site,l=c[0],f=c[1],h=t[0]-l,d=t[1]-f,g=i.site,m=g[0]-l,p=g[1]-f,v=2*(h*p-d*m),y=h*h+d*d,x=m*m+p*p,_=[(p*y-d*x)/v+l,(h*x-m*y)/v+f];_r(i.edge,c,g,_),u.edge=bn(c,t,null,_),i.edge=bn(t,g,null,_),Ge(r),Ge(i)}}function th(t,e){var n=t.site,r=n[0],i=n[1],o=i-e;if(!o)return r;var s=t.P;if(!s)return-1/0;n=s.site;var a=n[0],u=n[1],c=u-e;if(!c)return a;var l=a-r,f=1/o-1/c,h=l/c;return f?(-h+Math.sqrt(h*h-2*f*(l*l/(-2*c)-u+c/2+i-o/2)))/f+r:(r+a)/2}function sv(t,e){var n=t.N;if(n)return th(n,e);var r=t.site;return r[1]===e?r[0]:1/0}var G=1e-6,jf=1e-12,Xe,St,_n,st;function av(t,e,n){return(t[0]-n[0])*(e[1]-t[1])-(t[0]-e[0])*(n[1]-t[1])}function uv(t,e){return e[1]-t[1]||e[0]-t[0]}function Qi(t,e){var n=t.sort(uv).pop(),r,i,o;for(st=[],St=new Array(t.length),Xe=new Zs,_n=new Zs;;)if(o=Ki,n&&(!o||n[1]<o.y||n[1]===o.y&&n[0]<o.x))(n[0]!==r||n[1]!==i)&&(Jf(n),r=n[0],i=n[1]),n=t.pop();else if(o)Zf(o.arc);else break;if(Gf(),e){var s=+e[0][0],a=+e[0][1],u=+e[1][0],c=+e[1][1];Yf(s,a,u,c),Wf(s,a,u,c)}this.edges=st,this.cells=St,Xe=_n=st=St=null}Qi.prototype={constructor:Qi,polygons:function(){var t=this.edges;return this.cells.map(function(e){var n=e.halfedges.map(function(r){return Js(e,t[r])});return n.data=e.site.data,n})},triangles:function(){var t=[],e=this.edges;return this.cells.forEach(function(n,r){if(a=(o=n.halfedges).length)for(var i=n.site,o,s=-1,a,u,c=e[o[a-1]],l=c.left===i?c.right:c.left;++s<a;)u=l,c=e[o[s]],l=c.left===i?c.right:c.left,u&&l&&r<u.index&&r<l.index&&av(i,u,l)<0&&t.push([i.data,u.data,l.data])}),t},links:function(){return this.edges.filter(function(t){return t.right}).map(function(t){return{source:t.left.data,target:t.right.data}})},find:function(t,e,n){for(var r=this,i,o=r._found||0,s=r.cells.length,a;!(a=r.cells[o]);)if(++o>=s)return null;var u=t-a.site[0],c=e-a.site[1],l=u*u+c*c;do a=r.cells[i=o],o=null,a.halfedges.forEach(function(f){var h=r.edges[f],d=h.left;if(!((d===a.site||!d)&&!(d=h.right))){var g=t-d[0],m=e-d[1],p=g*g+m*m;p<l&&(l=p,o=d.index)}});while(o!==null);return r._found=i,n==null||l<=n*n?a.site:null}};function je(t,e,n){this.k=t,this.x=e,this.y=n}je.prototype={constructor:je,scale:function(t){return t===1?this:new je(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new je(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var ea=new je(1,0,0);na.prototype=je.prototype;function na(t){for(;!t.__zoom;)if(!(t=t.parentNode))return ea;return t.__zoom}var Z=F(Hd(),1),Yh=F(Od(),1),Ra=F(Ld(),1),Ji=F(_d(),1);var dy=F(nh(),1),Fr=F($d(),1);var qh=F(su(),1);function pv(t,e){return t.each(function(){var n=e.apply(this,arguments),r=O(this);for(var i in n)r.attr(i,n[i])})}function mv(t,e){for(var n in e)t.attr(n,e[n]);return t}function rh(t){return(typeof t=="function"?pv:mv)(this,t)}function gv(t,e,n){return t.each(function(){var r=e.apply(this,arguments),i=O(this);for(var o in r)i.style(o,r[o],n)})}function xv(t,e,n){for(var r in e)t.style(r,e[r],n);return t}function ih(t,e){return(typeof t=="function"?gv:xv)(this,t,e??"")}function vv(t,e){return t.each(function(){var n=e.apply(this,arguments),r=O(this);for(var i in n)r.property(i,n[i])})}function yv(t,e){for(var n in e)t.property(n,e[n]);return t}function oh(t){return(typeof t=="function"?vv:yv)(this,t)}function bv(t,e){return t.each(function(){var n=e.apply(this,arguments),r=O(this).transition(t);for(var i in n)r.attr(i,n[i])})}function wv(t,e){for(var n in e)t.attr(n,e[n]);return t}function sh(t){return(typeof t=="function"?bv:wv)(this,t)}function _v(t,e,n){return t.each(function(){var r=e.apply(this,arguments),i=O(this).transition(t);for(var o in r)i.style(o,r[o],n)})}function Sv(t,e,n){for(var r in e)t.style(r,e[r],n);return t}function ah(t,e){return(typeof t=="function"?_v:Sv)(this,t,e??"")}Et.prototype.attrs=rh;Et.prototype.styles=ih;Et.prototype.properties=oh;dn.prototype.attrs=sh;dn.prototype.styles=ah;var Pa=F(Yd(),1),Gh=F(fh(),1),gt=F(zd(),1),Qe=F(sp(),1),Wh=F(ph(),1),Xh=F(Bd(),1);var ue=F(au(),1),jh=F(Ud(),1),Kh=F(yh(),1),Qh=F(_h(),1),Zh=F(Ah(),1);var mo=F(ep(),1),Er=F(fp(),1),Jh=F(Ed(),1),td=F(qd(),1),ed=F(Vd(),1),to=F(hp(),1),nd=F(ap(),1),rd=F(Gr(),1);var Na=F(Mh(),1),go=F(Wd(),1),id=F(lp(),1),od=F(Ih(),1),oe=F(Kd(),1);var _e=F(Gd(),1);var sd=["*"];function py(t,e){if(t&1&&(dt(0,"div",1),Ot(1),pt()),t&2){let n=Ae();_o("top",n.contentPosition.top,"px")("left",n.contentPosition.left,"px")("height",n.contentPosition.height,"px")("width",n.contentPosition.width,"px")}}var my=["svgContent"],gy=["projectedDescription"],xy=["*",[["","legendMenu",""]],[["","description",""]]],vy=["*","[legendMenu]","[description]"],yy=t=>[t];function by(t,e){if(t&1&&(dt(0,"div",13),kn(1),pt()),t&2){let n=Ae(2);Nt("title",n.descriptionPrimary),Tt(),Ln(" ",n.descriptionPrimary," ")}}function wy(t,e){if(t&1&&(dt(0,"div",14),kn(1),pt()),t&2){let n=Ae(2);Nt("title",n.descriptionSecondary),Tt(),Ln(" ",n.descriptionSecondary," ")}}function _y(t,e){if(t&1&&(dt(0,"div",10),Ce(1,by,2,2,"div",11)(2,wy,2,2,"div",12),pt()),t&2){let n=Ae();Tt(),Nt("ngIf",!!n.descriptionPrimary),Tt(),Nt("ngIf",!!n.descriptionSecondary)}}function Sy(t,e){t&1&&(dt(0,"div",15,1),Ot(2,2),pt())}var Cy=["*",[["","leftEdge",""]],[["","rightEdge",""]],[["","top",""]],[["","bottom",""]]],Ay=["*","[leftEdge]","[rightEdge]","[top]","[bottom]"],Ey=t=>({"background-color":t});function My(t,e){if(t&1&&(dt(0,"div",10),kn(1),pt()),t&2){let n=Ae();Tt(),Ln(" ",n.value," ")}}function Ty(t,e){if(t&1&&(dt(0,"div",11),kn(1),pt()),t&2){let n=Ae();Tt(),Ln(" ",n.unitLabel," ")}}function Dy(t,e){t&1&&Ot(0,3)}function Iy(t,e){t&1&&Ot(0,4)}var V=function(t){return t.hidden="hidden",t.deemphasized="deemphasized",t.emphasized="emphasized",t.default="default",t}(V||{}),X=function(t){return t.background="background",t.data="data",t.unclippedData="unclipped-data",t.foreground="foreground",t}(X||{}),Mr="mouse_active",ua="interaction_values_active",Ze="interaction_values",xo="interaction_coordinates",ca="highlight_data_point",ad="select_data_point",Oa="highlight_series";var Tr="interaction_data_points",oa="interaction_data_point",Dr="destroy",ky="set_domain",ud="refresh",vo="chart_view_status",cd="series_state_change",Ly="axes_style_change",ld=new Wa("chart_component"),Ut={[X.background]:{name:X.background,order:0,clipped:!0},[X.data]:{name:X.data,order:50,clipped:!0},[X.unclippedData]:{name:X.unclippedData,order:51,clipped:!1},[X.foreground]:{name:X.foreground,order:1e3,clipped:!1}},Ir=-1,Yt=-2,kr="ignore-interaction",En=[0,0],Ry=[0,1];function Py(t){return!!t.domainWithTicks}function Br(t){return typeof t.bandwidth=="function"}function Ny(t){return typeof t.innerScale<"u"}var eo=class t{config;static DEFAULT_CONFIG={stateStyles:{[V.default]:{opacity:1},[V.hidden]:{opacity:0},[V.deemphasized]:{opacity:.1},[V.emphasized]:{opacity:1}}};constructor(e={}){this.config=e,this.config=(0,ae.default)(this.config,t.DEFAULT_CONFIG)}interaction={};getDataPointIndex(e,n,r){return Ir}highlightDataPoint(e,n,r){}getContainerStateStyles=e=>{if(!this.config.stateStyles)throw new Error("stateStyles property is not defined");return this.config.stateStyles[e||V.default]};setSeriesState(e,n){}setDataPointState(e,n){}getDomainOfFilteredData(e,n,r,i){let o=e.data;for(let s of Object.keys(n)){let a=n[s];!a.isDomainFixed||!a.isContinuous()||(o=this.filterDataByDomain(o,e,s,a.domain()))}return this.getDomain(o,e,r,i)}getDomain(e,n,r,i){return!e||e.length===0?En:Nn(e,(o,s,a)=>n.accessors.data?.[r]?.(o,s,Array.from(a),n))}filterDataByDomain(e,n,r,i){let o=n.accessors.data?.[r];return e.filter((s,a)=>{let u=o(s,a,e,n);return u>=i[0]&&u<=i[1]})}getRequiredLayers(){return[Ut[X.data]]}setupInteraction(e,n,r,i,o){let s=(0,Yh.default)(this.interaction,e,{})[n];s&&(0,Z.default)(s,a=>{r.on(n,()=>{let u=r.node().getBoundingClientRect();i.next({eventName:a,data:Xt(Wt({},o),{position:u})})})})}},W=function(t){return t.Click="click",t.Hover="hover",t.MouseDown="mousedown",t.MouseEnter="mouseenter",t.MouseLeave="mouseleave",t.MouseMove="mousemove",t.MouseUp="mouseup",t}(W||{}),Oy={annularWidth:20,annularPadding:5,maxThickness:30,annularGrowth:.15,cursor:"default",enableSeriesHighlighting:!0,enableDataPointHighlighting:!0},no=class extends eo{config;segmentWidth;constructor(e={}){super(e),this.config=e,this.config=(0,ae.default)(this.config,Oy)}draw(e,n){let r=e.containers[X.data],i=e.dataSeries.data,o=e.dataSeries.accessors,s=(u,c)=>this.getArc(e.scales.r.range(),jr(),c)(u);this.segmentWidth=this.getSegmentWidth(e);let a=r.selectAll("path.arc").data(i);a.exit().remove(),a.enter().append("path").attr("class","arc pointer-events nui-chart--path__outline").style("stroke-width",this.config.strokeWidth).style("cursor",this.config.cursor).on("mouseenter",(u,c)=>{this.emitDataPointHighlight(e,u,c,n)}).on("mouseleave",(u,c)=>{this.emitDataPointHighlight(e,null,Ir,n)}).on("click",(u,c)=>{n.next({eventName:ad,data:{seriesId:e.dataSeries.id,index:c,data:u.data,position:this.getDataPointPosition(e.dataSeries,c,e.scales)}})}).merge(a).attr("d",s).attr("fill",(u,c)=>o.data.color?o.data.color(u.data,c,i,e.dataSeries):o.series.color?.(e.dataSeries.id,e.dataSeries))}getDataPointPosition(e,n,r){if(n<0)return;let i=e.data[n],s=this.getArc(r.r.range(),jr(),n).centroid(i);return{x:s[0],y:s[1],width:0,height:0}}getInnerRadius(e,n){if((0,I.default)(this.segmentWidth)||(0,I.default)(this.config.annularPadding))throw new Error("Can't compute inner radius");let r=e[1]-e[0]-this.segmentWidth-n*(this.config.annularPadding+this.segmentWidth);return r>=0?r:0}getOuterRadius(e,n){if((0,I.default)(this.segmentWidth)||(0,I.default)(this.config.annularPadding))throw new Error("Can't compute outer radius");let r=e[1]-e[0]-n*(this.config.annularPadding+this.segmentWidth);return r>=0?r:0}getArc(e,n,r){let i=this.getInnerRadius(e,r);return n.outerRadius(this.getOuterRadius(e,r)).innerRadius(i)}getSegmentWidth(e){return this.config.maxThickness&&this.config.annularGrowth?Math.min((e.scales.r.range()[1]-e.scales.r.range()[0])*this.config.annularGrowth,this.config.maxThickness):this.config.annularWidth}emitDataPointHighlight(e,n,r,i){let o=this.getDataPointPosition(e.dataSeries,r,e.scales),s={seriesId:e.dataSeries.id,dataSeries:e.dataSeries,index:r,data:n,position:o};this.config.enableSeriesHighlighting&&i.next({eventName:Oa,data:s}),this.config.enableDataPointHighlighting&&i.next({eventName:ca,data:s}),i.next({eventName:Tr,data:{interactionType:W.MouseMove,dataPoints:{[e.dataSeries.id]:s}}})}},se=class{constructor(){}chart;initialize(){}update(){}updateDimensions(){}destroy(){}},kh=class extends se{contentPositionUpdateSubject=new ht;contentPosition={top:0,left:0,width:0,height:0};updateDimensions(){let e=this.chart.getDataManager().chartSeriesSet.reduce((n,r)=>r.renderer instanceof no&&!(0,I.default)(n)?Math.min(n,r.renderer.getInnerRadius(r.scales.r.range(),r.data.length-1)):n,1/0);if((0,I.default)(e))throw new Error("Radius is undefined");this.contentPosition=this.getContentPosition(e),this.contentPositionUpdateSubject.next(this.contentPosition)}destroy(){this.contentPositionUpdateSubject.complete()}getContentPosition(e){let n=[this.chart.getGrid().config().dimension.outerHeight()/2,this.chart.getGrid().config().dimension.outerWidth()/2];return{top:n[0]-e/Math.sqrt(2),left:n[1]-e/Math.sqrt(2),width:e*Math.sqrt(2),height:e*Math.sqrt(2)}}},jN=(()=>{class t{plugin;contentPosition;contentPositionUpdateSubscription;ngOnChanges(n){n.plugin&&(this.contentPositionUpdateSubscription?.unsubscribe(),this.contentPositionUpdateSubscription=this.plugin.contentPositionUpdateSubject.subscribe(r=>{this.contentPosition=r}),this.plugin.chart.updateDimensions())}ngOnDestroy(){this.contentPositionUpdateSubscription&&this.contentPositionUpdateSubscription.unsubscribe()}static \u0275fac=function(r){return new(r||t)};static \u0275cmp=Se({type:t,selectors:[["nui-chart-donut-content"]],inputs:{plugin:"plugin"},features:[en],ngContentSelectors:sd,decls:1,vars:1,consts:[["class","nui-chart-donut-content d-flex justify-content-center align-items-center text-center",3,"top","left","height","width",4,"ngIf"],[1,"nui-chart-donut-content","d-flex","justify-content-center","align-items-center","text-center"]],template:function(r,i){r&1&&(Dn(),Ce(0,py,2,8,"div",0)),r&2&&Nt("ngIf",i.plugin&&i.contentPosition)},dependencies:[qr],styles:[".nui-chart-donut-content[_ngcontent-%COMP%]{position:absolute;pointer-events:auto;width:100%;height:100%;overflow:hidden;text-overflow:ellipsis}"]})}return t})();var Sn=3,KN=(()=>{class t{changeDetector;marker;drawLine;color;maxSize=20;svgContent;viewBox;height="10px";width="10px";svg=new tn("");constructor(n){this.changeDetector=n}ngAfterViewInit(){this.svg.subscribe(n=>{this.renderMarkerSvg(n)})}ngOnChanges(n){(n.marker||n.color)&&(n.color&&this.marker.setColor(this.color),this.marker&&this.marker.getSvg&&(0,qh.default)(this.marker.getSvg)&&this.svg.next(this.marker.getSvg()))}ngOnDestroy(){this.svg.complete()}renderMarkerSvg(n){let r=this.svgContent.nativeElement,i=`<line x1="-10" y1="0" x2="10" y2="0" style="stroke:${this.color};stroke-width:2" />`;r.innerHTML="",this.drawLine&&r.insertAdjacentHTML("beforeend",i),r.insertAdjacentHTML("beforeend",n),setTimeout(()=>{let o=r.getBBox();this.viewBox=`${o.x-Sn} ${o.y-Sn} ${o.width+2*Sn} ${o.height+2*Sn}`,this.width=Math.min(o.width+2*Sn,this.maxSize)+"px",this.height=Math.min(o.height+2*Sn,this.maxSize)+"px",this.changeDetector.markForCheck()})}static \u0275fac=function(r){return new(r||t)(Pt(Yr))};static \u0275cmp=Se({type:t,selectors:[["nui-chart-marker"]],viewQuery:function(r,i){if(r&1&&Co(my,5),r&2){let o;Ao(o=Eo())&&(i.svgContent=o.first)}},inputs:{marker:"marker",drawLine:"drawLine",color:"color",maxSize:"maxSize"},features:[en],decls:3,vars:3,consts:[["svgContent",""]],template:function(r,i){r&1&&(Za(),dt(0,"svg"),So(1,"g",null,0),pt()),r&2&&eu("width",i.width)("height",i.height)("viewBox",i.viewBox)},styles:["[_nghost-%COMP%]{font-size:0}"]})}return t})(),QN=(()=>{class t{elRef;ngZone;cd;chart;resizeObserver;resizeHandler;intersectionObserver;constructor(n,r,i){this.elRef=n,this.ngZone=r,this.cd=i}ngOnInit(){this.intersectionObserver=new IntersectionObserver(this.intersectionObserverCallback),this.intersectionObserver.observe(this.elRef.nativeElement)}ngOnChanges(n){if(n.chart){let r=n.chart.previousValue;r&&r.destroy(),this.chart&&(this.chart.build(this.elRef.nativeElement),this.redraw())}}ngAfterContentInit(){this.chart.getEventBus().getStream(ud).subscribe(()=>{this.chart.updateDimensions()})}ngAfterViewInit(){this.resizeHandler=(0,Pa.default)(()=>this.redraw(),10),this.resizeObserver=new ResizeObserver(()=>{this.ngZone.run(()=>this.resizeHandler())}),this.ngZone.runOutsideAngular(()=>this.resizeObserver?.observe(this.elRef.nativeElement))}ngOnDestroy(){this.intersectionObserver?.unobserve(this.elRef.nativeElement),this.resizeObserver?.unobserve(this.elRef.nativeElement),this.chart?.destroy()}redraw=()=>{this.chart.updateDimensions(),this.cd.detectChanges()};intersectionObserverCallback=n=>{let r={isChartInView:n[0].isIntersecting};this.chart.getEventBus().getStream(vo).next({data:r})};static \u0275fac=function(r){return new(r||t)(Pt(Ja),Pt(tu),Pt(Yr))};static \u0275cmp=Se({type:t,selectors:[["nui-chart"]],inputs:{chart:"chart"},features:[ru([{provide:ld,useExisting:qa(()=>t)}]),en],decls:0,vars:0,template:function(r,i){},encapsulation:2})}return t})(),ro=class{streams={};getStream(e){return this.streams[e]||(this.streams[e]=new ht),this.streams[e]}destroy(){(0,Z.default)(Object.keys(this.streams),e=>{this.streams[e].complete()})}},la=class{lastIndex=-1;events=[Ze,xo,Mr,ud];charts={};subscriptions={};eventBus;constructor(){}addChart(e){let n=(++this.lastIndex).toString();this.charts[n]=e,this.eventBus||this.initializeEventBus(),(0,Z.default)(this.events,r=>{this.subscribe(n,e.getEventBus().getStream(r),i=>{i.broadcast||this.eventBus?.getStream(r).next({chartIndex:n,event:i})})}),this.subscribe(n,e.getEventBus().getStream(Dr),r=>{this.removeChart(e),Object.keys(this.charts).length===0&&this.destroy()})}removeChart(e){let n=this.getChartKey(e);if((0,I.default)(n))throw new Error("Chart not registered!");this.unsubscribeChart(n),delete this.charts[n]}destroy(){this.eventBus?.destroy(),this.eventBus=void 0}initializeEventBus(){this.eventBus=new ro;for(let e of this.events)this.eventBus.getStream(e).subscribe(n=>{for(let r of Object.keys(this.charts))r!==n.chartIndex&&(n.event.broadcast=!0,this.charts[r].getEventBus().getStream(e).next(n.event))})}subscribe(e,n,r){let i=n.subscribe(r),o=this.subscriptions[e];(0,I.default)(o)&&(o=[],this.subscriptions[e]=o),o.push(i)}unsubscribeChart(e){(0,Z.default)(this.subscriptions[e],n=>{n.unsubscribe()}),delete this.subscriptions[e]}getChartKey(e){return(0,Gh.default)(this.charts,n=>n===e)}},fd=(()=>{class t{collections={};getChartCollection(n){let r=this.collections[n];return(0,I.default)(r)&&(r=new la,this.collections[n]=r),r}static \u0275fac=function(r){return new(r||t)};static \u0275prov=Vr({token:t,factory:t.\u0275fac})}return t})(),ZN=(()=>{class t{chartComponent;chartCollectionService;collectionId;constructor(n,r){this.chartComponent=n,this.chartCollectionService=r}ngOnChanges(n){let r=n.collectionId;r&&(r.previousValue&&this.chartCollectionService.getChartCollection(r.previousValue).removeChart(this.chartComponent.chart),r.currentValue&&this.chartCollectionService.getChartCollection(r.currentValue).addChart(this.chartComponent.chart))}static \u0275fac=function(r){return new(r||t)(Pt(ld),Pt(fd))};static \u0275dir=Qa({type:t,selectors:[["","nuiChartCollectionId",""]],inputs:{collectionId:[ja.None,"nuiChartCollectionId","collectionId"]},features:[en]})}return t})(),Fa=function(t){return t.vertical="vertical",t.horizontal="horizontal",t}(Fa||{}),hd=(()=>{class t{activeChanged=new wo;active=!1;interactive=!1;orientation=Fa.vertical;seriesColor;seriesIcon;seriesUnitLabel;ngOnChanges(n){n.active&&this.activeChanged.emit(this.active)}ngOnDestroy(){this.activeChanged.complete()}static \u0275fac=function(r){return new(r||t)};static \u0275cmp=Se({type:t,selectors:[["nui-legend"]],hostAttrs:[1,"d-inline-block"],inputs:{active:"active",interactive:"interactive",orientation:"orientation",seriesColor:"seriesColor",seriesIcon:"seriesIcon",seriesUnitLabel:"seriesUnitLabel"},features:[en],ngContentSelectors:sd,decls:2,vars:2,consts:[[1,"nui-legend","d-flex","flex-wrap"]],template:function(r,i){r&1&&(Dn(),dt(0,"div",0),Ot(1),pt()),r&2&&nn("flex-column",i.orientation==="vertical")},encapsulation:2})}return t})();var Fy=(()=>{class t{legend;set active(n){this._active=n}set interactive(n){this._interactive=n}get interactive(){return this._interactive}isSelected=!0;isSelectedChange=new wo;descriptionPrimary;descriptionSecondary;icon;color;set seriesRenderState(n){this._seriesRenderState=n}get seriesRenderState(){return this._seriesRenderState||V.default}projectedDescription;get isInteractiveClassApplied(){return this._interactive}isHorizontalClassApplied=!1;get isActiveClassApplied(){return this._active&&this.seriesRenderState!==V.hidden}_seriesRenderState;_active=!1;_interactive;constructor(n){this.legend=n}ngAfterContentInit(){this.legend&&(this.legend.activeChanged.subscribe(n=>this._active=n),this.icon=this.icon||this.legend.seriesIcon,this._active=this.legend.active,this.interactive=this.interactive??this.legend.interactive,this.isHorizontalClassApplied=this.legend.orientation===Fa.horizontal)}onClick(){this.interactive&&this.isSelectedChange.next(!this.isSelected)}hasInputDescription(){return!(0,gt.default)(this.descriptionPrimary)||!(0,gt.default)(this.descriptionSecondary)}hasProjectedDescription(){return!!this.projectedDescription&&this.projectedDescription.nativeElement.children.length!==0}static \u0275fac=function(r){return new(r||t)(Pt(hd,9))};static \u0275cmp=Se({type:t,selectors:[["nui-legend-series"]],viewQuery:function(r,i){if(r&1&&Co(gy,5),r&2){let o;Ao(o=Eo())&&(i.projectedDescription=o.first)}},hostAttrs:[1,"nui-legend-series"],hostVars:6,hostBindings:function(r,i){r&1&&nu("click",function(){return i.onClick()}),r&2&&nn("nui-legend-series--interactive",i.isInteractiveClassApplied)("nui-legend-series--horizontal",i.isHorizontalClassApplied)("inverse",i.isActiveClassApplied)},inputs:{active:"active",interactive:"interactive",isSelected:"isSelected",descriptionPrimary:"descriptionPrimary",descriptionSecondary:"descriptionSecondary",icon:"icon",color:"color",seriesRenderState:"seriesRenderState"},outputs:{isSelectedChange:"isSelectedChange"},ngContentSelectors:vy,decls:12,vars:9,consts:[["descriptionTemplate",""],["projectedDescription",""],[1,"d-flex",3,"ngClass"],[1,"nui-legend-series__tile-wrapper"],[1,"nui-legend-series__tile"],[1,"nui-legend-series__checkbox-wrapper"],[1,"nui-legend-series__checkbox-mark"],[1,"nui-legend-series__checkbox-glyph"],["class","description-container nui-text-small d-flex flex-column justify-content-center",4,"ngIf","ngIfElse"],[1,"legend-menu"],[1,"description-container","nui-text-small","d-flex","flex-column","justify-content-center"],["class","description description-primary",3,"title",4,"ngIf"],["class","description description-secondary",3,"title",4,"ngIf"],[1,"description","description-primary",3,"title"],[1,"description","description-secondary",3,"title"],[1,"d-flex"]],template:function(r,i){if(r&1&&(Dn(xy),dt(0,"div",2)(1,"div",3)(2,"div",4),Ot(3),pt(),dt(4,"div",5)(5,"div",6),So(6,"i",7),pt()()(),Ce(7,_y,3,2,"div",8),dt(8,"div",9),Ot(9,1),pt()(),Ce(10,Sy,3,0,"ng-template",null,0,Ur)),r&2){let o=In(11);nn("nui-legend-series--deselected",!i.isSelected),Nt("ngClass",Mo(7,yy,"nui-legend-series--state-"+i.seriesRenderState)),Tt(4),nn("nui-legend-series__checkbox--checked",i.isSelected),Tt(3),Nt("ngIf",i.hasInputDescription())("ngIfElse",o)}},dependencies:[iu,qr],encapsulation:2,changeDetection:0})}return t})();var JN=(()=>{class t{legendSeries;legend;changeDetector;unitLabel;value;backgroundColor;color;seriesHasAdditionalContent;constructor(n,r,i){this.legendSeries=n,this.legend=r,this.changeDetector=i}ngAfterContentInit(){this.legend&&(this.unitLabel=this.unitLabel||this.legend.seriesUnitLabel,this.backgroundColor=this.backgroundColor||this.legend.seriesColor||"white")}ngAfterViewInit(){this.legendSeries&&(this.seriesHasAdditionalContent=this.legendSeries.hasInputDescription()||this.legendSeries.hasProjectedDescription(),this.changeDetector.detectChanges())}hasInputValue(){return!(0,Ji.default)(this.value)}hasInputUnitLabel(){return!(0,Ji.default)(this.unitLabel)}static \u0275fac=function(r){return new(r||t)(Pt(Fy,1),Pt(hd,9),Pt(Yr))};static \u0275cmp=Se({type:t,selectors:[["nui-rich-legend-tile"]],inputs:{unitLabel:"unitLabel",value:"value",backgroundColor:"backgroundColor",color:"color"},ngContentSelectors:Ay,decls:15,vars:13,consts:[["icon",""],["rightEdge",""],["projectedTopContent",""],["projectedBottomContent",""],[1,"nui-rich-legend-tile"],[1,"nui-rich-legend-tile__tilebox","d-flex","justify-content-center","align-items-end","flex-column",3,"ngStyle"],["class","nui-rich-legend-tile__tilebox-value nui-rich-legend-tile__ellipsified",4,"ngIf","ngIfElse"],["class","nui-rich-legend-tile__tilebox-unit nui-rich-legend-tile__ellipsified",4,"ngIf","ngIfElse"],[1,"nui-rich-legend-tile__icon"],[1,"nui-rich-legend-tile__point-marker"],[1,"nui-rich-legend-tile__tilebox-value","nui-rich-legend-tile__ellipsified"],[1,"nui-rich-legend-tile__tilebox-unit","nui-rich-legend-tile__ellipsified"]],template:function(r,i){if(r&1&&(Dn(Cy),dt(0,"div",4)(1,"div",5),Ce(2,My,2,1,"div",6)(3,Ty,2,1,"div",7),Ot(4),pt(),dt(5,"div",8,0),Ot(7,1),pt(),dt(8,"div",9,1),Ot(10,2),pt()(),Ce(11,Dy,1,0,"ng-template",null,2,Ur)(13,Iy,1,0,"ng-template",null,3,Ur)),r&2){let o=In(9),s=In(12),a=In(14);nn("nui-rich-legend-tile--has-point-marker",o.children.length>0)("nui-rich-legend-tile--series-has-additional-content",i.seriesHasAdditionalContent),Tt(),_o("color",i.color),Nt("ngStyle",Mo(11,Ey,i.backgroundColor)),Tt(),Nt("ngIf",i.hasInputValue())("ngIfElse",s),Tt(),Nt("ngIf",i.hasInputUnitLabel())("ngIfElse",a)}},dependencies:[qr,ou],styles:[".nui-rich-legend-tile[_ngcontent-%COMP%]{position:relative;width:60px;height:100%;line-height:18px}.nui-rich-legend-tile[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:empty{display:none}.nui-rich-legend-tile__tilebox[_ngcontent-%COMP%]{width:100%;height:100%;padding:0 5px;background-color:var(--nui-color-bg-light,#fff)}.nui-rich-legend-tile__ellipsified[_ngcontent-%COMP%]{max-width:100%;overflow:hidden;text-overflow:ellipsis}.nui-rich-legend-tile__tilebox-value[_ngcontent-%COMP%]{text-align:right;font-weight:600}.nui-rich-legend-tile__tilebox-value[_ngcontent-%COMP%]:not(:last-child){margin-bottom:-3px}.nui-rich-legend-tile__tilebox-unit[_ngcontent-%COMP%]{text-align:right;font-size:11px}.nui-rich-legend-tile__tilebox-unit[_ngcontent-%COMP%]:not(:first-child){margin-top:-3px}.nui-rich-legend-tile__point-marker[_ngcontent-%COMP%], .nui-rich-legend-tile__icon[_ngcontent-%COMP%]{position:absolute;line-height:0;top:50%;pointer-events:none}.nui-rich-legend-tile__point-marker[_ngcontent-%COMP%]{right:0;transform:translate(50%,-50%)}.nui-rich-legend-tile__icon[_ngcontent-%COMP%]{left:0;transform:translate(-50%,-50%)}.nui-rich-legend-tile--has-point-marker.nui-rich-legend-tile--series-has-additional-content[_ngcontent-%COMP%]{margin-right:5px}.nui-rich-legend-tile--has-point-marker[_ngcontent-%COMP%]   .nui-rich-legend-tile__tilebox[_ngcontent-%COMP%]{padding-right:7px}"]})}return t})(),Zi=function(t){return t.Start="start",t.End="end",t}(Zi||{});function dd(t){if(!(0,jh.default)(t,"var("))return t;let e=(0,Kh.default)((0,Qh.default)((0,Zh.default)(t,"var("),")"));return getComputedStyle(document.body).getPropertyValue(e)}var io=class{sourceProvider;fn;processedColors;constructor(e,n){this.sourceProvider=e,this.fn=n,this.reset()}get=e=>{let n=this.sourceProvider.get(e);if(!n)throw new Error("clr is not defined");let r=this.processedColors[n];return r||(r=this.fn(n),this.processedColors[n]=r),r};reset(){this.processedColors={}}},oo=class{values;providedValues;lastUsedIndex;constructor(e){this.values=e,this.reset()}get=e=>{let n=this.providedValues[e];if(!n){let r=++this.lastUsedIndex%this.values.length;n=this.values[r],this.providedValues[e]=n}return n};reset(){this.providedValues={},this.lastUsedIndex=-1}},so=class extends oo{colors;constructor(e){super(e),this.colors=e}},By=.2126,zy=.7152,Hy=.0722,sa=1/12.92,fa=class extends io{constructor(e,n){super(e,r=>{let i=dd(r),o=$t(i),s=this.getContrastRatio(o,$t(n.light));return this.getContrastRatio(o,$t(n.dark))>s?n.dark:n.light})}getContrastRatio(e,n){let r=this.getRelativeLuminance(e),i=this.getRelativeLuminance(n),o,s;return r>i?(o=r,s=i):(o=i,s=r),(o+.05)/(s+.05)}getRelativeLuminance(e){let n=e.r/255,r=e.g/255,i=e.b/255,o=n<=.03928?n*sa:this.adjustGamma(n),s=r<=.03928?r*sa:this.adjustGamma(r),a=i<=.03928?i*sa:this.adjustGamma(i);return o*By+s*zy+a*Hy}adjustGamma(e){return Math.pow((e+.055)/1.055,2.4)}},ao=class{_standardColors;_textColors;_backgroundColors;constructor(e,n={backgroundOpacity:.15}){(0,ue.default)(e)?this._standardColors=new so(e):this._standardColors=e,this._textColors=new fa(this.standardColors,{light:"white",dark:"black"}),this._backgroundColors=new io(this.standardColors,r=>{let i=dd(r),o=$t(i);return o.opacity=n.backgroundOpacity,o.toString()})}get standardColors(){return this._standardColors}get backgroundColors(){return this._backgroundColors}get textColors(){return this._textColors}},ha=class{svg;styledSvg;constructor(e){this.svg=e}getSvg(){return this.styledSvg||this.svg}setColor(e){this.styledSvg=(0,I.default)(e)?e:`<g fill="${e}">${this.svg}</g>`}},pd=["var(--nui-color-chart-one)","var(--nui-color-chart-two)","var(--nui-color-chart-three)","var(--nui-color-chart-four)","var(--nui-color-chart-five)","var(--nui-color-chart-six)","var(--nui-color-chart-seven)","var(--nui-color-chart-eight)","var(--nui-color-chart-nine)","var(--nui-color-chart-ten)"];var tO=["var(--nui-color-chart-one)","var(--nui-color-chart-one-light)","var(--nui-color-chart-one-dark)","var(--nui-color-chart-two)","var(--nui-color-chart-two-light)","var(--nui-color-chart-two-dark)","var(--nui-color-chart-three)","var(--nui-color-chart-three-light)","var(--nui-color-chart-three-dark)","var(--nui-color-chart-four)","var(--nui-color-chart-four-light)","var(--nui-color-chart-four-dark)","var(--nui-color-chart-five)","var(--nui-color-chart-five-light)","var(--nui-color-chart-five-dark)","var(--nui-color-chart-six)","var(--nui-color-chart-six-light)","var(--nui-color-chart-six-dark)","var(--nui-color-chart-seven)","var(--nui-color-chart-seven-light)","var(--nui-color-chart-seven-dark)","var(--nui-color-chart-eight)","var(--nui-color-chart-eight-light)","var(--nui-color-chart-eight-dark)","var(--nui-color-chart-nine)","var(--nui-color-chart-nine-light)","var(--nui-color-chart-nine-dark)","var(--nui-color-chart-ten)","var(--nui-color-chart-ten-light)","var(--nui-color-chart-ten-dark)"];var eO=["var(--nui-color-semantic-down)","var(--nui-color-semantic-down-bg)","var(--nui-color-semantic-critical)","var(--nui-color-semantic-critical-bg)","var(--nui-color-semantic-warning)","var(--nui-color-semantic-warning-bg)","var(--nui-color-semantic-unknown)","var(--nui-color-semantic-unknown-bg)","var(--nui-color-semantic-ok)","var(--nui-color-semantic-ok-bg)","var(--nui-color-semantic-info)","var(--nui-color-semantic-info-bg)","var(--nui-color-chart-ten-light)","var(--nui-color-chart-ten)"],Lh=["m0 0m-4 0a4 4 0 1 0 8 0 4 4 0 1 0-8 0z","m-4,-4l8,0l0,8l-8,0l0,-8z","m0-4 4 8-8 0z","m0-4.95 4.95 4.95-4.95 4.95-4.95-4.95 4.95-4.95z","m0 4-4-8 8 0z","m0-3.805 4.001 2.907-1.528 4.703-4.945 0-1.528-4.703z"],$y=["m0 2c1.105 0 2-.895 2-2 0-1.105-.895-2-2-2-1.105 0-2 .895-2 2 0 1.105.895 2 2 2zm0 2c-2.209 0-4-1.791-4-4 0-2.209 1.791-4 4-4 2.209 0 4 1.791 4 4 0 2.209-1.791 4-4 4z","m-2-2 0 4 4 0 0-4-4 0zm-2-2 8 0 0 8-8 0 0-8z","m0-4-4 8 8.001 0-4.001-8zm0 3.354 1.573 3.146-3.145 0 1.572-3.146z","m0-2.121-2.121 2.121 2.121 2.121 2.121-2.121-2.121-2.121zm0-2.828 4.95 4.95-4.95 4.95-4.95-4.95 4.95-4.95z","m0 4-4-8 8.001 0-4.001 8zm0-3.354 1.573-3.146-3.145 0 1.572 3.146z","m0-1.951-2.237 1.626.855 2.63 2.766 0 .855-2.63-2.237-1.626zm0-1.854 4.001 2.907-1.528 4.703-4.945 0-1.528-4.703 4.001-2.907z"],md=[...Lh.map(t=>`<path class="nui-chart--path__outline" d="${t}"></path>`),...$y.map((t,e)=>`<path class="nui-chart--path__outline-fill" stroke="none" d="${Lh[e]}"></path>
            <path class="nui-chart--path__outline" d="${t}"></path>`)].map(t=>new ha(t)),uo=class extends oo{markers;constructor(e){super(e),this.markers=e}};function zr(){return new so(pd)}function Vy(){return new ao(zr())}function yo(){return new uo(md)}var co=class{colorProvider;markerProvider;data;series;constructor(e=zr(),n=yo()){this.colorProvider=e,this.markerProvider=n,this.data={x:(r,i,o,s)=>r.x,x0:(r,i,o,s)=>this.data.x(r,i,o,s),x1:(r,i,o,s)=>this.data.x(r,i,o,s),y:(r,i,o,s)=>r.y,y0:(r,i,o,s)=>this.data.y(r,i,o,s),y1:(r,i,o,s)=>this.data.y(r,i,o,s),absoluteX0:(r,i,o,s)=>r.__stack_x?.start??this.data.x0(r,i,o,s),absoluteX1:(r,i,o,s)=>r.__stack_x?.end??this.data.x1(r,i,o,s),absoluteY0:(r,i,o,s)=>r.__stack_y?.start??this.data.y0(r,i,o,s),absoluteY1:(r,i,o,s)=>r.__stack_y?.end??this.data.y1(r,i,o,s)},this.series={color:this.colorProvider?this.colorProvider.get:void 0,marker:this.markerProvider?this.markerProvider.get:void 0}}},da=class{data;series;constructor(){}},lo=class extends da{colorProvider;markerProvider;data;series;constructor(e=zr(),n=yo()){super(),this.colorProvider=e,this.markerProvider=n,this.data={value:r=>r.value,category:(r,i,o,s)=>r.category?r.category:this.series.category?this.series.category(s.id,s):null,start:(r,i,o,s)=>{if(r.__bar)return r.__bar.start;if(typeof r.start<"u")return r.start;let a=this.getSingleValue(r,i,o,s);return Number.isFinite(a)?Math.min(0,a):null},end:(r,i,o,s)=>{if(r.__bar)return r.__bar.end;if(typeof r.end<"u")return r.end;let a=this.getSingleValue(r,i,o,s);return Number.isFinite(a)?Math.max(0,a):null}},this.series={color:this.colorProvider?this.colorProvider.get:void 0,marker:this.markerProvider?this.markerProvider.get:void 0,category:(r,i)=>i.name||i.id}}getSingleValue(e,n,r,i){let o;return this.data.value&&(o=this.data.value(e,n,r,i),typeof o>"u"&&(o=e)),o}},fo=class extends lo{constructor(e,n){super(e,n),this.data=Xt(Wt({},this.data),{startX:(r,i,o,s)=>this.data.start(r,i,o,s),endX:(r,i,o,s)=>this.data.end(r,i,o,s),startY:(r,i,o,s)=>this.data.category(r,i,o,s),endY:(r,i,o,s)=>this.data.category(r,i,o,s),thicknessY:(r,i,o,s)=>this.data.thickness?this.data.thickness(r,i,o,s):void 0})}},ho=class t{barAccessors;static STATUS_CATEGORY="status";static STATUS_DOMAIN=[t.STATUS_CATEGORY];get data(){return this.barAccessors.data}get series(){return this.barAccessors.series}constructor(e){this.barAccessors=e,e.data.status=n=>n.status}};function Uy(t,e){let n=new ho(new fo(t,e));return n.data.color=(r,i,o,s)=>t.get(n.data.status(r,i,o,s)),n.data.category=()=>ho.STATUS_CATEGORY,n}var Ba=.5;function Cr(t,e,n=Ba,r=Number.MAX_VALUE){if(!t)return 0;if(!Br(t))return t.convert(e);let i=t;if(!(0,ue.default)(e))return i.convert(e,n);let o=e;return o.length===1||!i.innerScale||r<=1?i.convert(o[0],n):i.convert(o[0],0)+Cr(i.innerScale,o.slice(1),n,r-1)}function gd(t,e){if(!t)return 0;let n=t.invert(e);if(!Br(t)||(0,I.default)(n))return n;let r=t;if(!r.innerScale)return n;let i=gd(r.innerScale,e-r.convert(n,0));return(0,ue.default)(i)?[n,...i]:[n,i]}var xt=class t{static getValueAccessor(e,n){let r=e(n,0);if(typeof r=="number"||typeof r=="string")return e;if(r.valueOf&&typeof r.valueOf()=="number")return(i,o)=>e(i,o).valueOf();throw new Error("Value in the data series does not return numeric valueOf().")}static getClosestIndex(e,n,r){if(e.length===1)return 0;if(e.length===0)return;let i=t.getValueAccessor(n,e[0]);if(typeof r=="string")return e.findIndex(a=>i(a,0)===r);let o=this.findNearestIndex(e,r,n);o=o>0?o-1:o,o=o>=e.length-1&&e.length!==1?e.length-2:o;let s=t.getCloser(i(e[o],o),i(e[o+1],o+1),r);return o+s}static getCloser(e,n,r){return Math.abs(r-e)<=Math.abs(r-n)?0:1}static clampToRange(e,n){return e<n[0]?n[0]:e>n[1]?n[1]:e}static uuid(){let e=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{let i=(e+Math.random()*16)%16|0;return e=Math.floor(e/16),(r==="x"?i:i&3|8).toString(16)})}static cssEscape(e){if(arguments.length===0)throw new TypeError("`cssEscape` requires an argument.");let n=String(e),r=n.length,i=-1,o,s="",a=n.charCodeAt(0);for(;++i<r;){if(o=n.charCodeAt(i),o===0){s+="\uFFFD";continue}if(o>=1&&o<=31||o===127||i===0&&o>=48&&o<=57||i===1&&o>=48&&o<=57&&a===45){s+="\\"+o.toString(16)+" ";continue}if(i===0&&r===1&&o===45){s+="\\"+n.charAt(i);continue}if(o>=128||o===45||o===95||o>=48&&o<=57||o>=65&&o<=90||o>=97&&o<=122){s+=n.charAt(i);continue}s+="\\"+n.charAt(i)}return s}static findNearestIndex(e,n,r=Jh.default){let i=0,o=e==null?i:e.length;for(;i<o;){let s=i+o>>>1,a=r(e[s],s);a!==null&&a<n?i=s+1:o=s}return Math.round(i)}static getXYValues(e,n,r,i){let o=t.getScaleValues(e,r),s=t.getScaleValues(n,i),a={};return(0,gt.default)(o)||(a.x=o),(0,gt.default)(s)||(a.y=s),a}static getScaleValues(e,n){function r(i,o){let s=gd(o,n);return(0,I.default)(s)||(i[o.id]=s),i}return e.reduce(r,{})}static getInteractionValues(e,n){return e?e[n]??Object.values(e)[0]:null}},Mn=class extends eo{draw(e,n){}getDataPointPosition(e,n,r){if(n<0||n>=e.data.length)return;let i=e.data[n];if(!e.accessors.data?.x||!e.accessors.data?.y)throw new Error("Can't get dataPointPosition");return{x:r.x.convert(e.accessors.data.x(i,n,e.data,e)),y:r.y.convert(e.accessors.data.y(i,n,e.data,e))}}getDataPointIndex(e,n,r){if((0,I.default)(n.x))return Yt;let i=xt.getClosestIndex(e.data,(o,s)=>e.accessors.data?.x?.(o,s,e.data,e),n.x);if((0,I.default)(i))throw new Error("Unable to get data point index");return i}},Yy=(()=>{class t extends Mn{config;constructor(n={}){super(n),this.config=n,this.config=(0,ae.default)(this.config,this.DEFAULT_CONFIG)}static THICK=11;static THIN=3;static MIN_BAR_SIZE_FOR_ICON=10;static MIN_BAR_THICKNESS=2;static BAR_RECT_CLASS="bar";DEFAULT_CONFIG={transitionDuration:300,padding:1,barClass:"bar-outline",highlightStrategy:void 0,pointerEvents:!0,enableMinBarThickness:!0};barContainerClass="bar-container";draw(n,r){let i=n.containers[X.data],o=n.dataSeries,s=o.accessors,a=this.getAttrsGenerator(o,n.scales),u=Un(),c=i.selectAll(`g.${this.barContainerClass}`).data(o.data);c.exit().remove();let l=c.enter().append("g").classed(this.barContainerClass,!0);l.append("rect").on("click",(h,d)=>{this.emitBarClick(n,h,d,r)});let f=(h,d)=>typeof s.data?.cssClass<"u"&&" "+s.data.cssClass(h,d,o.data,o)||"";l.merge(c).property(u,(h,d)=>a(h,d)).select("rect").attr("class",(h,d)=>`${t.BAR_RECT_CLASS} ${this.config.barClass}${this.config.pointerEvents?" pointer-events":""}`+f(h,d)).style("cursor",this.config.cursor??"").style("stroke-width",this.config?.strokeWidth??"").style("fill",(h,d)=>s.data.color?s.data.color(h,d,o.data,o):s.series.color?.(o.id,o)).attrs(function(){return u.get(this)}).select("rect").style("fill",(h,d)=>s.data.color?s.data.color(h,d,o.data,o):s.series.color?.(o.id,o)).attrs(u.get),s.data.marker&&(l.append("g").classed("bar-icon",!0),l.merge(c).select("g.bar-icon").html(function(h,d){let g=u.get(this);if(!g||(0,I.default)(g?.height)||(0,I.default)(g?.width))throw new Error("barSize is undefined");if(Math.min(g.height,g.width)-1>=t.MIN_BAR_SIZE_FOR_ICON)return s.data.marker?.(h,d,o.data,o)}).attr("transform",function(){let h=u.get(this);if(!h||(0,I.default)(h?.height)||(0,I.default)(h?.width))throw new Error("barAttrs is undefined");return`translate(${h.x+h.width/2}, ${h.y+h.height/2})`}))}getDataPointIndex(n,r,i){return this.config.highlightStrategy?this.config.highlightStrategy.getDataPointIndex(this,n,r,i):Yt}highlightDataPoint(n,r,i){this.config.highlightStrategy&&this.config.highlightStrategy.highlightDataPoint(this,n,r,i)}getDataPointPosition(n,r,i){let o=n.data[r];return o&&this.getAttrsGenerator(n,i)(o,r)}getDataPoint(n,r,i){return{seriesId:n.dataSeries.id,dataSeries:n.dataSeries,index:i,data:r,position:r?this.getDataPointPosition(n.dataSeries,i,n.scales):void 0}}filterDataByDomain(n){return n}getDomain(n,r,i,o){let s=r.accessors.data,a=i.toUpperCase(),u=c=>(l,f,h)=>s[c+a]?.(l,f,Array.from(h),r);if(o.isContinuous())return!n||n.length===0?En:[de(n,u("start")),he(n,u("end"))];{let c=n&&n.length>0?n.map(u("start")):[],l=Math.max(...c.map(f=>(0,ue.default)(f)?f.length:-1));return l>=0?Array.from(Array(l)).map((f,h)=>{let d=c.map(g=>h<g.length?g[h]:[]);return(0,Er.default)((0,mo.default)(d))}):[(0,Er.default)(c)]}}emitBarClick(n,r,i,o){o.next({eventName:ad,data:this.getDataPoint(n,r,i)})}getAttrsGenerator(n,r){let i=n.accessors.data;return(o,s)=>{let a=this.getDimensions(i,o,s,n,r.x,"X"),u=this.getDimensions(i,o,s,n,r.y,"Y");return{x:a.start,width:a.thickness,y:u.start,height:u.thickness}}}getDimensions(n,r,i,o,s,a){let u,c,l=n["thickness"+a],f=o.accessors.data["start"+a],h=o.accessors.data["end"+a];if(c=l?.(r,i,o.data,o),(0,I.default)(c)){if(!f||!h)throw new Error("Can't compute dimensions");let d=Cr(s,f(r,i,o.data,o),0),g=Cr(s,h(r,i,o.data,o),1);if(u=Math.min(d,g),c=Math.abs(d-g),Br(s)){if((0,I.default)(this.config.padding))throw new Error("Config is not defined");u+=this.config.padding,c-=this.config.padding*2}this.config.enableMinBarThickness&&(c=Math.max(c,t.MIN_BAR_THICKNESS))}else{if(!f)throw new Error("Can't compute dimensions");u=Cr(s,f(r,i,o.data,o),.5)-c/2}return{start:u,thickness:c}}}return t})(),aa={stateStyles:{[V.default]:{opacity:0},[V.hidden]:{opacity:0},[V.deemphasized]:{opacity:0},[V.emphasized]:{opacity:1}},ignoreForDomainCalculation:!0},nO={stateStyles:{[V.default]:{opacity:.3},[V.hidden]:{opacity:0},[V.deemphasized]:{opacity:0},[V.emphasized]:{opacity:1}},ignoreForDomainCalculation:!0},po={enabled:!1,clickable:!1};var pa=class{data={x:e=>e.x,y:e=>e.y}},ma=class extends pa{colorProvider;markerProvider;series;constructor(e=zr(),n=yo()){super(),this.colorProvider=e,this.markerProvider=n,this.data.defined=(r,i)=>r.hasOwnProperty("defined")?r.defined:!0,this.series={color:this.colorProvider?this.colorProvider.get:void 0,marker:this.markerProvider?this.markerProvider.get:void 0}}};function Rh(t,e){let n=t.range().map(o=>o),r=Math.min(n[0],n[1]),i=Math.max(n[0],n[1]);return e>=r&&e<=i}var xd=(()=>{class t{static DEFAULT_MARKER_CONTAINER_CLASS="marker";static MARKER_PATH_CLASS="marker-path";static manageMarker(n,r,i,o,s,a=po){if(!o)throw new Error("Container doesn't exist!");if(n.data.length===0){t.removeMarker(o);return}let u=n.accessors;i<0&&(i=n.data.length-1);let c=n.data[i];if(!u.data?.x||!u.data.y)throw new Error("Color or marker are undefined");let l=r.x.convert(u.data.x(c,i,n.data,n)),f=r.y.convert(u.data.y(c,i,n.data,n));if(typeof l<"u"&&typeof f<"u"&&Rh(r.x,l)&&Rh(r.y,f)){let h=n.id,d={index:i,data:c,seriesId:h,position:{x:l,y:f},dataSeries:n};if(!u.series?.marker||!u.series?.color)throw new Error("Color or marker are undefined");t.drawMarker(d,u.series.marker(h,n),u.series.color(h,n),o,s,t.DEFAULT_MARKER_CONTAINER_CLASS,a)}else t.removeMarker(o)}static drawMarker(n,r,i,o,s,a=t.DEFAULT_MARKER_CONTAINER_CLASS,u=po){let c=o.select(`g.${a}`),l=n?.position?.x,f=n?.position?.y,h={transform:`translate(${l}, ${f})`,cursor:"crosshair"},d=()=>`${u.enabled?" pointer-events":""}`,g=()=>`${u.enabled&&u.clickable?" pointer-events-click":""}`;c.empty()&&(c=o.append("g").classed(`${a}${d()}${g()}`,!0)),r.setColor(i),c.attrs(h),c.on("mouseenter",()=>{s.next({eventName:oa,data:{interactionType:W.Hover,dataPoint:n}})}),c.on("mouseleave",()=>{s.next({eventName:oa,data:{interactionType:W.Hover,dataPoint:Xt(Wt({},n),{index:Yt})}})}),c.on("click",()=>{s.next({eventName:oa,data:{interactionType:W.Click,dataPoint:n}})}),!c.selectAll("g > *").size()&&c.node()&&(c.node()?.appendChild(du.getSvgFromString(r.getSvg())),c.select("path").classed(t.MARKER_PATH_CLASS,!0));let m=c.select("path").node();if(m&&u.enabled){let p=m.getBoundingClientRect();m.setAttribute("x",Math.ceil(n?.position?.x-p.width/2).toString()),m.setAttribute("y",Math.ceil(n?.position?.y-p.height/2).toString())}}static removeMarker(n,r=t.DEFAULT_MARKER_CONTAINER_CLASS){n.select(`g.${r}`).remove()}}return t})(),Ph=(()=>{class t extends Mn{config;static UNCLIPPED_DATA_LAYER_NAME="unclipped-data";static LINE_CAP_CLASS_NAME="nui-chart-line-cap";static getStrokeStyleDashed(n){let r=n*2;return`${r},${r}`}static getStrokeStyleDotted(n){return`${n},${n}`}DEFAULT_CONFIG={strokeWidth:2,curveType:fe,interactive:!0,strokeStyle:"",strokeLinecap:"round",markerInteraction:po,useEnhancedLineCaps:!1,enhancedLineCap:{radius:3}};constructor(n={}){super(n),this.config=n,this.config=(0,ae.default)(this.config,this.DEFAULT_CONFIG)}draw(n,r){let i=n.containers[X.data],o=n.dataSeries.accessors.series.color?.(n.dataSeries.id,n.dataSeries),s=i.select("path.main");s.empty()&&(s=i.append("path").classed("main",!0).attrs({stroke:o??null,"stroke-width":this.config.strokeWidth??null,"stroke-dasharray":this.config.strokeStyle??null,"stroke-linecap":this.config.strokeLinecap??null,fill:"none"})),this.drawLine(n,s),this.config.interactionStrategy&&this.config.interactionStrategy.draw(this,n,r)}isInfiniteLineData(n){let r=n.dataSeries;return r.data.length===1&&typeof r.accessors.data.x(r.data[0],0,r.data,r)>"u"}drawLine(n,r){this.isInfiniteLineData(n)?this.drawInfiniteLine(n,r):this.drawStandardLine(n,r)}highlightDataPoint(n,r,i){if(!this.config.interactive)return;let o=n.dataSeries;o.accessors.series.marker&&xd.manageMarker(o,n.scales,r,n.containers[X.foreground],i,this.config.markerInteraction)}getRequiredLayers(){return[Ut[X.data],Ut[X.foreground],Ut[X.unclippedData]]}getDataPointPosition(n,r,i){return super.getDataPointPosition(n,r,i)}drawStandardLine(n,r){let i=n.dataSeries,o=i.accessors,s=!1,a=i.data.filter((c,l)=>{let f=typeof o.data.x(c,l,i.data,i)<"u"&&typeof o.data.y(c,l,i.data,i)<"u";return!f&&!s&&(console.warn("Data point",c,"was skipped as accessors didn't manage to extract any data."),console.warn(" -> accessors.data.x:",o.data.x),console.warn(" -> accessors.data.y:",o.data.y),s=!0),f});if(!this.config.curveType)throw new Error("curveType is not defined");let u=sn().x((c,l)=>n.scales.x.convert(o.data.x(c,l,i.data,i))).y((c,l)=>n.scales.y.convert(o.data.y(c,l,i.data,i))).defined((c,l)=>o.data.defined?o.data.defined(c,l,i.data,i):!0).curve(this.config.curveType);r.attr("d",u(a)??""),this.config.useEnhancedLineCaps&&this.updateLineCaps(a,n,this.config.enhancedLineCap?.fill||r.attr("stroke"))}drawInfiniteLine(n,r){let i=n.dataSeries,o=i.accessors,s=n.scales.y.convert(o.data.y(i.data[0],0,i.data,i)),a=[[n.scales.x.range()[0],s],[n.scales.x.range()[1],s]],c=sn().x(l=>l[0]).y(l=>l[1])(a);if(!c)throw new Error("Line cannot be computed");r.attr("shape-rendering","crispEdges").attr("d",c)}updateLineCaps(n,r,i){let o=r.dataSeries,s=o.accessors,a=n.filter((f,h)=>s?.data?.defined?s?.data?.defined(f,h,o.data,o):!0),u=(f,h)=>r.scales.x.convert(s.data.x(f,h,o.data,o)),c=(f,h)=>r.scales.y.convert(s.data.y(f,h,o.data,o)),l=r.containers[X.unclippedData].selectAll(`.${t.LINE_CAP_CLASS_NAME}`).data(a).attr("cx",u).attr("cy",c);l.enter().append("circle").attr("class",t.LINE_CAP_CLASS_NAME).attr("r",this.config.enhancedLineCap?.radius).attr("cx",u).attr("cy",c).style("stroke-width",this.config.enhancedLineCap?.strokeWidth).style("fill",i).style("stroke",this.config.enhancedLineCap?.stroke),l.exit().remove()}}return t})(),za=function(t){return t.Grayscale="grayscale",t}(za||{}),qy=`url("#${za.Grayscale}")`,Gy=`
0.2126 0.7152 0.0722 0 0
0.2126 0.7152 0.0722 0 0
0.2126 0.7152 0.0722 0 0
0      0      0      1 0
`,ga=class{data;series;constructor(){this.data={active:e=>e.active},this.series={start:()=>null,end:()=>null,activeColor:()=>"magenta"}}},Wy=(()=>{class t extends Mn{static SIDE_INDICATORS_LAYER="side-indicators";DEFAULT_CONFIG={};constructor(n={}){super(n),this.config=(0,ae.default)(this.config,this.DEFAULT_CONFIG)}draw(n,r){let i=n.containers[X.unclippedData],o=n.dataSeries,s=n.scales,a=n.dataSeries.accessors,u=i.select("rect"),c=o.data.length>0?a.data.active(o.data[0],0,n.dataSeries.data,n.dataSeries):!1,l=!c&&a.series.inactiveColor?a.series.inactiveColor:a.series.activeColor;u.empty()&&(u=i.append("rect").attrs({fill:l(o.id,o)}),!c&&!a.series.inactiveColor&&u.style("filter",qy));let f=a.series.start(o.id,o),h=a.series.end(o.id,o),d=h==null?0:s.y.convert(h),m=(f==null?s.y.range()[0]:Math.min(s.y.range()[0],s.y.convert(f)))-d,p=2;u.attrs({x:-p,y:d,height:m<0?0:m,width:p})}getDataPointIndex(n,r,i){return-1}getRequiredLayers(){return[Ut[X.unclippedData]]}}return t})(),Xy=(()=>{class t{loggerService;static SERIES_ID_SUFFIX="__thresholds-background";constructor(n){this.loggerService=n}injectThresholdsData(n,r){let i={};r.forEach(o=>o.entered=!1);for(let o=0;o<n.data.length;o++){let s=n.data[o],a=n.accessors.data.x(s,o,n.data,n),u=n.accessors.data.y(s,o,n.data,n);s.__thresholds={};let c=this.getZoneByXY(r,i,a,u);c&&(c.entered=!0,s.__thresholds.status=c.value)}}getBackgrounds(n,r,i,o,s={},a=(0,Qe.default)(aa)){n.data.length>0&&typeof n.data[0].__thresholds>"u"&&this.loggerService.warn("Thresholds metadata is not defined on provided data series",n);let u,c=Uy(o);return c.data.thickness=l=>s[l.status],Br(i.x)?(u=(0,Qe.default)(n.data),c.data.start=n.accessors.data.x,c.data.end=n.accessors.data.x,c.data.color=l=>l.__thresholds&&l.__thresholds.status?o.get(l.__thresholds.status):"transparent",c.data.thickness=l=>s[l.__thresholds.status]):u=this.getBackgroundsDataForContinuousScale(n,r),{id:n.id+t.SERIES_ID_SUFFIX,data:u,accessors:c,scales:i,renderer:new Yy(a),showInLegend:!1}}getBackgroundsDataForContinuousScale(n,r){let i=[],o=this.getBreakPoints(n,r),s={};for(let a=0;a<o.length-1;a++){let u=o[a],c=o[a+1];if(!u||!c)throw new Error("p1 or p2 are undefined");let l={x:(u.x+c.x)/2,y:(u.y+c.y)/2},f=this.getZoneByXY(r,s,l.x,l.y);if(f){let h=i[i.length-1];h&&h.end?.valueOf()===u.x&&h.status===f.value?h.end=new Date(c.x):i.push({status:f.value,start:new Date(u.x),end:new Date(c.x)})}}return i}getBreakPoints(n,r){let i=n.accessors.data,o=[];for(let s=0;s<n.data.length-1;s++){let a=n.data[s],u=n.data[s+1],c={x:i.x(a,s,n.data,n).valueOf(),y:i.y(a,s,n.data,n).valueOf()},l={x:i.x(u,s+1,n.data,n).valueOf(),y:i.y(u,s+1,n.data,n).valueOf()};for(let f=0;f<r.length;f++){let h=r[f],d=h.accessors.data.start?.(h.data[0],0,h.data,h),g=h.accessors.data.end?.(h.data[0],0,h.data,h),m=[d,g].map(p=>this.getCrossPointWithY(c,l,p)).filter(p=>p);[c,l].forEach(p=>{(p.y===d||p.y===g)&&(p.isZoneEdge=!0)}),o=(0,Xh.default)(o,m,[c,l],(p,v)=>p?.x===v?.x&&p?.isZoneEdge===v?.isZoneEdge)}}return(0,Wh.default)(o,"x")}getThresholdZones(n,r,i){let o=new co;return o.data.start=s=>s.start,o.data.end=s=>s.end,o.series.color=(s,a)=>i.get(a.value),r.map((s,a)=>({id:n.id+"__"+s.status+"-"+a,value:s.status,data:[{start:s.start,end:s.end}],scales:n.scales,accessors:o}))}getThresholdLines(n){if(n.findIndex(o=>o.entered)===-1)return[];let r={};function i(o,s,a){let u=o(s.data[0],0,s.data,s);typeof u<"u"&&typeof r[u]>"u"&&(r[u]={series:s,accessor:o,zoneBoundary:a})}for(let o of n)o.accessors.data.start&&o.accessors.data.end&&(i(o.accessors.data.start,o,Zi.Start),i(o.accessors.data.end,o,Zi.End));return(0,Fr.default)(r).map(o=>this.getThresholdLine(o.series,o.accessor,o.zoneBoundary))}getThresholdLine(n,r,i=Zi.Start){let o=new ma;o.data.y=r,o.series.color=n.accessors.series.color;let s=new Ph({interactive:!1,strokeWidth:1,strokeStyle:Ph.getStrokeStyleDashed(1),stateStyles:(0,Qe.default)(aa.stateStyles),ignoreForDomainCalculation:!0});return{id:`${n.id}__${i}__threshold-line`,data:n.data,value:n.value,accessors:o,renderer:s,scales:n.scales,showInLegend:!1}}getCrossPoint(n,r,i,o){let s={x:r.x-n.x,y:r.y-n.y},a={x:o.x-i.x,y:o.y-i.y},u=(-s.y*(n.x-i.x)+s.x*(n.y-i.y))/(-a.x*s.y+s.x*a.y),c=(a.x*(n.y-i.y)-a.y*(n.x-i.x))/(-a.x*s.y+s.x*a.y);if(u>=0&&u<=1&&c>=0&&c<=1)return{x:n.x+c*s.x,y:n.y+c*s.y}}getZoneByXY(n,r,i,o){for(let s of n){r[s.id]||(r[s.id]=0);let a=this.moveZoneIndex(r[s.id],s,i);r[s.id]=a;let u=s.data[a],c=s.accessors.data,l=c.start?.(u,a,s.data,s),f=c.end?.(u,a,s.data,s);if((typeof l>"u"||o>=l)&&(typeof f>"u"||o<=f))return s}return null}moveZoneIndex(n,r,i){for(;n<r.data.length-1&&r.accessors.data.x(r.data[n+1],n+1,r.data,r)<i;)n++;return n}getCrossPointWithY(n,r,i){return this.getCrossPoint(n,r,{x:n.x,y:i},{x:r.x,y:i})}getSideIndicators(n,r,i){let o=[],s=new Wy(i||(0,Qe.default)(aa)),a=n.findIndex(u=>u.entered)!==-1;for(let u of n){let c=new ga;c.series={start:()=>u.accessors.data.start?.(u.data[0],0,u.data,u),end:()=>u.accessors.data.end?.(u.data[0],0,u.data,u),activeColor:()=>u.accessors.series.color?.(u.id,u)};let l={id:u.id+"__side-indicator",data:[{active:a}],accessors:c,scales:r,renderer:s,showInLegend:!1};o.push(l)}return o}static \u0275fac=function(r){return new(r||t)(Xa(hu))};static \u0275prov=Vr({token:t,factory:t.\u0275fac})}return t})(),rO=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ka({type:t});static \u0275inj=Ga({providers:[fd,Xy],imports:[pu,mu,gu,lu]})}return t})();var Ha=function(t){return t[t.Small=3]="Small",t[t.Large=4]="Large",t}(Ha||{});function $a(t,e){if(!e||e.length===0)return;if(!(0,ue.default)(e[0])){t.domain(e);return}if(t.domain(e[0]),!Ny(t))return;$a(t.innerScale,e.slice(1))}var xa=class{chart;_chartSeriesSet=[];dataIndex={};_scalesIndexByKey={};_scalesIndexById={};get chartSeriesSet(){return this._chartSeriesSet}get scalesIndexByKey(){return this._scalesIndexByKey}get scalesIndexById(){return this._scalesIndexById}constructor(e){this.chart=e}update(e){let n=(0,td.default)(e.map(r=>r.id),(r,i,o)=>(0,ed.default)(o,r,i+1));n.length>0&&console.warn("Series set contains duplicate IDs:",n),this._chartSeriesSet=e||[],this.dataIndex=(0,to.default)(this._chartSeriesSet,r=>r.id),this._scalesIndexByKey=this.buildScalesIndex(this._chartSeriesSet),this._scalesIndexById=(0,to.default)((0,mo.default)((0,Fr.default)(this._scalesIndexByKey).map(r=>r.list)),r=>r.id)}getChartSeries(e){return this.dataIndex[e]}updateScaleDomain(e,n){if(!e.isDomainFixed&&e.domainCalculator){let r=this.chartSeriesSet.filter(i=>i.scales[n]===e&&!i.renderer.config.ignoreForDomainCalculation).filter(i=>i.renderState!==V.hidden);if(r.length||this.chart?.configuration?.updateDomainForEmptySeries){let i=e.domainCalculator(r,n,e);$a(e,i)}}}buildScalesIndex(e){let n={};return(0,Z.default)(e,r=>{(0,Z.default)(Object.keys(r.scales),i=>{let o=r.scales[i],s=n[i];s||(s={index:{},list:[]},n[i]=s),s.index[o.id]||(s.index[o.id]=o,s.list.push(o))})}),n}updateScaleDomains(){(0,Z.default)(Object.keys(this._scalesIndexByKey),e=>{(0,Z.default)(this._scalesIndexByKey[e].list,n=>{this.updateScaleDomain(n,e)})})}},va=class{lasagna;dataManager;interactionDataPointsSubject=new ht;rendererSubject=new ht;highlightDataPointSubscription;highlightedDataPoints={};renderLayers={};layerIndex={};constructor(e,n){this.lasagna=e,this.dataManager=n,this.highlightDataPointSubscription=this.rendererSubject.subscribe(r=>{r.eventName===ca&&this.highlightDataPoint(r.data.seriesId,r.data.index)})}update(){let e={};(0,Z.default)(this.dataManager.chartSeriesSet,n=>{let r=this.getSeriesChildContainers(n.id);Object.values(n.scales).findIndex(o=>{if(typeof e[o.id]>"u"){let s=o.isDomainValid();s||console.warn("Invalid scale domain detected for scale:",o),e[o.id]=s}return!e[o.id]})===-1&&n.renderer.draw({dataSeries:n,containers:r,scales:n.scales},this.rendererSubject)})}updateSeriesContainers(){this.layerIndex=this.buildLayerIndex(this.dataManager.chartSeriesSet),this.removeUnusedLayers(),this.addNeededLayers(),this.updateLayerContents()}emitInteractionDataPoints(e){let n=!1,r=this.dataManager.chartSeriesSet.reduce((i,o)=>{let s={};(0,Z.default)(Object.keys(e.values),l=>{let f=o.scales[l].id;s[l]=xt.getInteractionValues(e.values[l],f)});let a=Yt;o.data&&o.data.length>0&&(a=o.renderer.getDataPointIndex(o,s,o.scales));let u=o.renderer.getDataPointPosition(o,a,o.scales),c={seriesId:o.id,dataSeries:o,index:a,data:a>=0?o.data[a]:null,position:u};if(e.interactionType===W.MouseMove){let l=this.highlightedDataPoints[o.id];!(0,I.default)(a)&&((0,I.default)(l)||a===Yt||a!==l.index)&&(n=!0,this.rendererSubject.next({eventName:ca,data:c}))}return i[o.id]=c,i},{});(e.interactionType!==W.MouseMove||n)&&this.interactionDataPointsSubject.next({interactionType:e.interactionType,dataPoints:r}),n&&(this.highlightedDataPoints=r)}highlightDataPoint(e,n){let r=this.getSeriesChildContainers(e),i=this.dataManager.getChartSeries(e),o={dataSeries:i,containers:r,scales:i.scales,parentContainer:this.renderLayers.data};i.renderer.highlightDataPoint(o,n,this.rendererSubject)}setSeriesStates(e){(0,Z.default)(e,({seriesId:n,state:r})=>{let i=this.dataManager.getChartSeries(n);if(!i)return;let o=this.getSeriesChildContainers(n),s=i.renderer.getContainerStateStyles(r);(0,Z.default)((0,Fr.default)(o),a=>{a.attrs(s)}),i.renderer.setSeriesState(o,r)})}destroy(){this.highlightDataPointSubscription&&this.highlightDataPointSubscription.unsubscribe(),this.rendererSubject&&this.rendererSubject.complete()}buildLayerIndex(e){let n={};return(0,Z.default)(e,r=>{(0,Z.default)(r.renderer.getRequiredLayers(),i=>{if(Ut[i.name]&&!(0,Ra.default)(Ut[i.name],i))throw new Error(`Custom definition detected for render layer "${i.name}". Custom layers must use a name not already taken by the predefined layer set.`);let o=n[i.name];o||(o={seriesUsing:[],layerDefinition:i},n[i.name]=o),o.seriesUsing.push(r)})}),n}removeUnusedLayers(){(0,Z.default)(Object.keys(this.renderLayers),e=>{this.layerIndex[e]||(this.lasagna.removeLayer(e),delete this.renderLayers[e])})}addNeededLayers(){(0,Z.default)(this.layerIndex,e=>{this.renderLayers[e.layerDefinition.name]||(this.renderLayers[e.layerDefinition.name]=this.lasagna.addLayer(e.layerDefinition))})}updateLayerContents(){(0,Z.default)(Object.keys(this.renderLayers),e=>{let r=this.renderLayers[e].selectAll("g.data-series-container").data(this.layerIndex[e].seriesUsing,i=>i.id).order();r.enter().append("g").attrs({id:i=>this.getChildContainerId(e,i.id),class:"data-series-container"}),r.exit().remove()})}getSeriesChildContainers(e){let n={};return(0,Z.default)(Object.keys(this.renderLayers),r=>{let i=this.renderLayers[r];n[r]=i.selectAll(`#${r}-${xt.cssEscape(e)}`)}),n}getChildContainerId(e,n){return e+"-"+n}},ya=class extends se{renderEngine;isChartInView=!0;lastInteractionValuesPayload;destroy$=new ht;initialize(){this.renderEngine=this.chart.getRenderEngine(),this.chart.getEventBus().getStream(Ze).pipe(tt(this.destroy$)).subscribe(e=>{this.lastInteractionValuesPayload=e.data,this.isChartInView&&this.chart.getRenderEngine().emitInteractionDataPoints(this.lastInteractionValuesPayload)}),this.renderEngine.interactionDataPointsSubject.pipe(tt(this.destroy$)).subscribe(e=>{this.chart.getEventBus().getStream(Tr).next({data:e})}),this.renderEngine.rendererSubject.pipe(tt(this.destroy$)).subscribe(e=>{this.chart.getEventBus().getStream(e.eventName).next({data:e.data})}),this.chart.getEventBus().getStream(vo).pipe(tt(this.destroy$)).subscribe(e=>{this.isChartInView=e.data.isChartInView,this.isChartInView&&this.lastInteractionValuesPayload&&this.chart.getRenderEngine().emitInteractionDataPoints(this.lastInteractionValuesPayload)})}update(){this.renderEngine.updateSeriesContainers(),this.renderEngine.update()}updateDimensions(){this.renderEngine.update()}destroy(){this.renderEngine.destroy(),this.destroy$.next(),this.destroy$.complete()}},ba=class{grid;configuration;eventBus=new ro;element;target;filterDefs;dataManager;renderEngine;updateSubject=new tn([]);updateDimensionsSubject=new ht;seriesStatesSubject=new tn([]);plugins=[];constructor(e,n){if(this.grid=e,this.configuration=n,!e)throw new Error("Grid has to be defined!");e.updateChartDimensionsSubject=this.updateDimensionsSubject,e.eventBus=this.eventBus}getEventBus(){return this.eventBus}getDataManager(){return this.dataManager}getRenderEngine(){return this.renderEngine}getGrid(){return this.grid}addPlugin(e){e.chart=this,this.plugins.push(e)}removePlugin(e){let n=this.plugins.findIndex(r=>r instanceof e);n!==-1&&(this.plugins[n].destroy(),this.plugins.splice(n,1))}addPlugins(...e){for(let n of e)this.addPlugin(n)}removePlugins(...e){for(let n of e)this.removePlugin(n)}hasPlugin(e){return this.plugins.findIndex(n=>n instanceof e)!==-1}build(e){this.element=e,this.target=O(this.element).append("svg").attrs({class:"nui-chart",height:"100%",width:"100%"}),this.configureCssFilters(),this.buildGrid(),this.dataManager=this.buildDataManager(),this.renderEngine=this.buildRenderEngine(this.grid.getLasagna(),this.dataManager);let n=new ya;n.chart=this,this.plugins.unshift(n);for(let i of this.getGrid().buildPlugins(this))this.addPlugin(i);this.initialize();let r=()=>tt(this.getEventBus().getStream(Dr));this.updateSubject.pipe(r()).subscribe(i=>this.onUpdate(i)),this.updateDimensionsSubject.pipe(r()).subscribe(()=>this.onUpdateDimensions()),this.seriesStatesSubject.pipe(r()).subscribe(i=>this.onSetSeriesStates(i))}configureCssFilters(){this.filterDefs=this.target?.append("defs"),this.filterDefs?.append("filter").attr("id",za.Grayscale).append("feColorMatrix").attr("type","matrix").attr("values",Gy)}buildDataManager(){return new xa(this)}buildGrid(){this.target&&(this.grid.target(this.target),this.grid.build(),this.updateTargetDimensions(this.grid.config().dimension))}buildRenderEngine(e,n){return new va(e,n)}update(e){this.updateSubject.next(e)}updateDimensions(){this.updateDimensionsSubject.next()}initialize(){(0,Z.default)(this.plugins,e=>{e.initialize()})}destroy(){this.eventBus.getStream(Dr).next({data:null}),this.eventBus.destroy(),this.plugins.forEach(e=>e.destroy()),this.target?.remove(),this.target=void 0}setSeriesStates(e){this.seriesStatesSubject.next(e),this.eventBus.getStream(cd).next({data:e})}onUpdate(e){this.dataManager.update(e),this.grid.scales=this.dataManager.scalesIndexByKey,this.dataManager.updateScaleDomains(),this.grid.updateRanges(),this.plugins.forEach(n=>n.update())}onUpdateDimensions(){let e=this.grid.config().dimension;this.updateTargetDimensions(e);let n={};e.autoHeight&&(n.height=this.element.clientHeight),e.autoWidth&&(n.width=this.element.clientWidth),this.grid.updateDimensions(n),this.plugins.forEach(r=>r.updateDimensions())}updateTargetDimensions(e){e.autoHeight||this.target?.style("height",e.outerHeight()+"px"),e.autoWidth||this.target?.style("width",e.outerWidth()+"px")}onSetSeriesStates(e){this.renderEngine.setSeriesStates(e)}},Ke=function(t){return t.ToggleSeries="ToggleSeries",t.ResetVisibleSeries="ResetVisibleSeries",t.EmphasizeSeries="EmphasizeSeries",t}(Ke||{}),Ar=class{seriesId;series;emphasisState;visible;constructor(e,n,r=V.default,i=!0){this.seriesId=e,this.series=n,this.emphasisState=r,this.visible=i}get state(){return this.visible?this.emphasisState:V.hidden}},wa=class t{chart;palette;markers;static getLabel(e,n,r,i,o){if(!n||e.data.length===0)return null;let s=e.accessors.data?.[o||r];if(!s)return null;let a=n.index<0?e.data.length-1:n.index,u=e.data[a],c=s(u,a,e.data,e),l=e.scales[r];if(!l||!i)return c;let f=l.formatters[i];return f?f(c):c}highlightedDataPoints;isLegendActive=!1;inputSeriesSet=[];legendSeriesSet=[];chartAssistSubject=new ht;syncHandlerMap;getVisibleSeriesWithLegendBackup;syncSubscription;legendInteractionAssist;onEvent;constructor(e,n,r=Vy(),i=yo()){this.chart=e,this.palette=r,this.markers=i,this.configureChartEventSubscriptions(e.getEventBus()),n&&(this.seriesProcessor=n),this.legendInteractionAssist=new _a(this),this.syncHandlerMap={[Ke.EmphasizeSeries]:this.emphasizeSeries,[Ke.ResetVisibleSeries]:this.resetVisibleSeries,[Ke.ToggleSeries]:this.toggleSeries}}get renderStatesIndex(){return this.legendInteractionAssist.renderStatesIndex}legendLabelData$(e){let n=this.chart.getEventBus().getStream(Tr).asObservable().pipe(Ua(i=>i.data.interactionType===W.MouseMove),Va(i=>i.data.dataPoints[e.id])),r=i=>i&&i.index>=0;return n.pipe(Ya(i=>r(i)?bo(i.data):bo(e.data&&e.data.length?e.data[e.data.length-1]:null)))}seriesProcessor(e){return e}update(e,n=!0){this.inputSeriesSet=e;let r=this.seriesProcessor(e.map(o=>Xt(Wt({},o),{data:o.data||[]})));this.legendSeriesSet=r.filter(o=>o.showInLegend||typeof o.showInLegend>"u"),n&&this.legendInteractionAssist.update(r);let i=r.map(o=>Object.assign({renderState:this.renderStatesIndex[o.id]?.state},o));this.chart.update(i),this.publishRenderStates()}toggleSeries=(e,n)=>{this.legendInteractionAssist.setGroupVisibility(e,n),this.update(this.inputSeriesSet,!1),this.chartAssistSubject.next({type:Ke.ToggleSeries,payload:{seriesId:e,visible:n}})};resetVisibleSeries=()=>{this.legendInteractionAssist.resetSeries(),this.publishRenderStates(),this.chartAssistSubject.next({type:Ke.ResetVisibleSeries,payload:{}})};emphasizeSeries=e=>{this.legendInteractionAssist.emphasizeSeries(e),this.publishRenderStates(),this.chartAssistSubject.next({type:Ke.EmphasizeSeries,payload:{seriesId:e}})};isSeriesHidden(e){return this.legendInteractionAssist.isSeriesHidden(e)}seriesTrackByFn(e,n){return n.id}getHighlightedValue(e,n,r,i){if(!this.highlightedDataPoints)return;let o=this.highlightedDataPoints[e.id];return t.getLabel(e,o,n,r,i)}getVisibleSeriesWithLegend=()=>this.legendSeriesSet.filter(e=>!this.isSeriesHidden(e.id));syncWithChartAssist(e){this.getVisibleSeriesWithLegendBackup=this.getVisibleSeriesWithLegend,this.getVisibleSeriesWithLegend=e.getVisibleSeriesWithLegend,this.syncSubscription=e.chartAssistSubject.pipe(tt(e.chart.getEventBus().getStream(Dr))).subscribe(n=>{let r=Object.keys(n.payload).map(i=>n.payload[i]);this.syncHandlerMap[n.type](...r)})}unsyncChartAssist(){this.getVisibleSeriesWithLegend=this.getVisibleSeriesWithLegendBackup,this.syncSubscription&&this.syncSubscription.unsubscribe()}configureChartEventSubscriptions(e){let n={[Tr]:r=>{r.interactionType===W.MouseMove&&(this.highlightedDataPoints=Object.assign({},r.dataPoints))},[Oa]:r=>{r.index>=0?this.emphasizeSeries(r.seriesId):this.resetVisibleSeries()},[Mr]:r=>{this.isLegendActive=r}};(0,Z.default)(Object.keys(n),r=>{e.getStream(r).subscribe(i=>{n[r](i.data),this.onEvent&&this.onEvent(i)})})}publishRenderStates(){this.chart.setSeriesStates(this.legendInteractionAssist.getSeriesStates())}},_a=class{chartAssist;seriesGroups={};seriesIndex;renderStatesIndex={};constructor(e){this.chartAssist=e}update(e){this.seriesGroups=this.getSeriesGroups(e),this.seriesIndex=(0,to.default)(e,n=>n.id),this.resetSeries();for(let n of e.filter(r=>r.renderState))this.renderStatesIndex[n.id]=new Ar(n.id,n,n.renderState===V.hidden?V.default:n.renderState,n.renderState!==V.hidden)}getSeriesStates(){return(0,Fr.default)(this.renderStatesIndex)}isSeriesHidden(e){let n=this.renderStatesIndex[e];return n&&!n.visible}getSeriesGroups(e){let n={};for(let r of e){let i=r.id.indexOf("__"),o=i>=0?r.id.substring(0,i):r.id;n[o]||(n[o]=[]),n[o].push(r.id)}return n}setGroupState(e,n){if(this.seriesGroups[e])for(let r of this.seriesGroups[e])this.setRenderState(r,n)}setGroupVisibility(e,n){if(this.seriesGroups[e])for(let r of this.seriesGroups[e])this.setVisibility(r,n)}emphasizeSeries(e){for(let n of Object.keys(this.seriesGroups))this.setGroupState(n,n===e?V.emphasized:V.deemphasized)}resetSeries(){let e=this.chartAssist.getVisibleSeriesWithLegend();if(e.length===1)this.emphasizeSeries(e[0].id);else for(let r of Object.keys(this.seriesGroups))this.setGroupState(r,V.default)}setRenderState(e,n){let r=this.renderStatesIndex[e];r?r.emphasisState=n:(r=new Ar(e,this.seriesIndex[e],n),this.renderStatesIndex[e]=r)}setVisibility(e,n){let r=this.renderStatesIndex[e];r?r.visible=n:(r=new Ar(e,this.seriesIndex[e],V.default,n),this.renderStatesIndex[e]=r)}},Sa=class{_width=0;_height=0;margin={top:0,right:0,bottom:0,left:0};padding={top:0,right:0,bottom:0,left:0};marginLocked={top:!1,right:!1,bottom:!1,left:!1};autoWidth=!0;autoHeight=!0;width(e){return e===void 0?this._width:(this._width=e,this)}height(e){return e===void 0?this._height:(this._height=e,this)}outerWidth(e){let n=this.margin.right+this.margin.left;return e===void 0?this._width+n:(this._width=Math.max(e-n,0),this)}outerHeight(e){let n=this.margin.top+this.margin.bottom;return e===void 0?this._height+n:(this._height=Math.max(e-n,0),this)}};function jy(t,e){let n=t.text(),r=n.split(""),i=t.text("").append("tspan").attr("class",`${kr} ellipsis`).text("..."),o=t.insert("tspan",":first-child").attr("class",`${kr} text`).text(n),s=e.ellipsisWidth+e.horizontalPadding*2,a=r.length,u=(o?.node()?.getComputedTextLength()||0)+e.horizontalPadding*2;for(;r.length&&(u>e.widthLimit||r[r.length-1]===" ");)r.pop(),o.text(r.join("")),u=s+(o?.node()?.getComputedTextLength()||0);r.length===a&&i.remove()}var An=class{visible=!0;gridTicks=!1;tickSize=5;tickLabel={horizontalPadding:0,overflowHandler:jy};fit=!1;_approximateTicks=5;get approximateTicks(){return this._approximateTicks}set approximateTicks(e){this._approximateTicks=parseInt(e,10)}padding=0},Lr=class{className;color;width;visible=!0;constructor(e){this.className=e}},Rr=class{interactive=!0;dimension=new Sa;borders={top:void 0,bottom:void 0,left:void 0,right:void 0};cursor="crosshair";disableRenderAreaHeightCorrection=!1;disableRenderAreaWidthCorrection=!1},Je=(()=>{class t extends Rr{static DEFAULT_MARGIN={top:0,right:5,bottom:20,left:30};static DEFAULT_PADDING={left:0,right:0,top:5,bottom:5};axis={top:new An,right:new An,bottom:new An,left:new An};interactionPlugins=!0;constructor(){super(),this.dimension.padding=Object.assign({},t.DEFAULT_PADDING),this.dimension.margin=Object.assign({},t.DEFAULT_MARGIN),this.borders.bottom=new Lr("nui-chart-border nui-chart-border--thick"),this.borders.left=new Lr("nui-chart-border nui-chart-border--thick"),this.borders.left.visible=!1,this.axis.left.gridTicks=!0,this.axis.left.tickSize=0,this.axis.left.padding=10,this.axis.right.fit=!0,this.axis.right.tickSize=0,this.axis.right.padding=10,this.axis.bottom.tickLabel.horizontalPadding=5}}return t})();var Ky=(()=>{class t{target;interactiveArea;gridMargin;static CONTAINER_CLASS="mouse-interactive-area";active=new tn(!1);interaction=new tn({type:W.Click,coordinates:{x:0,y:0}});isActive=!1;constructor(n,r,i,o){this.target=n,this.interactiveArea=r,this.gridMargin=o,this.interactiveArea.style("cursor",i).classed(t.CONTAINER_CLASS,!0),this.target.on("mouseover",this.onMouseOver).on("mouseout",this.onMouseOut).on(W.MouseDown,()=>this.onMouseInteraction(W.MouseDown)).on(W.MouseUp,()=>this.onMouseInteraction(W.MouseUp)).on(W.MouseMove,()=>this.onMouseInteraction(W.MouseMove)).on(W.Click,()=>this.onMouseInteraction(W.Click))}onMouseInteraction=n=>{if(k.target.classList.contains(kr))return;let r=0,i=0,o=parseInt(this.interactiveArea.attr("width"),10)||0,s=parseInt(this.interactiveArea.attr("height"),10)||0;if(/firefox/i.test(navigator.userAgent)){let u=r+k.offsetX-(this.gridMargin?.left||0);u=u>o?o:u,r=u<0?0:u;let c=i+k.offsetY-(this.gridMargin?.top||0);c=c>s?s:c,i=c<0?0:c}else{let u=Yn(k.currentTarget),c=u[0]>o?o:u[0];r=c<0?0:c;let l=u[1]>s?s:u[1];i=l<0?0:l}this.interaction.next({type:n,coordinates:{x:r,y:i}})};onMouseOver=()=>{this.isActive||k.target.classList.contains(kr)||(this.isActive=!0,this.active.next(!0))};onMouseOut=()=>{if(!this.isActive)return;let n=k.relatedTarget;for(;n;){if(n===this.target.node())return;n=n.parentNode}this.isActive=!1,this.active.next(!1)};onMouseEnter=()=>{this.onMouseOver()};onMouseLeave=()=>{this.onMouseOut()}}return t})();function Qy(t,e){if(e.isContinuous()){let r=t.filter(s=>s!==En);if(r.length===0)return En;let i=de(r.filter(s=>typeof s[0]<"u").map(s=>s[0])),o=he(r.filter(s=>typeof s[1]<"u").map(s=>s[1]));return[i,o]}let n=Math.max(...t.map(r=>r.length));return Array.from(Array(n)).map((r,i)=>{let o=t.map(s=>i<s.length?s[i]:[]);return(0,Er.default)((0,mo.default)(o))})}function Zy(t,e){return t.reduce((n,r)=>{for(let i of Object.keys(r.scales)){if(i===e)continue;let o=r.scales[i];o.isDomainFixed&&(n[i]||(n[i]=[]),(0,Na.default)(n[i],o)===-1&&n[i].push(o))}return n},{})}var Jy=(t,e,n)=>{let r=Zy(t,e),i=t.map(o=>{let s=Object.keys(r).reduce((a,u)=>{let c=o.scales[u];return c&&c.isContinuous()&&(0,Na.default)(r[u],c)!==-1&&(a[u]=c),a},{});return o.renderer.getDomainOfFilteredData(o,s,e,o.scales[e])});return Qy(i,n)};var Pr=class{id;domainCalculator=Jy;formatters={};isDomainFixed;scaleUnits;isTimeseriesScale=!1;isReversed=!1;_fixDomainValues=[];_d3Scale;constructor(e){this.id=e||xt.uuid(),this._d3Scale=this.createD3Scale()}get d3Scale(){return this._d3Scale}get fixDomainValues(){return this._fixDomainValues}setFixDomainValues(e){e.length>1&&(this.domain([e[0],e[e.length-1]]),this.isDomainFixed=!0),this._fixDomainValues=e}range(e){return e?(this._d3Scale.range(this.isReversed?e.reverse():e),this):this._d3Scale.range()}domain(e){return e?(this._d3Scale.domain(e),this):this._d3Scale.domain()}fixDomain(e){return this.domain(e),this.isDomainFixed=!0,this}isDomainValid(){return this.domain().findIndex(e=>e===void 0)===-1}reverse(){return this.reversed(!this.isReversed)}reversed(e){return typeof e>"u"?this.isReversed:(this.isReversed=e,this)}},Tn=class extends Pr{constructor(e){super(e),this.formatters.tick=n=>n?.toLocaleString()}createD3Scale(){return cr()}convert(e){return this._d3Scale(e)}invert(e){return this._d3Scale.invert(e)}isContinuous(){return!0}isDomainValid(){return this.domain().findIndex(e=>isNaN(e))===-1}},Nr=class extends Pr{innerScale;constructor(e){super(e),this.formatters.tick=n=>{if((0,I.default)(n))throw new Error("Can't format bandFormatScale");return(0,rd.default)(n)}}createD3Scale(){return Be()}convert(e,n=Ba){return this._d3Scale(e)+n*this.bandwidth()}invert(e){let n=this._d3Scale.domain();if(this.range()[0]<this.range()[1]){let r=this.getRangeMidPoints(n.map(this._d3Scale));return n[Dt(r,e)]}else{let r=this.getRangeMidPoints(n.map((i,o)=>this._d3Scale(n[n.length-1-o])));return n[n.length-1-Dt(r,e)]}}range(e){let n=e?super.range(e):super.range();return e&&this.innerScale&&this.innerScale.range([0,this.bandwidth()]),n}round(e){return e?(this._d3Scale.round(e),this):this._d3Scale.round()}padding(e){return this._d3Scale.paddingInner(e),this._d3Scale.paddingOuter(e/2),this}align(e){return e?(this._d3Scale.align(e),this):this._d3Scale.align()}bandwidth(){return this._d3Scale.bandwidth()}step(){return this.domain().length?Math.abs(this.range()[1]-this.range()[0])/this.domain().length:0}copyToLinear(){let e=new Tn;return e.domain(this.range()).range(this.range()),e}bandTicks(){let e=[],n=this.range()[0],r=this.step();for(let i=0;i<=this.domain().length;i++)e.push(n+i*r);return e}isContinuous(){return!1}getRangeMidPoints(e){return e.slice(1).map(n=>n-this._d3Scale.step()*this._d3Scale.paddingInner()/2)}},t1=(t,e,n)=>{let r=(i,o,s)=>{let a=n(i,o,s),u=(0,Qe.default)(s);$a(u,a);let l=e(u.d3Scale).scale().ticks(t.approximateTicks);if(l.length<=1)return a;let f=l[1]-l[0];return l[0]>a[0]&&(a[0]=l[0]-f),l[l.length-1]<a[1]&&(a[1]=l[l.length-1]+f),a};return r.domainWithTicks=!0,r},e1="tick",Sr=(()=>{class t extends se{formatterName;static LAYER_NAME="interaction-label";areLabelUpdatesEnabled=!0;isChartInView=!1;lastInteractionValuesPayload;interactionLabelLayer;destroy$=new ht;elBBox;constructor(n="title"){super(),this.formatterName=n}initialize(){this.interactionLabelLayer=this.chart.getGrid().getLasagna().addLayer({name:t.LAYER_NAME,order:901,clipped:!1}),this.chart.getEventBus().getStream(Ze).pipe(tt(this.destroy$)).subscribe(n=>{if(n.data.values?.y){let r=this.chart.getGrid(),i=Object.keys(n.data.values.y),o=r.scales.y.list[0];if(o.isTimeseriesScale&&!i.includes(o.id))return}this.lastInteractionValuesPayload=n.data,this.isChartInView&&this.handleLabelUpdate()}),this.chart.getEventBus().getStream(vo).pipe(tt(this.destroy$)).subscribe(n=>{this.isChartInView=n.data.isChartInView,this.isChartInView&&this.lastInteractionValuesPayload&&this.handleLabelUpdate()})}handleLabelUpdate(){let n=this.chart.getGrid();if(!(n instanceof Hr))throw new Error(`${t.name} requires XYGrid`);let r=n.scales;if(!this.areLabelUpdatesEnabled||this.lastInteractionValuesPayload.interactionType!==W.MouseMove||(0,gt.default)(r))return;let i=(0,go.default)(r.x.index,{id:n.bottomScaleId});if(!i)throw new Error("xScale is not defined");let o=xt.getInteractionValues(this.lastInteractionValuesPayload.values.x,i.id);this.updateLabel(i,(0,ue.default)(o)?o.slice(0,o.length-1):o)}updateLabel(n,r){let i=this.interactionLabelLayer.select(`.${t.LAYER_NAME}`);if(i.empty()&&r)i=this.buildInteractionLabel(this.interactionLabelLayer);else if(!r){i.remove();return}let s=(n.formatters[this.formatterName]||n.formatters[e1])?.(r);if(!s)throw new Error("labelContent is not defined");let a=i.select("text").text(s);this.elBBox||(this.elBBox=a.node().getBBox());let u=this.chart.getGrid().config().dimension,c=u.height()-this.elBBox.y;a.attr("transform",`translate(0, ${c})`).style("text-anchor","middle");let l=(this.elBBox.height+this.elBBox.y)*2,f=this.elBBox.width+l,h=[f/2,u.width()-f/2],d=Cr(n,r,.5),g=xt.clampToRange(d,h);i.attr("transform",`translate(${g},0)`).select("rect").attrs({transform:`translate(0,${c})`,x:-(f/2),y:this.elBBox.y,width:f,height:this.elBBox.height})}destroy(){this.chart.getGrid().getLasagna().removeLayer(t.LAYER_NAME),this.destroy$.next(),this.destroy$.complete()}buildInteractionLabel(n){let r=n.append("g").attr("class",t.LAYER_NAME);return r.append("rect").attr("class",`${t.LAYER_NAME}__rect`),r.append("text").attr("class",`${t.LAYER_NAME}__text`),r}}return t})(),vd=(()=>{class t extends se{static LAYER_NAME="interaction-line";isChartInView=!1;lastInteractionValuesPayload;interactionLineLayer;destroy$=new ht;initialize(){this.interactionLineLayer=this.chart.getGrid().getLasagna().addLayer({name:"interaction-line",order:900,clipped:!0}),this.chart.getEventBus().getStream(Ze).pipe(tt(this.destroy$)).subscribe(n=>{this.lastInteractionValuesPayload=n.data,this.isChartInView&&this.handleLineUpdate()}),this.chart.getEventBus().getStream(vo).pipe(tt(this.destroy$)).subscribe(n=>{this.isChartInView=n.data.isChartInView,this.isChartInView&&this.lastInteractionValuesPayload&&this.handleLineUpdate()})}handleLineUpdate(){let n=this.chart.getGrid();if(!(n instanceof Hr))throw new Error(`${t.name} requires XYGrid`);let r=n.scales;if(this.lastInteractionValuesPayload.interactionType!==W.MouseMove||(0,gt.default)(r))return;let i=(0,go.default)(r.x.index,{id:n.bottomScaleId});if(!i)throw new Error("xScale is not defined");let o=xt.getInteractionValues(this.lastInteractionValuesPayload.values.x,i.id);this.updateLine(this.interactionLineLayer,i,o)}updateLine(n,r,i){let o=[];i&&o.push(i);let s=n.selectAll(`.${t.LAYER_NAME}`).data(o),a=c=>r.convert(c),u={class:t.LAYER_NAME,x1:a,y1:0,x2:a,y2:this.chart.getGrid().config().dimension.height()};s.enter().append("line").merge(s).attrs(u),s.exit().remove()}destroy(){this.chart.getGrid().getLasagna().removeLayer(t.LAYER_NAME),this.destroy$.next(),this.destroy$.complete()}}return t})(),Ca=class extends se{mouseInteractiveArea;destroy$=new ht;interactionValuesActive=!0;constructor(e){super(),this.mouseInteractiveArea=e}initialize(){this.mouseInteractiveArea.active.pipe(tt(this.destroy$)).subscribe(e=>{this.chart.getEventBus().getStream(Mr).next({data:e})}),this.chart.getEventBus().getStream(Mr).pipe(tt(this.destroy$)).subscribe(e=>{!e.data&&this.chart.getDataManager().chartSeriesSet&&this.highlightReset()}),this.chart.getEventBus().getStream(ua).pipe(tt(this.destroy$)).subscribe(e=>this.interactionValuesActive=e.data),this.mouseInteractiveArea.interaction.pipe(tt(this.destroy$)).subscribe(e=>{let n=this.chart.getGrid().scales;if(!(0,gt.default)(n)){if(this.interactionValuesActive){let r=n.x.list,i=n.y.list,o=e.coordinates.x,s=e.coordinates.y,a=xt.getXYValues(r,i,o,s);this.chart.getEventBus().getStream(Ze).next({data:{interactionType:e.type,values:a}})}this.chart.getEventBus().getStream(xo).next({data:{interactionType:e.type,coordinates:e.coordinates}})}})}update(){this.highlightReset()}updateDimensions(){this.highlightReset()}destroy(){this.destroy$.next(),this.destroy$.complete()}highlightReset(){this.chart.getEventBus().getStream(Ze).next({data:{interactionType:W.MouseMove,values:{}}})}},n1=(()=>{class t{clipPath;static CONTAINER_CLASS="lasagna-container";static LAYER_CLASS="lasagna-layer";layers=[];container;constructor(n,r){this.clipPath=r,this.container=n.append("g").attr("class",`${t.CONTAINER_CLASS} pointer-events`)}addLayer(n){return this.layers=(0,id.default)(this.layers.concat(n),"order"),this.update(),this.getLayerContainer(n.name)}removeLayer(n){let r=this.layers.findIndex(i=>i.name===n);r!==-1&&(this.layers.splice(r,1),this.update())}getLayerContainer(n){return this.container.select(`.${t.LAYER_CLASS}-${n}`)}getContainer(){return this.container}update(){let n=this.container.selectAll(`g.${t.LAYER_CLASS}`).data(this.layers,r=>r.name).order();n.enter().append("g").attrs({class:r=>`${t.LAYER_CLASS} ${t.LAYER_CLASS}-${r.name}`,"clip-path":r=>r.clipped?`url(#${this.clipPath})`:"","pointer-events":"none"}),n.exit().remove()}}return t})(),we=.5,Or=(()=>{class t{static GRID_CLASS_NAME="nui-chart-grid";static DEFAULT_BORDER_CLASS_NAME="nui-chart-border";static RENDERING_AREA_CLIP_PATH_PREFIX="clip-path_";static GRID_ELEMENTS_LAYER_NAME="grid-elements";static RENDERING_AREA_LAYER_NAME="rendering-area";static RENDER_AREA_HEIGHT_CORRECTION=1;static RENDER_AREA_WIDTH_CORRECTION=1;static TICK_DIMENSION_CORRECTION=1;updateChartDimensionsSubject;eventBus;container;renderingAreaClipPath;renderingArea;interactiveArea;lasagna;gridElementsLayer;borders={};_scales;_config;_target;getInteractiveArea(){return this.interactiveArea}getLasagna(){return this.lasagna}set scales(n){this._scales=n}get scales(){return this._scales}config(n){return n===void 0?this._config:(this._config=n,this)}target(n){return n===void 0?this._target:(this._target=n,this)}build(){if(!this.config()){let i=new Rr;this.config(i)}this.container=this._target.append("g").attrs({class:t.GRID_CLASS_NAME});let n=t.RENDERING_AREA_CLIP_PATH_PREFIX+xt.uuid();this.lasagna=new n1(this.container,n),this.renderingArea=this.buildRenderingArea(n),this.adjustRenderingArea(),this.gridElementsLayer=this.lasagna.addLayer({name:t.GRID_ELEMENTS_LAYER_NAME,order:100,clipped:!1});let r=this.buildBorders(this.gridElementsLayer);return r&&(this.borders=r),this}buildPlugins(n){return[]}update(){return(0,gt.default)(this.scales)?this:(this.updateBorders(),this.adjustRenderingArea(),this)}updateDimensions(n){let r=this.config().dimension;return n.width&&r.outerWidth(n.width-this.getOuterWidthDimensionCorrection()),n.height&&r.outerHeight(n.height),this.adjustRenderingArea(),this.updateRanges(),this}updateRanges(){return this.update(),this}getOuterWidthDimensionCorrection(){return t.TICK_DIMENSION_CORRECTION}buildBorders(n){if(!this.config()||!this.config().borders)return;let r=this.config().borders,i={},o=Object.keys(r);return(0,Z.default)(o,s=>{r[s]&&(i[s]=this.createBorder(n,r[s])??void 0)}),i}adjustRenderingArea=()=>{let n=this.config().dimension,r=this.config().disableRenderAreaHeightCorrection,i=this.config().disableRenderAreaWidthCorrection,o={width:Math.max(0,n.width()),height:Math.max(0,n.height()+(r?0:t.RENDER_AREA_HEIGHT_CORRECTION))};r||(o.y=-t.RENDER_AREA_HEIGHT_CORRECTION);let s=Xt(Wt({},o),{width:Math.max(0,n.width()-(i?0:t.RENDER_AREA_WIDTH_CORRECTION))});this.renderingAreaClipPath.attrs(o),this.renderingArea.attrs(s)};buildRenderingArea(n){return this.renderingAreaClipPath=this._target.append("clipPath").attr("id",n).append("rect"),this.lasagna.addLayer({name:t.RENDERING_AREA_LAYER_NAME,order:-1,clipped:!0}).append("rect").attrs({"pointer-events":"all",fill:"transparent"})}createBorder(n,r){let i=n.append("line").attr("class",r.className||t.DEFAULT_BORDER_CLASS_NAME);return r.width&&i.style("stroke-width",r.width),r.color&&i.style("stroke",r.color),i.node()}updateBottomBorder(){if(!this.borders.bottom)throw new Error("BottomBorder is not defined");O(this.borders.bottom).attrs({x1:0,y1:this.config().dimension.height()-we,x2:this.config().dimension.width()+t.TICK_DIMENSION_CORRECTION,y2:this.config().dimension.height()-we,class:this._config.borders.bottom.className||t.DEFAULT_BORDER_CLASS_NAME}).classed("hidden",!this._config.borders.bottom?.visible)}updateBorders(){this.borders.bottom&&this.updateBottomBorder(),this.borders.top&&O(this.borders.top).attrs({x1:0,y1:we,x2:this.config().dimension.width()+t.TICK_DIMENSION_CORRECTION,y2:we}).classed("hidden",!this._config.borders.top?.visible),this.borders.right&&O(this.borders.right).attrs({x1:this.config().dimension.width()-we,y1:0,x2:this.config().dimension.width()-we,y2:this.config().dimension.height()+t.TICK_DIMENSION_CORRECTION}).classed("hidden",!this._config.borders.right?.visible),this.borders.left&&O(this.borders.left).attrs({x1:we,y1:0,x2:we,y2:this.config().dimension.height()+t.TICK_DIMENSION_CORRECTION}).classed("hidden",!this._config.borders.left?.visible)}}return t})(),Hr=(()=>{class t extends Or{static TICK_LABEL_OVERFLOW_DEBOUNCE_INTERVAL=200;axisX={};axisYLeft={};axisYRight={};gridY={};gridX={};_bottomScaleId;_leftScaleId;_rightScaleId;reconcileMarginsDebounce;handleTickLabelOverflowDebounceIndex={};get bottomScaleId(){if(this._bottomScaleId)return this._bottomScaleId;if(!(0,gt.default)(this.scales))return this.scales.x.list[0].id}set bottomScaleId(n){this._bottomScaleId=n}get leftScaleId(){if(this._leftScaleId)return this._leftScaleId;if(!(0,gt.default)(this.scales))return this.scales.y.list[0].id}set leftScaleId(n){this._leftScaleId=n}get rightScaleId(){return this._rightScaleId}set rightScaleId(n){this._rightScaleId=n}set scales(n){this._scales=n,this._scales&&Object.keys(this._scales).forEach(r=>{let i=this.config().axis.left,o;r!=="x"&&r!=="y"||this._scales[r]?.list?.filter(s=>s instanceof Tn).forEach(s=>{s?.id===this.leftScaleId?(i=this.config().axis.left,o=ii):s?.id===this.rightScaleId?(i=this.config().axis.right,o=Bn):s?.id===this.bottomScaleId&&(i=this.config().axis.bottom,o=ri),s.domainCalculator&&!Py(s.domainCalculator)&&i.gridTicks&&(s.__domainCalculatedWithTicks=!0,s.domainCalculator=t1(i,o,s.domainCalculator))})})}get scales(){return this._scales}config(n){return n===void 0?this._config:(this._config=n,this)}constructor(n){super(),this.config(n||new Je)}build(){super.build(),this.config().interactive&&(this.interactiveArea=this.renderingArea),this.buildAxes(this.gridElementsLayer),this.recalculateMargins(this.container);let n=()=>tt(this.eventBus.getStream(Dr));return this.eventBus.getStream(cd).pipe(n()).subscribe(r=>{let i=this.handleSeriesStateChange(r);this.eventBus.getStream(Ly).next({data:i})}),this}handleSeriesStateChange(n){if(!this.rightScaleId)return;let r=[{scaleId:this.leftScaleId,element:this.axisYLeft.group},{scaleId:this.rightScaleId,element:this.axisYRight?.group}],i=this.calculateAxesStyles(n,r);for(let o of r)o.scaleId&&o.element.attrs(i[o.scaleId]);return i}calculateAxesStyles(n,r){let o=n.data.filter(s=>s.state===V.emphasized&&s.series).map(s=>s.series);if(o.length>0){let s=(0,Er.default)(o.map(a=>a?.scales.y).filter(a=>!!a));if(s.length<=0)return{};for(let a of s)if(a.id===this.leftScaleId||a.id===this.rightScaleId)return r.reduce((u,c)=>(u[c.scaleId]={opacity:a.id===c.scaleId?1:.1},u),{});return{}}else return r.reduce((s,a)=>(s[a.scaleId]={opacity:1},s),{})}buildPlugins(n){let r=[],i=this.config();return i.interactive&&r.push(new Ca(new Ky(this.getLasagna().getContainer(),this.getInteractiveArea(),i.cursor,i.dimension.margin))),i.interactionPlugins&&(r.push(new vd),r.push(new Sr)),r}update(){return super.update(),this.updateAxes(),this.handleMarginUpdate(),this}drawTicks(n,r,i,o){if(n.visible){let s=o(i.d3Scale).ticks(n.approximateTicks).tickSize(0);i.fixDomainValues?.length&&s.tickValues(i.fixDomainValues),s.tickFormat(i.formatters.tick),r.labelGroup.call(s);let a;i instanceof Nr?a=o(i.copyToLinear().d3Scale).tickSize(n.tickSize).tickValues(i.bandTicks()).tickFormat(()=>""):(a=o(i.d3Scale).tickSize(n.tickSize),i.fixDomainValues?.length&&a.tickValues(i.fixDomainValues),a.tickFormat(()=>""),a.ticks(n.approximateTicks)),r.tickGroup.call(a),this.adjustAxisTicks(r.labelGroup,i)}else r.labelGroup.selectAll("*").remove(),r.tickGroup.selectAll("*").remove()}drawGrids(n,r,i,o,s){let a=c=>c.selectAll(".tick line").classed("nui-zero-line",l=>l===0),u=i(o.d3Scale).tickSize(s);if(o.fixDomainValues?.length&&u.tickValues(o.fixDomainValues),u.tickFormat(()=>"").ticks(n.approximateTicks),n.gridTicks){let c=r.tickGroup.call(u);a(c)}else r.tickGroup.selectAll("*").remove()}updateRanges(){if((0,gt.default)(this.scales))return this;let n=this.config().dimension,r=n.padding;return this.scales.x&&(0,Z.default)(this.scales.x.list,i=>{i.range([r.left,n.width()-r.right])}),this.scales.y&&(0,Z.default)(this.scales.y.list,i=>{i.range([n.height()-r.bottom,r.top])}),super.updateRanges(),this}updateXAxis(){let n=this.bottomScaleId?this.scales.x.index[this.bottomScaleId]:void 0,r=this.config().axis;if(!n)throw new Error("xScale is not defined");this.axisX.group.attr("transform",`translate(0, ${this.config().dimension.height()})`),this.axisX.labelGroup.attr("transform",`translate(0, ${r.bottom.tickSize})`),this.drawTicks(r.bottom,this.axisX,n,ri),this.drawGrids(r.bottom,this.gridX,Ko,n,this.config().dimension.height()),this.gridX.tickGroup.attr("transform",`translate(0, ${this.config().dimension.height()})`)}updateYAxes(){let n=this.config().axis,r=this.leftScaleId?this.scales.y.index[this.leftScaleId]:void 0;if(!r)throw new Error("yLeftScale is not defined");if(this.axisYLeft.labelGroup.attr("transform",`translate(${-n.left.tickSize-n.left.padding}, 0)`),this.drawTicks(n.left,this.axisYLeft,r,ii),this.drawGrids(n.left,this.gridY,Bn,r,this.config().dimension.width()),this.rightScaleId){let i=this.scales.y.index[this.rightScaleId],o=n.right.padding+this.config().dimension.width()+n.right.tickSize;this.axisYRight.labelGroup.attr("transform",`translate(${o}, 0)`),this.axisYRight.tickGroup.attr("transform",`translate(${this.config().dimension.width()}, 0)`),this.drawTicks(n.right,this.axisYRight,i,Bn)}}updateAxes(){this.target()&&(this.updateXAxis(),this.updateYAxes())}adjustAxisTicks(n,r){let i=[];n.attr("cursor","default"),n.selectAll("g").each(function(){O(this).classed("sw-hidden",!1).classed("tick-hidden-text",!1),i.push(this)}),this.filterRepeatedElements(i).forEach(a=>{O(a).classed("tick-hidden-text",!0)});let s=this.selectAllAxisLabels(n);s.forEach(a=>{let u=O(a);if(u.select("text").attr("x",0).classed(kr,!0),u.classed("pointer-events",!0),u.select("title").empty()){let c=u.data()[0],l=r.formatters.tick?r.formatters.tick(c):c;u.append("title").text(l)}}),this.handleTickLabelOverflow(n,r,s)}handleTickLabelOverflow(n,r,i){let o=this.config().axis;if(r.id===this.bottomScaleId&&(r.isContinuous()||!o.bottom.tickLabel.overflowHandler)){this.getElementsToHide(i,this._config.dimension.width(),!0).forEach(p=>{let v=O(p);v.classed("tick-hidden-text",!0),v.classed("pointer-events",!1)});return}(r.id===this.rightScaleId||r.id===this.leftScaleId)&&this.getElementsToHide(i,this._config.dimension.height(),!1).forEach(p=>{O(p).classed("sw-hidden",!0)});let s=this.config().dimension.margin,a=0,u=0,c,l=!1,f=!1,h=o.right.tickLabel.maxWidth,d=o.left.tickLabel.maxWidth;if(r.id===this.bottomScaleId){let m=o.bottom.tickLabel.maxWidth,p=r.bandwidth?r.bandwidth():this.getTickDistance(i);(0,I.default)(m)?a=p:a=p>m?m:p,u=o.bottom.tickLabel.horizontalPadding,c=o.bottom.tickLabel.overflowHandler}else if(r.id===this.rightScaleId&&!o.right.fit){let m=s.right-o.right.padding-o.right.tickSize;(0,I.default)(h)?a=m:a=m>h?h:m,u=o.right.tickLabel.horizontalPadding,c=o.right.tickLabel.overflowHandler}else if(r.id===this.leftScaleId&&!o.left.fit){let m=s.left-o.left.padding-o.left.tickSize;(0,I.default)(d)?a=m:a=m>d?d:m,u=o.left.tickLabel.horizontalPadding,c=o.left.tickLabel.overflowHandler}else if(r.id===this.rightScaleId&&o.right.fit&&!(0,I.default)(h))a=h,u=o.right.tickLabel.horizontalPadding,c=o.right.tickLabel.overflowHandler,f=!0;else if(r.id===this.leftScaleId&&o.left.fit&&!(0,I.default)(d))a=d,u=o.left.tickLabel.horizontalPadding,c=o.left.tickLabel.overflowHandler,l=!0;else return;if(!c)return;let g=0;if(n.select(".sample-ellipsis").empty()){let m=n.append("text");g=m.classed("sample-ellipsis",!0).attr("opacity",0).append("tspan").text("...").node()?.getComputedTextLength()||0,m.remove()}this.handleTickLabelOverflowDebounceIndex[r.id]&&(clearTimeout(this.handleTickLabelOverflowDebounceIndex[r.id]),this.handleTickLabelOverflowDebounceIndex[r.id]=null),n.classed("tick-hidden-text",!0),i.forEach(m=>{O(m).classed("pointer-events",!1)}),this.handleTickLabelOverflowDebounceIndex[r.id]=setTimeout(()=>{i.forEach(p=>{let v=O(p);v.select("text").call(c,{widthLimit:a,horizontalPadding:u,ellipsisWidth:g}),v.classed("pointer-events",!0)});let m=this._config.dimension.marginLocked;m&&(f||l)&&(this.handleMarginUpdate(),m.right=f,m.left=l),n.classed("tick-hidden-text",!1)},t.TICK_LABEL_OVERFLOW_DEBOUNCE_INTERVAL)}selectAllAxisLabels(n){let r=[];return n.selectAll("g:not(.tick-hidden-text)").each(function(){r.push(this)}),r}getOuterWidthDimensionCorrection(){return this.config().axis.bottom.visible?Or.TICK_DIMENSION_CORRECTION:0}handleMarginUpdate(){let n=(0,nd.default)(this._config.dimension.margin);this.recalculateMargins(this.container),this.reconcileMarginsWithDebounce(n)}hasRightYAxis(){return this.config().axis.right.visible&&this.rightScaleId?.length>0}buildAxes(n){this.gridY.tickGroup=n.append("g").classed("sw-axis sw-axis-grid sw-axis-gridY",!0),this.gridX.tickGroup=n.append("g").classed("sw-axis sw-axis-grid sw-axis-gridX",!0),this.axisX.group=n.append("g").classed("sw-axis sw-axis-x",!0),this.axisX.tickGroup=this.axisX.group.append("g").classed("sw-axis sw-axis-x sw-axis-x-ticks",!0),this.axisX.labelGroup=this.axisX.group.append("g").classed("sw-axis sw-axis-x sw-axis-x-labels",!0),this.axisYLeft.group=n.append("g").classed("sw-axis sw-axis-y sw-axis-y-left",!0),this.axisYLeft.tickGroup=this.axisYLeft.group.append("g").classed("sw-axis sw-axis-y sw-axis-y-ticks",!0),this.axisYLeft.labelGroup=this.axisYLeft.group.append("g").classed("sw-axis sw-axis-y sw-axis-y-labels",!0),this.axisYRight.group=n.append("g").classed("sw-axis sw-axis-y sw-axis-y-right",!0),this.axisYRight.tickGroup=this.axisYRight.group.append("g").classed("sw-axis sw-axis-y sw-axis-y-ticks",!0),this.axisYRight.labelGroup=this.axisYRight.group.append("g").classed("sw-axis sw-axis-y sw-axis-y-labels",!0)}filterRepeatedElements(n){let r=[n[0]];return n.reduce((i,o)=>{let s=O(o).text();return s!==i&&r.push(o),s},n[0]&&O(n[0]).text()),n.filter(i=>r.indexOf(i)===-1)}getElementsToHide(n,r,i){let o=i?"width":"height",s=this.getTextMeasurement(n,o)<r,a=i?this.getMaxTextWidth(n)<this.getTickDistance(n):!1;if(i?s&&a:s)return[];let c=this.elementsFiltering(n,r,o);return n.filter(l=>c.indexOf(l)===-1)}elementsFiltering(n,r,i){let o,s=2,a=u=>i==="width"?this.getMaxTextWidth(u)>this.getTickDistance(u):this.getTextMeasurement(u,i)>r;do if(o=n.filter((u,c)=>c%s===0),s++,o.length===1&&a(o))break;while(a(o));return o}getTextMeasurement(n,r){let i=r==="width"?5:0;return n.reduce((o,s)=>o+s.getBoundingClientRect()[r]+i,0)}getMaxTextWidth(n){return n.length===0?0:Math.max.apply(null,n.map(r=>r.getBoundingClientRect().width))}getTickDistance(n){if(n.length===0)return 0;let r=1/0;return n.map(o=>{let s=o.getAttribute("transform");if((0,Ji.default)(s))throw new Error("tick transform is not defined");return parseFloat(s.slice(s.indexOf("(")+1,s.indexOf(",")))}).reduce((o,s)=>{let a=s-o;return a<r&&(r=a),s}),r}recalculateMargins(n){if(!n)return;let r=this._config.dimension,i=this.config().axis,o=r.outerWidth(),s=r.outerHeight();!r.marginLocked?.left&&i.left.fit&&i.left.visible&&(r.margin.left=this.getMaxTextWidth(this.selectAllAxisLabels(this.axisYLeft.labelGroup))+i.left.tickSize+i.left.padding),!r.marginLocked?.right&&i.right.fit&&this.hasRightYAxis()&&(r.margin.right=this.getMaxTextWidth(this.selectAllAxisLabels(this.axisYRight.labelGroup))+i.right.tickSize+i.right.padding);let a=this.bottomScaleId&&this.scales?this.scales.x?.index[this.bottomScaleId]:void 0;i.bottom.fit&&i.bottom.visible&&(a?.isContinuous()||!i.bottom.tickLabel.overflowHandler)&&this.fitBottomAxis(r);let u=r.margin.top,c=r.margin.bottom;r.margin.top=u,r.margin.bottom=c,r.outerWidth(o),r.outerHeight(s);let l=this.config().dimension.margin.left,f=this.config().dimension.margin.top;n.attr("transform",`translate(${l}, ${f})`)}fitBottomAxis(n){let r=this.scales?.x?.list[0].d3Scale;if(!r)return;let i=0,o=0,s=this.axisX.labelGroup.select(".tick:not(.tick-hidden-text):last-child text").node();if(s){i=s.getBoundingClientRect().width,o=r(s.innerHTML)??0;let a=r.range()[1],u=i/2-Math.abs(a-o)/2;n.margin.right=u>0?u:0}}reconcileMarginsWithDebounce(n){this.reconcileMarginsDebounce&&(clearTimeout(this.reconcileMarginsDebounce),this.reconcileMarginsDebounce=null),this.reconcileMarginsDebounce=setTimeout(()=>{this.areMarginsApproximatelyEqual(n,this._config.dimension.margin)||this.updateChartDimensionsSubject?.next()},100)}isApproximatelyEqual=(n,r)=>Math.abs(n-r)<.1;areMarginsApproximatelyEqual(n,r){return this.isApproximatelyEqual(n.top,r.top)&&this.isApproximatelyEqual(n.right,r.right)&&this.isApproximatelyEqual(n.bottom,r.bottom)&&this.isApproximatelyEqual(n.left,r.left)}}return t})();var iO={markerRadius:Ha.Large,enabled:!0};var Aa=class extends lo{constructor(e,n){super(e,n),this.data=Xt(Wt({},this.data),{startX:(r,i,o,s)=>this.data.category(r,i,o,s),endX:(r,i,o,s)=>this.data.category(r,i,o,s),thicknessX:(r,i,o,s)=>this.data.thickness?this.data.thickness(r,i,o,s):void 0,startY:(r,i,o,s)=>this.data.start(r,i,o,s),endY:(r,i,o,s)=>this.data.end(r,i,o,s)})}};function oO(t,e=new Tn){let n=new Nr;t&&t.grouped&&(n.padding(.25),n.innerScale=new Nr);let r;return!t||!t.horizontal?r={x:n,y:e}:(n.reverse(),r={x:e,y:n}),r}var sO={markerRadius:Ha.Large,enabled:!0};function r1(t,e="category"){return t.reduce((n,r)=>{let i=r.accessors.data[e],o=r.data.reduce((s,a,u)=>(s.push(i?.(a,u,r.data,r)),s),[]);return(0,od.default)(n,o,s=>s.valueOf())},[])}function i1(t,e){if(t.length===0)return t;let n=r1(t.filter(r=>(0,I.default)(r.preprocess)||r.preprocess));return t.reduce((r,i)=>{if(!(0,I.default)(i.preprocess)&&!i.preprocess)return r;let o=i.accessors.data.category,s=i.accessors.data.value;if(!s)throw new Error("valueAccessor is not defined");let a=i.data.reduce((c,l,f)=>Xt(Wt({},c),{[o(l,f,i.data,i)]:f}),{}),u=[];return n.forEach((c,l)=>{let f;if(a[c]!==void 0){f=i.data[a[c]];let h={},d=e(i)?1:0;h.start=r[l],r[l]+=(s(f,a[c],i.data,i)||0)*d,h.end=r[l],f.__bar=h,u.push(f)}}),i.data=u,r},Array(n.length).fill(0)),t}function aO(t){return i1(t,e=>!this.isSeriesHidden(e.id))}var Nh=class{colorProvider;data;series;constructor(e=zr()){this.colorProvider=e,this.data={value:n=>Number.isFinite(n)?n:n.value},this.series={color:this.colorProvider?this.colorProvider.get:void 0}}};var Ea=class extends Or{build(){return super.build(),this.recenter(),this}updateDimensions(e){let n=this.config().dimension;if((0,I.default)(e.width)||n.outerWidth(e.width),(0,I.default)(e.height)||n.outerHeight(e.height),this.scales){let r=this.scales.r;r&&r.list[0].range([0,Math.min(n.width(),n.height())/2])}return this.adjustRenderingArea(),this.updateRanges(),setTimeout(()=>{this.recenter()}),this}adjustRenderingArea=()=>{let e=this.config().dimension,n={width:e.outerWidth(),height:e.outerHeight(),transform:`translate(${-e.outerWidth()/2}, ${-e.outerHeight()/2})`};this.renderingAreaClipPath.attrs(n),this.renderingArea.attrs(n)};recenter(){this.container.attrs({transform:`translate(${this.config().dimension.outerWidth()/2},${this.config().dimension.outerHeight()/2})`})}};function uO(){let t=new Rr;return t.interactive=!1,new Ea().config(t)}function o1(t,e){if(!t[0])return t;let n=$o().sort(null),o=t[0].data.reduce((s,a)=>(s.push(t.map(u=>e(u)&&!u.excludeFromArcCalculation?u.accessors.data.value(u.data[s.length],s.length,u.data,u):0)),s),[]).map(s=>n(s));return t.map((s,a)=>Xt(Wt({},s),{data:s.preprocess===!1?s.data:o.map(u=>Xt(Wt({},u[a]),{data:s.data[0]}))}))}function cO(t){return o1(t,e=>!this.isSeriesHidden(e.id))}function lO(){return{r:new Tn().fixDomain(Ry)}}var Oh=class{valueMap;defaultValue;constructor(e,n){this.valueMap=e,this.defaultValue=n,this.reset()}get=e=>this.valueMap[e]||this.defaultValue;reset(){}};var $r=(t,e)=>new Intl.DateTimeFormat(oe.default.locale(),e).format(t),s1=t=>$r(t,{hour:"numeric",minute:"2-digit",second:"2-digit"}),a1=t=>$r(t,{hour:"numeric",minute:"2-digit"}),u1=t=>$r(t,{month:"short",day:"2-digit"}),c1=t=>$r(t,{month:"short"}),l1=t=>$r(t,{year:"numeric"}),Ma=t=>lr(t)<t?s1(t):ve(t)<t?a1(t):fr(t)<t?u1(t):Vt(t)<t?c1(t):l1(t),Ta=class extends Pr{constructor(e){super(e),this.formatters.tick=Ma}createD3Scale(){return Ks()}convert(e){return this._d3Scale(e)}invert(e){let n=this._d3Scale.invert(e);return isNaN(n.getTime())?void 0:n}isContinuous(){return!0}isDomainValid(){return this.domain().findIndex(e=>isNaN(e.getTime()))===-1}};function Cn(t){let e=new Date(t.getFullYear(),0,1).getTimezoneOffset(),n=new Date(t.getFullYear(),6,1).getTimezoneOffset();return Math.max(e,n)!==t.getTimezoneOffset()}var Fh=class extends Ta{_bandScale;_interval;constructor(e,n){super(n),this.interval(e),this._bandScale=Be(),this.formatters.title=this.defaultTitleFormatter}interval(e){return e?(this._interval=e,this):this._interval}domain(e){if(e){if(e.length===0||e.length%2!==0)throw new Error("TimeIntervalScale domain has to be defined as a pair of [from, to] time values.");let n=(0,Ra.default)(e,En),r=[];if(!n)for(let o=0;o+1<e.length;o+=2)r.push(...this.getBandsForInterval(e[o],e[o+1]));this._bandScale.domain(r);let i=n?e:[e[0],(0,oe.default)(e[1]).add(this.interval()).toDate()];return super.domain(i)}return super.domain()}range(e){if(e)this._bandScale.range(e);else return super.range();return super.range(e)}getBands(){return this._bandScale.domain()}convert(e,n=Ba){let r=this.truncToInterval(e,this.interval());if(!r)throw new Error("Could not convert interval");let i=this._bandScale(r);return typeof i=="number"?i+n*this.bandwidth():super.convert(e)}invert(e){let n=super.invert(e);return this.truncToInterval(n,this.interval())}bandwidth(){return this._bandScale.bandwidth()}truncToInterval(e,n,r=!1){if(!e)return e;let i=Cn(e),o=r?i:Cn(this.domain()[0]),s=o&&!i,a=!o&&i,c=this.interval().asDays()>=1&&a?(0,oe.duration)(1,"hour").asMilliseconds():0,l=new Date(e.getTime()+c),f=0;(s||a)&&(f=s?-60:60);let h=(l.getTimezoneOffset()+f)*6e4,d=l.getTime()-h,g=n.asMilliseconds(),m=d%g;if(m===0)return l;let p=d-m;return new Date(p+h)}isContinuous(){return!0}defaultTitleFormatter=e=>{let n=this.interval().asDays(),r=Cn(e),i=Cn(this.domain()[0]),o=!r&&i,s=r&&!i,a=0;(o||s)&&n>=1&&(a=o?36e5:-36e5);let u=new Date(e.getTime()+a),c=n>=1?(0,oe.default)(u).add(n,"days").toDate():(0,oe.default)(u).add(this.interval()).toDate();return Ma(u)+" - "+Ma(c)};getBandsForInterval(e,n){let r=[],i=this.truncToInterval(e,this.interval(),!0);if(!i)throw new Error("Could not get bands for interval");let o=this.interval().asMilliseconds(),s=this.interval().asDays(),a=Cn(e),u=Cn(n),c=!a&&u?(0,oe.duration)(1,"hour").asMilliseconds():0,l=s>=1?new Date(n.getTime()+c):n;for(;i<=l;)r.push(i),i=new Date(i.getTime()+o);return r}};var Da=class extends Je{constructor(){super(),this.dimension.padding.bottom=2}},Ia=class extends Je{constructor(){super(),this.interactionPlugins=!1,this.axis.left.gridTicks=!0,this.axis.left.tickSize=5,this.axis.bottom.gridTicks=!1,this.axis.left.fit=!0,this.axis.bottom.tickSize=5,this.axis.left.tickSize=0,this.dimension.margin.right=0,this.dimension.padding.bottom=2}},ka=class extends Je{constructor(){super(),this.interactionPlugins=!1,this.axis.left.gridTicks=!1,this.axis.left.tickSize=0,this.axis.bottom.gridTicks=!0,this.axis.left.fit=!0,this.axis.bottom.fit=!0,this.axis.bottom.tickSize=0,this.axis.left.tickSize=5,this.dimension.padding.left=2,this.borders.left.visible=!0,this.borders.bottom.visible=!1}};function Bh(t=new Je,e=!1,n=!0){return t.interactionPlugins=!1,t.axis.left.visible=!1,t.axis.left.gridTicks=!1,t.dimension.margin.left=5,t.dimension.margin.right=5,t.dimension.margin.bottom=e?t.dimension.margin.bottom:0,t.dimension.padding.top=5,t.dimension.padding.bottom=5,t.dimension.autoHeight=!1,t.dimension.height(36),n&&(t.borders.top=new Lr),e||(t.borders.bottom.visible=!1),t}var fO=(()=>{class t extends se{config;static LAYER_NAME="zoom-brush";static DEFAULT_CONFIG={enableExternalEvents:!1};grid;brush;zoomBrushLayer;brushElement;destroy$=new ht;brushStartX;interactionHandlerMap;constructor(n={}){super(),this.config=n,this.config=(0,ae.default)(this.config,t.DEFAULT_CONFIG),this.interactionHandlerMap={[W.MouseDown]:this.brushStart,[W.MouseMove]:this.brushMove,[W.MouseUp]:this.brushEnd}}initialize(){this.grid=this.chart.getGrid(),this.zoomBrushLayer=this.grid.getLasagna().addLayer({name:t.LAYER_NAME,order:Ut[X.foreground].order+1,clipped:!0}),this.chart.getEventBus().getStream(xo).pipe(tt(this.destroy$)).subscribe(n=>{if(n.broadcast&&!this.config.enableExternalEvents)return;let r=n.data;if(!((0,gt.default)(this.grid.scales)||(0,gt.default)(r.coordinates))&&this.interactionHandlerMap[r.interactionType]){let i=r.coordinates&&r.coordinates.x;this.interactionHandlerMap[r.interactionType](i)}}),this.brush=Ni(),this.brushElement=this.zoomBrushLayer.append("g").attr("class","brush"),this.chart.getGrid().getInteractiveArea().on("pointerdown",()=>k.target.setPointerCapture(k.pointerId)).on("pointerup",()=>k.target.releasePointerCapture(k.pointerId))}updateDimensions(){let n=this.grid.config().dimension;this.brush.extent([[0,0],[n.width(),n.height()]]),this.brush(this.zoomBrushLayer.select(".brush")),this.brushElement.select(".overlay").style("pointer-events","none"),this.brushElement.select(".selection").attr("stroke",null)}destroy(){this.grid.getLasagna().removeLayer(t.LAYER_NAME),this.destroy$.next(),this.destroy$.complete()}brushStart=n=>{(0,I.default)(this.brushStartX)&&(this.chart.getEventBus().getStream(ua).next({data:!1}),this.brushStartX=n)};brushMove=n=>{if((0,I.default)(this.brushStartX))return;let r=[this.brushStartX,n].sort((i,o)=>i-o);this.brush.move(this.brushElement,r)};brushEnd=n=>{if((0,I.default)(this.brushStartX))return;let r=[this.brushStartX,n].sort((u,c)=>u-c);this.brushStartX=void 0,this.chart.getEventBus().getStream(ua).next({data:!0}),this.brush.move(this.brushElement,null);let i=this.grid.scales.x.list;if(!i||r[0]===r[1])return;let o=0,s=this.grid.config();!s.disableRenderAreaWidthCorrection&&r[1]===s.dimension.width()-Or.RENDER_AREA_WIDTH_CORRECTION&&(o=Or.RENDER_AREA_WIDTH_CORRECTION);let a=i.reduce((u,c)=>(u[c.id]=[r[0],r[1]+o].map(l=>c.invert(l)),u),{});this.chart.getEventBus().getStream(ky).next({data:a})}}return t})(),hO=(()=>{class t extends se{config;syncService;static LAYER_NAME="timeseries-zoom-brush";static DEFAULT_CONFIG={enableExternalEvents:!0,collectionId:""};grid;brush;zoomBrushLayer;brushElement;destroy$=new ht;interactionHandlerMap;xScale;brushStartXCoord;brushEndXCoord;brushStartXDate;brushEndXDate;isChartHoverd=!1;isPopoverDisplayed=!1;zoomLineLayer;openPopoverSubject=new ht;openPopover$=this.openPopoverSubject.asObservable().pipe(tt(this.destroy$));closePopoverSubject=new ht;closePopover$=this.closePopoverSubject.asObservable().pipe(tt(this.destroy$));zoomCreatedSubject=new ht;zoomCreated$=this.zoomCreatedSubject.asObservable().pipe(tt(this.destroy$));resizeHandler=(0,Pa.default)(()=>{(0,I.default)(this.brushStartXDate)||(0,I.default)(this.brushEndXDate)||(this.moveBrushByDate(this.brushStartXDate,this.brushEndXDate),this.closePopover())},10);constructor(n={},r){super(),this.config=n,this.syncService=r,this.config=(0,ae.default)(this.config,t.DEFAULT_CONFIG),this.interactionHandlerMap={[W.MouseDown]:this.onBrushStart,[W.MouseMove]:this.onBrushMove,[W.MouseUp]:this.onBrushEnd},this.config.collectionId&&this.syncService?.registerPlugin(this.config.collectionId,this)}initialize(){this.grid=this.chart.getGrid(),this.zoomBrushLayer=this.grid.getLasagna().addLayer({name:t.LAYER_NAME,order:Ut[X.foreground].order+1,clipped:!0}),this.zoomLineLayer=this.chart.getGrid().getLasagna().addLayer({name:"zoom-interaction-line",order:900,clipped:!0}),this.chart.getEventBus().getStream(xo).pipe(tt(this.destroy$)).subscribe(n=>{if(n.broadcast&&!this.config.enableExternalEvents)return;let r=n.data;if(!((0,gt.default)(this.grid.scales)||(0,gt.default)(r.coordinates))&&this.interactionHandlerMap[r.interactionType]){let i=r.coordinates&&r.coordinates.x,o=r.coordinates&&r.coordinates.y;this.interactionHandlerMap[r.interactionType](i,o)}}),this.chart.getEventBus().getStream(Ze).pipe(tt(this.destroy$)).subscribe(n=>{if(n.data.values?.x){let r=this.grid,i=Object.keys(n.data.values.x),o=r.scales.x.list[0];o.isTimeseriesScale&&!i.includes(o.id)?(this.isChartHoverd=!1,this.closePopover()):this.isChartHoverd=!0}}),this.brush=Ni(),this.brushElement=this.zoomBrushLayer.append("g").attr("class","brush"),this.chart.getGrid().getInteractiveArea().on("pointerdown",()=>k.target.setPointerCapture(k.pointerId)).on("pointerup",()=>k.target.releasePointerCapture(k.pointerId))}updateDimensions(){let n=this.grid?.config()?.dimension;this.grid&&(this.xScale=(0,go.default)(this.grid.scales.x.index,{id:this.grid.bottomScaleId})),n&&(this.brush.extent([[0,0],[n.width(),n.height()]]),this.brush(this.zoomBrushLayer.select(".brush")),this.brushElement.select(".overlay").style("pointer-events","none"),this.brushElement.select(".selection").attr("stroke",null),this.resizeHandler())}destroy(){this.config.collectionId&&this.syncService?.removePlugin(this.config.collectionId,this),this.clearBrush(),this.grid.getLasagna().removeLayer(t.LAYER_NAME),this.destroy$.next(),this.destroy$.complete()}showPopover(){!this.isChartHoverd||this.isPopoverDisplayed||(0,I.default)(this.brushStartXCoord)||(0,I.default)(this.brushEndXCoord)||(this.isPopoverDisplayed=!0,this.openPopoverSubject.next(this.brushEndXCoord))}closePopover(){this.isPopoverDisplayed&&(this.isPopoverDisplayed=!1,this.closePopoverSubject.next())}moveBrushByDate(n,r){let i=this.xScale.convert(n),o=this.xScale.convert(r);if(!(this.brushStartXCoord===i&&this.brushEndXCoord===o)){if((0,I.default)(this.brushStartXCoord)&&(0,I.default)(this.brushStartXCoord)){this.createBrushWithoutDrag(i,o);return}this.moveBrush(n,r,i,o)}}moveBrushByCoord(n,r){if((0,I.default)(n)||(0,I.default)(r)||n===this.brushStartXCoord&&r===this.brushEndXCoord)return;if((0,I.default)(this.brushStartXCoord)&&(0,I.default)(this.brushEndXCoord)){this.createBrushWithoutDrag(n,r);return}let i=this.getDateFromCoord(n),o=this.getDateFromCoord(r);this.moveBrush(i,o,n,r)}clearBrush(){this.brush.move(this.brushElement,null),this.zoomLineLayer.selectAll("."+t.LAYER_NAME).remove(),this.brushEndXCoord=void 0,this.brushStartXCoord=void 0,this.brushStartXDate=void 0,this.brushEndXDate=void 0,this.closePopover()}getInspectionFrame(){return{startDate:this.brushStartXDate,endDate:this.brushEndXDate}}getDateFromCoord(n){let r=xt.getScaleValues([this.xScale],n);return(0,oe.default)(xt.getInteractionValues(r,this.xScale.id))}addZoomBoundaryLine(n,r){let i=this.zoomLineLayer.selectAll(t.LAYER_NAME).data([n]),o={class:t.LAYER_NAME,x1:r,y1:0,x2:r,y2:this.chart.getGrid().config().dimension.height()};i.enter().append("line").merge(i).attrs(o),i.exit().remove()}onBrushStart=n=>{(0,I.default)(this.brushStartXCoord)||this.clearBrush(),this.brushStartXCoord=n,this.brushStartXDate=this.getDateFromCoord(n),this.addZoomBoundaryLine(this.brushStartXDate,this.brushStartXCoord)};onBrushMove=n=>{if(!(0,I.default)(this.brushStartXCoord)){if((0,I.default)(this.brushEndXCoord)){let r=[this.brushStartXCoord,n].sort((i,o)=>i-o);this.brush.move(this.brushElement,r)}!(0,I.default)(this.brushStartXCoord)&&!(0,I.default)(this.brushEndXCoord)&&(n>=this.brushStartXCoord&&n<=this.brushEndXCoord?this.showPopover():this.closePopover())}};onBrushEnd=n=>{if((0,I.default)(this.brushStartXCoord))return;let r=this.getDateFromCoord(n);this.addZoomBoundaryLine(r,n),this.brushStartXCoord>n?(this.brushEndXCoord=this.brushStartXCoord,this.brushStartXCoord=n,this.brushEndXDate=this.brushStartXDate,this.brushStartXDate=r):(this.brushEndXCoord=n,this.brushEndXDate=r),this.isChartHoverd&&this.zoomCreatedSubject.next()};createBrushWithoutDrag(n,r){this.brushStartXCoord=n,this.brushEndXCoord=r,this.brushStartXDate=this.getDateFromCoord(n),this.brushEndXDate=this.getDateFromCoord(r),this.brush.move(this.brushElement,[n,r]),this.addZoomBoundaryLine(this.brushStartXDate,this.brushStartXCoord),this.addZoomBoundaryLine(this.brushEndXDate,this.brushEndXCoord)}moveBrush(n,r,i,o){let s=this.zoomLineLayer.selectAll("."+t.LAYER_NAME).nodes();s.length===2&&(s[0].setAttribute("x1",i.toString()),s[0].setAttribute("x2",i.toString()),s[1].setAttribute("x1",o.toString()),s[1].setAttribute("x2",o.toString()),this.brush.move(this.brushElement,[i,o]),this.brushStartXCoord=i,this.brushStartXDate=n,this.brushEndXCoord=o,this.brushEndXDate=r)}}return t})(),dO=(()=>{class t{collections={};registerPlugin(n,r){this.collections[n]?this.collections[n].push(r):this.collections[n]=[r]}getPlugins(n){return this.collections[n]??[]}removePlugin(n,r){if(!this.collections[n])return;let i=[...this.collections[n]],o=i.findIndex(s=>s===r);o!==-1&&(i.splice(o,1),this.collections[n]=i)}syncPositionInsideCollection(n,r,i){let o=this.getPlugins(n);setTimeout(()=>{o.forEach(s=>{s.moveBrushByDate(r,i)})})}clearZoomInsideCollection(n){this.getPlugins(n).forEach(i=>{i.clearBrush()})}static \u0275fac=function(r){return new(r||t)};static \u0275prov=Vr({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),zh=class{showBottomAxis;showTopBorder;palette;markers;sparks=[];isLegendActive=!1;gridConfig;lastGridConfig;highlightedDataPoints={};constructor(e=!0,n=!0,r=new ao(pd),i=new uo(md)){this.showBottomAxis=e,this.showTopBorder=n,this.palette=r,this.markers=i,this.gridConfig=Bh(new Je,!1,n),this.gridConfig.interactionPlugins=!1,this.lastGridConfig=Bh(new Je,e,n),this.lastGridConfig.interactionPlugins=!1}update(e){let n=e.map(r=>({id:r.id,chartSeriesSet:[r]}));this.updateSparks(n)}updateSparks(e){let n=(0,Qe.default)(e);this.sparks=n.map((r,i)=>{let o=i===n.length-1,s=r.id?this.sparks.findIndex(a=>a.id===r.id):-1;return s!==-1?r.chart=this.reconfigureChart(this.sparks[s].chart,o):(r.chart=r.chart||this.createChart(o),r.id=r.id||xt.uuid()),r.chart.update(r.chartSeriesSet),r})}getHighlightedValue(e,n,r){return wa.getLabel(e,this.highlightedDataPoints[e.id],n,r)}trackByFn(e,n){return n?.id}setRenderState(e,n){}getVisibleSeriesWithLegend(){return[]}createChart(e){let n=new Hr(e?this.lastGridConfig:this.gridConfig),r=new ba(n);return(this.showTopBorder||this.showBottomAxis)&&r.addPlugin(new vd),e&&this.showBottomAxis&&r.addPlugin(new Sr),this.configureEventSubscriptions(r.getEventBus()),r}configureEventSubscriptions(e){e.getStream(Tr).subscribe(n=>{if(n.data.interactionType===W.MouseMove){let r=n.data.dataPoints;Object.keys(r).forEach(i=>{this.highlightedDataPoints[i]=Object.assign({},r[i])})}}),e.getStream(Mr).subscribe(n=>{this.isLegendActive=n.data})}reconfigureChart(e,n){e.getGrid().config(n?this.lastGridConfig:this.gridConfig),e.updateDimensions();let r=e.hasPlugin(Sr);if(n&&!r&&this.showBottomAxis){let i=new Sr;e.addPlugin(i),i.initialize()}else!n&&r&&e.removePlugin(Sr);return e}};function pO(t){let e=new Hr;return e.config(t&&t.horizontal?new ka:new Ia),e}function mO(t,e,n){return t&&t.horizontal?new fo(e,n):new Aa(e,n)}var La=class{scaleKey;levels;selectedDataPointIdxFn;constructor(e,n=1,r){this.scaleKey=e,this.levels=n,this.selectedDataPointIdxFn=r}getDataPointIndex(e,n,r,i){let o=r[this.scaleKey];return typeof o>"u"?Yt:this.findDataPointByValue(n,o,this.scaleKey,i)}findDataPointByValue(e,n,r,i){let o=r.toUpperCase(),s=e.accessors.data,a=s["start"+o],u=s["end"+o];if(typeof n=="string")return(0,_e.default)(e.data,(c,l)=>n===a?.(c,l,e.data,e));if((0,ue.default)(n))return(0,_e.default)(e.data,(c,l)=>{let f=a?.(c,l,e.data,e),h=Math.min(this.levels,n.length,f.length);for(let d=0;d<h;d++)if(n[d]!==f[d])return!1;return!0});if(n.valueOf){let c=n.valueOf();if(i&&i[r]?.isContinuous()){let l=(0,_e.default)(e.data,(f,h)=>c>=a?.(f,h,e.data,e).valueOf()&&c<=u?.(f,h,e.data,e).valueOf());if(l===-1&&typeof u<"u")if(Br(i[r])){let f=(d,g)=>a?.(d,g,e.data,e),h=xt.findNearestIndex(e.data,n,f);l=h>=e.data.length||f(e.data[h],h)>c?-1:h}else l=xt.getClosestIndex(e.data,(f,h)=>u(f,h,e.data,e),n)??-1;return l}return(0,_e.default)(e.data,(l,f)=>c>=a?.(l,f,e.data,e).valueOf()&&c<=u?.(l,f,e.data,e).valueOf())}return Yt}highlightDataPoint(e,n,r,i){let o=n.containers[X.data],s=e.getContainerStateStyles,a=(0,I.default)(this.selectedDataPointIdxFn)?Ir:this.selectedDataPointIdxFn(n.dataSeries.id);o.selectAll(`g.${e.barContainerClass}`).each(function(u,c){let l;r===Yt?c===a||a===Ir?l=V.default:l=V.deemphasized:r===c||c===a?l=V.emphasized:l=V.deemphasized,O(this).attrs(s(l))})}draw(e,n,r){}},Hh=class extends La{outlineAdd=6;outlineElsMap=new Map;constructor(e,n=1,r){super(e,n,r)}highlightDataPoint(e,n,r){let i=n.containers[X.data],o=(0,I.default)(this.selectedDataPointIdxFn)?Ir:this.selectedDataPointIdxFn(n.dataSeries.id),s=i.selectAll(`g.${e.barContainerClass}`).nodes(),a=s[r]||s[o];if(!n.parentContainer)return;let u=`${e.barContainerClass}-outline-${n.dataSeries.id}`.split(".").join("-");if(!this.outlineElsMap.has(u)){let f=n.parentContainer.append("rect");f.classed(u,!0),this.outlineElsMap.set(u,f)}let c=this.outlineElsMap.get(u),l=n.dataSeries.data[r]?.y||n.dataSeries.data[r]?.value;if(l&&a&&c){let f=O(a).select("rect"),h=parseFloat(f.attr("x"))-this.outlineAdd/2,d=parseFloat(f.attr("y"))-this.outlineAdd/2,g=parseFloat(f.attr("width"))+this.outlineAdd,m=parseFloat(f.attr("height"))+this.outlineAdd;c.attr("x",h),c.attr("y",d),c.attr("width",g),c.attr("height",m),c.style("fill",f.style("fill")),c.style("display","inline")}(c&&!l||c&&!a)&&c.style("display","none")}},$h=class{scaleKey;levels;constructor(e,n=1){this.scaleKey=e,this.levels=n}getDataPointIndex(e,n,r,i){let o=r[this.scaleKey];return typeof o>"u"?Yt:this.findDataPointByValue(n,o,this.scaleKey)}findDataPointByValue(e,n,r){let i=r.toUpperCase(),o=e.accessors.data,s=o["start"+i],a=o["end"+i];if(typeof n=="string")return(0,_e.default)(e.data,(u,c)=>n===s?.(u,c,e.data,e));if((0,ue.default)(n))return(0,_e.default)(e.data,(u,c)=>{let l=s?.(u,c,e.data,e),f=Math.min(this.levels,n.length,l.length);for(let h=0;h<f;h++)if(n[h]!==l[h])return!1;return!0});if(n.valueOf){let u=n.valueOf();return(0,_e.default)(e.data,(c,l)=>u>=s?.(c,l,e.data,e).valueOf()&&u<=a?.(c,l,e.data,e).valueOf())}return Yt}highlightDataPoint(e,n,r,i){(r>=0||r===Yt)&&i.next({eventName:Oa,data:e.getDataPoint(n,n.dataSeries.data[r],r)})}draw(e,n,r){}},Vh=class extends no{getArc(e,n,r){return n.outerRadius(e[1]-e[0]).innerRadius(0)}};function gO(){let t=new Hr;return t.config(new Da),t}var Uh=class extends Mn{config;DEFAULT_CONFIG={curveType:fe,interactive:!0,areaClass:"nui-chart-area",markerInteraction:po};constructor(e={}){super(e),this.config=e,this.config=(0,ae.default)(this.config,this.DEFAULT_CONFIG)}draw(e,n){let r=e.containers[X.data],i=e.dataSeries.accessors,o=r.select(`path.${this.config.areaClass}`);if(o.empty()){if(!this.config.areaClass)throw new Error("areaClass is not defined");o=r.append("path").classed(this.config.areaClass,!0).attrs({fill:i.series.color?.(e.dataSeries.id,e.dataSeries)}).style("stroke-width",this.config.strokeWidth??1)}this.drawArea(e,o)}drawArea(e,n){let r=e.dataSeries,i=r.accessors,o=!1,s=r.data.filter((u,c)=>{let l=typeof i.data.absoluteX0?.(u,c,r.data,r)<"u"&&typeof i.data.absoluteX1?.(u,c,r.data,r)<"u"&&typeof i.data.absoluteY0?.(u,c,r.data,r)<"u"&&typeof i.data.absoluteY1?.(u,c,r.data,r)<"u";return!l&&!o&&(console.warn("Data point",u,"was skipped as accessors didn't manage to extract any data."),console.warn(" -> accessors.data.x0:",i.data.x0),console.warn(" -> accessors.data.y0:",i.data.y0),console.warn(" -> accessors.data.x1:",i.data.x1),console.warn(" -> accessors.data.y1:",i.data.y1),o=!0),l});if(!this.config.curveType)throw new Error("curveType is not defined");let a=Ho().x0((u,c)=>this.safetyCheck(e.scales.x.convert(i.data.absoluteX0?.(u,c,r.data,r)))).x1((u,c)=>this.safetyCheck(e.scales.x.convert(i.data.absoluteX1?.(u,c,r.data,r)))).y0((u,c)=>this.safetyCheck(e.scales.y.convert(i.data.absoluteY0?.(u,c,r.data,r)))).y1((u,c)=>this.safetyCheck(e.scales.y.convert(i.data.absoluteY1?.(u,c,r.data,r)))).curve(this.config.curveType);n.attr("d",a(s)??"")}getDomain(e,n,r,i){if(!e||e.length===0)return En;let o=n.accessors.data;if(r!=="x"&&r!=="y")return[void 0,void 0];let s=o[`absolute${r.toUpperCase()}0`],a=o[`absolute${r.toUpperCase()}1`];return[de(e,(u,c,l)=>de([s?.(u,c,l,n),a?.(u,c,l,n)])),he(e,(u,c,l)=>he([s?.(u,c,l,n),a?.(u,c,l,n)]))]}getRequiredLayers(){return[Ut[X.data],Ut[X.foreground]]}filterDataByDomain(e,n,r,i){let o=n.accessors.data[r+"0"],s=n.accessors.data[r+"1"];return e.filter((a,u)=>{let c=o?.(a,u,e,n),l=s?.(a,u,e,n);return Math.max(c,l)>=i[0]&&Math.min(c,l)<=i[1]})}highlightDataPoint(e,n,r){if(!e.dataSeries.accessors.series.marker||!this.config.interactive)return;let s=e.containers[X.foreground];xd.manageMarker(e.dataSeries,e.scales,n,s,r,this.config.markerInteraction)}safetyCheck(e){return typeof e>"u"||isNaN(e)?0:e}};function f1(t,e){if(t.length===0)return t;let n={},r="x",i="y";for(let o of t){if(o.preprocess===!1)continue;let s=o.accessors.data[r],a=o.accessors.data[i+"0"],u=o.accessors.data[i+"1"],c=e(o)?1:0;o.data.forEach((l,f)=>{let h=s(l,f,o.data,o),d=a?.(l,f,o.data,o),m=(u?.(l,f,o.data,o)-d)*c,p=n[h.valueOf()];typeof p>"u"&&(p=0,n[h.valueOf()]=p);let v=p+m;n[h.valueOf()]=v,l["__stack_"+i]={start:p,end:v}})}return t}function xO(t){return f1(t,e=>!this.isSeriesHidden(e.id))}function h1(t,e){if(t.length===0)return t;let n={},r={},i="x",o="y";for(let s of t)d1(i,o,s,e,r);for(let s of t)p1(i,o,s,e,n,r);return t}function vO(t){return h1(t,e=>!this.isSeriesHidden(e.id))}function d1(t,e,n,r,i){let o=n.accessors.data[t],s=n.accessors.data[e+"0"],a=n.accessors.data[e+"1"],u=r(n)?1:0;n.data.forEach((c,l)=>{let f=o(c,l,n.data,n),h=s?.(c,l,n.data,n),g=(a?.(c,l,n.data,n)-h)*u,m=i[f.valueOf()];typeof m>"u"&&(m=0,i[f.valueOf()]=m),i[f.valueOf()]=m+g})}function p1(t,e,n,r,i,o){let s=n.accessors.data[t],a=n.accessors.data[e+"0"],u=n.accessors.data[e+"1"],c=r(n)?1:0;n.data.forEach((l,f)=>{let h=s(l,f,n.data,n),d=a?.(l,f,n.data,n),m=(u?.(l,f,n.data,n)-d)*c,p=i[h.valueOf()];typeof p>"u"&&(p=0,i[h.valueOf()]=p);let v=m/o[h.valueOf()],y=p+v*100;i[h.valueOf()]=y,l["__stack_"+e]={start:p,end:y}})}function yO(t,e){let n=new co(t,e);return n.data.x=r=>r.x,n.data.y=n.data.absoluteY1,n.data.y0=()=>0,n.data.y1=r=>r.y,n}export{Vu as a,qu as b,om as c,sm as d,Ze as e,ad as f,Tr as g,Dr as h,ky as i,W as j,no as k,kh as l,jN as m,KN as n,QN as o,ZN as p,hd as q,Fy as r,JN as s,dd as t,so as u,fa as v,ao as w,tO as x,eO as y,zr as z,ho as A,Uy as B,Mn as C,Yy as D,pa as E,ma as F,Ph as G,rO as H,ba as I,wa as J,Je as K,Tn as L,Nr as M,Sr as N,vd as O,Hr as P,oO as Q,aO as R,Nh as S,uO as T,cO as U,lO as V,Oh as W,Ta as X,Fh as Y,fO as Z,hO as _,dO as $,zh as aa,pO as ba,mO as ca,La as da,Hh as ea,$h as fa,Vh as ga,gO as ha,Uh as ia,xO as ja,vO as ka,yO as la};
