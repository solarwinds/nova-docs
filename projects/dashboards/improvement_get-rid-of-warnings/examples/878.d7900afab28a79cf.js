"use strict";(self.webpackChunkexamples=self.webpackChunkexamples||[]).push([[878],{38878:(ee,C,r)=>{r.r(C),r.d(C,{ManyWidgetsModule:()=>q});var S=r(69808),m=r(40520),I=r(11420),l=r(30652),a=r(45388),f=r(27790),M=r(47794),W=r(68052),D=r(51454),R=r(37990),$=r(51933),Y=r(18631),E=r(22767),G=r(70655),L=r(61135),X=r(28746),e=r(5e3);let _=(()=>{class o extends l.LvN{constructor(t){super(),this.http=t,this.busy=new L.X(!1)}getFilteredData(){return(0,G.mG)(this,void 0,void 0,function*(){this.busy.next(!0);const t=Math.floor(Math.random()*Math.floor(99))+1;return new Promise(i=>{this.http.get(`https://jsonplaceholder.typicode.com/todos/${t}`).pipe((0,X.x)(()=>this.busy.next(!1))).subscribe({next:n=>{i({result:{value:n.id,label:n.title}})},error:n=>{i({result:null,error:{type:n.status}})}})})})}ngOnDestroy(){this.outputsSubject.complete()}}return o.providerId="AcmeKpiDataSource",o.mockError=!1,o.\u0275fac=function(t){return new(t||o)(e.LFG(m.eN))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac}),o})();var z=r(12498),x=r.n(z),T=r(77579),v=r(95698),N=r(82722),Z=r(90733),y=r.n(Z),J=r(34793),O=r.n(J);const F=o=>({id:`${o}`,type:"kpi",pizzagna:{[a.xW5.Configuration]:{header:{properties:{title:"KPI Widget!",subtitle:"A bunch of number boxes",collapsible:!0}},tiles:{providers:{},properties:{nodes:["kpi1"]}},kpi1:{id:"kpi1",providers:{[a.Muk.DataSource]:{providerId:_.providerId},[a.Muk.Adapter]:{providerId:a.u1$,properties:{componentId:"kpi1",propertyPath:"widgetData"}}}}}}}),[p,B]=function j(o){const d=[],t={},i={cols:8,rows:6,y:0,x:0};for(let n=0;n<=o;n++){const s=`widget${n.toString()}`,c=F(s),u=t[`widget${(n-1).toString()}`],h=u?Object.assign(Object.assign({},u),{y:u.y+6}):i;d.push(c),t[s]=h}return[d,t]}(15);function H(o,d){if(1&o&&(e.TgZ(0,"div",3)(1,"div",4),e._uU(2),e.qZA()()),2&o){const t=d.item;e.xp6(2),e.hij(" ",t.title," ")}}let b=(()=>{class o{constructor(t){this.widgetTypesService=t,this.widgetSelected=new e.vpe,this.widgetItems=[]}ngOnInit(){const t=new S.rS;this.widgetItems=p.map(i=>({title:t.transform(i.type),widget:this.widgetTypesService.mergeWithWidgetType(i)})),p.forEach(i=>{this.addUnconfiguredWidgetWithConfigLayer(i)})}addUnconfiguredWidget(t){const i=(new S.rS).transform(t);this.widgetItems.push({title:`Unconfigured ${i}`,widget:{id:`unconfigured${i}`,type:t,metadata:{needsConfiguration:!0},pizzagna:y()(this.widgetTypesService.getWidgetType(t).widget)}}),O()(this.widgetItems[this.widgetItems.length-1].widget.pizzagna,`${a.xW5.Structure}.header.properties.title`,`Unconfigured ${i}`)}addUnconfiguredWidgetWithConfigLayer(t){const i=(new S.rS).transform(t.type);this.widgetItems.push({title:`Unconfigured ${i} With Config Layer`,widget:Object.assign(Object.assign({},y()(this.widgetTypesService.mergeWithWidgetType(t))),{id:`unconfiguredWithConfigLayer${i}`,metadata:{needsConfiguration:!0}})}),O()(this.widgetItems[this.widgetItems.length-1].widget.pizzagna,`${a.xW5.Configuration}.header.properties.title`,`Unconfigured ${i} With Config Layer`)}onSelect(t){this.widgetSelected.emit(t[0].widget),this.widgetSelection=t}}return o.lateLoadKey="AcmeCloneSelectionComponent",o.\u0275fac=function(t){return new(t||o)(e.Y36(a.xTe))},o.\u0275cmp=e.Xpm({type:o,selectors:[["acme-clone-selection"]],outputs:{widgetSelected:"widgetSelected"},decls:4,vars:3,consts:[[1,"nui-widget-cloner"],["selectionMode","singleWithRequiredSelection",3,"itemsSource","selection","repeatItemTemplateRef","selectionChange"],["widgetClonerItem",""],[1,"nui-widget-cloner__item","d-flex","pt-2","pb-2","align-items-center"],[1,"text-info","ml-3"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"nui-repeat",1),e.NdJ("selectionChange",function(s){return i.onSelect(s)}),e.qZA()(),e.YNc(2,H,3,1,"ng-template",null,2,e.W1O)),2&t){const n=e.MAs(3);e.xp6(1),e.Q6J("itemsSource",i.widgetItems)("selection",i.widgetSelection)("repeatItemTemplateRef",n)}},directives:[l.$N6],styles:[".nui-widget-cloner__item[_ngcontent-%COMP%]{height:60px}"]}),o})();function K(o,d){if(1&o&&(e.TgZ(0,"div",3)(1,"div",4),e._uU(2),e.qZA()()),2&o){const t=d.item;e.xp6(2),e.hij(" ",t.title," ")}}let U=(()=>{class o extends b{constructor(t){super(t)}ngOnInit(){const t=new S.rS;this.widgetItems=p.map(i=>({title:t.transform(i.type),widget:this.widgetTypesService.mergeWithWidgetType(i)}))}}return o.lateLoadKey="AcmeCloneSelectionComponent",o.\u0275fac=function(t){return new(t||o)(e.Y36(a.xTe))},o.\u0275cmp=e.Xpm({type:o,selectors:[["acme-clone-selection"]],features:[e.qOj],decls:4,vars:3,consts:[[1,"nui-widget-cloner"],["selectionMode","singleWithRequiredSelection",3,"itemsSource","selection","repeatItemTemplateRef","selectionChange"],["widgetClonerItem",""],[1,"nui-widget-cloner__item","d-flex","pt-2","pb-2","align-items-center"],[1,"text-info","ml-3"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"nui-repeat",1),e.NdJ("selectionChange",function(s){return i.onSelect(s)}),e.qZA()(),e.YNc(2,K,3,1,"ng-template",null,2,e.W1O)),2&t){const n=e.MAs(3);e.xp6(1),e.Q6J("itemsSource",i.widgetItems)("selection",i.widgetSelection)("repeatItemTemplateRef",n)}},directives:[l.$N6],styles:[".nui-widget-cloner__item[_ngcontent-%COMP%]{height:60px}"]}),o})(),A=(()=>{class o{constructor(t){this.toastService=t,this.allowSubmit=!0,this.allowRemoval=!0,this.trySubmit=(i,n)=>{const s=new T.x;return setTimeout(()=>{if(this.allowSubmit)s.next(i);else{const c=$localize`Submit failed.`;this.toastService.error({title:c}),s.error(c)}},1e3),s.asObservable()},this.tryRemove=i=>{const n=new T.x;return setTimeout(()=>{if(this.allowRemoval)n.next(i);else{const s=$localize`Widget removal failed.`;this.toastService.error({title:s}),n.error(s)}},200),n.asObservable()},this.toastService.setConfig({timeOut:2e3})}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(l.klp))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac}),o})();var Q=r(34575),k=r(44994);const V=[{path:"",component:(()=>{class o{constructor(t,i,n,s,c){this.providerRegistry=t,this.submitHandler=i,this.widgetTypesService=n,this.widgetClonerService=s,this.refreshSettings=c,this.dashboard={positions:{},widgets:{}},this.gridsterConfig={minCols:12,maxCols:12,minRows:12},this.editMode=!1,this.systemRefreshInterval=60,this.belowFoldLazyLoadingConfig={enabled:!0},this.destroy$=new T.x,this.providerRegistry.setProviders({[_.providerId]:{provide:a.Fk3,useClass:_,deps:[m.eN]}})}ngOnInit(){var t,i;null===(i=null===(t=this.widgetTypesService.getWidgetType("table").configurator)||void 0===t?void 0:t[a.xW5.Structure].presentation.properties)||void 0===i||i.nodes.push("refresher"),this.refreshSettings.refreshRateSeconds=this.systemRefreshInterval;const n=p.map(c=>this.widgetTypesService.mergeWithWidgetType(c)),s=x()(n,c=>c.id);this.dashboard={positions:B,widgets:s}}onDsErrorSwitch(t){_.mockError=t}onShowButtonSwitch(t,i){for(const n of Object.keys(this.dashboard.widgets))this.dashboard=(0,l.zdu)(this.dashboard,`widgets.${n}.pizzagna.configuration.header.properties.${i}`,t)}ngAfterViewInit(){this.dashboardComponent.eventBus.subscribeUntil(a.MOJ,this.destroy$,t=>{this.widgetClonerService.open({widget:this.dashboard.widgets[t.widgetId],dashboardComponent:this.dashboardComponent,trySubmit:this.submitHandler.trySubmit,widgetSelectionComponentType:U}).pipe((0,v.q)(1),(0,N.R)(this.destroy$)).subscribe()})}onCloneWidget(){this.widgetClonerService.open({dashboardComponent:this.dashboardComponent,trySubmit:this.submitHandler.trySubmit,widgetSelectionComponentType:b}).pipe((0,v.q)(1),(0,N.R)(this.destroy$)).subscribe()}onEditWithCloner(){this.dashboardComponent.eventBus.next(a.MOJ,{widgetId:p[0].id})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}onSystemRefreshIntervalClick(){this.refreshSettings.refreshRateSeconds=this.systemRefreshInterval}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(a.CNH),e.Y36(A),e.Y36(a.xTe),e.Y36(a.$Ie),e.Y36(a.g4s))},o.\u0275cmp=e.Xpm({type:o,selectors:[["many-widgets-dashboard-dashboard"]],viewQuery:function(t,i){if(1&t&&e.Gf(a.MXM,7),2&t){let n;e.iGM(n=e.CRH())&&(i.dashboardComponent=n.first)}},features:[e._Bn([A])],decls:25,vars:11,consts:function(){let d,t,i,n,s,c,u,h,P,w;return d=$localize`:␟489801ff09de9b4a6ca8b6e05a475fa1ca00d98e␟5813529530812520031: Create Widget Clone
`,t=$localize`:␟d8e9c9957a5d6ebe7749aab0e18dcb5d944b2ef9␟7916291516675251750: Simulate edit with cloner
`,i=$localize`:␟5cab2718f1d3c09ccb1fca4886710430f59bf7c0␟81810662047948365: Edit mode `,n=$localize`:␟db70aaa4da7a9f7c0fa3a218907f9fa354a19038␟5855643886473775120: Allow Submit `,s=$localize`:␟d289dfdc6c4e23b49a96db083f95f1087ed1400a␟3687117978364204872: Allow Removal `,c=$localize`:␟3299af3b186d7701f4c0626e41eba58af8382723␟4106211393112768148: Show Edit Button `,u=$localize`:␟30251ad3dcd7facd3a222d48fb2ba02f8503c52c␟8096484277280346189: Show Remove Button `,h=$localize`:␟c355f0feb3f72b3594e6e975456cd0a2dac1d929␟870224976565315483: Data Source Error `,P=$localize`:␟90504d9af68fb3aa81accb4bc3005526deb04093␟5488473345097746222:System refresh interval (seconds)`,w=$localize`:␟559db359e3dcc0820499a4e58208fb22273e0d55␟5928813357836950616: Update system refresh interval `,[["type","button","nui-button","",1,"mb-3","ml-4",3,"click"],d,t,[1,"w-100",2,"height","725px"],[3,"nuiWidgetEditor","dashboard","gridsterConfig","editMode","belowFoldLazyLoadingConfig","dashboardChange","gridsterConfigChange"],[1,"my-3","d-flex","align-items-center"],[1,"ml-3",3,"value","valueChange"],i,n,s,c,u,[1,"ml-3",3,"valueChange"],h,[1,"d-flex","flex-row"],[2,"width","300px"],["caption",P],[3,"value","valueChange"],["type","button","nui-button","",1,"ml-4",3,"click"],w]},template:function(t,i){1&t&&(e.TgZ(0,"button",0),e.NdJ("click",function(){return i.onCloneWidget()}),e.SDv(1,1),e.qZA(),e.TgZ(2,"button",0),e.NdJ("click",function(){return i.onEditWithCloner()}),e.SDv(3,2),e.qZA(),e.TgZ(4,"div",3)(5,"nui-dashboard",4),e.NdJ("dashboardChange",function(s){return i.dashboard=s})("gridsterConfigChange",function(s){return i.gridsterConfig=s}),e.qZA()(),e.TgZ(6,"div",5)(7,"nui-switch",6),e.NdJ("valueChange",function(s){return i.editMode=s}),e.SDv(8,7),e.qZA(),e.TgZ(9,"nui-switch",6),e.NdJ("valueChange",function(s){return i.submitHandler.allowSubmit=s}),e.SDv(10,8),e.qZA(),e.TgZ(11,"nui-switch",6),e.NdJ("valueChange",function(s){return i.submitHandler.allowRemoval=s}),e.SDv(12,9),e.qZA(),e.TgZ(13,"nui-switch",6),e.NdJ("valueChange",function(s){return i.onShowButtonSwitch(s,"editable")}),e.SDv(14,10),e.qZA(),e.TgZ(15,"nui-switch",6),e.NdJ("valueChange",function(s){return i.onShowButtonSwitch(s,"removable")}),e.SDv(16,11),e.qZA(),e.TgZ(17,"nui-switch",12),e.NdJ("valueChange",function(s){return i.onDsErrorSwitch(s)}),e.SDv(18,13),e.qZA()(),e.TgZ(19,"div",14)(20,"div",15)(21,"nui-form-field",16)(22,"nui-textbox-number",17),e.NdJ("valueChange",function(s){return i.systemRefreshInterval=s}),e.qZA()()(),e.TgZ(23,"button",18),e.NdJ("click",function(){return i.onSystemRefreshIntervalClick()}),e.SDv(24,19),e.qZA()()),2&t&&(e.xp6(5),e.Q6J("nuiWidgetEditor",i.submitHandler)("dashboard",i.dashboard)("gridsterConfig",i.gridsterConfig)("editMode",i.editMode)("belowFoldLazyLoadingConfig",i.belowFoldLazyLoadingConfig),e.xp6(2),e.Q6J("value",i.editMode),e.xp6(2),e.Q6J("value",i.submitHandler.allowSubmit),e.xp6(2),e.Q6J("value",i.submitHandler.allowRemoval),e.xp6(2),e.Q6J("value",!0),e.xp6(2),e.Q6J("value",!0),e.xp6(7),e.Q6J("value",i.systemRefreshInterval))},directives:[l.r0F,Q.M,k.t,l.qUD,l.hgI,l.I5I],styles:[".nui-theme-switcher-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;padding:10px;background-color:var(--nui-color-bg-light,#fff)}"]}),o})(),data:{srlc:{hideIndicator:!0},showThemeSwitcher:!0}}];let q=(()=>{class o{constructor(t,i){this.widgetTypesService=t,this.componentRegistry=i,this.setupDataSourceProviders(),this.setupCustomProportionalWidgetDSConfig()}setupCustomProportionalWidgetDSConfig(){var t;const i=this.widgetTypesService.getWidgetType("proportional",1);null===(t=i.widget.structure[a.XMI].providers)||void 0===t||delete t.refresher,this.widgetTypesService.setNode(i,"configurator",a.ACc.DataSourceConfigComponentType,f.b.lateLoadKey),this.componentRegistry.registerByLateLoadKey(f.b)}setupDataSourceProviders(){this.setDataSourceProviders("table",[W.g.providerId,D.W.providerId,R.t.providerId,Y.n.providerId,$.a.providerId]);const t=this.widgetTypesService.getWidgetType("kpi",1);this.widgetTypesService.setNode(t,"configurator",a.ACc.DataSourceConfigComponentType,a.cY_.lateLoadKey),this.setDataSourceProviders("kpi",[{providerId:_.providerId,label:"Acme KPI Data Source 1"}]),this.setDataSourceProviders("proportional",[M.Q.providerId,M.s.providerId]),this.setDataSourceProviders("timeseries",[E.wi.providerId,E.u2.providerId])}setDataSourceProviders(t,i){const n=this.widgetTypesService.getWidgetType(t,1);this.widgetTypesService.setNode(n,"configurator",a.ACc.DataSourceProviders,i)}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(a.xTe),e.LFG(a.hiK))},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[a.CNH],imports:[[S.ez,m.JF,a.Pi,l.Gsl,l.Az_,l.vvu,l.cJ5,l.Ts3,l.sF0,l.ZuS,I.Bz.forChild(V),l.C6o,l.YMY]]}),o})()}}]);