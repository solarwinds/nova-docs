import{a as ie,d as w,e as oe}from"./chunk-JDWR5CD2.js";import{b as ue}from"./chunk-SPX2OUAB.js";import{a as ce}from"./chunk-MNLBQFGT.js";import{a as Z}from"./chunk-PRPDBMMC.js";import{a as $,c as G,g as Y,k as J}from"./chunk-I5QGFHJG.js";import{a as ne}from"./chunk-3SNBLT4R.js";import{c as x,f as ee}from"./chunk-ZEY3WGPI.js";import{p as te}from"./chunk-IOE73CTL.js";import{a as g}from"./chunk-KNI7S7QC.js";import{a as X}from"./chunk-YILH52ZF.js";import{a as ae}from"./chunk-ZR5STDHI.js";import{l as q}from"./chunk-EHNCPSLF.js";import{Bb as M,Db as L,Dc as z,Eb as F,Ec as H,Fc as Q,Gc as U,Ha as A,La as v,Pb as b,Qb as u,Sb as d,Wb as m,Xb as p,Yc as I,ac as V,ha as S,ia as k,mc as f,na as K,nb as h,nc as E,oc as B,pc as D,tb as s,tc as N,vc as j,wa as O,wc as P,xa as a,xc as W,ya as c,zb as T}from"./chunk-MC3BMXIX.js";import{g as _}from"./chunk-VBFW7A5V.js";var se=(()=>{class o{constructor(e,i){this.elRef=e,this.cdRef=i,this.isActive=!1}setActiveStyles(){this.isActive=!0,this.cdRef.markForCheck()}setInactiveStyles(){this.isActive=!1,this.cdRef.markForCheck()}static{this.\u0275fac=function(i){return new(i||o)(s(v),s(I))}}static{this.\u0275dir=M({type:o,selectors:[["","nuiMarkAsSelectedItem",""]],hostVars:2,hostBindings:function(i,t){i&2&&d("active",t.isActive)},standalone:!1})}}return o})();var le=_(ue()),R=_(ce());var y=_(ae());var C=(()=>{class o{constructor(e){this.liveAnnouncer=e}initSelectedItemsKeyManager(e,i){this.combobox=i,this.inputElement=i.inputElement?.nativeElement,this.selectedItems=e,this.selectedItemsKeyManager=new ee(e).withHorizontalOrientation("ltr").withWrap(),!(0,y.default)(this.activeSelectedItemIndex)&&this.activeSelectedItemIndex>=0&&Number.isInteger(this.activeSelectedItemIndex)&&setTimeout(()=>this.selectedItemsKeyManager.setActiveItem(this.activeSelectedItemIndex))}onKeydown(e){let i=e.target.selectionStart,t=this.isBackspace(e)||this.isLeftOrRightArrow(e);if(!(i!==0||!this.activeItem&&this.isRightArrow(e))){if(!t){this.deactivateSelectedItems();return}if(!this.combobox.manualDropdownControl&&!this.activeItem&&this.combobox.hideDropdown(),this.isLeftArrow(e)&&this.activeItem!==this.selectedItems.first){this.selectedItemsKeyManager.onKeydown(e),this.liveAnnouncer.announce(`${this.getActiveItemTitle} selected`);return}if(this.isRightArrow(e)&&this.activeItem){this.handleRightArrow(e);return}if(this.isBackspace(e)){this.handleBackspace();return}}}setLastItemActive(){this.selectedItemsKeyManager.setLastItemActive()}isSelectedItemsActive(){return!!this.activeItem}deactivateSelectedItems(){this.selectedItemsKeyManager.setActiveItem(-1),this.activeSelectedItemIndex=void 0}handleBackspace(){if(this.activeItem){this.deselectItem();return}if(!this.activeItem){this.setLastItemActive();return}}handleRightArrow(e){if(this.activeItem===this.selectedItems.last){this.selectedItemsKeyManager.onKeydown(e),this.deactivateSelectedItems(),this.combobox.manualDropdownControl||this.combobox.showDropdown();return}this.selectedItemsKeyManager.onKeydown(e),this.liveAnnouncer.announce(`${this.getActiveItemTitle} selected`)}calculateActiveSelectedItemIndex(){if((0,y.default)(this.selectedItemsKeyManager.activeItemIndex))throw new Error("ActiveItemIndex is not defined");let e=this.selectedItemsKeyManager.activeItemIndex-1;if(e>=0){this.activeSelectedItemIndex=e;return}if(e===-1&&this.selectedItems.length>1){this.activeSelectedItemIndex=0;return}if(e===-1&&this.selectedItems.length){this.activeSelectedItemIndex=void 0;return}if(e>=0&&this.selectedItems.length===0){this.activeSelectedItemIndex=void 0;return}}isBackspace(e){return e.code===g.BACKSPACE}isLeftOrRightArrow(e){return this.isLeftArrow(e)||this.isRightArrow(e)}isRightArrow(e){return e.code===g.ARROW_RIGHT}isLeftArrow(e){return e.code===g.ARROW_LEFT}get activeItem(){return this.selectedItemsKeyManager.activeItem}deselectItem(){(0,y.default)(this.selectedItemsKeyManager.activeItemIndex)||(this.calculateActiveSelectedItemIndex(),this.combobox.deselectItem(this.selectedItemsKeyManager.activeItemIndex),this.liveAnnouncer.announce(`${this.getActiveItemTitle} removed`))}get getActiveItemTitle(){return this.activeItem?.cdRef.context.item.label||""}static{this.\u0275fac=function(i){return new(i||o)(K(x))}}static{this.\u0275prov=k({token:o,factory:o.\u0275fac})}}return o})();var he=[[["","selectedItems",""]],"*"],pe=["[selectedItems]","*"];function ve(o,be){if(o&1){let e=V();m(0,"button",6),f("click",function(t){a(e);let n=E();return c(n.clearValue(t))}),p()}if(o&2){let e=E();d("disabled",e.isDisabled),u("isEmpty",!0)("nuiTooltip",e.clearValueButtonTooltip)("disabled",e.isDisabled)}}var He=(()=>{class o extends oe{set selectedItems(e){this.selectedItemsKeyControlService.initSelectedItemsKeyManager(e,this)}constructor(e,i,t,n,r){super(i,t,e,r),this.selectedItemsKeyControlService=n,this.liveAnnouncer=r,this.displayWith=null,this.isRemoveValueEnabled=!0,this.isTypeaheadEnabled=!0,this.searchEmpty=new A(!1),this.canCreateOption=new A(!1)}ngAfterContentInit(){this.clearValueButtonTooltip=this.multiselect?$localize`Remove all`:$localize`Remove`,setTimeout(()=>{super.ngAfterContentInit(),this.multiselect||this.setInputValue(this.getLastSelectedOption()?.value),this.cdRef.markForCheck()}),this.optionsChanged().subscribe(()=>{this.filterItems(this.inputValue.toString()),this.optionKeyControlService.scrollToActiveItem({block:"start",behavior:"smooth"}),this.cdRef.markForCheck()})}ngAfterViewInit(){super.ngAfterViewInit(),this.multiselect||this.dropdown.hide$.subscribe(()=>{let e=this.getLastSelectedOption();e&&(this.setInputValue(e.value),this.filterItems(this.inputValue.toString()),this.cdRef.markForCheck())})}ngOnChanges(e){super.ngOnChanges(e)}onMouseUp(e){if(this.mouseDown=!1,!this.manualDropdownControl){if(e!==this.inputElement.nativeElement&&!this.dropdown.showing){this.inputElement.nativeElement.focus();return}this.toggleDropdown()}}onKeyDown(e){super.onKeyDown(e),this.selectedItemsKeyControlService.onKeydown(e),this.selectedItemsKeyControlService.isSelectedItemsActive()?this.optionKeyControlService.resetActiveItem():this.optionKeyControlService.getActiveItemIndex()===-1&&this.optionKeyControlService.setFirstItemActive()}toggleDropdown(){super.toggleDropdown(),this.selectedItemsKeyControlService.deactivateSelectedItems()}selectOption(e){e.outfiltered||e.isDisabled||(super.selectOption(e),this.setInputValue(e.value),this.filterItems(),this.multiselect&&this.optionKeyControlService.setFirstItemActive(),this.cdRef.markForCheck())}deselectItem(e){let i;if(typeof e=="number"&&this.multiselect){let t=this.value[e];i=this.options.find(n=>(0,R.default)(n.value,t))}else i=this.options.find(t=>(0,R.default)(t.value,e));i&&(this.removeSelected(i),this.filterItems(),this.optionKeyControlService.setFirstItemActive())}handleInput(e){if(!e&&!this.multiselect){this.clearValue();return}this.filterItems(e.toString()),this.manualDropdownControl||this.showDropdown(),this.valueChanged.emit(e)}selectTextInInput(){this.isDropdownOpen&&setTimeout(()=>this.inputElement.nativeElement.select())}writeValue(e){super.writeValue(e),this.setInputValue(e),this.cdRef.markForCheck()}clearValue(e,i){this.isDisabled||(this.selectedOptions=[],this.onTouched(),this.setInputValue(""),this.removeSelected(),e?.stopPropagation(),this.filterItems(),this.optionKeyControlService.setFirstItemActive(),!i&&!this.manualDropdownControl&&this.dropdown.hide())}ngOnDestroy(){super.ngOnDestroy()}handleValueChange(e){this.multiselect&&this.selectedOptions.forEach(i=>i.outfiltered=!1),super.handleValueChange(e)}setInputValue(e){let i=this.multiselect?"":e,t=this.displayWith?this.displayWith(i):i;this.inputValue=t||"",this.valueChanged.emit(this.inputValue)}filterItems(e){if(this.isTypeaheadEnabled){let i=e?.toString().toLowerCase()||"";this.multiselect||(i=this.getLastSelectedOption()?.viewValue.toLowerCase()===i?"":i),this.options.forEach(t=>{let n=t.viewValue.toLowerCase();t.outfiltered=!(0,le.default)(n,i)}),this.multiselect&&this.selectedOptions.forEach(t=>t.outfiltered=!0),this.emitSearchResults()}}emitSearchResults(){let e=!this.options.some(i=>!i.outfiltered);this.searchEmpty.emit(e),this.canCreateOption.emit(this.isInputValueUnique())}isInputValueUnique(){let e=t=>t?.viewValue.toLowerCase(),i=this.inputValue.toString().toLowerCase();return!!(this.inputValue&&!this.options.find(t=>e(t)===i))}static{this.\u0275fac=function(i){return new(i||o)(s(v),s(w),s(I),s(C),s(x))}}static{this.\u0275cmp=T({type:o,selectors:[["nui-combobox-v2"]],contentQueries:function(i,t,n){if(i&1&&N(n,se,5),i&2){let r;j(r=P())&&(t.selectedItems=r)}},hostAttrs:["role","combobox","aria-haspopup","listbox","aria-owns","nui-overlay",1,"nui-combobox-v2"],hostVars:1,hostBindings:function(i,t){i&2&&b("aria-expanded",t.isDropdownOpen||!1)},inputs:{displayWith:"displayWith",isRemoveValueEnabled:"isRemoveValueEnabled",isTypeaheadEnabled:"isTypeaheadEnabled"},outputs:{searchEmpty:"searchEmpty",canCreateOption:"canCreateOption"},standalone:!1,features:[U([w,C,{provide:ie,useExisting:o},{provide:$,useExisting:S(()=>o),multi:!0},{provide:Z,useExisting:S(()=>o),multi:!0}]),L,O],ngContentSelectors:pe,decls:8,vars:17,consts:[["input",""],[1,"w-100","d-flex","flex-wrap","align-items-center","pt-2"],["type","text",1,"nui-combobox-v2__input","pb-2",3,"ngModelChange","input","keydown","click","disabled","ngModel","placeholder"],["tabindex","0","nui-button","","class","nui-combobox-v2__remove-value action","icon","remove","type","button",3,"isEmpty","nuiTooltip","disabled","click",4,"ngIf"],["tabindex","-1","nui-button","","type","button","icon","caret-down",1,"nui-combobox-v2__toggle","action",3,"click","isEmpty","disabled"],["roleAttr","listbox",3,"toggleReference","viewportMargin","overlayConfig"],["tabindex","0","nui-button","","icon","remove","type","button",1,"nui-combobox-v2__remove-value","action",3,"click","isEmpty","nuiTooltip","disabled"]],template:function(i,t){if(i&1){let n=V();B(he),m(0,"div",1),D(1),m(2,"input",2,0),Q("ngModelChange",function(l){return a(n),H(t.inputValue,l)||(t.inputValue=l),c(l)}),f("input",function(){a(n);let l=W(3);return c(t.handleInput(l.value))})("keydown",function(l){return a(n),c(t.onKeyDown(l))})("click",function(){return a(n),c(t.selectTextInInput())}),p()(),F(4,ve,1,5,"button",3),m(5,"button",4),f("click",function(){return a(n),c(t.selectTextInInput())}),p(),m(6,"nui-overlay",5),D(7,1),p()}i&2&&(b("role",t.multiselect&&t.selectedOptions.length?"list":null),h(2),d("has-error",t.isInErrorState),u("disabled",t.isDisabled),z("ngModel",t.inputValue),u("placeholder",t.placeholder),b("aria-label",t.ariaLabel||"input"),h(2),u("ngIf",t.isRemoveValueEnabled&&(t.selectedOptions[0]||t.inputValue)),h(),d("rotate",t.isDropdownOpen)("disabled",t.isDisabled),u("isEmpty",!0)("disabled",t.isDisabled),h(),u("toggleReference",t.elRef.nativeElement)("viewportMargin",t.popupViewportMargin)("overlayConfig",t.overlayConfig))},dependencies:[G,Y,J,X,ne,q,te],styles:[`.nui-combobox-v2{border-color:var(--nui-color-line-default,#d9d9d9);border-width:1px;border-style:solid;border-radius:3px;background:var(--nui-color-bg-content,#fff);box-shadow:inset 0 1px 1px #00000013;display:flex;transition:border-color ease-in-out .15s,box-shadow ease-in-out .15s;color:var(--nui-color-text-default,#111);min-height:28px;line-height:23px;min-width:100px;font-size:13px}.nui-combobox-v2:hover{border-color:var(--nui-color-line-default-hover,#b3b3b3)}.nui-combobox-v2:focus-within,.nui-combobox-v2:focus{border-color:var(--nui-color-line-active,#0079aa);outline:none}.nui-combobox-v2.error,.nui-combobox-v2.has-error{border-color:var(--nui-color-line-critical,#dd2c00)}.nui-combobox-v2.error:hover,.nui-combobox-v2.has-error:hover,.nui-combobox-v2.error:focus,.nui-combobox-v2.has-error:focus,.nui-combobox-v2.error:active,.nui-combobox-v2.has-error:active{border-color:var(--nui-color-line-critical,#dd2c00)}.nui-combobox-v2.disabled,.nui-combobox-v2[disabled]{background:var(--nui-color-disabled-secondary,#e8e8e8);border-color:transparent;cursor:not-allowed}.nui-combobox-v2.disabled:hover,.nui-combobox-v2[disabled]:hover{background:var(--nui-color-disabled-secondary,#e8e8e8);border-color:transparent}.nui-combobox-v2[readonly]{color:var(--nui-color-text-secondary,rgba(17, 17, 17, .6));background:var(--nui-color-disabled-secondary,#e8e8e8);border-color:transparent;cursor:default}.nui-combobox-v2[readonly]:hover,.nui-combobox-v2[readonly]:focus,.nui-combobox-v2[readonly]:active{color:var(--nui-color-text-secondary,rgba(17, 17, 17, .6));background:var(--nui-color-disabled-secondary,#e8e8e8);border-color:transparent}.nui-combobox-v2.disabled{color:var(--nui-color-text-disabled,rgba(17, 17, 17, .3));-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none}.nui-combobox-v2__input{flex:1;outline:none;box-sizing:border-box;border:none;background-color:transparent;background-image:none;min-height:23px;height:23px;resize:vertical;padding:0 10px;overflow-y:hidden;cursor:text;width:inherit;white-space:nowrap;overflow:hidden;-ms-text-overflow:ellipsis;-o-text-overflow:ellipsis;text-overflow:ellipsis}.nui-combobox-v2__input[disabled]{cursor:not-allowed}.nui-combobox-v2__input[disabled]::placeholder{color:var(--nui-color-text-disabled,rgba(17, 17, 17, .3))}.nui-combobox-v2__input::placeholder{color:var(--nui-color-text-secondary,rgba(17, 17, 17, .6));font-size:13px;font-weight:400;margin-right:5px;white-space:nowrap;overflow:hidden;-ms-text-overflow:ellipsis;-o-text-overflow:ellipsis;text-overflow:ellipsis}.nui-combobox-v2__remove-value.nui-button.action{border:none;border-radius:0;border-right:1px solid;border-right-color:var(--nui-color-line-default,#d9d9d9);min-height:28px;max-height:28px;align-self:center}.nui-combobox-v2__remove-value.nui-button.action:hover,.nui-combobox-v2__remove-value.nui-button.action:focus,.nui-combobox-v2__remove-value.nui-button.action:active{border-right:1px solid;border-right-color:var(--nui-color-line-default,#d9d9d9)}.nui-combobox-v2__remove-value.nui-button.action:focus{border-radius:3px;outline:none;z-index:500;box-shadow:inset 0 0 0 2px #00c4d280}.nui-combobox-v2__toggle.nui-button.action{min-height:28px;max-height:28px;align-self:center}.nui-combobox-v2__toggle.nui-button.action.rotate nui-icon{transform:rotate(180deg)}
`],encapsulation:2,changeDetection:0})}}return o})();export{se as a,He as b};
