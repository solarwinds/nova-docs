import{a as $}from"./chunk-T2WNPALM.js";import{a as z}from"./chunk-RK3CRQSE.js";import{a as N}from"./chunk-UINJOPJ7.js";import{a as V}from"./chunk-DP6M2T73.js";import{a as w}from"./chunk-BGMOZI4C.js";import{a as K}from"./chunk-OJIWOMMY.js";import{a as F}from"./chunk-CUY44B7R.js";import{Cb as v,Ha as k,Qb as P,Wb as m,Xb as d,Yc as R,hc as I,ia as M,mc as E,nb as p,tb as D,wa as y,zb as S}from"./chunk-MC3BMXIX.js";import{a as f,b as h,f as g,g as o}from"./chunk-VBFW7A5V.js";var B=g((H,L)=>{var q=w(),j=z(),x=K(),G=j(function(a,T){q(T,x(T),a)});L.exports=G});var b=g((U,O)=>{O.exports=B()});var C=o(b()),c=o(N()),s=o(F());var l=(()=>{class a{static cloneTimeFrame(e){return h(f({},e),{startDatetime:e.startDatetime.clone(),endDatetime:e.endDatetime.clone()})}constructor(){this.defaultPresets={lastHour:{name:$localize`Last hour`,startDatetimePattern:{hours:-1},endDatetimePattern:{}},last12Hours:{name:$localize`Last 12 hours`,startDatetimePattern:{hours:-12},endDatetimePattern:{}},last24Hours:{name:$localize`Last 24 hours`,startDatetimePattern:{hours:-24},endDatetimePattern:{}},last5Days:{name:$localize`Last 5 days`,startDatetimePattern:{days:-5},endDatetimePattern:{}},last7Days:{name:$localize`Last 7 days`,startDatetimePattern:{days:-7},endDatetimePattern:{}},last30Days:{name:$localize`Last 30 days`,startDatetimePattern:{days:-30},endDatetimePattern:{}}},this.currentPresets=(0,C.default)({},this.defaultPresets),this.reconcileTimeframe=(e,t,i)=>{t||(t=this.currentPresets),i||(i=(0,s.default)());let n=e.selectedPresetId&&t[e.selectedPresetId];return n?h(f({},e),{startDatetime:i.clone().add(n.startDatetimePattern),endDatetime:i.clone().add(n.endDatetimePattern)}):a.cloneTimeFrame(e)}}getTimeframe(e,t,i){if((0,c.default)(e))throw new Error("Parameter 'startDatetimePattern' is undefined");if((0,c.default)(t))throw new Error("Parameter 'endDateTimePattern' is undefined");let n=(0,s.default)(i).add(e),r=(0,s.default)(i).add(t);return{startDatetime:n,endDatetime:r,selectedPresetId:null}}getTimeframeByPresetId(e,t){if((0,c.default)(e))throw new Error("Parameter 'id' is undefined");let i=(0,s.default)(t).add(this.currentPresets[e].startDatetimePattern),n=(0,s.default)(t).add(this.currentPresets[e].endDatetimePattern);return{startDatetime:i,endDatetime:n,selectedPresetId:e,title:this.currentPresets[e].name}}getDefaultPresets(){return this.defaultPresets}extendCurrentPresets(e){(0,C.default)(this.currentPresets,e)}isEqual(e,t,i="minutes"){return e&&t&&e.endDatetime.isSame(t.endDatetime,i)&&e.startDatetime.isSame(t.startDatetime,i)}isEqualDuration(e,t,i="minutes"){return e&&t&&e.startDatetime.diff(e.endDatetime,i)===t.startDatetime.diff(t.endDatetime,i)}shiftTimeFrame(e,t){return{startDatetime:e.startDatetime.clone().add(t),endDatetime:e.endDatetime.clone().add(t),selectedPresetId:null}}getDuration(e){return s.default.duration(e.endDatetime.diff(e.startDatetime))}areTimeFrameDatesValid(e){let{startDatetime:t,endDatetime:i}=e,n=t&&t.isValid(),r=i&&i.isValid();return n&&r}static{this.\u0275fac=function(t){return new(t||a)}}static{this.\u0275prov=M({token:a,factory:a.\u0275fac})}}return a})();var u=o(V()),_=o(F());var re=(()=>{class a{constructor(e,t){this.timeFrameService=e,this.changeDetector=t,this.changed=new k}ngOnChanges(e){e.startModel&&(this.model=l.cloneTimeFrame(this.startModel),this.validateCombination())}ngOnInit(){this.startModel&&(this.model=l.cloneTimeFrame(this.startModel),this.validateCombination())}selectPreset(e,t){let i=this.timeFrameService.getTimeframe(t.startDatetimePattern,t.endDatetimePattern);i.selectedPresetId=e,this.model=i}isPresetSelected(e){return this.model&&this.model.selectedPresetId===e}onChangeInternalStart(e){this.model.startDatetime=e,this.onChangeInternal()}onChangeInternalEnd(e){this.model.endDatetime=e,this.onChangeInternal()}onBlurInternal(){this.validateCombination(),!this.model.startDatetime||!this.model.endDatetime?this.model=(0,u.default)(this.modelDefault):this.modelDefault=(0,u.default)(this.model),this.isFocused=!1}onFocusInternal(){this.modelDefault=(0,u.default)(this.model),this.isFocused=!0}validateCombination(){this.model.startDatetime&&this.model.endDatetime&&(this.model.startDatetime>=this.model.endDatetime?(this.model.endDatetime=(0,_.default)(this.model.startDatetime.valueOf()+this.distanceToEndDate),this.model.selectedPresetId=void 0,this.model.title=void 0):this.updateDistanceToEndDate(this.model.startDatetime,this.model.endDatetime))}updateDistanceToEndDate(e,t){let i=(0,_.default)(e),n=(0,_.default)(t);i.isValid()&&n.isValid()&&(this.distanceToEndDate=t.valueOf()-e.valueOf())}onChangeInternal(){if(this.isFocused||this.validateCombination(),this.model.selectedPresetId){let e=this.timeFrameService.getTimeframeByPresetId(this.model.selectedPresetId);(!this.model.startDatetime||!this.model.endDatetime||!this.timeFrameService.isEqualDuration(this.model,e))&&(this.model.selectedPresetId=void 0,this.model.title=void 0)}this.changed.emit(this.model)}static{this.\u0275fac=function(t){return new(t||a)(D(l),D(R))}}static{this.\u0275cmp=S({type:a,selectors:[["nui-time-frame-picker"]],inputs:{minDate:"minDate",maxDate:"maxDate",startModel:"startModel",appendToBody:"appendToBody"},outputs:{changed:"changed"},standalone:!1,features:[y],decls:10,vars:8,consts:()=>{let e;e=$localize`:␟8434d4a28744d7df82cd39ef8da4266fcbc40064␟5162686434580248853:Start`;let t;return t=$localize`:␟b68ce78c3f2c548391d812c248217f8a212491e1␟1241348629231510663:End`,[e,t,[1,"nui-time-frame-picker"],[1,"nui-time-frame-picker__date-times"],[1,"nui-time-frame-picker__label"],[1,"nui-time-frame-picker__date-time","nui-time-frame-picker__date-time_start"],[3,"modelChanged","focus","blur","minDate","maxDate","model","appendToBody"],[1,"nui-time-frame-picker__date-time","nui-time-frame-picker__date-time_end"]]},template:function(t,i){t&1&&(m(0,"div",2)(1,"div",3)(2,"label",4),I(3,0),d(),m(4,"span",5)(5,"nui-date-time-picker",6),E("modelChanged",function(r){return i.onChangeInternalStart(r)})("focus",function(){return i.onFocusInternal()})("blur",function(){return i.onBlurInternal()}),d()(),m(6,"label",4),I(7,1),d(),m(8,"span",7)(9,"nui-date-time-picker",6),E("modelChanged",function(r){return i.onChangeInternalEnd(r)})("focus",function(){return i.onFocusInternal()})("blur",function(){return i.onBlurInternal()}),d()()()()),t&2&&(p(5),P("minDate",i.minDate)("maxDate",i.maxDate)("model",i.model.startDatetime)("appendToBody",i.appendToBody),p(4),P("minDate",i.minDate)("maxDate",i.maxDate)("model",i.model.endDatetime)("appendToBody",i.appendToBody))},dependencies:[$],styles:[`.nui-time-frame-picker__date-time{display:flex}.nui-time-frame-picker__date-time_start{margin-bottom:15px}.nui-time-frame-picker__date-time_end{padding-bottom:10px}
`],encapsulation:2,changeDetection:0})}}return a})();var oe=(()=>{class a{transform(e,t="LLL"){return e?e.title||`${e.startDatetime.format(t)} - ${e.endDatetime.format(t)}`:""}static{this.\u0275fac=function(t){return new(t||a)}}static{this.\u0275pipe=v({name:"timeFrame",type:a,pure:!0,standalone:!1})}}return a})();export{l as a,re as b,oe as c};
