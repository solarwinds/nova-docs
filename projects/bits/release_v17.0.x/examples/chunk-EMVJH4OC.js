import{a as G}from"./chunk-EGPV2BM7.js";import{a as he}from"./chunk-XMJI4K6R.js";import{a as le}from"./chunk-DCAJHS4Z.js";import{a as ce}from"./chunk-XZBZIPTN.js";import{b as de}from"./chunk-RBCDJAEW.js";import{a as ae}from"./chunk-LT3SQWXE.js";import{f as m,g as $,s as Q}from"./chunk-P53HI2D5.js";import{c as z,h as I}from"./chunk-LVGKZ3JP.js";import{A as j}from"./chunk-CHJVZ6O7.js";import{a as s}from"./chunk-KNI7S7QC.js";import{a as re}from"./chunk-SPXQGSTF.js";import{Aa as O,Bb as W,Ca as F,Ia as U,Kb as h,Ra as d,Sa as C,U as P,_c as H,ec as y,g as N,ga as c,gc as E,hc as b,ia as T,lb as B,lc as D,mc as R,na as w,nc as u,oa as x,oc as p,pb as l,ra as K,ta as L,yc as _}from"./chunk-7UJBXEVU.js";import{a as g,b as M,g as a}from"./chunk-XR34LRGE.js";var ue=["*"],Y=(()=>{class o{constructor(e){this.element=e,this.active=!1,this.isDisabled=!1}setActiveStyles(){this.active=!0}setInactiveStyles(){this.active=!1}scrollIntoView(e){this.element.nativeElement.scrollIntoView(e||!0)}static{this.\u0275fac=function(t){return new(t||o)(l(d))}}static{this.\u0275cmp=O({type:o,selectors:[["nui-overlay-item"]],hostVars:4,hostBindings:function(t,i){t&2&&h("active",i.active)("disabled",i.isDisabled)},inputs:{isDisabled:"isDisabled"},features:[_([{provide:m,useExisting:w(()=>o)}])],ngContentSelectors:ue,decls:1,vars:0,template:function(t,i){t&1&&(E(),b(0))},styles:["[_nghost-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;-webkit-user-select:none;user-select:none;display:list-item;list-style-type:none}.active[_nghost-%COMP%]:not(.disabled){background-color:var(--nui-color-selected,rgba(0, 196, 210, .1));outline:none;z-index:500;box-shadow:inset 0 0 0 2px #00c4d280}"],changeDetection:0})}}return o})();var q=new K("NUI_SELECT_V2_OPTION_PARENT_COMPONENT"),S="options available",v="Dropdown closed";var pe=["*"],X=(()=>{class o extends Y{get selected(){if(!this.select.multiselect&&this.select?.selectedOptions[0])return isNaN(this.index)?this.select.selectedOptions[0]===this:this.select.selectedOptions[0]?.index===this.index}constructor(e,t){super(t),this.element=t,this.outfiltered=!1,this.select=e}onClick(e){e.preventDefault(),e.stopPropagation(),!this.isDisabled&&this.select.selectOption(this)}get viewValue(){return(this.element.nativeElement.textContent||"").trim()}static{this.\u0275fac=function(t){return new(t||o)(l(q,8),l(d))}}static{this.\u0275cmp=O({type:o,selectors:[["nui-select-v2-option"]],hostAttrs:["role","option",1,"nui-select-v2-option"],hostVars:4,hostBindings:function(t,i){t&1&&y("click",function(r){return i.onClick(r)}),t&2&&h("hidden",i.outfiltered)("selected",i.selected)},inputs:{value:"value",index:"index",displayValueContext:"displayValueContext",outfiltered:"outfiltered"},features:[_([{provide:m,useExisting:w(()=>o)}]),W],ngContentSelectors:pe,decls:1,vars:0,template:function(t,i){t&1&&(E(),b(0))},styles:["[_nghost-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;-webkit-user-select:none;user-select:none;display:list-item;list-style-type:none;margin-bottom:1px;font-size:13px;min-height:30px;padding:5px 10px;cursor:pointer;background-color:var(--nui-color-bg-transparent,transparent);color:var(--nui-color-text-default,#111)}[_nghost-%COMP%]:hover{color:var(--nui-color-text-default-hover,#000000);background-color:var(--nui-color-bg-transparent-hover,rgba(17, 17, 17, .05))}.active[_nghost-%COMP%]:not(.disabled){background-color:var(--nui-color-selected,rgba(0, 196, 210, .1));outline:none;z-index:500;box-shadow:inset 0 0 0 2px #00c4d280}.selected[_nghost-%COMP%]{background-color:var(--nui-color-selected,rgba(0, 196, 210, .1));font-weight:600}.selected[_nghost-%COMP%]:hover{background-color:var(--nui-color-selected-hover,rgba(0, 196, 210, .2))}.disabled[_nghost-%COMP%]{color:var(--nui-color-text-disabled,rgba(17, 17, 17, .3))}.disabled[_nghost-%COMP%]:hover{cursor:not-allowed}.hidden[_nghost-%COMP%]{display:none}.reset-box-sizes[_nghost-%COMP%]{height:unset;width:unset;min-width:unset;max-width:unset;min-height:unset;max-height:unset;padding:unset;margin:unset;border:unset}[_nghost-%COMP%]     .select-v2-option__label{max-width:100%;white-space:nowrap;overflow:hidden;-ms-text-overflow:ellipsis;-o-text-overflow:ellipsis;text-overflow:ellipsis}"],changeDetection:0})}}return o})();var J=a(re());var Z=(()=>{class o{constructor(e){this.liveAnnouncer=e}initKeyboardManager(){this.keyboardEventsManager=new z(this.optionItems).withVerticalOrientation()}handleKeydown(e){this.popup.showing?this.handleOpenKeyDown(e):this.handleClosedKeyDown(e)}setActiveItem(e){this.keyboardEventsManager?.setActiveItem(e)}resetActiveItem(){this.keyboardEventsManager.setActiveItem(-1)}setFirstItemActive(){this.keyboardEventsManager?.setFirstItemActive()}getActiveItemIndex(){return this.keyboardEventsManager.activeItemIndex}setSkipPredicate(e){this.keyboardEventsManager.skipPredicate(e)}scrollToActiveItem(e){this.keyboardEventsManager.activeItem&&setTimeout(()=>{this.keyboardEventsManager.activeItem?.scrollIntoView(e)})}hasActiveItem(){if((0,J.default)(this.keyboardEventsManager.activeItemIndex))throw new Error("ActiveItemIndex is not defined");return!!(this.keyboardEventsManager.activeItem&&this.keyboardEventsManager.activeItemIndex>=0)}handleOpenKeyDown(e){switch(e.code){case s.ARROW_DOWN:case s.ARROW_UP:this.keyboardEventsManager.onKeydown(e),this.announceNavigatedOption();break;case s.PAGE_UP:e.preventDefault(),this.keyboardEventsManager.onKeydown(e),this.keyboardEventsManager.setFirstItemActive();break;case s.PAGE_DOWN:e.preventDefault(),this.keyboardEventsManager.onKeydown(e),this.keyboardEventsManager.setLastItemActive();break}if(this.scrollToActiveItem({block:"nearest"}),!this.hasActiveItem()&&e.code===s.ENTER&&e.preventDefault(),this.hasActiveItem()&&e.code===s.ENTER){if(!this.keyboardEventsManager.activeItem)throw new Error("ActiveItem is not defined");this.keyboardEventsManager.activeItem.element.nativeElement.click()}(e.code===s.TAB||e.code===s.ESCAPE)&&(this.popup.toggle(),this.announceDropdown(this.popup.showing))}handleClosedKeyDown(e){this.shouldBePrevented(e)&&e.preventDefault(),e.code===s.ARROW_DOWN&&(this.popup.toggle(),this.scrollToActiveItem({block:"center"}))}shouldBePrevented(e){return e.code===s.ARROW_DOWN||e.code===s.ARROW_UP||e.code===s.ENTER}announceNavigatedOption(){let e=this.keyboardEventsManager.activeItem;e&&this.liveAnnouncer.announce(e.value)}announceDropdown(e){let t=e?`${this.optionItems.length} ${S}`:v;this.liveAnnouncer.announce(t)}static{this.\u0275fac=function(t){return new(t||o)(L(I))}}static{this.\u0275prov=x({token:o,factory:o.\u0275fac})}}return o})();var ie=a(de()),f=a(ae()),A=a(ce()),oe=a(le()),ne=a(he());var fe=["input"],ee={panelClass:$},te=10,mt=(()=>{class o{get overlayConfig(){return this._overlayConfig}set overlayConfig(e){this._overlayConfig=g(g({},ee),e)}get ariaLabel(){return this._ariaLabel}set ariaLabel(e){e!==this._ariaLabel&&(this._ariaLabel=e,this.cdRef.markForCheck())}get selectedOptions(){return this._selectedOptions}set selectedOptions(e){this._selectedOptions=e;let t=this.getValueFromOptions(e);this.value=t,this.onChange(t),this.valueSelected.emit(t)}constructor(e,t,i,n){this.optionKeyControlService=e,this.cdRef=t,this.elRef=i,this.liveAnnouncer=n,this.placeholder="",this._overlayConfig=ee,this.manualDropdownControl=!1,this.syncWidth=!0,this.isDisabled=!1,this.allowedKeys=[s.ARROW_UP,s.ARROW_DOWN,s.ENTER].map(String),this.caretIcon="caret-down",this.popupUtilities=new G,this.destroy$=new N,this._selectedOptions=[],this._ariaLabel="",this.valueSelected=new C,this.valueChanged=new C,this.clickOutsideDropdown=new C,this.onChange=()=>{},this.onTouched=()=>{}}ngOnChanges(e){e.value&&this.handleValueChange(e.value?.currentValue),e.dropdownCustomContainer&&this.dropdown&&this.defineDropdownContainer()}ngAfterContentInit(){this.handleValueChange(this.value)}ngAfterViewInit(){this.initClosingOnClicksOutside(),this.initOnTouch(),this.syncWidth&&this.initPopupUtilities(),this.initKeyboardManager(),this.defineDropdownContainer(),this.adjustDropdownOnVScrollResize()}onMouseDown(){this.mouseDown=!0}onMouseUp(e){this.mouseDown=!1,this.manualDropdownControl||this.toggleDropdown()}onFocusIn(){this.isOpenOnFocus()&&(this.showDropdown(),this.announceDropdown(!0))}onWindowResize(){this.popupUtilities.syncWidth()}onKeyDown(e){this.manualDropdownControl||this.optionKeyControlService.handleKeydown(e),this.manualDropdownControl&&this.dropdown.showing&&this.isAllowedKeyOnManualDropdown(e)&&this.optionKeyControlService.handleKeydown(e)}showDropdown(){this.isDisabled||(this.dropdown.show(),this.setActiveItemOnDropdown(),this.scrollToOption(),this.announceDropdown(!0))}hideDropdown(){this.isDisabled||(this.dropdown.hide(),this.announceDropdown(!1))}toggleDropdown(){this.isDisabled||(this.dropdown.toggle(),this.announceDropdown(this.dropdown.showing),this.setActiveItemOnDropdown(),this.scrollToOption(),this.cdkVirtualScroll&&this.cdkVirtualScroll.checkViewportSize())}selectOption(e){if((0,ie.default)(this.selectedOptions,e)&&!this.manualDropdownControl){this.hideDropdown();return}this.selectedOptions=this.multiselect?this.selectedOptions.concat(e):[e],this.optionKeyControlService.setActiveItem(e),this.manualDropdownControl||this.hideDropdown()}removeSelected(e){this.multiselect&&(this.selectedOptions=e?(0,ne.default)(this.selectedOptions,e):[])}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.isDisabled=e}writeValue(e){this.handleValueChange(e)}getLastSelectedOption(){return(0,oe.default)(this.selectedOptions)}get isDropdownOpen(){return this.dropdown?.showing}ngOnDestroy(){this.dropdown?.showing&&this.dropdown.hide(),this.destroy$.next(),this.destroy$.complete(),this.virtualScrollResizeObserver&&this.virtualScrollResizeObserver.unobserve(this.cdkVirtualScroll.elementRef.nativeElement)}getValueFromOptions(e=this.selectedOptions){return this.multiselect?e.map(t=>t.value):e[0]?.value||""}handleValueChange(e){if((0,A.default)(e)){this.value="",this._selectedOptions=[],this.setActiveItemOnDropdown();return}if(this.value=e,this.multiselect&&Array.isArray(e))this._selectedOptions=e.map(t=>this.options?.find(i=>(0,f.default)(i.value,t))).filter(t=>t),this._selectedOptions.forEach(t=>t.outfiltered=!0);else{let t=e,i=this.options?.find(n=>(0,f.default)(n.value,t));this._selectedOptions=i?[i]:[]}this.valueChanged.emit(),this.setActiveItemOnDropdown()}optionsChanged(){return this.allPopupItems.changes.pipe(c(this.destroy$),P(0),T(()=>{this.handleValueChange(this.value),this.validateValueWithSelectedOptions(),this.optionKeyControlService.setFirstItemActive()}))}validateValueWithSelectedOptions(){let e=this.selectedOptions.map(i=>i.value),t=(0,A.default)(this.value)?[]:this.multiselect?this.value:[this.value];(0,f.default)(e,t)||(this.value=this.multiselect?e:e[0],this.onChange(this.value),console.warn("Options changed, no correspondent 'value' found. Current value: ",this.value,"Previous value: ",t))}scrollToOption(){!(0,A.default)(this.value)&&!this.multiselect&&setTimeout(()=>this.selectedOptions[0]?.scrollIntoView({block:"center"}))}initKeyboardManager(){this.optionKeyControlService.optionItems=this.allPopupItems,this.optionKeyControlService.popup=this.dropdown,this.optionKeyControlService.initKeyboardManager(),this.optionKeyControlService.setSkipPredicate(e=>!!(e.outfiltered||e.isDisabled))}setActiveItemOnDropdown(){let e;this.multiselect||(e=this.options?.find(t=>(0,f.default)(t.value,this.value))),e&&!this.multiselect?this.optionKeyControlService.setActiveItem(this.selectedOptions[0]):this.optionKeyControlService.setFirstItemActive()}initClosingOnClicksOutside(){this.dropdown.clickOutside.pipe(c(this.destroy$)).subscribe(e=>{this.manualDropdownControl||this.hideDropdown(),this.clickOutsideDropdown.emit(e)})}initOnTouch(){this.dropdown.hide$.pipe(c(this.destroy$)).subscribe(()=>{this.onTouched(),this.cdRef.markForCheck()})}isAllowedKeyOnManualDropdown(e){return this.allowedKeys.includes(e.code)}defineDropdownContainer(){this.dropdown.customContainer=this.dropdownCustomContainer}initPopupUtilities(){let e=this.popupUtilities.setPopupComponent(this.dropdown).getResizeObserver();this.dropdown.show$.pipe(c(this.destroy$)).subscribe(()=>{this.popupUtilities.syncWidth(),e.observe(this.elRef.nativeElement)}),this.dropdown.hide$.pipe(c(this.destroy$)).subscribe(()=>{e.unobserve(this.elRef.nativeElement)})}adjustDropdownOnVScrollResize(){if(!this.cdkVirtualScroll)return;let e=this.cdkVirtualScroll.elementRef.nativeElement,t=parseInt(e.style.height,10),i=Number.isNaN(t)?0:t+te;this.dropdown.overlayConfig=M(g({},this.overlayConfig),{minHeight:i}),this.virtualScrollResizeObserver=new ResizeObserver(n=>{for(let r of n){let V=r.contentRect,se=V.height?V.height+te:0;this.dropdown.updateSize({minHeight:se})}}),this.virtualScrollResizeObserver.observe(e)}isOpenOnFocus(){return!this.mouseDown&&!this.manualDropdownControl&&document.activeElement===this.inputElement.nativeElement}announceDropdown(e){if(e){this.liveAnnouncer.announce(`${this.options.length} ${S}`);return}let t=this.value?`${this.value} selected ${v}`:v;this.liveAnnouncer.announce(t)}static{this.\u0275fac=function(t){return new(t||o)(l(Z),l(H),l(d),l(I))}}static{this.\u0275dir=F({type:o,contentQueries:function(t,i,n){if(t&1&&(D(n,j,5),D(n,X,5),D(n,m,5)),t&2){let r;u(r=p())&&(i.cdkVirtualScroll=r.first),u(r=p())&&(i.options=r),u(r=p())&&(i.allPopupItems=r)}},viewQuery:function(t,i){if(t&1&&(R(fe,5),R(Q,5)),t&2){let n;u(n=p())&&(i.inputElement=n.first),u(n=p())&&(i.dropdown=n.first)}},hostVars:4,hostBindings:function(t,i){t&1&&y("mousedown",function(){return i.onMouseDown()})("mouseup",function(r){return i.onMouseUp(r.target)})("focusin",function(){return i.onFocusIn()})("resize",function(){return i.onWindowResize()},!1,B),t&2&&h("disabled",i.isDisabled)("has-error",i.isInErrorState)},inputs:{placeholder:"placeholder",popupViewportMargin:"popupViewportMargin",overlayConfig:"overlayConfig",multiselect:"multiselect",manualDropdownControl:"manualDropdownControl",value:"value",dropdownCustomContainer:"dropdownCustomContainer",syncWidth:"syncWidth",isDisabled:"isDisabled",isInErrorState:"isInErrorState",ariaLabel:"ariaLabel"},outputs:{valueSelected:"valueSelected",valueChanged:"valueChanged",clickOutsideDropdown:"clickOutsideDropdown"},features:[U]})}}return o})();export{q as a,Y as b,X as c,Z as d,mt as e};
