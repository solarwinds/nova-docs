import{a as b}from"./chunk-EP75EVMT.js";import{a as j,b as M,c as B}from"./chunk-O3JQU3EK.js";import{a as I}from"./chunk-DZ2EIOUK.js";import{b as E}from"./chunk-JCVUXDPD.js";import{c as V}from"./chunk-DCCIYGKJ.js";import{b as H}from"./chunk-3QGDSSEJ.js";import{a as U}from"./chunk-UINJOPJ7.js";import{a as N}from"./chunk-CUY44B7R.js";import{a as w}from"./chunk-YILH52ZF.js";import{l as F}from"./chunk-EHNCPSLF.js";import{Eb as f,Oc as S,Pc as C,Qb as c,Tc as k,Wb as r,Xb as n,ac as P,g as x,mc as u,nb as s,nc as m,tb as D,xa as p,xc as h,ya as d,yc as l,zb as y,zc as v}from"./chunk-MC3BMXIX.js";import{g}from"./chunk-VBFW7A5V.js";var q=g(H()),K=g(U()),_=g(N());function O(a,T){if(a&1){let e=P();r(0,"nui-dialog-footer")(1,"button",13),u("click",function(){p(e);let t=m(2);return d(t.cancelPopover())}),l(2," Cancel "),n(),r(3,"button",14),u("click",function(){p(e);let t=m(2);return d(t.confirmPopover())}),l(4," Use "),n()()}}function Q(a,T){if(a&1){let e=P();r(0,"div")(1,"nui-quick-picker",10),u("presetSelected",function(t){p(e);let o=m();return d(o.handlePresetSelection(t))}),r(2,"nui-time-frame-picker",11),u("changed",function(t){p(e);let o=m();return d(o.updateTf(t))}),n()()(),f(3,O,5,0,"nui-dialog-footer",12)}if(a&2){let e=m();s(),c("presets",e.presets)("selectedPreset",e.acceptedTimeframe.selectedPresetId),s(),c("startModel",e.acceptedTimeframe),s(),c("ngIf",e.showFooter)}}function z(a,T){if(a&1){let e=P();r(0,"div")(1,"nui-quick-picker",15),u("presetSelected",function(t){p(e);let o=m();return d(o.handlePresetSelectionDatePicker(t))}),r(2,"nui-date-picker",16),u("valueChange",function(t){p(e);let o=m();return d(o.dateChanged(t))}),n()()()}if(a&2){let e=m();s(),c("presets",e.presetsDatePicker)("selectedPreset",e.selectedPresetKeyDatePicker),s(),c("inline",!0)("value",e.selectedDate)("preserveInsignificant",!1)}}function A(a,T){if(a&1){let e=P();r(0,"div")(1,"nui-quick-picker",10),u("presetSelected",function(t){p(e);let o=m();return d(o.handlePresetSelection(t))}),r(2,"nui-time-frame-picker",11),u("changed",function(t){p(e);let o=m();return d(o.updateTf(t))}),n(),r(3,"nui-date-picker",16),u("valueChange",function(t){p(e);let o=m();return d(o.dateChanged(t))}),n()()()}if(a&2){let e=m();s(),c("presets",e.presets)("selectedPreset",e.acceptedTimeframe.selectedPresetId),s(),c("startModel",e.acceptedTimeframe),s(),c("inline",!0)("value",e.selectedDate)("preserveInsignificant",!1)}}var oe=(()=>{class a{constructor(e){this.timeframeService=e,this.selectedPresetKey="lastHour",this.selectedPresetKeyDatePicker="dimasBirthday",this.showFooter=!1,this.closePopoverSubject=new x,this.openPopoverSubject=new x,this.presets=e.getDefaultPresets(),this.acceptedTimeframe=this.timeframeService.getTimeframeByPresetId(this.selectedPresetKey,"02/17/1986"),this.tf=this.acceptedTimeframe,this.presetsDatePicker=this.getDefaultPresets(),this.selectedDate=this.getDateFromPreset(this.selectedPresetKeyDatePicker)}updateTf(e){this.tf=e;let i=()=>this.timeframeService.areTimeFrameDatesValid(e),t=()=>this.timeframeService.isEqual(this.tf,this.acceptedTimeframe);i()&&!t()&&(this.showFooter=!0),this.selectedPresetKey=this.tf.selectedPresetId}confirmPopover(){this.showFooter=!1,this.closePopoverSubject.next(),this.acceptedTimeframe=this.tf}cancelPopover(){this.showFooter=!1,this.closePopoverSubject.next()}handlePresetSelection(e){this.selectedPresetKeyDatePicker=e,this.tf=this.timeframeService.getTimeframeByPresetId(e,"02/17/1986"),this.acceptedTimeframe=this.tf,this.closePopoverSubject.next()}confirmPopoverDatePicker(){this.closePopoverSubject.next()}handlePresetSelectionDatePicker(e){this.selectedDate=this.getDateFromPreset(e),this.selectedPresetKeyDatePicker=e,this.confirmPopoverDatePicker()}dateChanged(e){this.selectedDate.isSame(e,"day")||(this.selectedDate=e,this.selectedPresetKeyDatePicker=this.getPresetFromDate(e),this.confirmPopoverDatePicker())}getDefaultPresets(){return{today:{name:"Today",pattern:()=>(0,_.default)()},yesterday:{name:"Yesterday",pattern:()=>(0,_.default)().subtract(1,"days")},dimasBirthday:{name:"Dima's Birthday",pattern:()=>(0,_.default)("1986-02-17")},random:{name:"Random date (to show that we can)",pattern:()=>(0,_.default)(+new Date-Math.floor(Math.random()*1e11))}}}getDateFromPreset(e){let i=this.getDefaultPresets()[e];return i?i.pattern():(0,_.default)()}getPresetFromDate(e){let i=(0,q.default)(Object.keys(this.presets),t=>e.isSame(this.getDateFromPreset(t),"day"));if((0,K.default)(i))throw new Error("DatePreset was not found");return i}static{this.\u0275fac=function(i){return new(i||a)(D(j))}}static{this.\u0275cmp=y({type:a,selectors:[["nui-time-frame-picker-visual-test"]],standalone:!1,decls:32,vars:21,consts:[["popoverTimeFramePicker",""],["popoverDayPicker",""],["popoverTimeFramePickerUnlimited",""],[1,"container"],[1,"row"],[1,"col"],["trigger","click","id","nui-demo-visual-default-popover",3,"template","hasPadding","closePopover","modal"],[1,"nui-text-link",2,"cursor","pointer"],["trigger","click","id","nui-demo-visual-datepicker-popover",3,"template","hasPadding","closePopover","unlimited","modal"],["trigger","click","id","nui-demo-visual-complex-popover",3,"template","hasPadding","closePopover","modal","unlimited"],["pickerTitle","Custom Range",3,"presetSelected","presets","selectedPreset"],[3,"changed","startModel"],[4,"ngIf"],["nui-button","","type","button","displayStyle","action",1,"pr-3","nui-time-frame-picker__cancel",3,"click"],["nui-button","","type","button","displayStyle","primary",1,"nui-time-frame-picker__use",3,"click"],["pickerTitle","Custom Date","presetsTitle","Baselines",3,"presetSelected","presets","selectedPreset"],[3,"valueChange","inline","value","preserveInsignificant"]],template:function(i,t){if(i&1&&(r(0,"div",3)(1,"div",4)(2,"div",5)(3,"h4"),l(4,"TimeFrame Picker in Popover"),n(),r(5,"nui-popover",6)(6,"span",7),l(7),S(8,"timeFrame"),n()(),f(9,Q,4,4,"ng-template",null,0,k),n(),r(11,"div",5)(12,"h4"),l(13,"TimeFrame Picker with other components"),n(),r(14,"nui-popover",8)(15,"span",7),l(16,"Select day"),n()(),r(17,"p"),l(18," Selected date: "),r(19,"em"),l(20),n()(),f(21,z,3,5,"ng-template",null,1,k),n(),r(23,"div",5)(24,"h4"),l(25," TimeFrame Picker + Date picker with unlimited width in Popover "),n(),r(26,"nui-popover",9)(27,"span",7),l(28),S(29,"timeFrame"),n()(),f(30,A,4,6,"ng-template",null,2,k),n()()()),i&2){let o=h(10),R=h(22),Y=h(31);s(5),c("template",o)("hasPadding",!1)("closePopover",t.closePopoverSubject)("modal",!0),s(2),v(C(8,17,t.acceptedTimeframe)),s(7),c("template",R)("hasPadding",!1)("closePopover",t.closePopoverSubject)("unlimited",!0)("modal",!0),s(6),v(t.selectedDate==null?null:t.selectedDate.format("MMMM Do, YYYY")),s(6),c("template",Y)("hasPadding",!1)("closePopover",t.closePopoverSubject)("modal",!0)("unlimited",!0),s(2),v(C(29,19,t.acceptedTimeframe))}},dependencies:[w,I,M,V,F,b,E,B],encapsulation:2})}}return a})();export{oe as a};
