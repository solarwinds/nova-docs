import{a as g}from"./chunk-EXWK5BYM.js";import{a as f}from"./chunk-R5GD4OPT.js";import{a as C}from"./chunk-YVGSTYPW.js";import{d as y}from"./chunk-THDOSL77.js";import{Aa as l,Ib as p,Ob as h,Pb as d,Sa as n,_c as m,ec as c,g as i,pb as a}from"./chunk-7UJBXEVU.js";var w=(()=>{class o{constructor(e){this.cd=e,this.readonly=!1,this.placeholder="default placeholder",this.value="",this.draggingInProgress=!1,this.focusedTokenChange=new n,this.tokensChange=new n,this.cursorPosChange=new n,this.valueChange=new n,this.submitQuery=new n,this.tokens=[],this.cursorSetter$$=new i,this.currentCursorPos=-1,this.renderer=new C,this.currentHelp=[],this.tokenizer=new f,this.helpUpdater=new g}onValueChange(e){this.tokens=e.tokens,this.value!==e.value&&(this.value=e.value),this.updateHelp()}onCursorPosChange(e){this.currentCursorPos!==e&&(this.currentCursorPos=e,this.updateHelp(),this.cd.detectChanges())}onSubmit(){}updateTextAfterHelpSelection(e){let r=this.getFocusedTokenIndex(),t=this.tokens[r].start+e.value.length;this.value=this.value.substring(0,this.tokens[r].start)+e.value+this.value.substring(this.tokens[r].end+1),this.cursorSetter$$.next(t)}updateHelp(){let e=this.getFocusedTokenIndex();this.currentHelp=this.helpUpdater.getCurrentHelp(e,this.tokens)}getFocusedTokenIndex(){for(let e=0;e<this.tokens.length;e++)if(this.tokens[e].start<=this.currentCursorPos&&this.tokens[e].end+1>=this.currentCursorPos)return e;return-1}static{this.\u0275fac=function(r){return new(r||o)(a(m))}}static{this.\u0275cmp=l({type:o,selectors:[["nui-freetype-query-builder-visual-test"]],inputs:{exampleId:"exampleId",readonly:"readonly",placeholder:"placeholder",value:"value",draggingInProgress:"draggingInProgress"},outputs:{focusedTokenChange:"focusedTokenChange",tokensChange:"tokensChange",cursorPosChange:"cursorPosChange",valueChange:"valueChange",submitQuery:"submitQuery"},decls:1,vars:7,consts:[["id","example1",3,"currentValue","cursorPos","submitQuery","helpItemSelected","value","currentHelp","tokenizer","renderer","placeholder","cursorSetter$","readonly"]],template:function(r,t){r&1&&(h(0,"nui-freetype-query-builder",0),c("currentValue",function(s){return t.onValueChange(s)})("cursorPos",function(s){return t.onCursorPosChange(s)})("submitQuery",function(){return t.onSubmit()})("helpItemSelected",function(s){return t.updateTextAfterHelpSelection(s)}),d()),r&2&&p("value",t.value)("currentHelp",t.currentHelp)("tokenizer",t.tokenizer)("renderer",t.renderer)("placeholder",t.placeholder)("cursorSetter$",t.cursorSetter$$)("readonly",t.readonly)},dependencies:[y],encapsulation:2})}}return o})();export{w as a};
