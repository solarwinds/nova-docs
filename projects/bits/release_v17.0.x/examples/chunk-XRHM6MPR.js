import{a as g}from"./chunk-EXWK5BYM.js";import{a as f}from"./chunk-R5GD4OPT.js";import{a as C}from"./chunk-YVGSTYPW.js";import{d as y}from"./chunk-THDOSL77.js";import{Aa as l,Ib as p,Ob as d,Pb as h,Sa as n,_c as m,ec as c,g as i,pb as a}from"./chunk-7UJBXEVU.js";var H=(()=>{class s{constructor(e){this.cd=e,this.readonly=!1,this.placeholder="default placeholder",this.value="",this.draggingInProgress=!1,this.focusedTokenChange=new n,this.tokensChange=new n,this.cursorPosChange=new n,this.valueChange=new n,this.submitQuery=new n,this.tokens=[],this.cursorSetter$$=new i,this.currentCursorPos=-1,this.renderer=new C,this.currentHelp=[],this.tokenizer=new f,this.helpUpdater=new g}onValueChange(e){this.tokens=e.tokens,this.value!==e.value&&(this.value=e.value),this.updateHelp()}onCursorPosChange(e){this.currentCursorPos!==e&&(this.currentCursorPos=e,this.updateHelp(),this.cd.detectChanges())}onSubmit(){}updateTextAfterHelpSelection(e){let t=this.getFocusedTokenIndex(),r=this.tokens[t].start+e.value.length;this.value=this.value.substring(0,this.tokens[t].start)+e.value+this.value.substring(this.tokens[t].end+1),this.cursorSetter$$.next(r)}updateHelp(){let e=this.getFocusedTokenIndex();this.currentHelp=this.helpUpdater.getCurrentHelp(e,this.tokens)}getFocusedTokenIndex(){for(let e=0;e<this.tokens.length;e++)if(this.tokens[e].start<=this.currentCursorPos&&this.tokens[e].end+1>=this.currentCursorPos)return e;return-1}static{this.\u0275fac=function(t){return new(t||s)(a(m))}}static{this.\u0275cmp=l({type:s,selectors:[["example-freetype-query-builder"]],inputs:{exampleId:"exampleId",readonly:"readonly",placeholder:"placeholder",value:"value",draggingInProgress:"draggingInProgress"},outputs:{focusedTokenChange:"focusedTokenChange",tokensChange:"tokensChange",cursorPosChange:"cursorPosChange",valueChange:"valueChange",submitQuery:"submitQuery"},decls:1,vars:8,consts:[[3,"currentValue","cursorPos","submitQuery","helpItemSelected","id","value","currentHelp","tokenizer","renderer","placeholder","cursorSetter$","readonly"]],template:function(t,r){t&1&&(d(0,"nui-freetype-query-builder",0),c("currentValue",function(o){return r.onValueChange(o)})("cursorPos",function(o){return r.onCursorPosChange(o)})("submitQuery",function(){return r.onSubmit()})("helpItemSelected",function(o){return r.updateTextAfterHelpSelection(o)}),h()),t&2&&p("id",r.exampleId)("value",r.value)("currentHelp",r.currentHelp)("tokenizer",r.tokenizer)("renderer",r.renderer)("placeholder",r.placeholder)("cursorSetter$",r.cursorSetter$$)("readonly",r.readonly)},dependencies:[y],encapsulation:2})}}return s})();export{H as a};
