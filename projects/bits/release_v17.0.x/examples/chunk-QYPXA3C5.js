import{a as n,b as c,c as C}from"./chunk-TI6FRSJ2.js";import{a as O}from"./chunk-UINJOPJ7.js";import{a as R}from"./chunk-YFYS4LRF.js";import{d as b}from"./chunk-XRSLDQYN.js";import{f as d,i as f}from"./chunk-LO2VWMBZ.js";import{a as y}from"./chunk-7YQPYNLH.js";import{Bb as S,Ha as g,Ia as v,La as u,sb as E,tb as t,wa as p}from"./chunk-MC3BMXIX.js";import{g as z}from"./chunk-VBFW7A5V.js";var D=z(R()),o=z(y()),m=z(O());var G="nui-resize-gutter",Y=(()=>{class h{set resizerDirection(e){this._direction=e,this.refreshStyle()}get resizerDirection(){return this._direction}set resizerDisabled(e){this._disabled=e,this.resizeGutter&&(this.switchDisabledClasses(),e||this.refreshStyle())}get resizerDisabled(){return this._disabled}constructor(e,i,s,l,r,a){this.elRef=e,this.renderer=i,this.utilService=s,this._element=l,this.ngZone=r,this.eventBusService=a,this._size=16,this._disabled=!1,this.resizerValue=c.pixel,this.resizerSizeChanged=new g,this.resizeClass=G,this.offsetSize=this._size/2,this._resizeElement=document.createElement("div"),this._oldSize=0,this._isDragging=!1,this._isFirstTimeInteracting=!0,this._isHovering=!1,this.eventSubscriptions=[]}ngOnChanges(e){e.resizerDirection&&this.resizeGutter&&this.appendResizeElement()}ngAfterViewInit(){this.targetElement=this.elRef,this.addSubscription(),this.isAtTheBeginning()?(this.renderer.insertBefore(this.targetElement.nativeElement,this._resizeElement,this.targetElement.nativeElement.firstElementChild),this.resizeGutter=this.targetElement.nativeElement.firstElementChild):(this.renderer.appendChild(this.targetElement.nativeElement,this._resizeElement),this.resizeGutter=this.targetElement.nativeElement.lastElementChild),this.appendResizeElement(),this.resizeGutter.className=this.resizeClass,this.parentContainerNode=this.targetElement.nativeElement.parentElement,this.addResizeObserver(),this.appendEvents(),this.refreshStyle()}ngOnDestroy(){this.resizeObserver&&this.resizeObserver.unobserve(this.targetElement.nativeElement.parentElement),this.resizeSubscription&&this.resizeSubscription.unsubscribe(),this.unlistenEvents()}addResizeObserver(){let e=(0,D.default)(i=>this.refreshStyle(),300);this.resizeObserver=new ResizeObserver(i=>{i.forEach(s=>{this.ngZone.run(()=>{this.resizerDisabled||e(s)})})}),this.ngZone.runOutsideAngular(()=>{this.resizeObserver?.observe(this.targetElement.nativeElement.parentElement)})}addSubscription(){this.resizeSubscription=this.eventBusService.getStream(d).subscribe(e=>this.refreshStyle())}onSizeChanged(e){this.resizerSizeChanged.emit(e)}refreshStyle(){this.resizeGutter&&!this.resizerDisabled&&(this.renderer.setStyle(this.resizeGutter,this.resizePropObj.sizeToSet,`${this._size}px`),this.renderer.setStyle(this.resizeGutter,this.resizePropObj.otherSizeProperty,"100%"),this.calculatePosition(),this.renderer.setStyle(this.resizeGutter,"cursor",this.resizePropObj.cursor),this.switchDisabledClasses())}unlistenEvents(){this.eventSubscriptions.forEach(e=>{(0,o.default)(e)&&e()})}appendEvents(){this.eventSubscriptions.push(this.renderer.listen(this.resizeGutter,"mouseenter",e=>this.onMouseEnter(e))),this.eventSubscriptions.push(this.renderer.listen(this.resizeGutter,"mouseleave",()=>this.onMouseLeave())),this.eventSubscriptions.push(this.renderer.listen(this.resizeGutter,"mousedown",e=>this.onMouseDown(e)))}isResizeHorizontal(){return this.resizerDirection===n.left||this.resizerDirection===n.right}isAtTheBeginning(){return this.resizerDirection===n.left||this.resizerDirection===n.top}switchDisabledClasses(){this.resizerDisabled?this.renderer.addClass(this.resizeGutter,`${this.resizeClass}-disabled`):this.renderer.removeClass(this.resizeGutter,`${this.resizeClass}-disabled`)}appendResizeElement(){this.resizerSplit&&this.renderer.removeChild(this.resizeGutter,this.resizerSplit),this.resizerSplit=document.createElement("div"),this.renderer.addClass(this.resizerSplit,`${this.resizeClass}__split`),this.renderer.addClass(this.resizerSplit,`${this.resizeClass}__split-${this.isResizeHorizontal()?"horizontal":"vertical"}`),this.renderer.appendChild(this.resizeGutter,this.resizerSplit),this.resizePropObj=C[this.resizerDirection]}unlistenResizeEvents(){(0,o.default)(this.mouseMoveUnlisten)&&!this._isHovering&&this.mouseMoveUnlisten(),(0,o.default)(this.mouseUpUnlisten)&&this.mouseUpUnlisten()}onMouseEnter(e){this._isHovering=!0,(!(0,m.default)(e.buttons)&&e.buttons===0||!(0,m.default)(e.which)&&e.which===0)&&(this.renderer.addClass(this.resizeGutter,`${this.resizeClass}--hovering`),this.mouseMoveUnlisten=this.renderer.listen(document,"mousemove",i=>this.onMouseMove(i)))}onMouseLeave(){this.renderer.removeClass(this.resizeGutter,`${this.resizeClass}--hovering`),this._isDragging||(this._isHovering=!1,this.unlistenResizeEvents())}onMouseMove(e){this._isFirstTimeInteracting&&this._isDragging&&(this.refreshStyle(),this._isFirstTimeInteracting=!1),this._isDragging&&(this.applyNewSize(e),this.calculatePosition())}onMouseDown(e){this.renderer.addClass(this.resizeGutter,`${this.resizeClass}--active`),this.renderer.setStyle(document.documentElement,"cursor",this.resizePropObj.cursor),this._isDragging=!0,this._oldSize=this.isResizeHorizontal()?e.clientX:e.clientY,this.mouseUpUnlisten=this.renderer.listen(document,"mouseup",i=>this.onMouseUp(i)),e.preventDefault()}onMouseUp(e){this.renderer.removeStyle(document.documentElement,"cursor"),this.renderer.removeClass(this.resizeGutter,`${this.resizeClass}--active`),this._isDragging=!1,this.eventBusService.getStream(d).next(e)}calculatePosition(){if(this.resizerDisabled)return;let e=this.parentContainerNode.getBoundingClientRect()[this.resizePropObj.appendDirection],i=this.targetElement.nativeElement.getBoundingClientRect()[this.resizePropObj.borderToCalculate];this.renderer.setStyle(this.resizeGutter,this.resizePropObj.appendDirection,`${Math.abs(e-i)-this.offsetSize}px`)}applyNewSize(e){if(this.sibling=this.targetElement.nativeElement.nextSibling,!this._isDragging||this.resizerDisabled)return;let i=this.isResizeHorizontal()?e.clientX:e.clientY;this.updateSize(i)}updateSize(e){let i=this.isMultiple?"flex-basis":this.resizePropObj.sizeToSet,s=this.parentContainerNode[this.resizePropObj.nativeElementSizeProperty],l=this.resizerValue===c.pixel?1:100/s,r=`${this.calculateNativeElementSize(e,this.resizePropObj.nativeElementSizeProperty)*l}${this.resizerValue}`,a=`${this.targetElement.nativeElement[this.resizePropObj.nativeElementSizeProperty]-this.offsetSize}px`;if(!this.isMultiple)this.renderer.setStyle(this.targetElement.nativeElement,i,r);else{let _=`${this.calculateSiblingSize(e,this.resizePropObj.nativeElementSizeProperty)*l}${this.resizerValue}`;this.parentContainerNode.children.length>2&&(this.renderer.setStyle(this.sibling,i,_),this.renderer.setStyle(this.targetElement.nativeElement,i,r))}this.renderer.setStyle(this.resizeGutter,this.resizePropObj.appendDirection,a),this.onSizeChanged(r),this._oldSize=e}calculateNativeElementSize(e,i){return this.isAtTheBeginning()?this.targetElement.nativeElement[i]-(e-this._oldSize):this.targetElement.nativeElement[i]+(e-this._oldSize)}calculateSiblingSize(e,i){return this.isAtTheBeginning()?this.sibling[i]+(e-this._oldSize):this.sibling[i]-(e-this._oldSize)}static{this.\u0275fac=function(i){return new(i||h)(t(u),t(E),t(b),t(u),t(v),t(f))}}static{this.\u0275dir=S({type:h,selectors:[["","nuiResizer",""]],inputs:{resizerDirection:"resizerDirection",resizerDisabled:"resizerDisabled",resizerValue:"resizerValue",isMultiple:"isMultiple"},outputs:{resizerSizeChanged:"resizerSizeChanged"},standalone:!1,features:[p]})}}return h})();export{Y as a};
