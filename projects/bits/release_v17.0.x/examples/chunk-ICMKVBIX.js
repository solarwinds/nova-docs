import{a as J}from"./chunk-HOPRZHSS.js";import{a as K}from"./chunk-YFYS4LRF.js";import{d as L}from"./chunk-XRSLDQYN.js";import{h as Q}from"./chunk-LWI5ZV6Y.js";import{k as Y}from"./chunk-LPZ5CZ7G.js";import{c as G}from"./chunk-LO2VWMBZ.js";import{a as X}from"./chunk-5J7BNPXL.js";import{a as $}from"./chunk-ZR5STDHI.js";import{a as B,c as W}from"./chunk-Y7C4AM3Q.js";import{a as H}from"./chunk-EHNCPSLF.js";import{Bb as m,Ha as o,Ia as A,La as S,Pb as T,Sb as P,g as w,ia as I,mc as p,tb as c}from"./chunk-MC3BMXIX.js";import{f as z,g as f}from"./chunk-VBFW7A5V.js";var O=z((Ce,Z)=>{var te=K(),ie=B(),re="Expected a function";function se(i,y,e){var t=!0,r=!0;if(typeof i!="function")throw new TypeError(re);return ie(e)&&(t="leading"in e?!!e.leading:t,r="trailing"in e?!!e.trailing:r),te(i,y,{leading:t,maxWait:y,trailing:r})}Z.exports=se});var M=z((rt,k)=>{var ae=Y(),ne=J(),oe=Q(),le=X();function de(i,y){var e=le(i)?ae:ne;return e(i,oe(y,3))}k.exports=de});var q=z((nt,U)=>{var fe=W(),ge=fe.isFinite;function ue(i){return typeof i=="number"&&ge(i)}U.exports=ue});var ee=i=>i.target instanceof HTMLAnchorElement,C=i=>!ee(i),x=i=>typeof i=="boolean"?()=>i:i;var be=(()=>{class i{constructor(){this._cancelBubble=x(!0),this._preventDefault=C,this.passed$=new o,this.canceled$=new o,this.prevented$=new o}set cancelBubble(e){this._cancelBubble=x(e??!0)}set preventDefault(e){this._preventDefault=x(e??C)}handleEvent(e){let t=!0;this._cancelBubble(e)&&(e.stopPropagation(),e.stopImmediatePropagation(),this.canceled$.emit(e),t=!1),this._preventDefault(e)&&(e.preventDefault(),this.prevented$.emit(e),t=!1),t&&this.passed$.emit(e)}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275dir=m({type:i,selectors:[["","nuiClickFilter",""]],hostBindings:function(t,r){t&1&&p("click",function(s){return r.handleEvent(s)})},inputs:{cancelBubble:"cancelBubble",preventDefault:"preventDefault"},outputs:{passed$:"passed$",canceled$:"canceled$",prevented$:"prevented$"},standalone:!1})}}return i})();var N=f(O());var _=f($()),F=f(B());var E=(()=>{class i{constructor(){this.onDragStateSubject=new w}get onDragStateChanged(){return this.onDragStateSubject.asObservable()}setDragPayload(e,t){this.dragPayload=e;let r=(0,F.default)(e)?JSON.stringify(e):e;t.dataTransfer?.setData("Text",r),t.dataTransfer?.setData("text/plain",r),this.onDragStateSubject.next({payload:this.dragPayload,isInProgress:!0})}getDragPayload(e){return(0,_.default)(this.dragPayload)?{data:this.extractDragObject(e),isExternal:!0}:{data:this.dragPayload,isExternal:!1}}resetPayload(){this.onDragStateSubject.next({payload:this.dragPayload,isInProgress:!1}),this.dragPayload=void 0}extractDragObject(e){let t=e.dataTransfer?.getData("Text")||e.dataTransfer?.getData("text/plain");try{return JSON.parse(t||"")}catch{return t}}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275prov=I({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var l={verticalScrollPercentage:30,horizontalScrollPercentage:30,checkIntervalInMs:30,accelerationFactor:.5,dragOverThrottleInMs:100,adornerUpdateThrottleInMs:16};var Me=(()=>{class i{static{this.draggableClass="nui-drag__draggable"}static{this.draggingClass="nui-drag--dragging"}static{this.dragSourceClass="nui-drag__drag-source"}static{this.adornerClass="nui-drag__drag-container"}static{this.adornerHaloClass="nui-drag__drag-halo"}static{this.dragsourceOverlayClass="nui-drag__drag-source--overlay"}onDragStart(e){this.dragStart.emit(e),this.document.defaultView?.getSelection()?.removeAllRanges(),window.getSelection()?.removeAllRanges(),this.dragsourceOverlay=this.createDragVisuals(e),this.setImageAndData(e),this.zone.runOutsideAngular(()=>{this.document.addEventListener("dragover",this.mouseHook)}),e.stopPropagation()}onDragEnd(e){this.dragEnd.emit(e),this.elRef.nativeElement.classList.remove(i.dragSourceClass),this.adorner&&(this.adorner.remove(),this.adorner=void 0),this.dragsourceOverlay&&(this.dragsourceOverlay.remove(),this.dragsourceOverlay=void 0),this.dragAndDropService.resetPayload(),e.stopPropagation(),this.zone.runOutsideAngular(()=>{this.document.removeEventListener("dragover",this.mouseHook)})}constructor(e,t,r,n,s){this.elRef=e,this.zone=t,this.utilService=r,this.dragAndDropService=n,this.document=s,this.dragStart=new o,this.dragEnd=new o,this.moveDragAdorner=(0,N.default)(a=>{requestAnimationFrame(()=>{this.adorner&&(this.adorner.style.left=a.x+"px",this.adorner.style.top=a.y+"px"),this.autoScroll(a.x,a.y)})},l.adornerUpdateThrottleInMs),this.mouseHook=a=>{let g=a.clientX,h=a.clientY;this.moveDragAdorner({x:g,y:h})},this.createDragVisuals=a=>{this.adorner=this.document.createElement("div"),this.adorner.style.left=a.clientX+"px",this.adorner.style.top=a.clientY+"px",this.adorner.classList.add(i.adornerClass),this.adornerDragClass&&this.adorner.classList.add(this.adornerDragClass);let g=this.document.createElement("div");if(g.classList.add(i.adornerHaloClass),this.adorner.appendChild(g),!this.utilService.browser?.isSafari()){let d=a.currentTarget.cloneNode(!0);d.style.width=this.elRef.nativeElement.offsetWidth+"px",d.style.height=this.elRef.nativeElement.offsetHeight+"px",d.classList.add(i.draggingClass),d.removeAttribute("draggable"),this.adorner.appendChild(d)}this.elRef.nativeElement.parentNode.appendChild(this.adorner);let h=this.document.createElement("div");return h.classList.add(i.dragsourceOverlayClass),setTimeout(()=>{this.elRef.nativeElement.appendChild(h)},0),this.elRef.nativeElement.classList.add(i.dragSourceClass),h}}ngOnInit(){this.draggable=!0}setImageAndData(e){if(typeof DragEvent<"u"&&e instanceof DragEvent||e.dataTransfer){if(e.dataTransfer?.setDragImage)if(this.utilService.browser?.isSafari())e.dataTransfer.setDragImage(this.elRef.nativeElement,0,-10);else{let t=this.document.createElement("div");e.dataTransfer.setDragImage(t,0,0)}if(!e.dataTransfer)throw new Error("Event do not contain dataTransfer property");e.dataTransfer.dropEffect="copy",this.dragAndDropService.setDragPayload(this.payload,e)}}autoScroll(e,t){if(!e||!t)return;if(!this.document.defaultView)throw new Error("Document does not contain defaultView property");let r=t/this.document.defaultView.innerHeight*100,n=e/this.document.defaultView.innerWidth*100,s=l.verticalScrollPercentage,a=100-l.verticalScrollPercentage,g=l.horizontalScrollPercentage,h=100-l.horizontalScrollPercentage,d=this.document.defaultView.pageXOffset,v=this.document.defaultView.pageYOffset,D=!1;if(r<s){let u=(s-r)*l.accelerationFactor;v=v-u,D=!0}if(r>a){let u=(r-a)*l.accelerationFactor;v=v+u,D=!0}if(n<g){let u=(g-n)*l.accelerationFactor;d=d-u,D=!0}if(n>h){let u=(n-h)*l.accelerationFactor;d=d+u,D=!0}D&&this.document.defaultView.scrollTo(d,v)}static{this.\u0275fac=function(t){return new(t||i)(c(S),c(A),c(L),c(E),c(H))}}static{this.\u0275dir=m({type:i,selectors:[["","nuiDraggable",""]],hostVars:3,hostBindings:function(t,r){t&1&&p("dragstart",function(s){return r.onDragStart(s)})("dragend",function(s){return r.onDragEnd(s)}),t&2&&(T("draggable",r.draggable),P("nui-drag__draggable",r.draggable))},inputs:{adornerDragClass:"adornerDragClass",payload:"payload"},outputs:{dragStart:"dragStart",dragEnd:"dragEnd"},standalone:!1})}}return i})();var b=f($()),V=f(O());var tt=(()=>{class i{onDragEnter(e){let t=this.dragAndDropService.getDragPayload(e);this.validateDrop(t)&&this.dragElements.length===0?(this.elRef.nativeElement.classList.remove(this.dropIndicatorClass),this.elRef.nativeElement.classList.add(this.dragOverClass),this.dragEnter.emit(e)):this.dragElements.length===0&&this.invalidDragOverClass&&this.elRef.nativeElement.classList.add(this.invalidDragOverClass),this.dragElements.push(e.target),e.preventDefault()}onDragOver(e){let t=this.dragAndDropService.getDragPayload(e);this.validateDrop(t)&&this.dragThrottle(e),e.preventDefault()}onDragLeave(e){let t=this.dragAndDropService.getDragPayload(e);this.dragElements=this.dragElements.filter(r=>r!==e.target),this.validateDrop(t)&&this.dragElements.length===0?(this.elRef.nativeElement.classList.remove(this.dragOverClass),t?.isExternal||this.elRef.nativeElement.classList.add(this.dropIndicatorClass),this.dragLeave.emit(e)):this.dragElements.length===0&&this.invalidDragOverClass&&this.elRef.nativeElement.classList.remove(this.invalidDragOverClass)}onDrop(e){let t=this.dragAndDropService.getDragPayload(e);return e.preventDefault(),this.validateDrop(t)?(this.dragElements=[],(typeof DragEvent<"u"&&e instanceof DragEvent||e.dataTransfer)&&this.dropSuccess.emit({event:e,payload:t.data}),this.elRef.nativeElement.classList.remove(this.dragOverClass)):(0,b.default)(this.invalidDragOverClass)||this.elRef.nativeElement.classList.remove(this.invalidDragOverClass),this.dragAndDropService.resetPayload(),e.stopPropagation(),!1}constructor(e,t){this.elRef=e,this.dragAndDropService=t,this.dragOverClass="nui-drag--over",this.dragOver=new o,this.dragEnter=new o,this.dragLeave=new o,this.dropSuccess=new o,this.dragElements=[],this.dragThrottle=(0,V.default)(r=>{this.dragOver.emit(r)},l.checkIntervalInMs,{trailing:!1})}ngOnInit(){this.onDragStateChangedSubscription=this.dragAndDropService.onDragStateChanged.subscribe(e=>{!(0,b.default)(this.dropIndicatorClass)&&this.validateDrop({data:e.payload,isExternal:!1})&&(e.isInProgress?this.elRef.nativeElement.classList.add(this.dropIndicatorClass):this.elRef.nativeElement.classList.remove(this.dropIndicatorClass))})}validateDrop(e){return this.dropValidator?this.dropValidator.isValidDropTarget(e.data,e.isExternal):!0}ngOnDestroy(){(0,b.default)(this.onDragStateChangedSubscription)||this.onDragStateChangedSubscription.unsubscribe()}static{this.\u0275fac=function(t){return new(t||i)(c(S),c(E))}}static{this.\u0275dir=m({type:i,selectors:[["","nuiDroppable",""]],hostBindings:function(t,r){t&1&&p("dragenter",function(s){return r.onDragEnter(s)})("dragover",function(s){return r.onDragOver(s)})("dragleave",function(s){return r.onDragLeave(s)})("drop",function(s){return r.onDrop(s)})},inputs:{dragOverClass:"dragOverClass",invalidDragOverClass:"invalidDragOverClass",dropIndicatorClass:"dropIndicatorClass",dropValidator:"dropValidator"},outputs:{dragOver:"dragOver",dragEnter:"dragEnter",dragLeave:"dragLeave",dropSuccess:"dropSuccess"},standalone:!1})}}return i})();var ce=f(M()),he=f(G());var me=f(q());export{be as a,E as b,Me as c,tt as d};
