"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const protractor_1 = require("@solarwinds/uzi/protractor");
const uzi_1 = require("@solarwinds/uzi");
const ellipsis_atom_1 = require("./ellipsis.atom");
const helpers_1 = require("../helpers");
const _ = require("lodash");
describe("USERCONTROL ellipsis", () => {
    beforeEach(() => {
        helpers_1.default.prepareBrowser("ellipsis");
    });
    const defaultEllipsis = uzi_1.Atom.find(ellipsis_atom_1.EllipsisAtom, "defaultEllipsis");
    const tooltipOptionsEllipsis = uzi_1.Atom.find(ellipsis_atom_1.EllipsisAtom, "tooltipOptionsEllipsis");
    const tooltipOptionsWithParent = uzi_1.Atom.find(ellipsis_atom_1.EllipsisAtom, "optionsTooltipWithParent");
    const defaultTitle = "HTML is great for declaring static documents, " +
        "but it falters when we try to use it for declaring dynamic views in web-applications.";
    const defaultTooltip = "The tooltip differs from actual title";
    it("should properly render/populate 'title', 'uib-tooltip'", () => {
        expect(defaultEllipsis.getTitle()).toBe(defaultTitle);
        expect(defaultEllipsis.getEllipsedAttribute("uib-tooltip")).toBe(defaultTooltip);
    });
    it("should check difference between tooltip and text", () => {
        expect(defaultEllipsis.getTitle()).not.toBe(defaultTooltip);
    });
    xit("should show tooltip on 'mouseenter'", () => {
        expect(defaultEllipsis.getEllipsedAttribute("tooltip-enable")).toBe("false");
        expect(defaultEllipsis.isTooltipDisplayed()).toBe(false);
        protractor_1.browser.manage().window().setSize(640, 880);
        protractor_1.browser.wait(() => defaultEllipsis.getEllipsedAttribute("tooltip-enable")
            .then(isEnabled => _.isEqual(isEnabled, "true")));
        defaultEllipsis.moveMouseToTarget(defaultEllipsis);
        expect(defaultEllipsis.getEllipsedAttribute("tooltip-enable")).toBe("true");
        expect(defaultEllipsis.isTooltipDisplayed()).toBe(true);
    });
    xit("should not show tooltip while text is full length", () => {
        protractor_1.browser.manage().window().setSize(1540, 880);
        protractor_1.browser.wait(() => defaultEllipsis.getEllipsedAttribute("tooltip-enable")
            .then(isEnabled => _.isEqual(isEnabled, "false")));
        defaultEllipsis.moveMouseToTarget(defaultEllipsis);
        expect(defaultEllipsis.getEllipsedAttribute("tooltip-enable")).toBe("false");
        expect(defaultEllipsis.isTooltipDisplayed()).toBe(false);
    });
    xit("should use tooltip options", () => {
        const tooltipPlacement = "bottom";
        expect(tooltipOptionsEllipsis.getEllipsedAttribute("tooltip-enable")).toBe("false");
        expect(tooltipOptionsEllipsis.isTooltipDisplayed()).toBe(false);
        protractor_1.browser.manage().window().setSize(640, 880);
        protractor_1.browser.wait(() => tooltipOptionsEllipsis.getEllipsedAttribute("tooltip-enable")
            .then(isEnabled => _.isEqual(isEnabled, "true")));
        tooltipOptionsEllipsis.moveMouseToTarget(tooltipOptionsEllipsis);
        expect(tooltipOptionsEllipsis.getTooltipAttribute("placement")).toBe(tooltipPlacement);
        expect(tooltipOptionsEllipsis.isTooltipDisplayed()).toBe(true);
    });
    it("should compile bindHtmlTemplate with xuiHighlight:'HTML' filter", () => {
        expect(defaultEllipsis.getElement().element(protractor_1.by.css(".xui-highlighted")).getText()).toBe("HTML");
    });
    it("should compile bindHtmlTemplate with lowercase filter", () => {
        const loweCasedTitle = defaultTitle.toLowerCase();
        expect(tooltipOptionsEllipsis.getTitle()).toBe(loweCasedTitle);
    });
    xdescribe("with attribute find-parent-class=true", () => {
        beforeEach(() => {
            helpers_1.default.prepareBrowser("ellipsis");
        });
        it("shouldn't add ellipsis when text is shorter than parent element", () => {
            protractor_1.browser.manage().window().setSize(1540, 880);
            protractor_1.browser.wait(() => tooltipOptionsWithParent.getEllipsedAttribute("tooltip-enable")
                .then(isEnabled => _.isEqual(isEnabled, "false")));
            expect(tooltipOptionsWithParent.getEllipsedAttribute("tooltip-enable")).toBe("false");
        });
        it("should show tooltip when ellipsis is enabled and mouseenter", () => {
            protractor_1.browser.manage().window().setSize(640, 880);
            protractor_1.browser.wait(() => tooltipOptionsWithParent.getEllipsedAttribute("tooltip-enable")
                .then(isEnabled => _.isEqual(isEnabled, "true")));
            tooltipOptionsWithParent.moveMouseToTarget(tooltipOptionsWithParent);
            expect(tooltipOptionsWithParent.isTooltipDisplayed()).toBe(true);
        });
        it("shouldn't show tooltip when ellipsis is disabled and mouseenter", () => {
            protractor_1.browser.manage().window().setSize(1500, 880);
            protractor_1.browser.wait(() => tooltipOptionsWithParent.getEllipsedAttribute("tooltip-enable")
                .then(isEnabled => _.isEqual(isEnabled, "false")));
            tooltipOptionsWithParent.moveMouseToTarget(tooltipOptionsWithParent);
            expect(tooltipOptionsWithParent.isTooltipDisplayed()).toBe(false);
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvZWxsaXBzaXMvZWxsaXBzaXMuZTJlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsMkRBQWdFO0FBQ2hFLHlDQUFxQztBQUNyQyxtREFBNkM7QUFDN0Msd0NBQWlDO0FBQ2pDLDRCQUE0QjtBQUU1QixRQUFRLENBQUMsc0JBQXNCLEVBQUUsR0FBRyxFQUFFO0lBRWxDLFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDWixpQkFBTyxDQUFDLGNBQWMsQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUN2QyxDQUFDLENBQUMsQ0FBQztJQUVILE1BQU0sZUFBZSxHQUFHLFVBQUksQ0FBQyxJQUFJLENBQUMsNEJBQVksRUFBRSxpQkFBaUIsQ0FBQyxDQUFDO0lBQ25FLE1BQU0sc0JBQXNCLEdBQUcsVUFBSSxDQUFDLElBQUksQ0FBQyw0QkFBWSxFQUFFLHdCQUF3QixDQUFDLENBQUM7SUFDakYsTUFBTSx3QkFBd0IsR0FBRyxVQUFJLENBQUMsSUFBSSxDQUFDLDRCQUFZLEVBQUUsMEJBQTBCLENBQUMsQ0FBQztJQUVyRixNQUFNLFlBQVksR0FBRyxnREFBZ0Q7UUFDakUsdUZBQXVGLENBQUM7SUFDNUYsTUFBTSxjQUFjLEdBQUcsdUNBQXVDLENBQUM7SUFFL0QsRUFBRSxDQUFDLHdEQUF3RCxFQUFFLEdBQUcsRUFBRTtRQUM5RCxNQUFNLENBQUMsZUFBZSxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBQ3RELE1BQU0sQ0FBQyxlQUFlLENBQUMsb0JBQW9CLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUM7SUFDckYsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMsa0RBQWtELEVBQUUsR0FBRyxFQUFFO1FBQ3hELE1BQU0sQ0FBQyxlQUFlLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxDQUFDO0lB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QWtCLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUN0RSxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQyxDQUFDLENBQUMiLCJmaWxlIjoiY29tcG9uZW50cy9lbGxpcHNpcy9lbGxpcHNpcy5lMmUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2Jyb3dzZXIsIGJ5LCBwcm9taXNlfSBmcm9tIFwiQHNvbGFyd2luZHMvdXppL3Byb3RyYWN0b3JcIjtcbmltcG9ydCB7QXRvbX0gZnJvbSBcIkBzb2xhcndpbmRzL3V6aVwiO1xuaW1wb3J0IHtFbGxpcHNpc0F0b219IGZyb20gXCIuL2VsbGlwc2lzLmF0b21cIjtcbmltcG9ydCBIZWxwZXJzIGZyb20gXCIuLi9oZWxwZXJzXCI7XG5pbXBvcnQgKiBhcyBfIGZyb20gXCJsb2Rhc2hcIjtcblxuZGVzY3JpYmUoXCJVU0VSQ09OVFJPTCBlbGxpcHNpc1wiLCAoKSA9PiB7XG5cbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgICAgSGVscGVycy5wcmVwYXJlQnJvd3NlcihcImVsbGlwc2lzXCIpO1xuICAgIH0pO1xuXG4gICAgY29uc3QgZGVmYXVsdEVsbGlwc2lzID0gQXRvbS5maW5kKEVsbGlwc2lzQXRvbSwgXCJkZWZhdWx0RWxsaXBzaXNcIik7XG4gICAgY29uc3QgdG9vbHRpcE9wdGlvbnNFbGxpcHNpcyA9IEF0b20uZmluZChFbGxpcHNpc0F0b20sIFwidG9vbHRpcE9wdGlvbnNFbGxpcHNpc1wiKTtcbiAgICBjb25zdCB0b29sdGlwT3B0aW9uc1dpdGhQYXJlbnQgPSBBdG9tLmZpbmQoRWxsaXBzaXNBdG9tLCBcIm9wdGlvbnNUb29sdGlwV2l0aFBhcmVudFwiKTtcblxuICAgIGNvbnN0IGRlZmF1bHRUaXRsZSA9IFwiSFRNTCBpcyBncmVhdCBmb3IgZGVjbGFyaW5nIHN0YXRpYyBkb2N1bWVudHMsIFwiICtcbiAgICAgICAgXCJidXQgaXQgZmFsdGVycyB3aGVuIHdlIHRyeSB0byB1c2UgaXQgZm9yIGRlY2xhcmluZyBkeW5hbWljIHZpZXdzIGluIHdlYi1hcHBsaWNhdGlvbnMuXCI7XG4gICAgY29uc3QgZGVmYXVsdFRvb2x0aXAgPSBcIlRoZSB0b29sdGlwIGRpZmZlcnMgZnJvbSBhY3R1YWwgdGl0bGVcIjtcblxuICAgIGl0KFwic2hvdWxkIHByb3Blcmx5IHJlbmRlci9wb3B1bGF0ZSAndGl0bGUnLCAndWliLXRvb2x0aXAnXCIsICgpID0+IHtcbiAgICAgICAgZXhwZWN0KGRlZmF1bHRFbGxpcHNpcy5nZXRUaXRsZSgpKS50b0JlKGRlZmF1bHRUaXRsZSk7XG4gICAgICAgIGV4cGVjdChkZWZhdWx0RWxsaXBzaXMuZ2V0RWxsaXBzZWRBdHRyaWJ1dGUoXCJ1aWItdG9vbHRpcFwiKSkudG9CZShkZWZhdWx0VG9vbHRpcCk7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCBjaGVjayBkaWZmZXJlbmNlIGJldHdlZW4gdG9vbHRpcCBhbmQgdGV4dFwiLCAoKSA9PiB7XG4gICAgICAgIGV4cGVjdChkZWZhdWx0RWxsaXBzaXMuZ2V0VGl0bGUoKSkubm90LnRvQmUoZGVmYXVsdFRvb2x0aXApO1xuICAgIH0pO1xuXG4gICAgeGl0KFwic2hvdWxkIHNob3cgdG9vbHRpcCBvbiAnbW91c2VlbnRlcidcIiwgKCkgPT4ge1xuICAgICAgICBleHBlY3QoZGVmYXVsdEVsbGlwc2lzLmdldEVsbGlwc2VkQXR0cmlidXRlKFwidG9vbHRpcC1lbmFibGVcIikpLnRvQmUoXCJmYWxzZVwiKTtcbiAgICAgICAgZXhwZWN0KGRlZmF1bHRFbGxpcHNpcy5pc1Rvb2x0aXBEaXNwbGF5ZWQoKSkudG9CZShmYWxzZSk7XG4gICAgICAgIGJyb3dzZXIubWFuYWdlKCkud2luZG93KCkuc2V0U2l6ZSg2NDAsIDg4MCk7XG4gICAgICAgIGJyb3dzZXIud2FpdCgoKSA9PiBkZWZhdWx0RWxsaXBzaXMuZ2V0RWxsaXBzZWRBdHRyaWJ1dGUoXCJ0b29sdGlwLWVuYWJsZVwiKVxuICAgICAgICAgICAgLnRoZW4oaXNFbmFibGVkID0+IF8uaXNFcXVhbChpc0VuYWJsZWQsIFwidHJ1ZVwiKSkpO1xuICAgICAgICBkZWZhdWx0RWxsaXBzaXMubW92ZU1vdXNlVG9UYXJnZXQoZGVmYXVsdEVsbGlwc2lzKTtcbiAgICAgICAgZXhwZWN0KGRlZmF1bHRFbGxpcHNpcy5nZXRFbGxpcHNlZEF0dHJpYnV0ZShcInRvb2x0aXAtZW5hYmxlXCIpKS50b0JlKFwidHJ1ZVwiKTtcbiAgICAgICAgZXhwZWN0KGRlZmF1bHRFbGxpcHNpcy5pc1Rvb2x0aXBEaXNwbGF5ZWQoKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIHhpdChcInNob3VsZCBub3Qgc2hvdyB0b29sdGlwIHdoaWxlIHRleHQgaXMgZnVsbCBsZW5ndGhcIiwgKCkgPT4ge1xuICAgICAgICBicm93c2VyLm1hbmFnZSgpLndpbmRvdygpLnNldFNpemUoMTU0MCwgODgwKTtcbiAgICAgICAgYnJvd3Nlci53YWl0KCgpID0+IGRlZmF1bHRFbGxpcHNpcy5nZXRFbGxpcHNlZEF0dHJpYnV0ZShcInRvb2x0aXAtZW5hYmxlXCIpXG4gICAgICAgICAgICAudGhlbihpc0VuYWJsZWQgPT4gXy5pc0VxdWFsKGlzRW5hYmxlZCwgXCJmYWxzZVwiKSkpO1xuICAgICAgICBkZWZhdWx0RWxsaXBzaXMubW92ZU1vdXNlVG9UYXJnZXQoZGVmYXVsdEVsbGlwc2lzKTtcbiAgICAgICAgZXhwZWN0KGRlZmF1bHRFbGxpcHNpcy5nZXRFbGxpcHNlZEF0dHJpYnV0ZShcInRvb2x0aXAtZW5hYmxlXCIpKS50b0JlKFwiZmFsc2VcIik7XG4gICAgICAgIGV4cGVjdChkZWZhdWx0RWxsaXBzaXMuaXNUb29sdGlwRGlzcGxheWVkKCkpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgeGl0KFwic2hvdWxkIHVzZSB0b29sdGlwIG9wdGlvbnNcIiwgKCkgPT4ge1xuICAgICAgICBjb25zdCB0b29sdGlwUGxhY2VtZW50ID0gXCJib3R0b21cIjtcbiAgICAgICAgZXhwZWN0KHRvb2x0aXBPcHRpb25zRWxsaXBzaXMuZ2V0RWxsaXBzZWRBdHRyaWJ1dGUoXCJ0b29sdGlwLWVuYWJsZVwiKSkudG9CZShcImZhbHNlXCIpO1xuICAgICAgICBleHBlY3QodG9vbHRpcE9wdGlvbnNFbGxpcHNpcy5pc1Rvb2x0aXBEaXNwbGF5ZWQoKSkudG9CZShmYWxzZSk7XG4gICAgICAgIGJyb3dzZXIubWFuYWdlKCkud2luZG93KCkuc2V0U2l6ZSg2NDAsIDg4MCk7XG4gICAgICAgIGJyb3dzZXIud2FpdCgoKSA9PiB0b29sdGlwT3B0aW9uc0VsbGlwc2lzLmdldEVsbGlwc2VkQXR0cmlidXRlKFwidG9vbHRpcC1lbmFibGVcIilcbiAgICAgICAgICAgIC50aGVuKGlzRW5hYmxlZCA9PiBfLmlzRXF1YWwoaXNFbmFibGVkLCBcInRydWVcIikpKTtcbiAgICAgICAgdG9vbHRpcE9wdGlvbnNFbGxpcHNpcy5tb3ZlTW91c2VUb1RhcmdldCh0b29sdGlwT3B0aW9uc0VsbGlwc2lzKTtcbiAgICAgICAgZXhwZWN0KHRvb2x0aXBPcHRpb25zRWxsaXBzaXMuZ2V0VG9vbHRpcEF0dHJpYnV0ZShcInBsYWNlbWVudFwiKSkudG9CZSh0b29sdGlwUGxhY2VtZW50KTtcbiAgICAgICAgZXhwZWN0KHRvb2x0aXBPcHRpb25zRWxsaXBzaXMuaXNUb29sdGlwRGlzcGxheWVkKCkpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCBjb21waWxlIGJpbmRIdG1sVGVtcGxhdGUgd2l0aCB4dWlIaWdobGlnaHQ6J0hUTUwnIGZpbHRlclwiLCAoKSA9PiB7XG4gICAgICAgIGV4cGVjdChkZWZhdWx0RWxsaXBzaXMuZ2V0RWxlbWVudCgpLmVsZW1lbnQoYnkuY3NzKFwiLnh1aS1oaWdobGlnaHRlZFwiKSkuZ2V0VGV4dCgpKS50b0JlKFwiSFRNTFwiKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIGNvbXBpbGUgYmluZEh0bWxUZW1wbGF0ZSB3aXRoIGxvd2VyY2FzZSBmaWx0ZXJcIiwgKCkgPT4ge1xuICAgICAgICBjb25zdCBsb3dlQ2FzZWRUaXRsZSA9IGRlZmF1bHRUaXRsZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBleHBlY3QodG9vbHRpcE9wdGlvbnNFbGxpcHNpcy5nZXRUaXRsZSgpKS50b0JlKGxvd2VDYXNlZFRpdGxlKTtcbiAgICB9KTtcblxuICAgIHhkZXNjcmliZShcIndpdGggYXR0cmlidXRlIGZpbmQtcGFyZW50LWNsYXNzPXRydWVcIiwgKCkgPT4ge1xuXG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgICAgICAgSGVscGVycy5wcmVwYXJlQnJvd3NlcihcImVsbGlwc2lzXCIpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdChcInNob3VsZG4ndCBhZGQgZWxsaXBzaXMgd2hlbiB0ZXh0IGlzIHNob3J0ZXIgdGhhbiBwYXJlbnQgZWxlbWVudFwiLCAoKSA9PiB7XG4gICAgICAgICAgICBicm93c2VyLm1hbmFnZSgpLndpbmRvdygpLnNldFNpemUoMTU0MCwgODgwKTtcbiAgICAgICAgICAgIGJyb3dzZXIud2FpdCgoKSA9PiB0b29sdGlwT3B0aW9uc1dpdGhQYXJlbnQuZ2V0RWxsaXBzZWRBdHRyaWJ1dGUoXCJ0b29sdGlwLWVuYWJsZVwiKVxuICAgICAgICAgICAgICAgIC50aGVuKGlzRW5hYmxlZCA9PiBfLmlzRXF1YWwoaXNFbmFibGVkLCBcImZhbHNlXCIpKSk7XG4gICAgICAgICAgICBleHBlY3QodG9vbHRpcE9wdGlvbnNXaXRoUGFyZW50LmdldEVsbGlwc2VkQXR0cmlidXRlKFwidG9vbHRpcC1lbmFibGVcIikpLnRvQmUoXCJmYWxzZVwiKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoXCJzaG91bGQgc2hvdyB0b29sdGlwIHdoZW4gZWxsaXBzaXMgaXMgZW5hYmxlZCBhbmQgbW91c2VlbnRlclwiLCAoKSA9PiB7XG4gICAgICAgICAgICBicm93c2VyLm1hbmFnZSgpLndpbmRvdygpLnNldFNpemUoNjQwLCA4ODApO1xuICAgICAgICAgICAgYnJvd3Nlci53YWl0KCgpID0+IHRvb2x0aXBPcHRpb25zV2l0aFBhcmVudC5nZXRFbGxpcHNlZEF0dHJpYnV0ZShcInRvb2x0aXAtZW5hYmxlXCIpXG4gICAgICAgICAgICAgICAgLnRoZW4oaXNFbmFibGVkID0+IF8uaXNFcXVhbChpc0VuYWJsZWQsIFwidHJ1ZVwiKSkpO1xuICAgICAgICAgICAgdG9vbHRpcE9wdGlvbnNXaXRoUGFyZW50Lm1vdmVNb3VzZVRvVGFyZ2V0KHRvb2x0aXBPcHRpb25zV2l0aFBhcmVudCk7XG4gICAgICAgICAgICBleHBlY3QodG9vbHRpcE9wdGlvbnNXaXRoUGFyZW50LmlzVG9vbHRpcERpc3BsYXllZCgpKS50b0JlKHRydWUpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdChcInNob3VsZG4ndCBzaG93IHRvb2x0aXAgd2hlbiBlbGxpcHNpcyBpcyBkaXNhYmxlZCBhbmQgbW91c2VlbnRlclwiLCAoKSA9PiB7XG4gICAgICAgICAgICBicm93c2VyLm1hbmFnZSgpLndpbmRvdygpLnNldFNpemUoMTUwMCwgODgwKTtcbiAgICAgICAgICAgIGJyb3dzZXIud2FpdCgoKSA9PiB0b29sdGlwT3B0aW9uc1dpdGhQYXJlbnQuZ2V0RWxsaXBzZWRBdHRyaWJ1dGUoXCJ0b29sdGlwLWVuYWJsZVwiKVxuICAgICAgICAgICAgICAgIC50aGVuKGlzRW5hYmxlZCA9PiBfLmlzRXF1YWwoaXNFbmFibGVkLCBcImZhbHNlXCIpKSk7XG4gICAgICAgICAgICB0b29sdGlwT3B0aW9uc1dpdGhQYXJlbnQubW92ZU1vdXNlVG9UYXJnZXQodG9vbHRpcE9wdGlvbnNXaXRoUGFyZW50KTtcbiAgICAgICAgICAgIGV4cGVjdCh0b29sdGlwT3B0aW9uc1dpdGhQYXJlbnQuaXNUb29sdGlwRGlzcGxheWVkKCkpLnRvQmUoZmFsc2UpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn0pO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
