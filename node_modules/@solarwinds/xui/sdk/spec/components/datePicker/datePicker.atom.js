"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const protractor_1 = require("@solarwinds/uzi/protractor");
const uzi_1 = require("@solarwinds/uzi");
/**
 * Lukas: WARNING FOR TRESPASSERS
 *
 * For anyone who's going to touch datepicker e2e tests - this atom doesn't have proper API for simply setting date
 * value to the field ... something like setValue(date:Date), or setValue(int year, int month, int day) would be
 * really nice to have, because the users don't want to mess with internal structure of the datepicker component.
 * Current API is more likely for internal testing only.
 */
class DatePickerAtom extends uzi_1.Atom {
    clickTitle() {
        let title = this.getElementByCss("button[id*='title']");
        return title.click();
    }
    getPopup() {
        return this.getElementByCss(".dropdown-menu");
    }
    clickCalendarIcon() {
        let icon = this.getElementByCss(".xui-datepicker__icon");
        return icon.click();
    }
    isOpened() {
        return this.getElement().element(protractor_1.by.className("uib-datepicker-popup")).isPresent();
    }
    clickInput() {
        let icon = this.getElementByCss(".form-control");
        return icon.click();
    }
    clickToday() {
        return this.clickButton("Today");
    }
    formatDate(date) {
        return date.toLocaleDateString("en-US");
    }
    getInput() {
        return this.getElement().element(protractor_1.by.css(".form-control"));
    }
    getInputValue() {
        return this.getElementValue(".form-control");
    }
    acceptText(value) {
        return this.acceptKeys(value);
    }
    acceptKeys(...keys) {
        return this.getInput().sendKeys(...keys);
    }
    clearText() {
        return this.getInput().clear();
    }
    getTitle() {
        return this.getElementText("button[id*='title']");
    }
    getNextTitle() {
        let newTitle;
        let nextTitle = this.getTitle().then(function (currentTitle) {
            if (currentTitle.length === 4) {
                let coef = Math.floor((parseInt(currentTitle, 10) - 2000) / 20);
                let rangeStart = 2000 + 20 * coef + 1;
                let rangeEnd = rangeStart + 20 - 1;
                newTitle = rangeStart + " - " + rangeEnd;
            }
            else {
                newTitle = currentTitle.substring(currentTitle.length - 4);
            }
            return newTitle;
        });
        return nextTitle;
    }
    goNext() {
        return this.clickElement(".btn.uib-right");
    }
    goBack() {
        return this.clickElement(".btn.uib-left");
    }
    selectDay(day, index) {
        return this.clickButton(day.toString(), index);
    }
    selectMonth(month, index) {
        return this.clickButton(month, index);
    }
    selectYear(year, index) {
        return this.clickButton(year, index);
    }
    getYearElement(year, index) {
        return this.selectButton(year, index);
    }
    getMonthElement(month, index) {
        return this.selectButton(month, index);
    }
    getActiveDay() {
        return this.getElementText(".btn.btn-info.active");
    }
    isValid() {
        return this.getInput().getAttribute("class").then((result) => {
            return result.split(/ +/).indexOf("ng-invalid") === -1;
        });
    }
    getElementTest(className) {
        return this.getElementByCss(className);
    }
    // private helpers
    getClassValueByCss(title) {
        return this.getElementByCss(title).getAttribute("class");
    }
    getClassValueByButtonText(title, index) {
        return this.selectButton(title, index).getAttribute("class");
    }
    clickButton(buttonTitle, index = 0) {
        let button = super.getElement().all(protractor_1.by.buttonText(buttonTitle)).get(index);
        return button.click();
    }
    getElementValue(identifier, deep) {
        return this.getElementByCss(identifier, deep).getAttribute("value");
    }
    getElementText(identifier, deep) {
        return this.getElementByCss(identifier, deep).getText();
    }
    clickElement(identifier) {
        return this.getElementByCss(identifier).click();
    }
    getElementByCss(identifier, deep) {
        //if deep is passed then look in shadow DOM
        if (deep) {
            return super.getElement().element(protractor_1.by.css("* /deep/ " + identifier));
        }
        else {
            return super.getElement().element(protractor_1.by.css(identifier));
        }
    }
    selectButton(identifier, index = 0) {
        return super.getElement().all(protractor_1.by.buttonText(identifier)).get(index);
    }
}
DatePickerAtom.CSS_CLASS = "xui-datepicker";
DatePickerAtom.MONTHNAMES_SHORT = ["Jan", "Feb", "Mar", "Apr", "May", "Jun",
    "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
DatePickerAtom.MONTHNAMES_LONG = ["January", "February", "March", "April", "May", "June",
    "July", "August", "September", "October", "November", "December"];
DatePickerAtom.ACCEPTED_DATES = [
    "10-1-1988",
    "11-02-88",
    "1999-Feb-5",
    "2000-5-15",
    "99-5-25",
    "88-Nov-5",
    "4-12-2000",
    "6-Apr-1999",
    "7-10-99",
    "1-Oct-82",
    "10/1/1988",
    "11/02/88",
    "1999/Feb/5",
    "2000/5/15",
    "99/5/25",
    "88/Nov/5",
    "4/12/2000",
    "6/Apr/1999",
    "7/10/99",
    "1/Oct/82",
    "10 1 1988",
    "01 02 88",
    "1999 Feb 5",
    "2000 5 15",
    "99 5 25",
    "88 Nov 5",
    "4 12 2000",
    "6 Apr 1999",
    "7 10 99",
    "1 Oct 82",
    "10.1.1988",
    "01.02.88",
    "1999.Feb.5",
    "2000.5.15",
    "99.5.25",
    "88.Nov.5",
    "4.12.2000",
    "6.Apr.1999",
    "7.10.99",
    "1.Oct.82"
];
exports.DatePickerAtom = DatePickerAtom;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvZGF0ZVBpY2tlci9kYXRlUGlja2VyLmF0b20udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSwyREFBc0U7QUFDdEUseUNBQXFDO0FBRXJDOzs7Ozs7O0dBT0c7QUFFSCxvQkFBNEIsU0FBUSxVQUFJO0lBc0Q3QixVQUFVO1FBQ2IsSUFBSSxLQUFLLEdBQUcsSUFBSSxDQUFDLGVBQWUsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO1FBQ3hELE1BQU0sQ0FBQyxLQUFLLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDekIsQ0FBQztJQUVNLFFBQVE7UUFDWCxNQUFNLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO0lBQ2xELENBQUM7SUFFTSxpQkFBaUI7UUFDcEIsSUFBSSxJQUFJLEdBQUcsSUFBSSxDQUFDLGVBQWUsQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO1FBQ3pELE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDeEIsQ0FBQztJQUVNLFFBQVE7UUFDWCxNQUFNLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFDLE9BQU8sQ0FBQyxlQUFFLENBQUMsU0FBUyxDQUFDLHNCQUFzQixDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUN2RixDQUFDO0lBRU0sVUFBVTtRQUNiLElBQUksSUFBSSxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsZUFBZSxDQUFDLENBQUM7UUFDakQsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztJQUN4QixDQUFDO0lBRU0sVUFBVTtRQUNiLE1BQU0sQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ3JDLENBQUM7SUFFTSxVQUFVLENBQUMsSUFBVTtRQUN4QixNQUFNLENBQUMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQzVDLENBQUM7SUFFTSxRQUFRO1FBQ1gsTUFBTSxDQUFDLElB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LEtBQUssRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEtBQUssQ0FBQyxDQUFDO0FBQ2hDLDhCQUFlLEdBQWEsQ0FBQyxTQUFTLEVBQUUsVUFBVSxFQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU07SUFDN0YsTUFBTSxFQUFFLFFBQVEsRUFBRSxXQUFXLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxVQUFVLENBQUMsQ0FBQztBQUV4RCw2QkFBYyxHQUFhO0lBQ3JDLFdBQVc7SUFDWCxVQUFVO0lBQ1YsWUFBWTtJQUNaLFdBQVc7SUFDWCxTQUFTO0lBQ1QsVUFBVTtJQUNWLFdBQVc7SUFDWCxZQUFZO0lBQ1osU0FBUztJQUNULFVBQVU7SUFFVixXQUFXO0lBQ1gsVUFBVTtJQUNWLFlBQVk7SUFDWixXQUFXO0lBQ1gsU0FBUztJQUNULFVBQVU7SUFDVixXQUFXO0lBQ1gsWUFBWTtJQUNaLFNBQVM7SUFDVCxVQUFVO0lBRVYsV0FBVztJQUNYLFVBQVU7SUFDVixZQUFZO0lBQ1osV0FBVztJQUNYLFNBQVM7SUFDVCxVQUFVO0lBQ1YsV0FBVztJQUNYLFlBQVk7SUFDWixTQUFTO0lBQ1QsVUFBVTtJQUVWLFdBQVc7SUFDWCxVQUFVO0lBQ1YsWUFBWTtJQUNaLFdBQVc7SUFDWCxTQUFTO0lBQ1QsVUFBVTtJQUNWLFdBQVc7SUFDWCxZQUFZO0lBQ1osU0FBUztJQUNULFVBQVU7Q0FDYixDQUFDO0FBcEROLHdDQStNQyIsImZpbGUiOiJjb21wb25lbnRzL2RhdGVQaWNrZXIvZGF0ZVBpY2tlci5hdG9tLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtieSwgRWxlbWVudEZpbmRlciwgcHJvbWlzZX0gZnJvbSBcIkBzb2xhcndpbmRzL3V6aS9wcm90cmFjdG9yXCI7XG5pbXBvcnQge0F0b219IGZyb20gXCJAc29sYXJ3aW5kcy91emlcIjtcblxuLyoqXG4gKiBMdWthczogV0FSTklORyBGT1IgVFJFU1BBU1NFUlNcbiAqXG4gKiBGb3IgYW55b25lIHdobydzIGdvaW5nIHRvIHRvdWNoIGRhdGVwaWNrZXIgZTJlIHRlc3RzIC0gdGhpcyBhdG9tIGRvZXNuJ3QgaGF2ZSBwcm9wZXIgQVBJIGZvciBzaW1wbHkgc2V0dGluZyBkYXRlXG4gKiB2YWx1ZSB0byB0aGUgZmllbGQgLi4uIHNvbWV0aGluZyBsaWtlIHNldFZhbHVlKGRhdGU6RGF0ZSksIG9yIHNldFZhbHVlKGludCB5ZWFyLCBpbnQgbW9udGgsIGludCBkYXkpIHdvdWxkIGJlXG4gKiByZWFsbHkgbmljZSB0byBoYXZlLCBiZWNhdXNlIHRoZSB1c2VycyBkb24ndCB3YW50IHRvIG1lc3Mgd2l0aCBpbnRlcm5hbCBzdHJ1Y3R1cmUgb2YgdGhlIGRhdGVwaWNrZXIgY29tcG9uZW50LlxuICogQ3VycmVudCBBUEkgaXMgbW9yZSBsaWtlbHkgZm9yIGludGVybmFsIHRlc3Rpbmcgb25seS5cbiAqL1xuXG5leHBvcnQgY2xhc3MgRGF0ZVBpY2tlckF0b20gZXh0ZW5kcyBBdG9tIHtcbiAgICBwdWJsaWMgc3RhdGljIENTU19DTEFTUyA9IFwieHVpLWRhdGVwaWNrZXJcIjtcblxuICAgIHB1YmxpYyBzdGF0aWMgTU9OVEhOQU1FU19TSE9SVDogc3RyaW5nW10gPSBbXCJKYW5cIiwgXCJGZWJcIiwgXCJNYXJcIiwgXCJBcHJcIiwgXCJNYXlcIiwgXCJKdW5cIixcbiAgICAgICAgXCJKdWxcIiwgXCJBdWdcIiwgXCJTZXBcIiwgXCJPY3RcIiwgXCJOb3ZcIiwgXCJEZWNcIl07XG4gICAgcHVibGljIHN0YXRpYyBNT05USE5BTUVTX0xPTkc6IHN0cmluZ1tdID0gW1wiSmFudWFyeVwiLCBcIkZlYnJ1YXJ5XCIsIFwiTWFyY2hcIiwgXCJBcHJpbFwiLCBcIk1heVwiLCBcIkp1bmVcIixcbiAgICAgICAgXCJKdWx5XCIsIFwiQXVndXN0XCIsIFwiU2VwdGVtYmVyXCIsIFwiT2N0b2JlclwiLCBcIk5vdmVtYmVyXCIsIFwiRGVjZW1iZXJcIl07XG5cbiAgICBwdWJsaWMgc3RhdGljIEFDQ0VQVEVEX0RBVEVTOiBzdHJpbmdbXSA9IFtcbiAgICAgICAgXCIxMC0xLTE5ODhcIixcbiAgICAgICAgXCIxMS0wMi04OFwiLFxuICAgICAgICBcIjE5OTktRmViLTVcIixcbiAgICAgICAgXCIyMDAwLTUtMTVcIixcbiAgICAgICAgXCI5OS01LTI1XCIsXG4gICAgICAgIFwiODgtTm92LTVcIixcbiAgICAgICAgXCI0LTEyLTIwMDBcIixcbiAgICAgICAgXCI2LUFwci0xOTk5XCIsXG4gICAgICAgIFwiNy0xMC05OVwiLFxuICAgICAgICBcIjEtT2N0LTgyXCIsXG5cbiAgICAgICAgXCIxMC8xLzE5ODhcIixcbiAgICAgICAgXCIxMS8wMi84OFwiLFxuICAgICAgICBcIjE5OTkvRmViLzVcIixcbiAgICAgICAgXCIyMDAwLzUvMTVcIixcbiAgICAgICAgXCI5OS81LzI1XCIsXG4gICAgICAgIFwiODgvTm92LzVcIixcbiAgICAgICAgXCI0LzEyLzIwMDBcIixcbiAgICAgICAgXCI2L0Fwci8xOTk5XCIsXG4gICAgICAgIFwiNy8xMC85OVwiLFxuICAgICAgICBcIjEvT2N0LzgyXCIsXG5cbiAgICAgICAgXCIxMCAxIDE5ODhcIixcbiAgICAgICAgXCIwMSAwMiA4OFwiLFxuICAgICAgICBcIjE5OTkgRmViIDVcIixcbiAgICAgICAgXCIyMDAwIDUgMTVcIixcbiAgICAgICAgXCI5OSA1IDI1XCIsXG4gICAgICAgIFwiODggTm92IDVcIixcbiAgICAgICAgXCI0IDEyIDIwMDBcIixcbiAgICAgICAgXCI2IEFwciAxOTk5XCIsXG4gICAgICAgIFwiNyAxMCA5OVwiLFxuICAgICAgICBcIjEgT2N0IDgyXCIsXG5cbiAgICAgICAgXCIxMC4xLjE5ODhcIixcbiAgICAgICAgXCIwMS4wMi44OFwiLFxuICAgICAgICBcIjE5OTkuRmViLjVcIixcbiAgICAgICAgXCIyMDAwLjUuMTVcIixcbiAgICAgICAgXCI5OS41LjI1XCIsXG4gICAgICAgIFwiODguTm92LjVcIixcbiAgICAgICAgXCI0LjEyLjIwMDBcIixcbiAgICAgICAgXCI2LkFwci4xOTk5XCIsXG4gICAgICAgIFwiNy4xMC45OVwiLFxuICAgICAgICBcIjEuT2N0LjgyXCJcbiAgICBdO1xuXG4gICAgcHVibGljIGNsaWNrVGl0bGUoKTogcHJvbWlzZS5Qcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgbGV0IHRpdGxlID0gdGhpcy5nZXRFbGVtZW50QnlDc3MoXCJidXR0b25baWQqPSd0aXRsZSddXCIpO1xuICAgICAgICByZXR1cm4gdGl0bGUuY2xpY2soKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0UG9wdXAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldEVsZW1lbnRCeUNzcyhcIi5kcm9wZG93bi1tZW51XCIpO1xuICAgIH1cblxuICAgIHB1YmxpYyBjbGlja0NhbGVuZGFySWNvbigpOiBwcm9taXNlLlByb21pc2U8dm9pZD4ge1xuICAgICAgICBsZXQgaWNvbiA9IHRoaXMuZ2V0RWxlbWVudEJ5Q3NzKFwiLnh1aS1kYXRlcGlja2VyX19pY29uXCIpO1xuICAgICAgICByZXR1cm4gaWNvbi5jbGljaygpO1xuICAgIH1cblxuICAgIHB1YmxpYyBpc09wZW5lZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RWxlbWVudCgpLmVsZW1lbnQoYnkuY2xhc3NOYW1lKFwidWliLWRhdGVwaWNrZXItcG9wdXBcIikpLmlzUHJlc2VudCgpO1xuICAgIH1cblxuICAgIHB1YmxpYyBjbGlja0lucHV0KCk6IHByb21pc2UuUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGxldCBpY29uID0gdGhpcy5nZXRFbGVtZW50QnlDc3MoXCIuZm9ybS1jb250cm9sXCIpO1xuICAgICAgICByZXR1cm4gaWNvbi5jbGljaygpO1xuICAgIH1cblxuICAgIHB1YmxpYyBjbGlja1RvZGF5KCk6IHByb21pc2UuUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHJldHVybiB0aGlzLmNsaWNrQnV0dG9uKFwiVG9kYXlcIik7XG4gICAgfVxuXG4gICAgcHVibGljIGZvcm1hdERhdGUoZGF0ZTogRGF0ZSk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBkYXRlLnRvTG9jYWxlRGF0ZVN0cmluZyhcImVuLVVTXCIpO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRJbnB1dCgpOiBFbGVtZW50RmluZGVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RWxlbWVudCgpLmVsZW1lbnQoYnkuY3NzKFwiLmZvcm0tY29udHJvbFwiKSk7XG4gICAgfVxuXG4gICAgcHVibGljIGdldElucHV0VmFsdWUoKTogcHJvbWlzZS5Qcm9taXNlPHN0cmluZz4ge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRFbGVtZW50VmFsdWUoXCIuZm9ybS1jb250cm9sXCIpO1xuICAgIH1cblxuICAgIHB1YmxpYyBhY2NlcHRUZXh0KHZhbHVlOiBzdHJpbmcpOiBwcm9taXNlLlByb21pc2U8dm9pZD4ge1xuICAgICAgICByZXR1cm4gdGhpcy5hY2NlcHRLZXlzKHZhbHVlKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYWNjZXB0S2V5cyguLi5rZXlzOiBhbnlbXSk6IHByb21pc2UuUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldElucHV0KCkuc2VuZEtleXMoLi4ua2V5cyk7XG4gICAgfVxuXG4gICAgcHVibGljIGNsZWFyVGV4dCgpOiBwcm9taXNlLlByb21pc2U8dm9pZD4ge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRJbnB1dCgpLmNsZWFyKCk7XG4gICAgfVxuXG4gICAgcHVibGljIGdldFRpdGxlKCk6IHByb21pc2UuUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RWxlbWVudFRleHQoXCJidXR0b25baWQqPSd0aXRsZSddXCIpO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXROZXh0VGl0bGUoKTogc3RyaW5nIHtcbiAgICAgICAgbGV0IG5ld1RpdGxlOiBzdHJpbmc7XG4gICAgICAgIGxldCBuZXh0VGl0bGU6IGFueSA9IHRoaXMuZ2V0VGl0bGUoKS50aGVuKGZ1bmN0aW9uIChjdXJyZW50VGl0bGUpIHtcbiAgICAgICAgICAgIGlmIChjdXJyZW50VGl0bGUubGVuZ3RoID09PSA0KSB7XG4gICAgICAgICAgICAgICAgbGV0IGNvZWY6IG51bWJlciA9IE1hdGguZmxvb3IoKHBhcnNlSW50KGN1cnJlbnRUaXRsZSwgMTApIC0gMjAwMCkgLyAyMCk7XG4gICAgICAgICAgICAgICAgbGV0IHJhbmdlU3RhcnQ6IG51bWJlciA9IDIwMDAgKyAyMCAqIGNvZWYgKyAxO1xuICAgICAgICAgICAgICAgIGxldCByYW5nZUVuZDogbnVtYmVyID0gcmFuZ2VTdGFydCArIDIwIC0gMTtcbiAgICAgICAgICAgICAgICBuZXdUaXRsZSA9IHJhbmdlU3RhcnQgKyBcIiAtIFwiICsgcmFuZ2VFbmQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG5ld1RpdGxlID0gY3VycmVudFRpdGxlLnN1YnN0cmluZyhjdXJyZW50VGl0bGUubGVuZ3RoIC0gNCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3VGl0bGU7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gbmV4dFRpdGxlO1xuICAgIH1cblxuICAgIHB1YmxpYyBnb05leHQoKTogcHJvbWlzZS5Qcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2xpY2tFbGVtZW50KFwiLmJ0bi51aWItcmlnaHRcIik7XG4gICAgfVxuXG4gICAgcHVibGljIGdvQmFjaygpOiBwcm9taXNlLlByb21pc2U8dm9pZD4ge1xuICAgICAgICByZXR1cm4gdGhpcy5jbGlja0VsZW1lbnQoXCIuYnRuLnVpYi1sZWZ0XCIpO1xuICAgIH1cblxuICAgIHB1YmxpYyBzZWxlY3REYXkoZGF5OiBudW1iZXIsIGluZGV4PzogbnVtYmVyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNsaWNrQnV0dG9uKGRheS50b1N0cmluZygpLCBpbmRleCk7XG4gICAgfVxuXG4gICAgcHVibGljIHNlbGVjdE1vbnRoKG1vbnRoOiBzdHJpbmcsIGluZGV4PzogbnVtYmVyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNsaWNrQnV0dG9uKG1vbnRoLCBpbmRleCk7XG4gICAgfVxuXG4gICAgcHVibGljIHNlbGVjdFllYXIoeWVhcjogc3RyaW5nLCBpbmRleD86IG51bWJlcikge1xuICAgICAgICByZXR1cm4gdGhpcy5jbGlja0J1dHRvbih5ZWFyLCBpbmRleCk7XG4gICAgfVxuXG4gICAgcHVibGljIGdldFllYXJFbGVtZW50KHllYXI6IHN0cmluZywgaW5kZXg/OiBudW1iZXIpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0QnV0dG9uKHllYXIsIGluZGV4KTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0TW9udGhFbGVtZW50KG1vbnRoOiBzdHJpbmcsIGluZGV4PzogbnVtYmVyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNlbGVjdEJ1dHRvbihtb250aCwgaW5kZXgpO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRBY3RpdmVEYXkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldEVsZW1lbnRUZXh0KFwiLmJ0bi5idG4taW5mby5hY3RpdmVcIik7XG4gICAgfVxuXG4gICAgcHVibGljIGlzVmFsaWQoKTogcHJvbWlzZS5Qcm9taXNlPGJvb2xlYW4+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0SW5wdXQoKS5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKS50aGVuKChyZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdC5zcGxpdCgvICsvKS5pbmRleE9mKFwibmctaW52YWxpZFwiKSA9PT0gLTE7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRFbGVtZW50VGVzdChjbGFzc05hbWU6IHN0cmluZykge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRFbGVtZW50QnlDc3MoY2xhc3NOYW1lKTtcbiAgICB9XG5cbiAgICAvLyBwcml2YXRlIGhlbHBlcnNcblxuICAgIHByaXZhdGUgZ2V0Q2xhc3NWYWx1ZUJ5Q3NzKHRpdGxlOiBzdHJpbmcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RWxlbWVudEJ5Q3NzKHRpdGxlKS5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGdldENsYXNzVmFsdWVCeUJ1dHRvblRleHQodGl0bGU6IHN0cmluZywgaW5kZXg6IG51bWJlcikge1xuICAgICAgICByZXR1cm4gdGhpcy5zZWxlY3RCdXR0b24odGl0bGUsIGluZGV4KS5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNsaWNrQnV0dG9uKGJ1dHRvblRpdGxlOiBzdHJpbmcsIGluZGV4OiBudW1iZXIgPSAwKSB7XG4gICAgICAgIGxldCBidXR0b24gPSBzdXBlci5nZXRFbGVtZW50KCkuYWxsKGJ5LmJ1dHRvblRleHQoYnV0dG9uVGl0bGUpKS5nZXQoaW5kZXgpO1xuICAgICAgICByZXR1cm4gYnV0dG9uLmNsaWNrKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRFbGVtZW50VmFsdWUoaWRlbnRpZmllcjogc3RyaW5nLCBkZWVwPzogYm9vbGVhbikge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRFbGVtZW50QnlDc3MoaWRlbnRpZmllciwgZGVlcCkuZ2V0QXR0cmlidXRlKFwidmFsdWVcIik7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRFbGVtZW50VGV4dChpZGVudGlmaWVyOiBzdHJpbmcsIGRlZXA/OiBib29sZWFuKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldEVsZW1lbnRCeUNzcyhpZGVudGlmaWVyLCBkZWVwKS5nZXRUZXh0KCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjbGlja0VsZW1lbnQoaWRlbnRpZmllcjogc3RyaW5nKTogcHJvbWlzZS5Qcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RWxlbWVudEJ5Q3NzKGlkZW50aWZpZXIpLmNsaWNrKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRFbGVtZW50QnlDc3MoaWRlbnRpZmllcjogc3RyaW5nLCBkZWVwPzogYm9vbGVhbikge1xuICAgICAgICAvL2lmIGRlZXAgaXMgcGFzc2VkIHRoZW4gbG9vayBpbiBzaGFkb3cgRE9NXG4gICAgICAgIGlmIChkZWVwKSB7XG4gICAgICAgICAgICByZXR1cm4gc3VwZXIuZ2V0RWxlbWVudCgpLmVsZW1lbnQoYnkuY3NzKFwiKiAvZGVlcC8gXCIgKyBpZGVudGlmaWVyKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gc3VwZXIuZ2V0RWxlbWVudCgpLmVsZW1lbnQoYnkuY3NzKGlkZW50aWZpZXIpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgc2VsZWN0QnV0dG9uKGlkZW50aWZpZXI6IHN0cmluZywgaW5kZXg6IG51bWJlciA9IDApIHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldEVsZW1lbnQoKS5hbGwoYnkuYnV0dG9uVGV4dChpZGVudGlmaWVyKSkuZ2V0KGluZGV4KTtcbiAgICB9XG5cbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
