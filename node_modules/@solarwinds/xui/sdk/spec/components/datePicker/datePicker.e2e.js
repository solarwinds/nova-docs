"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const protractor = require("@solarwinds/uzi/protractor");
const protractor_1 = require("@solarwinds/uzi/protractor");
const helpers_1 = require("../helpers");
const index_atom_1 = require("../index.atom");
const uzi_1 = require("@solarwinds/uzi");
describe("USERCONTROL datePicker", () => {
    let datePickerInline;
    let datePickerPopUp;
    let datePickerInlineDisabled;
    let datePickerPopUpDisabled;
    let datePickerWithNgChange;
    let datePickerMaxMin;
    function getMaxDate() {
        return protractor_1.element(protractor_1.by.id("maxDate")).getText();
    }
    function getMinDate() {
        return protractor_1.element(protractor_1.by.id("minDate")).getText();
    }
    beforeEach(() => {
        helpers_1.default.prepareBrowser("datePicker");
        datePickerInline = uzi_1.Atom.findIn(index_atom_1.DatePickerAtom, protractor_1.element(protractor_1.by.id("inline-datepicker")));
        datePickerPopUp = uzi_1.Atom.findIn(index_atom_1.DatePickerAtom, protractor_1.element(protractor_1.by.id("input-datepicker")));
        datePickerInlineDisabled =
            uzi_1.Atom.findIn(index_atom_1.DatePickerAtom, protractor_1.element(protractor_1.by.id("disabled-inline-datepicker")));
        datePickerPopUpDisabled =
            uzi_1.Atom.findIn(index_atom_1.DatePickerAtom, protractor_1.element(protractor_1.by.id("disabled-input-datepicker")));
        datePickerWithNgChange = index_atom_1.DatePickerAtom.findIn(index_atom_1.DatePickerAtom, protractor_1.element(protractor_1.by.id("datepicker-with-onchange")));
        datePickerMaxMin = uzi_1.Atom.findIn(index_atom_1.DatePickerAtom, protractor_1.element(protractor_1.by.id("datepicker-with-maxmin")));
    });
    //----------INLINE MODE OF DATEPICKER---------------
    describe("when it is disabled", () => {
        it("clicking on title does nothing", () => {
            let originalTitle = datePickerInlineDisabled.getTitle();
            datePickerInlineDisabled.clickTitle().then(() => {
                fail("Element should not be clickable for Observer");
            }, (err) => {
                expect(err.message.toString()).toMatch("is not clickable at point");
            });
            let modifiedTitle = datePickerInlineDisabled.getTitle();
            expect(originalTitle).toEqual(modifiedTitle);
        });
        it("clicking on next does nothing", () => {
            let originalTitle = datePickerInlineDisabled.getTitle();
            datePickerInlineDisabled.goNext().then(() => {
                fail("Element should not be clickable for Observer");
            }, (err) => {
                expect(err.message.toString()).toMatch("is not clickable at point");
            });
            let modifiedTitle = datePickerInlineDisabled.getTitle();
            expect(originalTitle).toEqual(modifiedTitle);
        });
        it("clicking on back does nothing", () => {
            let originalTitle = datePickerInlineDisabled.getTitle();
            datePickerInlineDisabled.goBack().then(() => {
                fail("Element should not be clickable for Observer");
            }, (err) => {
                expect(err.message.toString()).toMatch("is not clickable at point");
            });
            let modifiedTitle = datePickerInlineDisabled.getTitle();
            expect(originalTitle).toEqual(modifiedTitle);
        });
    });
    it("should show year in title and months in body upon click on title", () => {
        let currentYear = new Date().getFullYear().toString();
        //Get random month
        let randomMonth = () => {
            return index_atom_1.DatePickerAtom.MONTHNAMES_SHORT[Math.floor(Math.random() * 12)];
        };
        //Go upper level in title
        datePickerInline.clickTitle();
        expect(datePickerInline.getTitle()).toEqual(currentYear);
        expect(datePickerInline.getMonthElement(randomMonth()).isPresent()).toBe(true);
    });
    it("should change title upon click on next/previous buttons", () => {
        //define current title and title which should appear upon click on Next button
        const date = new Date();
        const currentMonthNumber = date.getMonth();
        const thisYear = date.getFullYear();
        const nextYear = currentMonthNumber === 11 ? thisYear + 1 : thisYear; // hack for December
        let currentTitle = `${index_atom_1.DatePickerAtom.MONTHNAMES_LONG[currentMonthNumber]} ${thisYear}`;
        let nextTitle = `${index_atom_1.DatePickerAtom.MONTHNAMES_LONG[(currentMonthNumber + 1) % 12]} ${nextYear}`;
        //initial title
        expect(datePickerInline.getTitle()).toEqual(currentTitle);
        //go next
        datePickerInline.goNext();
        //title after click on Next button
        expect(datePickerInline.getTitle()).toEqual(nextTitle);
        //go back to initial title
        datePickerInline.goBack();
        //initial title
        expect(datePickerInline.getTitle()).toEqual(currentTitle);
    });
    it("should show years in body upon click on title (in state of year)", () => {
        let nextTitle = datePickerInline.getNextTitle();
        let currentYear = new Date().getFullYear().toString();
        datePickerInline.clickTitle();
        expect(datePickerInline.getTitle()).toEqual(nextTitle);
        expect(datePickerInline.getYearElement(currentYear).isPresent()).toBe(true);
    });
    //--------POPUP MODE OF DATEPICKER-------------
    it("should not be possible to click on icon when it is disabled", () => {
        expect(datePickerPopUpDisabled.getInput().isEnabled()).toBe(false);
    });
    it("should open popup upon click on icon", () => {
        datePickerPopUp.clickCalendarIcon();
        expect(datePickerPopUp.getPopup().isDisplayed()).toBe(true);
    });
    it("should show datepicker popup upon click on input", () => {
        datePickerPopUp.clickInput();
        expect(datePickerPopUp.getPopup().isDisplayed()).toBe(true);
    });
    // TC1: verify that current date on popup and date on opened calendar are the same
    it("should have the same date both on input form and popped up window upon the click on input", () => {
        let stringDate = "1/1/2020";
        //check if value on input is correct
        expect(datePickerPopUp.getInputValue()).toEqual(stringDate);
        //click on it
        datePickerPopUp.clickInput();
        expect(datePickerPopUp.getTitle()).toEqual("January 2020");
        //check that correct day is selected
        expect(datePickerPopUp.getActiveDay()).toEqual("01");
    });
    // 2TC: verify that all buttons (except "Close") working as expected
    it("should select current date upon click on 'Today'", () => {
        datePickerPopUp.clickInput();
        datePickerPopUp.clickToday();
        expect(datePickerPopUp.getInputValue()).toEqual(datePickerPopUp.formatDate(new Date()));
    });
    // TC3: open the calendar and choose some date, verify that date is choosen and popup show correct date
    it("should correctly change to the selected date", () => {
        let day = 20;
        let date = new Date("1 Jan 2020");
        date.setDate(day);
        datePickerPopUp.clickInput();
        //select some date
        datePickerPopUp.selectDay(day);
        //check that input updated to selected date
        expect(datePickerPopUp.getInputValue()).toEqual(datePickerPopUp.formatDate(date));
        protractor_1.browser.wait(() => datePickerPopUp.isOpened().then((isOpened) => !isOpened));
        datePickerPopUp.clickCalendarIcon();
        //check that selected day is active
        expect(datePickerPopUp.getActiveDay()).toEqual("20");
    });
    // UIF-1271 - popup wasn't closing after selecting date
    it("should close datepicker popup upon click on a date", () => {
        // open popup by clicking on popup
        datePickerPopUp.clickInput();
        //browser.wait(()=>datePickerPopUp.getPopup().isDisplayed(), 1000);
        expect(datePickerPopUp.getPopup().isDisplayed()).toBe(true);
        // close popup by clicking on "Today" button
        datePickerPopUp.clickToday();
        expect(datePickerPopUp.getPopup().isPresent()).toBe(false);
    });
    // UIF-2140 - DatePicker: support text input
    describe("should be validate the text inputs accordingly, such ", () => {
        let wrongDates = [
            "abcdefg",
            "112233"
        ];
        for (let date of index_atom_1.DatePickerAtom.ACCEPTED_DATES) {
            testDateFormat(date, true);
        }
        for (let date of wrongDates) {
            testDateFormat(date, false);
        }
        function testDateFormat(date, acceptable) {
            let validity = acceptable ? "valid" : "invalid";
            it(date + " as " + validity, () => {
                datePickerPopUp.clearText();
                datePickerPopUp.acceptText(date);
                expect(datePickerPopUp.isValid()).toBe(acceptable);
            });
        }
    });
    it("calls onChange when new value is selected", () => {
        datePickerWithNgChange.clickInput();
        datePickerWithNgChange.clickToday();
        const verificationInput = protractor_1.element(protractor_1.by.id("onChangeCalled"));
        expect(verificationInput.getAttribute("value")).toBe("true");
    });
    describe("when maxDate, minDate is set", () => {
        let minDate;
        let maxDate;
        beforeEach((done) => {
            protractor.promise
                .all([getMinDate(), getMaxDate()])
                .then((values) => {
                minDate = new Date(values[0].slice(1, -1));
                maxDate = new Date(values[1].slice(1, -1));
                done();
            });
        });
        it("should forbid selection of date less than minDate", () => {
            //larger dates can be selected
            let date = new Date(minDate);
            date.setDate(date.getDate() + 2);
            datePickerMaxMin.clearText();
            datePickerMaxMin.acceptText(datePickerMaxMin.formatDate(date));
            datePickerMaxMin.clickCalendarIcon();
            expect(datePickerMaxMin.getInputValue()).toEqual(datePickerMaxMin.formatDate(date));
            //smaller dates should reset back to the minDate
            date = new Date(minDate);
            date.setDate(date.getDate() - 2);
            datePickerMaxMin.clearText();
            datePickerMaxMin.acceptText(datePickerMaxMin.formatDate(date));
            datePickerMaxMin.clickCalendarIcon();
            expect(datePickerMaxMin.getInputValue()).toEqual(datePickerMaxMin.formatDate(minDate));
        });
        it("should forbid selection of date greater than maxDate", () => {
            //smaller dates can be selected
            let date = new Date(maxDate);
            date.setDate(date.getDate() - 2);
            datePickerMaxMin.clearText();
            datePickerMaxMin.acceptText(datePickerMaxMin.formatDate(date));
            datePickerMaxMin.clickCalendarIcon();
            expect(datePickerMaxMin.getInputValue()).toEqual(datePickerMaxMin.formatDate(date));
            //larger dates should reset back to the maxDate
            date = new Date(maxDate);
            date.setDate(date.getDate() + 2);
            datePickerMaxMin.clearText();
            datePickerMaxMin.acceptText(datePickerMaxMin.formatDate(date));
            datePickerMaxMin.clickCalendarIcon();
            expect(datePickerMaxMin.getInputValue()).toEqual(datePickerMaxMin.formatDate(maxDate));
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvZGF0ZVBpY2tlci9kYXRlUGlja2VyLmUyZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHlEQUF5RDtBQUN6RCwyREFBeUU7QUFDekUsd0NBQWlDO0FBQ2pDLDhDQUE2QztBQUM3Qyx5Q0FBcUM7QUFFckMsUUFBUSxDQUFDLHdCQUF3QixFQUFFLEdBQUcsRUFBRTtJQUNwQyxJQUFJLGdCQUFnQyxDQUFDO0lBQ3JDLElBQUksZUFBK0IsQ0FBQztJQUNwQyxJQUFJLHdCQUF3QyxDQUFDO0lBQzdDLElBQUksdUJBQXVDLENBQUM7SUFDNUMsSUFBSSxzQkFBc0MsQ0FBQztJQUMzQyxJQUFJLGdCQUFnQyxDQUFDO0lBRXJDO1FBQ0ksTUFBTSxDQUFDLG9CQUFPLENBQUMsZUFBRSxDQUFDLEVBQUUsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDO0lBQy9DLENBQUM7SUFFRDtRQUNJLE1BQU0sQ0FBQyxvQkFBTyxDQUFDLGVBQUUsQ0FBQyxFQUFFLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxPQUFPLEVBQUUsQ0FBQztJQUMvQyxDQUFDO0lBRUQsVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNaLGlCQUFPLENBQUMsY0FBYyxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBQ3JDLGdCQUFnQixHQUFHLFVBQUksQ0FBQyxNQUFNLENBQUMsMkJBQWMsRUFBRSxvQkFBTyxDQUFDLGVBQUUsQ0FBQyxFQUFFLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDcEYsZUFBZSxHQUFHLFVBQUksQ0FBQyxNQUFNLENBQUMsMkJBQWMsRUFBRSxvQkFBTyxDQUFDLGVBQUUsQ0FBQyxFQUFFLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFbEYsd0JBQXdCO1lBQ3BCLFVBQUksQ0FBQyxNQUFNLENBQUMsMkJBQWMsRUFBRSxvQkFBTyxDQUFDLGVBQUUsQ0FBQyxFQUFFLENBQUMsNEJBQTRCLENBQUMsQ0FB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Z0JBQWdCLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztZQUVyQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsYUFBYSxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsZ0JBQWdCLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7WUFFcEYsK0NBQStDO1lBQy9DLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUN6QixJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQztZQUVqQyxnQkFBZ0IsQ0FBQyxTQUFTLEVBQUUsQ0FBQztZQUM3QixnQkFBZ0IsQ0FBQyxVQUFVLENBQUMsZ0JBQWdCLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7WUFDL0QsZ0JBQWdCLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztZQUVyQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsYUFBYSxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsZ0JBQWdCLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7UUFDM0YsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQztBQUNQLENBQUMsQ0FBQyxDQUFDIiwiZmlsZSI6ImNvbXBvbmVudHMvZGF0ZVBpY2tlci9kYXRlUGlja2VyLmUyZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIHByb3RyYWN0b3IgZnJvbSBcIkBzb2xhcndpbmRzL3V6aS9wcm90cmFjdG9yXCI7XG5pbXBvcnQge2Jyb3dzZXIsIGJ5LCBlbGVtZW50LCBwcm9taXNlfSBmcm9tIFwiQHNvbGFyd2luZHMvdXppL3Byb3RyYWN0b3JcIjtcbmltcG9ydCBIZWxwZXJzIGZyb20gXCIuLi9oZWxwZXJzXCI7XG5pbXBvcnQge0RhdGVQaWNrZXJBdG9tfSBmcm9tIFwiLi4vaW5kZXguYXRvbVwiO1xuaW1wb3J0IHtBdG9tfSBmcm9tIFwiQHNvbGFyd2luZHMvdXppXCI7XG5cbmRlc2NyaWJlKFwiVVNFUkNPTlRST0wgZGF0ZVBpY2tlclwiLCAoKSA9PiB7XG4gICAgbGV0IGRhdGVQaWNrZXJJbmxpbmU6IERhdGVQaWNrZXJBdG9tO1xuICAgIGxldCBkYXRlUGlja2VyUG9wVXA6IERhdGVQaWNrZXJBdG9tO1xuICAgIGxldCBkYXRlUGlja2VySW5saW5lRGlzYWJsZWQ6IERhdGVQaWNrZXJBdG9tO1xuICAgIGxldCBkYXRlUGlja2VyUG9wVXBEaXNhYmxlZDogRGF0ZVBpY2tlckF0b207XG4gICAgbGV0IGRhdGVQaWNrZXJXaXRoTmdDaGFuZ2U6IERhdGVQaWNrZXJBdG9tO1xuICAgIGxldCBkYXRlUGlja2VyTWF4TWluOiBEYXRlUGlja2VyQXRvbTtcblxuICAgIGZ1bmN0aW9uIGdldE1heERhdGUoKSB7XG4gICAgICAgIHJldHVybiBlbGVtZW50KGJ5LmlkKFwibWF4RGF0ZVwiKSkuZ2V0VGV4dCgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldE1pbkRhdGUoKSB7XG4gICAgICAgIHJldHVybiBlbGVtZW50KGJ5LmlkKFwibWluRGF0ZVwiKSkuZ2V0VGV4dCgpO1xuICAgIH1cblxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgICBIZWxwZXJzLnByZXBhcmVCcm93c2VyKFwiZGF0ZVBpY2tlclwiKTtcbiAgICAgICAgZGF0ZVBpY2tlcklubGluZSA9IEF0b20uZmluZEluKERhdGVQaWNrZXJBdG9tLCBlbGVtZW50KGJ5LmlkKFwiaW5saW5lLWRhdGVwaWNrZXJcIikpKTtcbiAgICAgICAgZGF0ZVBpY2tlclBvcFVwID0gQXRvbS5maW5kSW4oRGF0ZVBpY2tlckF0b20sIGVsZW1lbnQoYnkuaWQoXCJpbnB1dC1kYXRlcGlja2VyXCIpKSk7XG5cbiAgICAgICAgZGF0ZVBpY2tlcklubGluZURpc2FibGVkID1cbiAgICAgICAgICAgIEF0b20uZmluZEluKERhdGVQaWNrZXJBdG9tLCBlbGVtZW50KGJ5LmlkKFwiZGlzYWJsZWQtaW5saW5lLWRhdGVwaWNrZXJcIikpKTtcbiAgICAgICAgZGF0ZVBpY2tlclBvcFVwRGlzYWJsZWQgPVxuICAgICAgICAgICAgQXRvbS5maW5kSW4oRGF0ZVBpY2tlckF0b20sIGVsZW1lbnQoYnkuaWQoXCJkaXNhYmxlZC1pbnB1dC1kYXRlcGlja2VyXCIpKSk7XG5cbiAgICAgICAgZGF0ZVBpY2tlcldpdGhOZ0NoYW5nZSA9IERhdGVQaWNrZXJBdG9tLmZpbmRJbihEYXRlUGlja2VyQXRvbSwgZWxlbWVudChieS5pZChcImRhdGVwaWNrZXItd2l0aC1vbmNoYW5nZVwiKSkpO1xuXG4gICAgICAgIGRhdGVQaWNrZXJNYXhNaW4gPSBBdG9tLmZpbmRJbihEYXRlUGlja2VyQXRvbSwgZWxlbWVudChieS5pZChcImRhdGVwaWNrZXItd2l0aC1tYXhtaW5cIikpKTtcbiAgICB9KTtcblxuICAgIC8vLS0tLS0tLS0tLUlOTElORSBNT0RFIE9GIERBVEVQSUNLRVItLS0tLS0tLS0tLS0tLS1cbiAgICBkZXNjcmliZShcIndoZW4gaXQgaXMgZGlzYWJsZWRcIiwgKCkgPT4ge1xuICAgICAgICBpdChcImNsaWNraW5nIG9uIHRpdGxlIGRvZXMgbm90aGluZ1wiLCAoKSA9PiB7XG5cbiAgICAgICAgICAgIGxldCBvcmlnaW5hbFRpdGxlID0gZGF0ZVBpY2tlcklubGluZURpc2FibGVkLmdldFRpdGxlKCk7XG5cbiAgICAgICAgICAgIGRhdGVQaWNrZXJJbmxpbmVEaXNhYmxlZC5jbGlja1RpdGxlKCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGZhaWwoXCJFbGVtZW50IHNob3VsZCBub3QgYmUgY2xpY2thYmxlIGZvciBPYnNlcnZlclwiKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIChlcnIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGVyci5tZXNzYWdlLnRvU3RyaW5nKCkpLnRvTWF0Y2goXCJpcyBub3QgY2xpY2thYmxlIGF0IHBvaW50XCIpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBsZXQgbW9kaWZpZWRUaXRsZSA9IGRhdGVQaWNrZXJJbmxpbmVEaXNhYmxlZC5nZXRUaXRsZSgpO1xuICAgICAgICAgICAgZXhwZWN0KG9yaWdpbmFsVGl0bGUpLnRvRXF1YWwobW9kaWZpZWRUaXRsZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KFwiY2xpY2tpbmcgb24gbmV4dCBkb2VzIG5vdGhpbmdcIiwgKCkgPT4ge1xuXG4gICAgICAgICAgICBsZXQgb3JpZ2luYWxUaXRsZSA9IGRhdGVQaWNrZXJJbmxpbmVEaXNhYmxlZC5nZXRUaXRsZSgpO1xuXG4gICAgICAgICAgICBkYXRlUGlja2VySW5saW5lRGlzYWJsZWQuZ29OZXh0KCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGZhaWwoXCJFbGVtZW50IHNob3VsZCBub3QgYmUgY2xpY2thYmxlIGZvciBPYnNlcnZlclwiKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIChlcnIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGVyci5tZXNzYWdlLnRvU3RyaW5nKCkpLnRvTWF0Y2goXCJpcyBub3QgY2xpY2thYmxlIGF0IHBvaW50XCIpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBsZXQgbW9kaWZpZWRUaXRsZSA9IGRhdGVQaWNrZXJJbmxpbmVEaXNhYmxlZC5nZXRUaXRsZSgpO1xuICAgICAgICAgICAgZXhwZWN0KG9yaWdpbmFsVGl0bGUpLnRvRXF1YWwobW9kaWZpZWRUaXRsZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KFwiY2xpY2tpbmcgb24gYmFjayBkb2VzIG5vdGhpbmdcIiwgKCkgPT4ge1xuXG4gICAgICAgICAgICBsZXQgb3JpZ2luYWxUaXRsZSA9IGRhdGVQaWNrZXJJbmxpbmVEaXNhYmxlZC5nZXRUaXRsZSgpO1xuXG4gICAgICAgICAgICBkYXRlUGlja2VySW5saW5lRGlzYWJsZWQuZ29CYWNrKCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGZhaWwoXCJFbGVtZW50IHNob3VsZCBub3QgYmUgY2xpY2thYmxlIGZvciBPYnNlcnZlclwiKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIChlcnIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGVyci5tZXNzYWdlLnRvU3RyaW5nKCkpLnRvTWF0Y2goXCJpcyBub3QgY2xpY2thYmxlIGF0IHBvaW50XCIpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBsZXQgbW9kaWZpZWRUaXRsZSA9IGRhdGVQaWNrZXJJbmxpbmVEaXNhYmxlZC5nZXRUaXRsZSgpO1xuICAgICAgICAgICAgZXhwZWN0KG9yaWdpbmFsVGl0bGUpLnRvRXF1YWwobW9kaWZpZWRUaXRsZSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoXCJzaG91bGQgc2hvdyB5ZWFyIGluIHRpdGxlIGFuZCBtb250aHMgaW4gYm9keSB1cG9uIGNsaWNrIG9uIHRpdGxlXCIsICgpID0+IHtcbiAgICAgICAgbGV0IGN1cnJlbnRZZWFyOiBzdHJpbmcgPSBuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCkudG9TdHJpbmcoKTtcbiAgICAgICAgLy9HZXQgcmFuZG9tIG1vbnRoXG4gICAgICAgIGxldCByYW5kb21Nb250aCA9ICgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBEYXRlUGlja2VyQXRvbS5NT05USE5BTUVTX1NIT1JUW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEyKV07XG4gICAgICAgIH07XG4gICAgICAgIC8vR28gdXBwZXIgbGV2ZWwgaW4gdGl0bGVcbiAgICAgICAgZGF0ZVBpY2tlcklubGluZS5jbGlja1RpdGxlKCk7XG5cbiAgICAgICAgZXhwZWN0KGRhdGVQaWNrZXJJbmxpbmUuZ2V0VGl0bGUoKSkudG9FcXVhbChjdXJyZW50WWVhcik7XG5cbiAgICAgICAgZXhwZWN0KGRhdGVQaWNrZXJJbmxpbmUuZ2V0TW9udGhFbGVtZW50KHJhbmRvbU1vbnRoKCkpLmlzUHJlc2VudCgpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJzaG91bGQgY2hhbmdlIHRpdGxlIHVwb24gY2xpY2sgb24gbmV4dC9wcmV2aW91cyBidXR0b25zXCIsICgpID0+IHtcbiAgICAgICAgLy9kZWZpbmUgY3VycmVudCB0aXRsZSBhbmQgdGl0bGUgd2hpY2ggc2hvdWxkIGFwcGVhciB1cG9uIGNsaWNrIG9uIE5leHQgYnV0dG9uXG4gICAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBjb25zdCBjdXJyZW50TW9udGhOdW1iZXIgPSBkYXRlLmdldE1vbnRoKCk7XG4gICAgICAgIGNvbnN0IHRoaXNZZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xuICAgICAgICBjb25zdCBuZXh0WWVhciA9IGN1cnJlbnRNb250aE51bWJlciA9PT0gMTEgPyB0aGlzWWVhciArIDEgOiB0aGlzWWVhcjsgLy8gaGFjayBmb3IgRGVjZW1iZXJcblxuICAgICAgICBsZXQgY3VycmVudFRpdGxlOiBzdHJpbmcgPSBgJHtEYXRlUGlja2VyQXRvbS5NT05USE5BTUVTX0xPTkdbY3VycmVudE1vbnRoTnVtYmVyXX0gJHt0aGlzWWVhcn1gO1xuICAgICAgICBsZXQgbmV4dFRpdGxlOiBzdHJpbmcgPSBgJHtEYXRlUGlja2VyQXRvbS5NT05USE5BTUVTX0xPTkdbKGN1cnJlbnRNb250aE51bWJlciArIDEpICUgMTJdfSAke25leHRZZWFyfWA7XG5cbiAgICAgICAgLy9pbml0aWFsIHRpdGxlXG4gICAgICAgIGV4cGVjdChkYXRlUGlja2VySW5saW5lLmdldFRpdGxlKCkpLnRvRXF1YWwoY3VycmVudFRpdGxlKTtcbiAgICAgICAgLy9nbyBuZXh0XG4gICAgICAgIGRhdGVQaWNrZXJJbmxpbmUuZ29OZXh0KCk7XG4gICAgICAgIC8vdGl0bGUgYWZ0ZXIgY2xpY2sgb24gTmV4dCBidXR0b25cbiAgICAgICAgZXhwZWN0KGRhdGVQaWNrZXJJbmxpbmUuZ2V0VGl0bGUoKSkudG9FcXVhbChuZXh0VGl0bGUpO1xuICAgICAgICAvL2dvIGJhY2sgdG8gaW5pdGlhbCB0aXRsZVxuICAgICAgICBkYXRlUGlja2VySW5saW5lLmdvQmFjaygpO1xuICAgICAgICAvL2luaXRpYWwgdGl0bGVcbiAgICAgICAgZXhwZWN0KGRhdGVQaWNrZXJJbmxpbmUuZ2V0VGl0bGUoKSkudG9FcXVhbChjdXJyZW50VGl0bGUpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJzaG91bGQgc2hvdyB5ZWFycyBpbiBib2R5IHVwb24gY2xpY2sgb24gdGl0bGUgKGluIHN0YXRlIG9mIHllYXIpXCIsICgpID0+IHtcbiAgICAgICAgbGV0IG5leHRUaXRsZTogYW55ID0gZGF0ZVBpY2tlcklubGluZS5nZXROZXh0VGl0bGUoKTtcbiAgICAgICAgbGV0IGN1cnJlbnRZZWFyOiBzdHJpbmcgPSBuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCkudG9TdHJpbmcoKTtcbiAgICAgICAgZGF0ZVBpY2tlcklubGluZS5jbGlja1RpdGxlKCk7XG5cbiAgICAgICAgZXhwZWN0KGRhdGVQaWNrZXJJbmxpbmUuZ2V0VGl0bGUoKSkudG9FcXVhbChuZXh0VGl0bGUpO1xuXG4gICAgICAgIGV4cGVjdChkYXRlUGlja2VySW5saW5lLmdldFllYXJFbGVtZW50KGN1cnJlbnRZZWFyKS5pc1ByZXNlbnQoKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIC8vLS0tLS0tLS1QT1BVUCBNT0RFIE9GIERBVEVQSUNLRVItLS0tLS0tLS0tLS0tXG4gICAgaXQoXCJzaG91bGQgbm90IGJlIHBvc3NpYmxlIHRvIGNsaWNrIG9uIGljb24gd2hlbiBpdCBpcyBkaXNhYmxlZFwiLCAoKSA9PiB7XG4gICAgICAgIGV4cGVjdChkYXRlUGlja2VyUG9wVXBEaXNhYmxlZC5nZXRJbnB1dCgpLmlzRW5hYmxlZCgpKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIG9wZW4gcG9wdXAgdXBvbiBjbGljayBvbiBpY29uXCIsICgpID0+IHtcbiAgICAgICAgZGF0ZVBpY2tlclBvcFVwLmNsaWNrQ2FsZW5kYXJJY29uKCk7XG5cbiAgICAgICAgZXhwZWN0KGRhdGVQaWNrZXJQb3BVcC5nZXRQb3B1cCgpLmlzRGlzcGxheWVkKCkpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCBzaG93IGRhdGVwaWNrZXIgcG9wdXAgdXBvbiBjbGljayBvbiBpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIGRhdGVQaWNrZXJQb3BVcC5jbGlja0lucHV0KCk7XG5cbiAgICAgICAgZXhwZWN0KGRhdGVQaWNrZXJQb3BVcC5nZXRQb3B1cCgpLmlzRGlzcGxheWVkKCkpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICAvLyBUQzE6IHZlcmlmeSB0aGF0IGN1cnJlbnQgZGF0ZSBvbiBwb3B1cCBhbmQgZGF0ZSBvbiBvcGVuZWQgY2FsZW5kYXIgYXJlIHRoZSBzYW1lXG5cbiAgICBpdChcInNob3VsZCBoYXZlIHRoZSBzYW1lIGRhdGUgYm90aCBvbiBpbnB1dCBmb3JtIGFuZCBwb3BwZWQgdXAgd2luZG93IHVwb24gdGhlIGNsaWNrIG9uIGlucHV0XCIsICgpID0+IHtcbiAgICAgICAgbGV0IHN0cmluZ0RhdGU6IHN0cmluZyA9IFwiMS8xLzIwMjBcIjtcblxuICAgICAgICAvL2NoZWNrIGlmIHZhbHVlIG9uIGlucHV0IGlzIGNvcnJlY3RcbiAgICAgICAgZXhwZWN0KGRhdGVQaWNrZXJQb3BVcC5nZXRJbnB1dFZhbHVlKCkpLnRvRXF1YWwoc3RyaW5nRGF0ZSk7XG5cbiAgICAgICAgLy9jbGljayBvbiBpdFxuICAgICAgICBkYXRlUGlja2VyUG9wVXAuY2xpY2tJbnB1dCgpO1xuXG4gICAgICAgIGV4cGVjdChkYXRlUGlja2VyUG9wVXAuZ2V0VGl0bGUoKSkudG9FcXVhbChcIkphbnVhcnkgMjAyMFwiKTtcblxuICAgICAgICAvL2NoZWNrIHRoYXQgY29ycmVjdCBkYXkgaXMgc2VsZWN0ZWRcbiAgICAgICAgZXhwZWN0KGRhdGVQaWNrZXJQb3BVcC5nZXRBY3RpdmVEYXkoKSkudG9FcXVhbChcIjAxXCIpO1xuICAgIH0pO1xuXG4gICAgLy8gMlRDOiB2ZXJpZnkgdGhhdCBhbGwgYnV0dG9ucyAoZXhjZXB0IFwiQ2xvc2VcIikgd29ya2luZyBhcyBleHBlY3RlZFxuXG4gICAgaXQoXCJzaG91bGQgc2VsZWN0IGN1cnJlbnQgZGF0ZSB1cG9uIGNsaWNrIG9uICdUb2RheSdcIiwgKCkgPT4ge1xuICAgICAgICBkYXRlUGlja2VyUG9wVXAuY2xpY2tJbnB1dCgpO1xuICAgICAgICBkYXRlUGlja2VyUG9wVXAuY2xpY2tUb2RheSgpO1xuXG4gICAgICAgIGV4cGVjdChkYXRlUGlja2VyUG9wVXAuZ2V0SW5wdXRWYWx1ZSgpKS50b0VxdWFsKGRhdGVQaWNrZXJQb3BVcC5mb3JtYXREYXRlKG5ldyBEYXRlKCkpKTtcbiAgICB9KTtcblxuICAgIC8vIFRDMzogb3BlbiB0aGUgY2FsZW5kYXIgYW5kIGNob29zZSBzb21lIGRhdGUsIHZlcmlmeSB0aGF0IGRhdGUgaXMgY2hvb3NlbiBhbmQgcG9wdXAgc2hvdyBjb3JyZWN0IGRhdGVcbiAgICBpdChcInNob3VsZCBjb3JyZWN0bHkgY2hhbmdlIHRvIHRoZSBzZWxlY3RlZCBkYXRlXCIsICgpID0+IHtcbiAgICAgICAgbGV0IGRheTogbnVtYmVyID0gMjA7XG4gICAgICAgIGxldCBkYXRlOiBEYXRlID0gbmV3IERhdGUoXCIxIEphbiAyMDIwXCIpO1xuICAgICAgICBkYXRlLnNldERhdGUoZGF5KTtcblxuICAgICAgICBkYXRlUGlja2VyUG9wVXAuY2xpY2tJbnB1dCgpO1xuICAgICAgICAvL3NlbGVjdCBzb21lIGRhdGVcbiAgICAgICAgZGF0ZVBpY2tlclBvcFVwLnNlbGVjdERheShkYXkpO1xuXG4gICAgICAgIC8vY2hlY2sgdGhhdCBpbnB1dCB1cGRhdGVkIHRvIHNlbGVjdGVkIGRhdGVcbiAgICAgICAgZXhwZWN0KGRhdGVQaWNrZXJQb3BVcC5nZXRJbnB1dFZhbHVlKCkpLnRvRXF1YWwoZGF0ZVBpY2tlclBvcFVwLmZvcm1hdERhdGUoZGF0ZSkpO1xuXG4gICAgICAgIGJyb3dzZXIud2FpdCgoKSA9PiBkYXRlUGlja2VyUG9wVXAuaXNPcGVuZWQoKS50aGVuKChpc09wZW5lZCkgPT4gIWlzT3BlbmVkKSk7XG4gICAgICAgIGRhdGVQaWNrZXJQb3BVcC5jbGlja0NhbGVuZGFySWNvbigpO1xuICAgICAgICAvL2NoZWNrIHRoYXQgc2VsZWN0ZWQgZGF5IGlzIGFjdGl2ZVxuICAgICAgICBleHBlY3QoZGF0ZVBpY2tlclBvcFVwLmdldEFjdGl2ZURheSgpKS50b0VxdWFsKFwiMjBcIik7XG4gICAgfSk7XG5cbiAgICAvLyBVSUYtMTI3MSAtIHBvcHVwIHdhc24ndCBjbG9zaW5nIGFmdGVyIHNlbGVjdGluZyBkYXRlXG4gICAgaXQoXCJzaG91bGQgY2xvc2UgZGF0ZXBpY2tlciBwb3B1cCB1cG9uIGNsaWNrIG9uIGEgZGF0ZVwiLCAoKSA9PiB7XG4gICAgICAgIC8vIG9wZW4gcG9wdXAgYnkgY2xpY2tpbmcgb24gcG9wdXBcbiAgICAgICAgZGF0ZVBpY2tlclBvcFVwLmNsaWNrSW5wdXQoKTtcblxuICAgICAgICAvL2Jyb3dzZXIud2FpdCgoKT0+ZGF0ZVBpY2tlclBvcFVwLmdldFBvcHVwKCkuaXNEaXNwbGF5ZWQoKSwgMTAwMCk7XG4gICAgICAgIGV4cGVjdChkYXRlUGlja2VyUG9wVXAuZ2V0UG9wdXAoKS5pc0Rpc3BsYXllZCgpKS50b0JlKHRydWUpO1xuXG4gICAgICAgIC8vIGNsb3NlIHBvcHVwIGJ5IGNsaWNraW5nIG9uIFwiVG9kYXlcIiBidXR0b25cbiAgICAgICAgZGF0ZVBpY2tlclBvcFVwLmNsaWNrVG9kYXkoKTtcbiAgICAgICAgZXhwZWN0KGRhdGVQaWNrZXJQb3BVcC5nZXRQb3B1cCgpLmlzUHJlc2VudCgpKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcblxuICAgIC8vIFVJRi0yMTQwIC0gRGF0ZVBpY2tlcjogc3VwcG9ydCB0ZXh0IGlucHV0XG4gICAgZGVzY3JpYmUoXCJzaG91bGQgYmUgdmFsaWRhdGUgdGhlIHRleHQgaW5wdXRzIGFjY29yZGluZ2x5LCBzdWNoIFwiLCAoKSA9PiB7XG5cbiAgICAgICAgbGV0IHdyb25nRGF0ZXM6IHN0cmluZ1tdID0gW1xuICAgICAgICAgICAgXCJhYmNkZWZnXCIsXG4gICAgICAgICAgICBcIjExMjIzM1wiXG4gICAgICAgIF07XG5cbiAgICAgICAgZm9yIChsZXQgZGF0ZSBvZiBEYXRlUGlja2VyQXRvbS5BQ0NFUFRFRF9EQVRFUykge1xuICAgICAgICAgICAgdGVzdERhdGVGb3JtYXQoZGF0ZSwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChsZXQgZGF0ZSBvZiB3cm9uZ0RhdGVzKSB7XG4gICAgICAgICAgICB0ZXN0RGF0ZUZvcm1hdChkYXRlLCBmYWxzZSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB0ZXN0RGF0ZUZvcm1hdChkYXRlOiBzdHJpbmcsIGFjY2VwdGFibGU6IGJvb2xlYW4pIHtcbiAgICAgICAgICAgIGxldCB2YWxpZGl0eSA9IGFjY2VwdGFibGUgPyBcInZhbGlkXCIgOiBcImludmFsaWRcIjtcbiAgICAgICAgICAgIGl0KGRhdGUgKyBcIiBhcyBcIiArIHZhbGlkaXR5LCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgZGF0ZVBpY2tlclBvcFVwLmNsZWFyVGV4dCgpO1xuICAgICAgICAgICAgICAgIGRhdGVQaWNrZXJQb3BVcC5hY2NlcHRUZXh0KGRhdGUpO1xuICAgICAgICAgICAgICAgIGV4cGVjdChkYXRlUGlja2VyUG9wVXAuaXNWYWxpZCgpKS50b0JlKGFjY2VwdGFibGUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgIH0pO1xuXG4gICAgaXQoXCJjYWxscyBvbkNoYW5nZSB3aGVuIG5ldyB2YWx1ZSBpcyBzZWxlY3RlZFwiLCAoKSA9PiB7XG4gICAgICAgIGRhdGVQaWNrZXJXaXRoTmdDaGFuZ2UuY2xpY2tJbnB1dCgpO1xuICAgICAgICBkYXRlUGlja2VyV2l0aE5nQ2hhbmdlLmNsaWNrVG9kYXkoKTtcbiAgICAgICAgY29uc3QgdmVyaWZpY2F0aW9uSW5wdXQgPSBlbGVtZW50KGJ5LmlkKFwib25DaGFuZ2VDYWxsZWRcIikpO1xuICAgICAgICBleHBlY3QodmVyaWZpY2F0aW9uSW5wdXQuZ2V0QXR0cmlidXRlKFwidmFsdWVcIikpLnRvQmUoXCJ0cnVlXCIpO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoXCJ3aGVuIG1heERhdGUsIG1pbkRhdGUgaXMgc2V0XCIsICgpID0+IHtcbiAgICAgICAgbGV0IG1pbkRhdGU6IERhdGU7XG4gICAgICAgIGxldCBtYXhEYXRlOiBEYXRlO1xuXG4gICAgICAgIGJlZm9yZUVhY2goIChkb25lOiBEb25lRm4pID0+IHtcbiAgICAgICAgICAgIHByb3RyYWN0b3IucHJvbWlzZVxuICAgICAgICAgICAgICAgLmFsbChbZ2V0TWluRGF0ZSgpLCBnZXRNYXhEYXRlKCldKVxuICAgICAgICAgICAgICAgLnRoZW4oKHZhbHVlczpzdHJpbmdbXSkgPT4ge1xuICAgICAgICAgICAgICAgICAgIG1pbkRhdGUgPSBuZXcgRGF0ZSh2YWx1ZXNbMF0uc2xpY2UoMSwtMSkpO1xuICAgICAgICAgICAgICAgICAgIG1heERhdGUgPSBuZXcgRGF0ZSh2YWx1ZXNbMV0uc2xpY2UoMSwtMSkpO1xuICAgICAgICAgICAgICAgICAgIGRvbmUoKTtcbiAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KFwic2hvdWxkIGZvcmJpZCBzZWxlY3Rpb24gb2YgZGF0ZSBsZXNzIHRoYW4gbWluRGF0ZVwiLCAoKSA9PiB7XG4gICAgICAgICAgICAvL2xhcmdlciBkYXRlcyBjYW4gYmUgc2VsZWN0ZWRcbiAgICAgICAgICAgIGxldCBkYXRlOiBEYXRlID0gbmV3IERhdGUobWluRGF0ZSk7XG4gICAgICAgICAgICBkYXRlLnNldERhdGUoZGF0ZS5nZXREYXRlKCkgKyAyKTtcblxuICAgICAgICAgICAgZGF0ZVBpY2tlck1heE1pbi5jbGVhclRleHQoKTtcbiAgICAgICAgICAgIGRhdGVQaWNrZXJNYXhNaW4uYWNjZXB0VGV4dChkYXRlUGlja2VyTWF4TWluLmZvcm1hdERhdGUoZGF0ZSkpO1xuICAgICAgICAgICAgZGF0ZVBpY2tlck1heE1pbi5jbGlja0NhbGVuZGFySWNvbigpO1xuXG4gICAgICAgICAgICBleHBlY3QoZGF0ZVBpY2tlck1heE1pbi5nZXRJbnB1dFZhbHVlKCkpLnRvRXF1YWwoZGF0ZVBpY2tlck1heE1pbi5mb3JtYXREYXRlKGRhdGUpKTtcblxuICAgICAgICAgICAgLy9zbWFsbGVyIGRhdGVzIHNob3VsZCByZXNldCBiYWNrIHRvIHRoZSBtaW5EYXRlXG4gICAgICAgICAgICBkYXRlID0gbmV3IERhdGUobWluRGF0ZSk7XG4gICAgICAgICAgICBkYXRlLnNldERhdGUoZGF0ZS5nZXREYXRlKCkgLSAyKTtcblxuICAgICAgICAgICAgZGF0ZVBpY2tlck1heE1pbi5jbGVhclRleHQoKTtcbiAgICAgICAgICAgIGRhdGVQaWNrZXJNYXhNaW4uYWNjZXB0VGV4dChkYXRlUGlja2VyTWF4TWluLmZvcm1hdERhdGUoZGF0ZSkpO1xuICAgICAgICAgICAgZGF0ZVBpY2tlck1heE1pbi5jbGlja0NhbGVuZGFySWNvbigpO1xuXG4gICAgICAgICAgICBleHBlY3QoZGF0ZVBpY2tlck1heE1pbi5nZXRJbnB1dFZhbHVlKCkpLnRvRXF1YWwoZGF0ZVBpY2tlck1heE1pbi5mb3JtYXREYXRlKG1pbkRhdGUpKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoXCJzaG91bGQgZm9yYmlkIHNlbGVjdGlvbiBvZiBkYXRlIGdyZWF0ZXIgdGhhbiBtYXhEYXRlXCIsICgpID0+IHtcbiAgICAgICAgICAgIC8vc21hbGxlciBkYXRlcyBjYW4gYmUgc2VsZWN0ZWRcbiAgICAgICAgICAgIGxldCBkYXRlOiBEYXRlID0gbmV3IERhdGUobWF4RGF0ZSk7XG4gICAgICAgICAgICBkYXRlLnNldERhdGUoZGF0ZS5nZXREYXRlKCkgLSAyKTtcblxuICAgICAgICAgICAgZGF0ZVBpY2tlck1heE1pbi5jbGVhclRleHQoKTtcbiAgICAgICAgICAgIGRhdGVQaWNrZXJNYXhNaW4uYWNjZXB0VGV4dChkYXRlUGlja2VyTWF4TWluLmZvcm1hdERhdGUoZGF0ZSkpO1xuICAgICAgICAgICAgZGF0ZVBpY2tlck1heE1pbi5jbGlja0NhbGVuZGFySWNvbigpO1xuXG4gICAgICAgICAgICBleHBlY3QoZGF0ZVBpY2tlck1heE1pbi5nZXRJbnB1dFZhbHVlKCkpLnRvRXF1YWwoZGF0ZVBpY2tlck1heE1pbi5mb3JtYXREYXRlKGRhdGUpKTtcblxuICAgICAgICAgICAgLy9sYXJnZXIgZGF0ZXMgc2hvdWxkIHJlc2V0IGJhY2sgdG8gdGhlIG1heERhdGVcbiAgICAgICAgICAgIGRhdGUgPSBuZXcgRGF0ZShtYXhEYXRlKTtcbiAgICAgICAgICAgIGRhdGUuc2V0RGF0ZShkYXRlLmdldERhdGUoKSArIDIpO1xuXG4gICAgICAgICAgICBkYXRlUGlja2VyTWF4TWluLmNsZWFyVGV4dCgpO1xuICAgICAgICAgICAgZGF0ZVBpY2tlck1heE1pbi5hY2NlcHRUZXh0KGRhdGVQaWNrZXJNYXhNaW4uZm9ybWF0RGF0ZShkYXRlKSk7XG4gICAgICAgICAgICBkYXRlUGlja2VyTWF4TWluLmNsaWNrQ2FsZW5kYXJJY29uKCk7XG5cbiAgICAgICAgICAgIGV4cGVjdChkYXRlUGlja2VyTWF4TWluLmdldElucHV0VmFsdWUoKSkudG9FcXVhbChkYXRlUGlja2VyTWF4TWluLmZvcm1hdERhdGUobWF4RGF0ZSkpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn0pO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
