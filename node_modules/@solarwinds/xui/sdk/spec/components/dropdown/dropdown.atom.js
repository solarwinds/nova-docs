"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const protractor = require("@solarwinds/uzi/protractor");
const protractor_1 = require("@solarwinds/uzi/protractor");
const uzi_1 = require("@solarwinds/uzi");
const index_atom_1 = require("../index.atom");
class DropdownAtom extends uzi_1.Atom {
    constructor() {
        super(...arguments);
        this.click = () => {
            return this.getToggleElement().click();
        };
        /**
         * Toggle dropdown and select a new item from the options.
         */
        this.select = (title) => {
            // Have to click (toggle the list) first because
            // you can't interact with hidden elements.
            this.click();
            return this.getItemByText(title).click();
        };
        this.scrollToAndSelect = (itemText) => {
            return this.scrollToItem(itemText).then((item) => {
                return item.click();
            });
        };
        this.scrollToItem = (itemText) => {
            this.click();
            const itemEl = this.getItemByText(itemText);
            const scrollbar = uzi_1.Atom.findIn(index_atom_1.ScrollbarAtom, super.getElement());
            return scrollbar.scrollToElement(itemEl).then(() => {
                return itemEl;
            });
        };
        this.getItemByText = (itemText) => {
            // Using xpath, because I need a specific item inside of collection, and
            // css doesn't have text selector
            const xpath = ".//div/ul/li/div/ng-include/div[text()='" + itemText + "']";
            return super.getElement().element(protractor_1.by.xpath(xpath));
        };
        this.getNumberOfItems = () => {
            return this.getItems().count();
        };
        /**
         * @returns {string} The value displayed in dropdown.
         */
        this.getCurrentValue = () => {
            return this.getMainTitleElement().getText();
        };
        this.getPlaceholder = () => {
            return super.getElement()
                .element(protractor_1.by.className("xui-dropdown__placeholder"))
                .getText();
        };
        this.getLabelElement = () => {
            return super.getElement().element(protractor_1.by.className("xui-dropdown__label"));
        };
        this.getGroupElement = () => {
            return super.getElement().element(protractor_1.by.className("xui-dropdown__btn-group"));
        };
        this.getItems = () => {
            return super.getElement().all(protractor_1.by.className("xui-dropdown__menuitem"));
        };
        this.getItemsWithClass = (className) => {
            return super.getElement().all(protractor_1.by.css(".xui-dropdown__menuitem." + className));
        };
        this.getItemsWithNestedClass = (className) => {
            return super.getElement().all(protractor_1.by.css(".xui-dropdown__menuitem ." + className));
        };
        this.isValidationTextDisplayed = () => {
            return super.getElement()
                .element(protractor_1.by.css(".xui-dropdown__messages"))
                .isDisplayed();
        };
        this.isRequiredStyleDisplayed = () => {
            return this.getToggleElement()
                .getAttribute("class")
                .then((classes) => {
                const index = classes.indexOf("xui-dropdown__invalid");
                return index >= 0;
            });
        };
        this.areSuggestionsDisplayed = () => {
            return this.getSuggestionsDropdown().isDisplayed();
        };
        this.acceptInput = (input) => {
            return super.getElement().element(protractor_1.by.tagName("input")).sendKeys(input);
        };
        this.getSuggestions = () => {
            return this.getSuggestionsDropdown().all(protractor_1.by.css("li"));
        };
        this.getSuggestion = (index) => {
            return this.getSuggestionsDropdown().all(protractor_1.by.css("li")).get(index);
        };
        this.getSuggestionLink = (index) => {
            return this.getSuggestionLinks().get(index);
        };
        this.getSuggestionLinks = () => {
            return this.getSuggestionsDropdown().all(protractor_1.by.css("li a"));
        };
        this.getValueAttr = () => {
            return super.getElement().element(protractor_1.by.tagName("input")).getAttribute("value");
        };
        this.areItemsDisplayed = () => {
            return this.getItemsDropdown().isDisplayed();
        };
        this.getDividers = () => {
            return super.getElement().all(protractor_1.by.className("divider"));
        };
        // private helpers
        this.getToggleElement = () => {
            return super.getElement().element(protractor_1.by.className("xui-dropdown__toggle"));
        };
        this.getMainTitleElement = () => {
            return super.getElement().element(protractor_1.by.className("xui-dropdown__display-value"));
        };
        this.getItemsDropdown = () => {
            return super.getElement().element(protractor_1.by.css("ul.xui-dropdown__menu"));
        };
        this.getSuggestionsDropdown = () => {
            return super.getElement().element(protractor_1.by.css("input + ul.dropdown-menu"));
        };
    }
    getItemText(idx) {
        const item = this.getItems().get(idx);
        const textElement = item.element(protractor_1.by.xpath(".//div/ng-include/div"));
        return textElement.getAttribute("innerText");
    }
    ;
    getInput() {
        return super.getElement().element(protractor_1.by.className("xui-dropdown__input"));
    }
    acceptText(text) {
        return this.clearText().then(() => {
            return this.getInput().sendKeys(text, protractor.Key.ENTER);
        });
    }
    getInputValue() {
        return this.getInput().getAttribute("value");
    }
    clearText() {
        return this.getInput().clear();
    }
    isValid() {
        return this.getElement().getAttribute("class").then((result) => {
            return result.split(/ +/).indexOf("ng-invalid") === -1;
        });
    }
}
DropdownAtom.CSS_CLASS = "xui-dropdown";
exports.DropdownAtom = DropdownAtom;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvZHJvcGRvd24vZHJvcGRvd24uYXRvbS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHlEQUF5RDtBQUN6RCwyREFBbUc7QUFDbkcseUNBQXFDO0FBQ3JDLDhDQUE0QztBQUU1QyxrQkFBMEIsU0FBUSxVQUFJO0lBQXRDOztRQUdXLFVBQUssR0FBRyxHQUEwQixFQUFFO1lBQ3ZDLE1BQU0sQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUMzQyxDQUFDLENBQUM7UUFFRjs7V0FFRztRQUNJLFdBQU0sR0FBRyxDQUFDLEtBQWEsRUFBeUIsRUFBRTtZQUNyRCxnREFBZ0Q7WUFDaEQsMkNBQTJDO1lBQzNDLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztZQUNiLE1BQU0sQ0FBTyxJQUFJLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBRSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ3BELENBQUMsQ0FBQztRQUVLLHNCQUFpQixHQUFHLENBQUMsUUFBZ0IsRUFBeUIsRUFBRTtZQUNuRSxNQUFNLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFtQixFQUFFLEVBQUU7Z0JBQzVELE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7WUFDeEIsQ0FBQyxDQUFDLENBQUM7UUFDUCxDQUFDLENBQUM7UUFFSyxpQkFBWSxHQUFHLENBQUMsUUFBZ0IsRUFBa0MsRUFBRTtZQUN2RSxJQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7WUFDYixNQUFNLE1BQU0sR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBQzVDLE1BQU0sU0FBUyxHQUFHLFVBQUksQ0FBQyxNQUFNLENBQUMsMEJBQWEsRUFBRSxLQUFLLENBQUMsVUFBVSxFQUFFLENBQUMsQ0FBQztZQUNqRSxNQUFNLENBQUMsU0FBUyxDQUFDLGVBQWUsQ0FBQyxNQUFN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LElBQUksQ0FBQyxDQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztRQUMzRCxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7O0FBdEhhLHNCQUFTLEdBQUcsY0FBYyxDQUFDO0FBRDdDLG9DQTZLQyIsImZpbGUiOiJjb21wb25lbnRzL2Ryb3Bkb3duL2Ryb3Bkb3duLmF0b20uanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBwcm90cmFjdG9yIGZyb20gXCJAc29sYXJ3aW5kcy91emkvcHJvdHJhY3RvclwiO1xuaW1wb3J0IHtieSwgZWxlbWVudCwgRWxlbWVudEFycmF5RmluZGVyLCBFbGVtZW50RmluZGVyLCBwcm9taXNlfSBmcm9tIFwiQHNvbGFyd2luZHMvdXppL3Byb3RyYWN0b3JcIjtcbmltcG9ydCB7QXRvbX0gZnJvbSBcIkBzb2xhcndpbmRzL3V6aVwiO1xuaW1wb3J0IHtTY3JvbGxiYXJBdG9tfSBmcm9tIFwiLi4vaW5kZXguYXRvbVwiO1xuXG5leHBvcnQgY2xhc3MgRHJvcGRvd25BdG9tIGV4dGVuZHMgQXRvbSB7XG4gICAgcHVibGljIHN0YXRpYyBDU1NfQ0xBU1MgPSBcInh1aS1kcm9wZG93blwiO1xuXG4gICAgcHVibGljIGNsaWNrID0gKCk6IHByb21pc2UuUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFRvZ2dsZUVsZW1lbnQoKS5jbGljaygpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBUb2dnbGUgZHJvcGRvd24gYW5kIHNlbGVjdCBhIG5ldyBpdGVtIGZyb20gdGhlIG9wdGlvbnMuXG4gICAgICovXG4gICAgcHVibGljIHNlbGVjdCA9ICh0aXRsZTogc3RyaW5nKTogcHJvbWlzZS5Qcm9taXNlPHZvaWQ+ID0+IHtcbiAgICAgICAgLy8gSGF2ZSB0byBjbGljayAodG9nZ2xlIHRoZSBsaXN0KSBmaXJzdCBiZWNhdXNlXG4gICAgICAgIC8vIHlvdSBjYW4ndCBpbnRlcmFjdCB3aXRoIGhpZGRlbiBlbGVtZW50cy5cbiAgICAgICAgdGhpcy5jbGljaygpO1xuICAgICAgICByZXR1cm4gKDxhbnk+dGhpcy5nZXRJdGVtQnlUZXh0KHRpdGxlKSkuY2xpY2soKTtcbiAgICB9O1xuXG4gICAgcHVibGljIHNjcm9sbFRvQW5kU2VsZWN0ID0gKGl0ZW1UZXh0OiBzdHJpbmcpOiBwcm9taXNlLlByb21pc2U8dm9pZD4gPT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5zY3JvbGxUb0l0ZW0oaXRlbVRleHQpLnRoZW4oKGl0ZW06IEVsZW1lbnRGaW5kZXIpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBpdGVtLmNsaWNrKCk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBwdWJsaWMgc2Nyb2xsVG9JdGVtID0gKGl0ZW1UZXh0OiBzdHJpbmcpOiBwcm9taXNlLlByb21pc2U8RWxlbWVudEZpbmRlcj4gPT4ge1xuICAgICAgICB0aGlzLmNsaWNrKCk7XG4gICAgICAgIGNvbnN0IGl0ZW1FbCA9IHRoaXMuZ2V0SXRlbUJ5VGV4dChpdGVtVGV4dCk7XG4gICAgICAgIGNvbnN0IHNjcm9sbGJhciA9IEF0b20uZmluZEluKFNjcm9sbGJhckF0b20sIHN1cGVyLmdldEVsZW1lbnQoKSk7XG4gICAgICAgIHJldHVybiBzY3JvbGxiYXIuc2Nyb2xsVG9FbGVtZW50KGl0ZW1FbCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gaXRlbUVsO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcHVibGljIGdldEl0ZW1CeVRleHQgPSAoaXRlbVRleHQ6IHN0cmluZyk6IEVsZW1lbnRGaW5kZXIgPT4ge1xuICAgICAgICAvLyBVc2luZyB4cGF0aCwgYmVjYXVzZSBJIG5lZWQgYSBzcGVjaWZpYyBpdGVtIGluc2lkZSBvZiBjb2xsZWN0aW9uLCBhbmRcbiAgICAgICAgLy8gY3NzIGRvZXNuJ3QgaGF2ZSB0ZXh0IHNlbGVjdG9yXG4gICAgICAgIGNvbnN0IHhwYXRoID0gXCIuLy9kaXYvdWwvbGkvZGl2L25nLWluY2x1ZGUvZGl2W3RleHQoKT0nXCIgKyBpdGVtVGV4dCArIFwiJ11cIjtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldEVsZW1lbnQoKS5lbGVtZW50KGJ5LnhwYXRoKHhwYXRoKSk7XG4gICAgfTtcblxuICAgIHB1YmxpYyBnZXROdW1iZXJPZkl0ZW1zID0gKCk6IHByb21pc2UuUHJvbWlzZTxudW1iZXI+ID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0SXRlbXMoKS5jb3VudCgpO1xuICAgIH07XG5cbiAgICBwdWJsaWMgZ2V0SXRlbVRleHQoaWR4OiBudW1iZXIpOiBwcm9taXNlLlByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIGNvbnN0IGl0ZW0gPSB0aGlzLmdldEl0ZW1zKCkuZ2V0KGlkeCk7XG4gICAgICAgIGNvbnN0IHRleHRFbGVtZW50ID0gaXRlbS5lbGVtZW50KGJ5LnhwYXRoKFwiLi8vZGl2L25nLWluY2x1ZGUvZGl2XCIpKTtcbiAgICAgICAgcmV0dXJuIHRleHRFbGVtZW50LmdldEF0dHJpYnV0ZShcImlubmVyVGV4dFwiKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQHJldHVybnMge3N0cmluZ30gVGhlIHZhbHVlIGRpc3BsYXllZCBpbiBkcm9wZG93bi5cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0Q3VycmVudFZhbHVlID0gKCk6IHByb21pc2UuUHJvbWlzZTxzdHJpbmc+ID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TWFpblRpdGxlRWxlbWVudCgpLmdldFRleHQoKTtcbiAgICB9O1xuXG4gICAgcHVibGljIGdldFBsYWNlaG9sZGVyID0gKCk6IHByb21pc2UuUHJvbWlzZTxzdHJpbmc+ID0+IHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldEVsZW1lbnQoKVxuICAgICAgICAgICAgLmVsZW1lbnQoYnkuY2xhc3NOYW1lKFwieHVpLWRyb3Bkb3duX19wbGFjZWhvbGRlclwiKSlcbiAgICAgICAgICAgIC5nZXRUZXh0KCk7XG4gICAgfTtcblxuICAgIHB1YmxpYyBnZXRMYWJlbEVsZW1lbnQgPSAoKTogRWxlbWVudEZpbmRlciA9PiB7XG4gICAgICAgIHJldHVybiBzdXBlci5nZXRFbGVtZW50KCkuZWxlbWVudChieS5jbGFzc05hbWUoXCJ4dWktZHJvcGRvd25fX2xhYmVsXCIpKTtcbiAgICB9O1xuXG4gICAgcHVibGljIGdldEdyb3VwRWxlbWVudCA9ICgpOiBFbGVtZW50RmluZGVyID0+IHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldEVsZW1lbnQoKS5lbGVtZW50KGJ5LmNsYXNzTmFtZShcInh1aS1kcm9wZG93bl9fYnRuLWdyb3VwXCIpKTtcbiAgICB9O1xuXG4gICAgcHVibGljIGdldEl0ZW1zID0gKCk6IEVsZW1lbnRBcnJheUZpbmRlciA9PiB7XG4gICAgICAgIHJldHVybiBzdXBlci5nZXRFbGVtZW50KCkuYWxsKGJ5LmNsYXNzTmFtZShcInh1aS1kcm9wZG93bl9fbWVudWl0ZW1cIikpO1xuICAgIH07XG5cbiAgICBwdWJsaWMgZ2V0SXRlbXNXaXRoQ2xhc3MgPSAoY2xhc3NOYW1lOiBzdHJpbmcpOiBFbGVtZW50QXJyYXlGaW5kZXIgPT4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0RWxlbWVudCgpLmFsbChieS5jc3MoXCIueHVpLWRyb3Bkb3duX19tZW51aXRlbS5cIiArIGNsYXNzTmFtZSkpO1xuICAgIH07XG5cbiAgICBwdWJsaWMgZ2V0SXRlbXNXaXRoTmVzdGVkQ2xhc3MgPSAoY2xhc3NOYW1lOiBzdHJpbmcpOiBFbGVtZW50QXJyYXlGaW5kZXIgPT4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0RWxlbWVudCgpLmFsbChieS5jc3MoXCIueHVpLWRyb3Bkb3duX19tZW51aXRlbSAuXCIgKyBjbGFzc05hbWUpKTtcbiAgICB9O1xuXG4gICAgcHVibGljIGlzVmFsaWRhdGlvblRleHREaXNwbGF5ZWQgPSAoKTogcHJvbWlzZS5Qcm9taXNlPGJvb2xlYW4+ID0+IHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldEVsZW1lbnQoKVxuICAgICAgICAgICAgLmVsZW1lbnQoYnkuY3NzKFwiLnh1aS1kcm9wZG93bl9fbWVzc2FnZXNcIikpXG4gICAgICAgICAgICAuaXNEaXNwbGF5ZWQoKTtcbiAgICB9O1xuXG4gICAgcHVibGljIGlzUmVxdWlyZWRTdHlsZURpc3BsYXllZCA9ICgpOiBwcm9taXNlLlByb21pc2U8Ym9vbGVhbj4gPT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRUb2dnbGVFbGVtZW50KClcbiAgICAgICAgICAgIC5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKVxuICAgICAgICAgICAgLnRoZW4oKGNsYXNzZXM6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gY2xhc3Nlcy5pbmRleE9mKFwieHVpLWRyb3Bkb3duX19pbnZhbGlkXCIpO1xuICAgICAgICAgICAgICAgIHJldHVybiBpbmRleCA+PSAwO1xuICAgICAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHB1YmxpYyBnZXRJbnB1dCgpOiBFbGVtZW50RmluZGVyIHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldEVsZW1lbnQoKS5lbGVtZW50KGJ5LmNsYXNzTmFtZShcInh1aS1kcm9wZG93bl9faW5wdXRcIikpO1xuICAgIH1cblxuICAgIHB1YmxpYyBhY2NlcHRUZXh0KHRleHQ6IHN0cmluZyk6IHByb21pc2UuUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHJldHVybiB0aGlzLmNsZWFyVGV4dCgpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0SW5wdXQoKS5zZW5kS2V5cyh0ZXh0LCBwcm90cmFjdG9yLktleS5FTlRFUik7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRJbnB1dFZhbHVlKCk6IHByb21pc2UuUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0SW5wdXQoKS5nZXRBdHRyaWJ1dGUoXCJ2YWx1ZVwiKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgY2xlYXJUZXh0KCk6IHByb21pc2UuUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldElucHV0KCkuY2xlYXIoKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgaXNWYWxpZCgpOiBwcm9taXNlLlByb21pc2U8Ym9vbGVhbj4ge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRFbGVtZW50KCkuZ2V0QXR0cmlidXRlKFwiY2xhc3NcIikudGhlbigocmVzdWx0KT0+IHtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQuc3BsaXQoLyArLykuaW5kZXhPZihcIm5nLWludmFsaWRcIikgPT09IC0xO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYXJlU3VnZ2VzdGlvbnNEaXNwbGF5ZWQgPSAoKTogcHJvbWlzZS5Qcm9taXNlPGJvb2xlYW4+ID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U3VnZ2VzdGlvbnNEcm9wZG93bigpLmlzRGlzcGxheWVkKCk7XG4gICAgfTtcblxuICAgIHB1YmxpYyBhY2NlcHRJbnB1dCA9IChpbnB1dDogc3RyaW5nKSA9PiB7XG4gICAgICAgIHJldHVybiBzdXBlci5nZXRFbGVtZW50KCkuZWxlbWVudChieS50YWdOYW1lKFwiaW5wdXRcIikpLnNlbmRLZXlzKGlucHV0KTtcbiAgICB9O1xuXG4gICAgcHVibGljIGdldFN1Z2dlc3Rpb25zID0gKCk6IEVsZW1lbnRBcnJheUZpbmRlciA9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFN1Z2dlc3Rpb25zRHJvcGRvd24oKS5hbGwoYnkuY3NzKFwibGlcIikpO1xuICAgIH07XG5cbiAgICBwdWJsaWMgZ2V0U3VnZ2VzdGlvbiA9IChpbmRleDogbnVtYmVyKTogRWxlbWVudEZpbmRlciA9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFN1Z2dlc3Rpb25zRHJvcGRvd24oKS5hbGwoYnkuY3NzKFwibGlcIikpLmdldChpbmRleCk7XG4gICAgfTtcblxuICAgIHB1YmxpYyBnZXRTdWdnZXN0aW9uTGluayA9IChpbmRleDogbnVtYmVyKTogRWxlbWVudEZpbmRlciA9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFN1Z2dlc3Rpb25MaW5rcygpLmdldChpbmRleCk7XG4gICAgfTtcblxuICAgIHB1YmxpYyBnZXRTdWdnZXN0aW9uTGlua3MgPSAoKTogRWxlbWVudEFycmF5RmluZGVyID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U3VnZ2VzdGlvbnNEcm9wZG93bigpLmFsbChieS5jc3MoXCJsaSBhXCIpKTtcbiAgICB9O1xuXG4gICAgcHVibGljIGdldFZhbHVlQXR0ciA9ICgpOiBwcm9taXNlLlByb21pc2U8c3RyaW5nPiA9PiB7XG4gICAgICAgIHJldHVybiBzdXBlci5nZXRFbGVtZW50KCkuZWxlbWVudChieS50YWdOYW1lKFwiaW5wdXRcIikpLmdldEF0dHJpYnV0ZShcInZhbHVlXCIpO1xuICAgIH07XG5cbiAgICBwdWJsaWMgYXJlSXRlbXNEaXNwbGF5ZWQgPSAoKTogcHJvbWlzZS5Qcm9taXNlPGJvb2xlYW4+ID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0SXRlbXNEcm9wZG93bigpLmlzRGlzcGxheWVkKCk7XG4gICAgfTtcblxuICAgIHB1YmxpYyBnZXREaXZpZGVycyA9ICgpOiBFbGVtZW50QXJyYXlGaW5kZXIgPT4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0RWxlbWVudCgpLmFsbChieS5jbGFzc05hbWUoXCJkaXZpZGVyXCIpKTtcbiAgICB9O1xuXG4gICAgLy8gcHJpdmF0ZSBoZWxwZXJzXG4gICAgcHJpdmF0ZSBnZXRUb2dnbGVFbGVtZW50ID0gKCk6IEVsZW1lbnRGaW5kZXIgPT4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0RWxlbWVudCgpLmVsZW1lbnQoYnkuY2xhc3NOYW1lKFwieHVpLWRyb3Bkb3duX190b2dnbGVcIikpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGdldE1haW5UaXRsZUVsZW1lbnQgPSAoKTogRWxlbWVudEZpbmRlciA9PiB7XG4gICAgICAgIHJldHVybiBzdXBlci5nZXRFbGVtZW50KCkuZWxlbWVudChieS5jbGFzc05hbWUoXCJ4dWktZHJvcGRvd25fX2Rpc3BsYXktdmFsdWVcIikpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGdldEl0ZW1zRHJvcGRvd24gPSAoKTogRWxlbWVudEZpbmRlciA9PiB7XG4gICAgICAgIHJldHVybiBzdXBlci5nZXRFbGVtZW50KCkuZWxlbWVudChieS5jc3MoXCJ1bC54dWktZHJvcGRvd25fX21lbnVcIikpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGdldFN1Z2dlc3Rpb25zRHJvcGRvd24gPSAoKTogRWxlbWVudEZpbmRlciA9PiB7XG4gICAgICAgIHJldHVybiBzdXBlci5nZXRFbGVtZW50KCkuZWxlbWVudChieS5jc3MoXCJpbnB1dCArIHVsLmRyb3Bkb3duLW1lbnVcIikpO1xuICAgIH07XG59XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
