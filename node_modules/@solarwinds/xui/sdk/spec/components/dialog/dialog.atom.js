"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const protractor_1 = require("@solarwinds/uzi/protractor");
const uzi_1 = require("@solarwinds/uzi");
const index_atom_1 = require("../index.atom");
class DialogAtom extends uzi_1.Atom {
    constructor() {
        super(...arguments);
        this.getHeader = () => {
            return super.getElement().element(protractor_1.by.className("modal-header"));
        };
        this.getHeaderClose = () => {
            return super.getElement().element(protractor_1.by.className("xui-icon-close"));
        };
        this.getTitle = () => {
            return super.getElement().element(protractor_1.by.className("modal-title")).getText();
        };
        this.isWarningStatusIconPresent = () => {
            return super.getElement()
                .element(protractor_1.by.className("xui-icon-status_warning"))
                .isPresent();
        };
        this.isErrorStatusIconPresent = () => {
            return super.getElement()
                .element(protractor_1.by.className("xui-icon-status_critical"))
                .isPresent();
        };
        this.isStatusIconPresent = () => {
            return this.isWarningStatusIconPresent().then((isWarningIconPresent) => {
                return isWarningIconPresent ? true : this.isErrorStatusIconPresent();
            });
        };
        this.getBody = () => {
            return super.getElement().element(protractor_1.by.className("modal-body"));
        };
        this.getMessage = () => {
            return this.getBody()
                .all(protractor_1.by.tagName("p"))
                .get(0)
                .getText();
        };
        this.getTranscludedContent = () => {
            return this.getBody().all(protractor_1.by.css("[ng-transclude]")).get(0);
        };
        this.getContent = (id) => {
            return this.getTranscludedContent().element(protractor_1.by.id(id));
        };
        this.getFooterButtons = () => {
            return super.getElement()
                .element(protractor_1.by.className("modal-footer"))
                .all(protractor_1.by.className("xui-button"));
        };
        this.getFooter = () => {
            return super.getElement()
                .element(protractor_1.by.className("modal-footer"));
        };
        this.getVisibleFooterButtons = () => {
            return this.getFooterButtons().filter((button) => {
                return button.isDisplayed();
            });
        };
        this.getVisibleFooterButton = (buttonText) => {
            return this.getVisibleFooterButtons().filter((button) => {
                return button.getText().then((text) => {
                    return buttonText.toLowerCase() === text.toLowerCase();
                });
            }).first();
        };
        this.footerButtonCount = () => {
            return this.getVisibleFooterButtons().count();
        };
        this.clickFooterButton = (buttonText) => {
            const button = this.getVisibleFooterButton(buttonText);
            if (button) {
                return button.click();
            }
        };
        this.isBusyOverlayDisplayed = () => {
            return uzi_1.Atom.findIn(index_atom_1.ProgressAtom, undefined, 0).isDisplayed();
        };
        this.cancelBusy = () => {
            return uzi_1.Atom.findIn(index_atom_1.ProgressAtom, undefined, 0).cancelProgress();
        };
        this.isBusyOverlayHidden = () => {
            return uzi_1.Atom.findIn(index_atom_1.ProgressAtom, undefined, 0)
                .isDisplayed()
                .then((isDisplayed) => {
                return !isDisplayed;
            });
        };
        this.isFooterBtnHasClass = (buttonIndex, className) => {
            return this.getVisibleFooterButtons().get(buttonIndex).getAttribute("class").then((classes) => {
                return classes.includes(className);
            });
        };
        this.isFooterBtnIconHasClass = (buttonIndex, className) => {
            return this.getVisibleFooterButtons().get(buttonIndex).element(protractor_1.by.css("i")).getAttribute("class")
                .then((classes) => {
                return classes.includes(className);
            });
        };
    }
}
DialogAtom.CSS_CLASS = "xui-dialog";
DialogAtom.get = () => {
    const dialogEl = protractor_1.browser.element(protractor_1.by.css("body .xui-modal-top .xui-dialog"));
    return new DialogAtom(dialogEl);
};
DialogAtom.waitUntilHidden = () => {
    return protractor_1.browser.wait(() => {
        const element = protractor_1.browser.element(protractor_1.by.css("body .xui-modal-top .xui-dialog"));
        return element.isPresent().then((isPresent) => !isPresent);
    });
};
DialogAtom.isPresent = () => {
    const element = protractor_1.browser.element(protractor_1.by.css("body .xui-modal-top .xui-dialog"));
    return element.isPresent();
};
exports.DialogAtom = DialogAtom;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvZGlhbG9nL2RpYWxvZy5hdG9tLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsMkRBQW1HO0FBQ25HLHlDQUFxQztBQUNyQyw4Q0FBMkM7QUFFM0MsZ0JBQXdCLFNBQVEsVUFBSTtJQUFwQzs7UUFvQlcsY0FBUyxHQUFHLEdBQWtCLEVBQUU7WUFDbkMsTUFBTSxDQUFDLEtBQUssQ0FBQyxVQUFVLEVBQUUsQ0FBQyxPQUFPLENBQUMsZUFBRSxDQUFDLFNBQVMsQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDO1FBQ3BFLENBQUMsQ0FBQztRQUVLLG1CQUFjLEdBQUcsR0FBa0IsRUFBRTtZQUN4QyxNQUFNLENBQUMsS0FBSyxDQUFDLFVBQVUsRUFBRSxDQUFDLE9BQU8sQ0FBQyxlQUFFLENBQUMsU0FBUyxDQUFDLGdCQUFnQixDQUFDLENBQUMsQ0FBQztRQUN0RSxDQUFDLENBQUM7UUFFSyxhQUFRLEdBQUcsR0FBNEIsRUFBRTtZQUM1QyxNQUFNLENBQUMsS0FBSyxDQUFDLFVBQVUsRUFBRSxDQUFDLE9BQU8sQ0FBQyxlQUFFLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUM7UUFDN0UsQ0FBQyxDQUFDO1FBRUssK0JBQTBCLEdBQUcsR0FBNkIsRUFBRTtZQUMvRCxNQUFNLENBQUMsS0FBSyxDQUFDLFVBQVUsRUFBRTtpQkFDcEIsT0FBTyxDQUFDLGVBQUUsQ0FBQyxTQUFTLENBQUMseUJBQXlCLENBQUMsQ0FBQztpQkFDaEQsU0FBUyxFQUFFLENBQUM7UUFDckIsQ0FBQyxDQUFDO1FBRUssNkJBQXdCLEdBQUcsR0FBNkIsRUFBRTtZQUM3RCxNQUFNLENBQUMsS0FBSyxDQUFDLFVBQVUsRUFBRTtpQkFDcEIsT0FBTyxDQUFDLGVBQUUsQ0FBQyxTQUFTLENBQUMsMEJBQTBCLENBQUMsQ0FBQztpQkFDakQsU0FBUyxFQUFFLENBQUM7UUFDckIsQ0FBQyxDQUFDO1FBRUssd0JBQW1CLEdBQUcs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QUFpQyxDQUFDLENBQUMsQ0FBQztJQUMzRSxNQUFNLENBQUMsT0FBTyxDQUFDLFNBQVMsRUFBRSxDQUFDO0FBQy9CLENBQUMsQ0FBQztBQWxCTixnQ0FxSUMiLCJmaWxlIjoiY29tcG9uZW50cy9kaWFsb2cvZGlhbG9nLmF0b20uanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2Jyb3dzZXIsIGJ5LCBFbGVtZW50QXJyYXlGaW5kZXIsIEVsZW1lbnRGaW5kZXIsIHByb21pc2V9IGZyb20gXCJAc29sYXJ3aW5kcy91emkvcHJvdHJhY3RvclwiO1xuaW1wb3J0IHtBdG9tfSBmcm9tIFwiQHNvbGFyd2luZHMvdXppXCI7XG5pbXBvcnQge1Byb2dyZXNzQXRvbX0gZnJvbSBcIi4uL2luZGV4LmF0b21cIjtcblxuZXhwb3J0IGNsYXNzIERpYWxvZ0F0b20gZXh0ZW5kcyBBdG9tIHtcbiAgICBwdWJsaWMgc3RhdGljIENTU19DTEFTUyA9IFwieHVpLWRpYWxvZ1wiO1xuXG4gICAgcHVibGljIHN0YXRpYyBnZXQgPSAoKTogRGlhbG9nQXRvbSA9PiB7XG4gICAgICAgIGNvbnN0IGRpYWxvZ0VsID0gYnJvd3Nlci5lbGVtZW50KGJ5LmNzcyhcImJvZHkgLnh1aS1tb2RhbC10b3AgLnh1aS1kaWFsb2dcIikpO1xuICAgICAgICByZXR1cm4gbmV3IERpYWxvZ0F0b20oZGlhbG9nRWwpO1xuICAgIH07XG5cbiAgICBwdWJsaWMgc3RhdGljIHdhaXRVbnRpbEhpZGRlbiA9ICgpID0+IHtcbiAgICAgICAgcmV0dXJuIGJyb3dzZXIud2FpdCgoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gYnJvd3Nlci5lbGVtZW50KGJ5LmNzcyhcImJvZHkgLnh1aS1tb2RhbC10b3AgLnh1aS1kaWFsb2dcIikpO1xuICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQuaXNQcmVzZW50KCkudGhlbigoaXNQcmVzZW50KSA9PiAhaXNQcmVzZW50KTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHB1YmxpYyBzdGF0aWMgaXNQcmVzZW50ID0gKCk6IHByb21pc2UuUHJvbWlzZTxib29sZWFuPiA9PiB7XG4gICAgICAgIGNvbnN0IGVsZW1lbnQgPSBicm93c2VyLmVsZW1lbnQoYnkuY3NzKFwiYm9keSAueHVpLW1vZGFsLXRvcCAueHVpLWRpYWxvZ1wiKSk7XG4gICAgICAgIHJldHVybiBlbGVtZW50LmlzUHJlc2VudCgpO1xuICAgIH07XG5cbiAgICBwdWJsaWMgZ2V0SGVhZGVyID0gKCk6IEVsZW1lbnRGaW5kZXIgPT4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0RWxlbWVudCgpLmVsZW1lbnQoYnkuY2xhc3NOYW1lKFwibW9kYWwtaGVhZGVyXCIpKTtcbiAgICB9O1xuXG4gICAgcHVibGljIGdldEhlYWRlckNsb3NlID0gKCk6IEVsZW1lbnRGaW5kZXIgPT4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0RWxlbWVudCgpLmVsZW1lbnQoYnkuY2xhc3NOYW1lKFwieHVpLWljb24tY2xvc2VcIikpO1xuICAgIH07XG5cbiAgICBwdWJsaWMgZ2V0VGl0bGUgPSAoKTogcHJvbWlzZS5Qcm9taXNlPHN0cmluZz4gPT4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0RWxlbWVudCgpLmVsZW1lbnQoYnkuY2xhc3NOYW1lKFwibW9kYWwtdGl0bGVcIikpLmdldFRleHQoKTtcbiAgICB9O1xuXG4gICAgcHVibGljIGlzV2FybmluZ1N0YXR1c0ljb25QcmVzZW50ID0gKCk6IHByb21pc2UuUHJvbWlzZTxib29sZWFuPiA9PiB7XG4gICAgICAgIHJldHVybiBzdXBlci5nZXRFbGVtZW50KClcbiAgICAgICAgICAgIC5lbGVtZW50KGJ5LmNsYXNzTmFtZShcInh1aS1pY29uLXN0YXR1c193YXJuaW5nXCIpKVxuICAgICAgICAgICAgLmlzUHJlc2VudCgpO1xuICAgIH07XG5cbiAgICBwdWJsaWMgaXNFcnJvclN0YXR1c0ljb25QcmVzZW50ID0gKCk6IHByb21pc2UuUHJvbWlzZTxib29sZWFuPiA9PiB7XG4gICAgICAgIHJldHVybiBzdXBlci5nZXRFbGVtZW50KClcbiAgICAgICAgICAgIC5lbGVtZW50KGJ5LmNsYXNzTmFtZShcInh1aS1pY29uLXN0YXR1c19jcml0aWNhbFwiKSlcbiAgICAgICAgICAgIC5pc1ByZXNlbnQoKTtcbiAgICB9O1xuXG4gICAgcHVibGljIGlzU3RhdHVzSWNvblByZXNlbnQgPSAoKTogcHJvbWlzZS5Qcm9taXNlPGJvb2xlYW4+ID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXNXYXJuaW5nU3RhdHVzSWNvblByZXNlbnQoKS50aGVuKChpc1dhcm5pbmdJY29uUHJlc2VudDogYm9vbGVhbikgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGlzV2FybmluZ0ljb25QcmVzZW50ID8gPGFueT50cnVlIDogdGhpcy5pc0Vycm9yU3RhdHVzSWNvblByZXNlbnQoKTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHB1YmxpYyBnZXRCb2R5ID0gKCk6IEVsZW1lbnRGaW5kZXIgPT4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0RWxlbWVudCgpLmVsZW1lbnQoYnkuY2xhc3NOYW1lKFwibW9kYWwtYm9keVwiKSk7XG4gICAgfTtcblxuICAgIHB1YmxpYyBnZXRNZXNzYWdlID0gKCkgPT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRCb2R5KClcbiAgICAgICAgICAgIC5hbGwoYnkudGFnTmFtZShcInBcIikpXG4gICAgICAgICAgICAuZ2V0KDApXG4gICAgICAgICAgICAuZ2V0VGV4dCgpO1xuICAgIH07XG5cbiAgICBwdWJsaWMgZ2V0VHJhbnNjbHVkZWRDb250ZW50ID0gKCk6IEVsZW1lbnRGaW5kZXIgPT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRCb2R5KCkuYWxsKGJ5LmNzcyhcIltuZy10cmFuc2NsdWRlXVwiKSkuZ2V0KDApO1xuICAgIH07XG5cbiAgICBwdWJsaWMgZ2V0Q29udGVudCA9IChpZDogc3RyaW5nKTogRWxlbWVudEZpbmRlciA9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFRyYW5zY2x1ZGVkQ29udGVudCgpLmVsZW1lbnQoYnkuaWQoaWQpKTtcbiAgICB9O1xuXG4gICAgcHVibGljIGdldEZvb3RlckJ1dHRvbnMgPSAoKTogRWxlbWVudEFycmF5RmluZGVyID0+IHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldEVsZW1lbnQoKVxuICAgICAgICAgICAgLmVsZW1lbnQoYnkuY2xhc3NOYW1lKFwibW9kYWwtZm9vdGVyXCIpKVxuICAgICAgICAgICAgLmFsbChieS5jbGFzc05hbWUoXCJ4dWktYnV0dG9uXCIpKTtcbiAgICB9O1xuXG4gICAgcHVibGljIGdldEZvb3Rlcj0gKCk6IEVsZW1lbnRGaW5kZXIgPT4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0RWxlbWVudCgpXG4gICAgICAgICAgICAuZWxlbWVudChieS5jbGFzc05hbWUoXCJtb2RhbC1mb290ZXJcIikpO1xuICAgIH07XG5cbiAgICBwdWJsaWMgZ2V0VmlzaWJsZUZvb3RlckJ1dHRvbnMgPSAoKTogRWxlbWVudEFycmF5RmluZGVyID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Rm9vdGVyQnV0dG9ucygpLmZpbHRlcigoYnV0dG9uOiBFbGVtZW50RmluZGVyKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gYnV0dG9uLmlzRGlzcGxheWVkKCk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBwdWJsaWMgZ2V0VmlzaWJsZUZvb3RlckJ1dHRvbiA9IChidXR0b25UZXh0OiBzdHJpbmcpOiBFbGVtZW50RmluZGVyID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VmlzaWJsZUZvb3RlckJ1dHRvbnMoKS5maWx0ZXIoKGJ1dHRvbjogRWxlbWVudEZpbmRlcikgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGJ1dHRvbi5nZXRUZXh0KCkudGhlbigodGV4dDogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGJ1dHRvblRleHQudG9Mb3dlckNhc2UoKSA9PT0gdGV4dC50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pLmZpcnN0KCk7XG4gICAgfTtcblxuICAgIHB1YmxpYyBmb290ZXJCdXR0b25Db3VudCA9ICgpOiBwcm9taXNlLlByb21pc2U8bnVtYmVyPiA9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFZpc2libGVGb290ZXJCdXR0b25zKCkuY291bnQoKTtcbiAgICB9O1xuXG4gICAgcHVibGljIGNsaWNrRm9vdGVyQnV0dG9uID0gKGJ1dHRvblRleHQ6IHN0cmluZykgPT4ge1xuICAgICAgICBjb25zdCBidXR0b24gPSB0aGlzLmdldFZpc2libGVGb290ZXJCdXR0b24oYnV0dG9uVGV4dCk7XG4gICAgICAgIGlmIChidXR0b24pIHtcbiAgICAgICAgICAgIHJldHVybiBidXR0b24uY2xpY2soKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBwdWJsaWMgaXNCdXN5T3ZlcmxheURpc3BsYXllZCA9ICgpOiBwcm9taXNlLlByb21pc2U8Ym9vbGVhbj4gPT4ge1xuICAgICAgICByZXR1cm4gQXRvbS5maW5kSW4oUHJvZ3Jlc3NBdG9tLCB1bmRlZmluZWQsIDApLmlzRGlzcGxheWVkKCk7XG4gICAgfTtcblxuICAgIHB1YmxpYyBjYW5jZWxCdXN5ID0gKCk6IHByb21pc2UuUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgICAgIHJldHVybiBBdG9tLmZpbmRJbihQcm9ncmVzc0F0b20sIHVuZGVmaW5lZCwgMCkuY2FuY2VsUHJvZ3Jlc3MoKTtcbiAgICB9O1xuXG4gICAgcHVibGljIGlzQnVzeU92ZXJsYXlIaWRkZW4gPSAoKTogcHJvbWlzZS5Qcm9taXNlPGJvb2xlYW4+ID0+IHtcbiAgICAgICAgcmV0dXJuIEF0b20uZmluZEluKFByb2dyZXNzQXRvbSwgdW5kZWZpbmVkLCAwKVxuICAgICAgICAgICAgLmlzRGlzcGxheWVkKClcbiAgICAgICAgICAgIC50aGVuKChpc0Rpc3BsYXllZDogYm9vbGVhbikgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiAhaXNEaXNwbGF5ZWQ7XG4gICAgICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcHVibGljIGlzRm9vdGVyQnRuSGFzQ2xhc3MgPSAoYnV0dG9uSW5kZXg6IG51bWJlciwgY2xhc3NOYW1lOiBzdHJpbmcpOiBwcm9taXNlLlByb21pc2U8Ym9vbGVhbj4gPT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRWaXNpYmxlRm9vdGVyQnV0dG9ucygpLmdldChidXR0b25JbmRleCkuZ2V0QXR0cmlidXRlKFwiY2xhc3NcIikudGhlbiggKGNsYXNzZXMpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBjbGFzc2VzLmluY2x1ZGVzKGNsYXNzTmFtZSk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBwdWJsaWMgaXNGb290ZXJCdG5JY29uSGFzQ2xhc3MgPSAoYnV0dG9uSW5kZXg6IG51bWJlciwgY2xhc3NOYW1lOiBzdHJpbmcpOiBwcm9taXNlLlByb21pc2U8Ym9vbGVhbj4gPT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRWaXNpYmxlRm9vdGVyQnV0dG9ucygpLmdldChidXR0b25JbmRleCkuZWxlbWVudChieS5jc3MoXCJpXCIpKS5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKVxuICAgICAgICAgICAgLnRoZW4oIChjbGFzc2VzKSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNsYXNzZXMuaW5jbHVkZXMoY2xhc3NOYW1lKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH07XG59XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
