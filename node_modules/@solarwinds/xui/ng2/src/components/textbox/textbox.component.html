<div class="xui-textbox"
     [class.xui-textbox--disabled]="disabled"
     [class.has-error]="isInErrorState()">

    <div class="xui-textbox__control-label-container" *ngIf='caption'>
        <label [for]="name" class="xui-textbox__control-label">{{caption}}</label>

        <span class="xui-textbox__state-text">{{stateText()}}</span>
    </div>

    <div class="has-feedback"
         [ngClass]="{'xui-textbox__input-wrapper--inline': hasSuffix()}"
         [ngStyle]="{'width': customBoxWidth}">

        <input *ngIf="!rows || rows <= 1" class="form-control xui-textbox__input"
               [ngClass]="{ 'xui-textbox__input--icon': showFeedback() }"
               [name]="name"
               [(ngModel)]="value"
               [placeholder]="placeholder"
               (input)="handleChangedValue(value, boxInput)"
               [disabled]="disabled"
               [readonly]="readonly"
               [required]="required"
               [type]="type"
               [xuiValidationHandler]="validatorSet"
               [xuiValidationHandlerAsync]="validatorAsync"
               #boxInput="ngModel"/>

        <textarea *ngIf="rows > 1" class="form-control xui-textbox__input"
                  [rows]="rows"
                  [name]="name"
                  [(ngModel)]="value"
                  [placeholder]="placeholder"
                  (input)="handleChangedValue(value, boxTextarea)"
                  [disabled]="disabled"
                  [readonly]="readonly"
                  [required]="required"
                  [xuiValidationHandler]="validatorSet"
                  [xuiValidationHandlerAsync]="validatorAsync"
                  #boxTextarea="ngModel"></textarea>

        <xui-icon *ngIf="isInErrorState()"
                  icon="severity_error" cssClass="form-control-feedback"
                  iconSize="small" aria-hidden="true">
        </xui-icon>

        <div class="form-control-feedback xui-textbox__busy">
            <xui-spinner [show]="validationState.pending"></xui-spinner>
        </div>

        <div *ngIf="type === 'number'" >
            <span class="xui-textbox__updown xui-textbox__down-button">
                <button xui-button type="button"
                        displayStyle="tertiary" icon="caret-down" [isRepeat]="true"
                        [disabled]="isUnavailableToChange()"
                        (click)="addNumber(-1);"></button>
            </span>
            <span class="xui-textbox__updown xui-textbox__updown-divider"></span>
            <span class="xui-textbox__updown xui-textbox__up-button">
                <button xui-button type="button"
                        displayStyle="tertiary" icon="caret-up" [isRepeat]="true"
                        [disabled]="isUnavailableToChange()"
                        (click)="addNumber(1);"></button>
            </span>
        </div>
    </div>

    <span *ngIf="hasSuffix()"
          class="xui-textbox__suffix">{{suffix}}</span>

    <div *ngIf="isInErrorState()"
         class="xui-textbox__messages xui-validation" role="alert">

        <div *ngFor="let name of getAllValidatorNames()">
            <div *ngIf="validationState.errors[name]">
                {{validationState.errors[name].message}}
            </div>
        </div>
    </div>

    <xui-help-hint [hidden]="!hint" class="xui-textbox__help">{{hint}}</xui-help-hint>
</div>
