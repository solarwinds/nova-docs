import { browser, by } from "@solarwinds/uzi/protractor";
import { Atom } from "@solarwinds/uzi";
import { PopupAtom } from "./popup.atom";
import Helpers from "../helpers";

describe("USERCONTROL Popup", () => {

    let subject1: PopupAtom;
    let subject2: PopupAtom;

    beforeEach(() => {
        Helpers.prepareBrowser("popup");

        subject1 = Atom.find(PopupAtom, "xui-demo-popup1");
        subject2 = Atom.find(PopupAtom, "xui-demo-popup2");
    });

    it("should be opened/closed on click event", () => {
        subject1.getPopupToggle().click();
        expect(subject1.isOpened()).toBe(true);

        subject1.getPopupToggle().click();
        expect(subject1.isOpened()).toBe(false);
    });

    it("should be closed when other popup is opened", () => {
        subject1.getPopupToggle().click();
        subject2.getPopupToggle().click();

        expect(subject1.isOpened()).toBe(false);
        expect(subject2.isOpened()).toBe(true);
    });

    it("should be closed if click outside the popup", () => {
        subject1.getPopupToggle().click();
        expect(subject1.isOpened()).toBe(true);

        browser.element(by.id("xui-demo-outside-popup-block")).click();
        expect(subject1.isOpened()).toBe(false);
    });

});
