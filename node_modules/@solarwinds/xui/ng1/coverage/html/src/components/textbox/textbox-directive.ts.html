<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for src/components/textbox/textbox-directive.ts</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../../prettify.css" />
    <link rel="stylesheet" href="../../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../../index.html">All files</a> / <a href="index.html">src/components/textbox</a> textbox-directive.ts
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">96.88% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>31/32</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">77.78% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>7/9</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>3/3</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">96.77% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>30/31</span>
      </div>
    </div>
  </div>
  <div class='status-line high'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-yes">4x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">10x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">10x</span>
<span class="cline-any cline-yes">10x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">import TextboxController from "./textbox-controller";
&nbsp;
/**
 * @ngdoc directive
 * @name xui.directive:xuiTextbox
 * @restrict E
 *
 * @description
 * XUI Textbox description.
 *
 * @parameters
 * @param {string} caption Value used as a label for the text box.
 * @param {string} placeholder Value used as a placeholder for the text box.
 * @param {string} validators Comma-delimmited string of validator identifiers along with parameters (e.g. min=-5).
 * @param {string} type Type of input box (e.g. email, number, password).
 * @param {string} rows Number of rows for input.
 * @param {string} name Name of the element.
 * @param {string} help-text Help content provided below the text box.
 * @param {string} is-disabled Expression to disable the text box.
 * @param {string} is-read-only Expression to make the text box read only.
 * @param {boolean=} is-required Attribute to set/change conditional 'required' validation.
 * @param {object} ng-model-options This component also supports `ng-model-options` directive for binding to forms.
 * @param {string} custom-box-width Use to set a custom width for the input field.
 * @param {string} suffix Use to set suffix (in conjunction with custom width).
 *
 * @example
 *&lt;example module="xui"&gt;
 *     &lt;file src="src/components/textbox/docs/textbox-examples.html" name="index.html"&gt;&lt;/file&gt;
 *     &lt;file src="src/components/textbox/docs/textbox-examples.js" name="app.js"&gt;&lt;/file&gt;
 *&lt;/example&gt;
 */
&nbsp;
interface ITextboxScope extends ng.IScope {
    name:string;
}
&nbsp;
//this directive does an unusual thing- it delays compiling the input it contains
//the reason for this is for validators.  The validators need to be able to be pulled from the
//directive's attributes, and be put on the child input control.  There are 2 hiccups here.
//The first is that we can have a custom validator that must be placed on the input PRE compile, so
//that it can be compiled with the input.  The second is that bindings put on some of the validators
//need to be compiled against the directive's scope, not the isolated one inside the directive.
//Putting the logic in the link allows bindings to be resolved; delayed compilation on the
//input allows custom validators to be compiled properly.
class Textbox implements ng.IDirective {
    public static $inject = ["swUtil", "$compile"];
&nbsp;
    constructor(private swUtil:any, private $compile:ng.ICompileService) {
    }
&nbsp;
    public require = ["xuiTextbox"];
    public restrict = "E";
    public replace = true;
    public transclude = true;
    public templateUrl = "xui/components/textbox/textbox-directive.html";
    public scope = {};
    public controller = "xuiTextboxController";
    public controllerAs = "textCtrl";
    public bindToController = {
        name: "@?",
        caption: "@?",
        type: "@?",
        placeholder: "@?",
        validators: "@?",
        helpText: "@?",
        rows: "@?",
        customBoxWidth: "@?",
        suffix: "@?",
        modelOptions: "&lt;?ngModelOptions",
        value: "=ngModel",
        onChange: "&amp;?ngChange",
        onBlur: "&amp;?ngBlur",
        onFocus: "&amp;?ngFocus",
        isRequired: "&lt;?"
    };
&nbsp;
    public link = (scope:ITextboxScope, element:ng.IAugmentedJQuery,
                   attrs:ng.IAttributes, controllers:any,
                   transcludeFn:ng.ITranscludeFunction) =&gt; {
        const textboxController:TextboxController = controllers[0];
&nbsp;
        this.swUtil.initComponent(attrs, "textbox");
&nbsp;
        if (!("caption" in attrs)) {
            element.find(".xui-textbox__control-label-container")
                .addClass("xui-textbox__control-label-container--hidden");
        }
&nbsp;
        this.swUtil.watchBoolean(attrs, "isDisabled", textboxController);
        this.swUtil.watchBoolean(attrs, "isReadOnly", textboxController);
&nbsp;
        //normally, scope.name would be populated after a digest cycle from the attr collection
        //however, we need the name immediately, so it can be put on the form controller
        //without setting this here, the formController[scope.name] call later on will fail
        if (!scope.name) {
            scope.name = attrs["name"];
        }
&nbsp;
        textboxController.multiline = (attrs["rows"] &amp;&amp; attrs["rows"] &gt; 1) || false;
&nbsp;
        let elementToUse:ng.IAugmentedJQuery = null;
&nbsp;
        if (textboxController.multiline) {
            elementToUse = element.find("textarea");
            element.find("input").remove();
        } else {
            elementToUse = element.find("input");
            element.find("textarea").remove();
        }
&nbsp;
        if (attrs["validators"]) {
            _.each(attrs["validators"].split(","), (validator:string) =&gt; {
                let parts = validator.split("=");
                let name = parts[0];
                let value = parts.length &gt; 1 ? parts[1] : "";
                if (name === "required") {
                    textboxController.isRequired = true;
                } else {<span class="branch-0 cbranch-no" title="branch not covered" ></span>
                    elementToUse.attr(name, value);
                }
            });
        }
&nbsp;
        if (attrs["ngPattern"]) {
            elementToUse.attr("ng-pattern", attrs["ngPattern"]);
        }
&nbsp;
        elementToUse.removeAttr("ng-non-bindable");
        <span class="missing-if-branch" title="if path not taken" >I</span>this.$compile(elementToUse)(scope);
<span class="cstat-no" title="statement not covered" >        textboxController.input = elementToUse.controller("</span>ngModel");
    };
}
&nbsp;
export default Textbox;
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="https://istanbul.js.org/" target="_blank">istanbul</a> at Fri Dec 15 2017 19:51:34 GMT+0000 (UTC)
</div>
</div>
<script src="../../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../../sorter.js"></script>
</body>
</html>
