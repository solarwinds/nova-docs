/**
 * @ngdoc directive
 * @name xui.directive:xuiCode
 * @restrict E
 *
 * @description
 * Purpose of this component is to format and colorize your source code snippets. Code content has to be passed in as
 * an attribute <code>content</code> as using transclusion is not white-space and new-line friendly. Optionally you can
 * specify a programming language to be used for highlighting, otherwise an automated detection will be used. This
 * directive is encapsulating Highlight.js library.
 *
 * @parameters
 * @param {string} content The source code to be displayed.
 * @param {string=} lang Programming language used (auto-detect if not present) - see
 * https://highlightjs.org/static/demo/ for possible values.
 *
 * @example
 *    <example module="xui">
 *        <file src="src/components/code/docs/code-examples.html" name="index.html"></file>
 *        <file src="src/components/code/docs/code-examples.js" name="script.js"></file>
 *    </example>
 */
import * as hljs from "highlight.js";

export class Code implements ng.IDirective {

    public template = require<string>("./code-directive.html");
    public transclude = true;
    public controller = CodeController;
    public replace = true;
    public bindToController = {
        "lang": "@",
        "content": "<"
    };

    public link = (scope: ng.IScope, element: ng.IAugmentedJQuery, attrs: ng.IAttributes,
                   controller: CodeController, transclude: ng.ITranscludeFunction) => {
        if (angular.isDefined(controller.content)) {
            element.text(controller.content);
            hljs.highlightBlock(element.get(0));
        } else {
            element.append(transclude());
        }
    };

}

class CodeController {
    public content: string;
}
