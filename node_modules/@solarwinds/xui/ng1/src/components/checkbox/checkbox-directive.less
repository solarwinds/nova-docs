@import (reference) "../../styles/mixins.less";
@import (reference) "../../styles/xui-framework-variables.less";
@import (reference) "../../styles/xui-icon-backgrounds.less";

@xui-checkbox-border-width: 2px;
@xui-checkbox-margin: 7px;
@xui-checkbox-padding: 7px;
@xui-checkbox-shadow-width: 4px;

.xui .xui-checkbox-inline {
    .xui-checkbox {
        display: inline-block;
        padding-right: @padding-large-horizontal;
    }
}

.xui .xui-checkbox {
    padding: @xui-checkbox-margin 0;
    vertical-align: top;
    line-height: normal;

    &.xui-checkbox--has-action .xui-checkbox-mark:after {
        display: none;
    }

    &-label {
        position: relative;
        cursor: pointer;
        margin: 0;
        font-weight: @xui-font-weight-regular;
    }

    &-mark {
        border: solid @xui-checkbox-border-width @xui-color-border-dark;
        background: @xui-color-input-bg no-repeat 0 center;
        background-size: @icon-size-small;
        width: @icon-size-small;
        height: @icon-size-small;
        float: left;
        transition: background-color .3s, border-color .3s;
        &:after {
            top: -10px;
            bottom: -10px;
            left: -10px;
            content: '';
        }
    }

    &-glyph {
        display: none;
        width: 100%;
        height: 100%;
        background-size: (@icon-size-small - (@xui-checkbox-border-width * 2));
        .xui-icon-name-checkmark();
    }

    &-input {
        .opacity(0);
        width: 1px;
        height: 1px;
        position: absolute;

        &:checked + .xui-checkbox-label > .xui-checkbox-mark {
            background-color: @xui-color-active;
            border-color: @xui-color-active;

            > .xui-checkbox-glyph {
                display: block;
            }
        }
        &:indeterminate + .xui-checkbox-label > .xui-checkbox-mark {
            border-color: @xui-color-border-dark;

            > .xui-checkbox-glyph {
                background: @xui-color-active !important;
                border: solid 2px @xui-color-input-bg;
                display: block;
            }
        }
        &:disabled + .xui-checkbox-label {
            .opacity(@disabled-opacity);
            .no-select();
            color: @xui-color-inactive;
            cursor: default;
        }
        &:disabled:checked + .xui-checkbox-label > .xui-checkbox-mark {
            background-color: @xui-color-inactive;
            border-color: @xui-color-inactive;
        }
        &:disabled:not(:checked) + .xui-checkbox-label > .xui-checkbox-mark {
            border-color: @xui-color-inactive;
            background-color: lighten(@xui-color-inactive, 30%);
        }
        &:disabled:indeterminate + .xui-checkbox-label > .xui-checkbox-mark {
            > .xui-checkbox-glyph {
                background: @xui-color-inactive !important;
            }
        }
        &:not(:disabled) {
            &.xui-checkbox-hover + .xui-checkbox-label > .xui-checkbox-mark,
            &:focus + .xui-checkbox-label > .xui-checkbox-mark {
                .box-shadow(0 0 0 @xui-checkbox-shadow-width @xui-color-selected-outline);
                border-color: darken(@xui-color-border-dark, 20%);
            }
            &:checked {
                &.xui-checkbox-hover + .xui-checkbox-label > .xui-checkbox-mark,
                &:active + .xui-checkbox-label > .xui-checkbox-mark,
                &:focus + .xui-checkbox-label > .xui-checkbox-mark {
                    background-color: @xui-color-active-hover;
                    border-color: @xui-color-active-hover;
                }
            }
            &:indeterminate {
                &.xui-checkbox-hover + .xui-checkbox-label > .xui-checkbox-mark,
                &:active + .xui-checkbox-label > .xui-checkbox-mark,
                &:focus + .xui-checkbox-label > .xui-checkbox-mark {
                    border-color: darken(@xui-color-border-dark, 20%);
                    > .xui-checkbox-glyph {
                        background: @xui-color-active-hover !important;
                    }
                }
            }
        }
    }

    &-transclude {
        margin: -2px 0 -2px (@icon-size-small + @xui-checkbox-margin);
        line-height: @line-height-base;
    }

    .xui-help-hint {
        margin-left: (@icon-size-small + @xui-checkbox-margin);
    }

    &.xui-checkbox-empty {
        padding: @xui-checkbox-padding; // make enough space for the shadow
        line-height: 0;

        &.xui-checkbox-empty--no-left-padding {
            padding: @xui-checkbox-margin @xui-checkbox-margin @xui-checkbox-margin 0;
        }
    }
    .xui-validation {
        color: @state-danger-text;
        display: none;
    }

    &-invalid {
        .xui-checkbox {
            &-label {
                color: @state-danger-text;
            }
        }
        .xui-validation {
            display: block;
        }
    }

    &.xui-checkbox--no-shadow {
        .xui-checkbox-mark:after {
            // corrects the outlining when selected
            top: -7px;
            bottom: -7px;
        }

        .xui-checkbox-input {
            &.xui-checkbox-hover + .xui-checkbox-label > .xui-checkbox-mark,
            &:active + .xui-checkbox-label > .xui-checkbox-mark,
            &:focus + .xui-checkbox-label > .xui-checkbox-mark {
                .box-shadow(none);
            }
        }

        &.xui-checkbox-empty {
            padding: 2px 0; // removes the shadow paddings
        }
    }
}
