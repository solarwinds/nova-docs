(function () {
    "use strict";

    Xui.module
        .controller("DemoIconController", DemoIconController, ["$http", "xuiToastService", "getJsonLocation"]);

    function DemoIconController($http, toastService, getJsonLocation) {
        var vm = this;
        vm.icons = [];
        vm.categories = [];
        vm.textAlignment = "right";
        vm.iconName = "add";
        vm.iconSize = "";
        vm.iconStatus = "";
        vm.iconColor = "";
        vm.iconHoverColor = "";
        vm.iconTooltip = "Custom icon tooltip";
        vm.isNgDocs = (window.location.href.indexOf("api-docs") != -1);
        vm.onClipboardSuccess = onClipboardSuccess;

        vm.pathToFile = getJsonLocation("icons.json");

        vm.useDark = false;
        vm.useDarkBackground = false;

        vm.shouldBeColored = function(icon) {
            return icon.cat_namespace !== "no-coloring";
        };

        $http.get(vm.pathToFile).then(successCallback, errorCallback);

        //#region Internal Methods
        function successCallback(response) {
            vm.icons = response.data;
            vm.categories = getCategories(vm.icons);
        }

        function errorCallback(response) {
            toastService.error("Error loading data. Contact the Apollo team");
            console.log("Error: File not found in " + vm.pathToFile);
            // whoops, looks like someone forgot to deal with broken build!
        }

        function onClipboardSuccess() {
            toastService.success("Icon name was copied to clipboard.");
        }
        function getCategories(icons) {
            var categories = [];
            for (var i in icons) {
                if (categories.indexOf(icons[i].category) == -1) {
                    categories.push(icons[i].category);
                }
            }
            return categories;
        }

    }

})();
