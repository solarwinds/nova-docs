(function () {
    "use strict";

    Xui.module
        .controller("DemoSearchingController", DemoSearchingController, ["xuiSearchingService"]);

    function DemoSearchingController(searchingService) {
        var vm = this;
        var now = new Date().getTime();
        var week = 7 * 24 * 60 * 60 * 1000;

        vm.items = [
            {stringContainer: "abc", numberContainer: 123, dateContainer: new Date(now - week)},
            {stringContainer: "abcd", numberContainer: 1234, dateContainer: new Date(now)},
            {stringContainer: "abcde", numberContainer: 12345, dateContainer: new Date(now + week)}
        ];
        vm.itemsFormatted = JSON.stringify(vm.items, null, 2);
        vm.searchResult = null;
        vm.searchResultFormatted = null;
        vm.searchValue = null;
        vm.props = [];

        /* this ugly part is needed because the checkboxGroup doesn't work with string values */
        vm.getProps = function () {
            var props = [];

            if (vm.props.includes(1)) {
                props.push("stringContainer");
            }
            if (vm.props.includes(2)) {
                props.push("numberContainer");
            }
            if (vm.props.includes(3)) {
                props.push("dateContainer");
            }

            return props;
        };

        vm.search = function () {
            var props = vm.getProps();

            console.log(props, vm.searchValue);
            vm.searchResult = searchingService.search(vm.items, props, vm.searchValue);
            vm.searchResultFormatted = JSON.stringify(vm.searchResult, null, 2);
        };
    }
})();
