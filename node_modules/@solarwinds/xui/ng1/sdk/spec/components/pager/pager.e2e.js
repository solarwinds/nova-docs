"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const protractor_1 = require("@solarwinds/uzi/protractor");
const index_atom_1 = require("../index.atom");
const helpers_1 = require("../helpers");
const uzi_1 = require("@solarwinds/uzi");
describe("USERCONTROL pager", () => {
    let atom;
    const adjacent = 2;
    const itemCount = 1012;
    const pages = [
        { number: 1, items: "1-25" },
        { number: 5, items: "101-125" },
        { number: 15, items: "351-375" },
        { number: 41, items: "1001-1012" }
    ];
    const pageTwenty = 20;
    beforeEach(() => {
        helpers_1.default.prepareBrowser("pager");
        const parentId = "xui-demo-components-pager";
        atom = uzi_1.Atom.findIn(index_atom_1.PagerAtom, protractor_1.element(protractor_1.by.id(parentId)));
    });
    let getDisplayingText = (itemsPerPage, page, totalItems) => {
        const endItem = Math.min(itemsPerPage * page, totalItems);
        const startItem = itemsPerPage * (page - 1) + 1;
        return startItem.toString() + "-" + endItem.toString();
    };
    it("should be " + itemCount + " items in pager component", () => {
        expect(atom.itemCountText()).toBe(itemCount.toString());
    });
    it("should correctly report items per page", () => {
        const expectedItemsPerPage = "25";
        expect(atom.itemsPerPageSelection()).toBe(expectedItemsPerPage);
    });
    it("should display correct number of page links, including ellipsis links", () => {
        const pageLinkCount = Math.ceil(itemCount / 25);
        expect(atom.pageCount()).toEqual(pageLinkCount);
    });
    it("should display first page by default", () => {
        expect(atom.activePage()).toEqual(1);
    });
    it("should activate the page clicked", () => {
        expect(atom.activePage()).toBe(1);
        expect(atom.isActivePage(3)).toBe(false);
        atom.pageLinkClick(3);
        expect(atom.isActivePage(1)).toBe(false);
        expect(atom.isActivePage(3)).toBe(true);
        atom.pageLinkClick(4);
        expect(atom.isActivePage(1)).toBe(false);
        expect(atom.isActivePage(3)).toBe(false);
        expect(atom.isActivePage(4)).toBe(true);
    });
    it("should honor 'Items per Page'", () => {
        expect(atom.pageCount()).toEqual(41);
        expect(atom.itemsDisplayedText()).toBe(getDisplayingText(25, 1, itemCount));
        atom.pageLinkClick(5);
        expect(atom.itemsDisplayedText()).toBe(getDisplayingText(25, 5, itemCount));
        atom.pageLinkClick(41);
        expect(atom.itemsDisplayedText()).toBe(getDisplayingText(25, 41, itemCount));
        atom.setItemsPerPage(10);
        expect(atom.pageCount()).toEqual(102);
        expect(atom.itemsDisplayedText()).toBe(getDisplayingText(10, 1, itemCount));
        atom.pageLinkClick(5);
        expect(atom.itemsDisplayedText()).toBe(getDisplayingText(10, 5, itemCount));
        atom.pageLinkClick(102);
        expect(atom.itemsDisplayedText()).toBe(getDisplayingText(10, 102, itemCount));
    });
    it("should display ellipsed page links on ellipsis click", () => {
        expect(atom.activePage()).toBe(1);
        expect(atom.isActivePage(pageTwenty)).toBe(false);
        atom.ellipsisLinkClick(0);
        atom.ellipsedPageLink(pageTwenty).click();
        expect(atom.isActivePage(1)).toBe(false);
        expect(atom.isActivePage(pageTwenty)).toBe(true);
    });
    it("should display 2 ellipsis links when active page is not an endpoint link", () => {
        expect(atom.activePage()).toBe(1);
        expect(atom.isEllipsisLinkDisplayed(0)).toBe(true);
        expect(atom.isEllipsisLinkDisplayed(1)).toBe(false);
        atom.ellipsisLinkClick(0);
        atom.ellipsedPageLink(pageTwenty).click();
        expect(atom.isActivePage(pageTwenty)).toBe(true);
        expect(atom.isEllipsisLinkDisplayed(0)).toBe(true);
        expect(atom.isEllipsisLinkDisplayed(1)).toBe(true);
    });
    it("should display 'adjacent' page links on each side of the active page, " +
        "when the active page is not an endpoint link", () => {
        expect(atom.activePage()).toEqual(1);
        atom.ellipsisLink(0).click();
        atom.ellipsedPageLink(pageTwenty).click();
        expect(atom.isActivePage(pageTwenty)).toBe(true);
        expect(atom.isPageLinkVisible(pageTwenty)).toBe(true);
        // left adjacent
        expect(atom.isPageLinkVisible(pageTwenty - adjacent - 1)).toBe(false);
        for (let i = pageTwenty - adjacent; i < adjacent; ++i) {
            expect(atom.isPageLinkVisible(i)).toBe(true);
        }
        // right adjacent
        expect(atom.isPageLinkVisible(pageTwenty + adjacent + 1)).toBe(false);
        for (let i = pageTwenty + 1; i <= pageTwenty + adjacent; ++i) {
            expect(atom.isPageLinkVisible(i)).toBe(true);
        }
    });
    it("page number 15 from popup dialog should be clicked and pages " +
        getDisplayingText(25, 15, itemCount) + " should be displayed", () => {
        atom.ellipsisLink(0).click();
        atom.pageLinkClick(15);
        expect(atom.itemsDisplayedText()).toBe(getDisplayingText(25, 15, itemCount));
    });
    it("should honor 'hideIfEmpty' when pageCount <= 1", () => {
        expect(atom.isDisplayed()).toBe(true);
        const atom2 = uzi_1.Atom.findIn(index_atom_1.PagerAtom, protractor_1.element(protractor_1.by.id("xui-demo-hide-empty-pager-single-page")));
        expect(atom2.isDisplayed()).toBe(false);
        const atom3 = uzi_1.Atom.findIn(index_atom_1.PagerAtom, protractor_1.element(protractor_1.by.id("xui-demo-hide-empty-pager-no-items")));
        expect(atom3.isDisplayed()).toBe(false);
        const atom4 = uzi_1.Atom.findIn(index_atom_1.PagerAtom, protractor_1.element(protractor_1.by.id("xui-demo-show-empty-pager")));
        expect(atom4.isDisplayed()).toBe(true);
        const atom5 = uzi_1.Atom.findIn(index_atom_1.PagerAtom, protractor_1.element(protractor_1.by.id("xui-demo-hide-pager-with-wrong-data")));
        expect(atom5.isDisplayed()).toBe(false);
    });
    it("should honor 'show-prev-next' and provide default", () => {
        expect(atom.arePrevNextLinksDisplayed()).toBe(true);
        const atom2 = uzi_1.Atom.findIn(index_atom_1.PagerAtom, protractor_1.element(protractor_1.by.id("xui-demo-hide-prev-next")));
        expect(atom2.arePrevNextLinksDisplayed()).toBe(false);
    });
    it("should set the correct page on prev/next click", () => {
        expect(atom.activePage()).toEqual(1);
        atom.nextLink().click();
        expect(atom.activePage()).toEqual(2);
        atom.nextLink().click();
        expect(atom.activePage()).toEqual(3);
        atom.prevLink().click();
        expect(atom.activePage()).toEqual(2);
        atom.prevLink().click();
        expect(atom.activePage()).toEqual(1);
        // test prev disablement
        atom.prevLink().click();
        expect(atom.activePage()).toEqual(1);
        // test next disablement
        atom.pageLinkClick(41);
        expect(atom.activePage()).toEqual(41);
        atom.nextLink().click();
        expect(atom.activePage()).toEqual(41);
    });
    it("should honor 'dots' and provide default", () => {
        expect(atom.ellipsisLink(0).getText()).toBe("...");
        const atom1 = uzi_1.Atom.findIn(index_atom_1.PagerAtom, protractor_1.element(protractor_1.by.id("xui-demo-hide-prev-next")));
        expect(atom1.ellipsisLink(0).getText()).toBe("***");
    });
    it("edge detection of component with xui-edge-definer class", () => {
        const atom6 = uzi_1.Atom.findIn(index_atom_1.PagerAtom, protractor_1.element(protractor_1.by.id("xui-demo-edge-detection-pager")));
        expect(atom6.isEllipsisHasDropupClass()).toBeTruthy();
        expect(atom6.isItemsDispHasDropupClass()).toBeTruthy();
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvcGFnZXIvcGFnZXIuZTJlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsMkRBQWdFO0FBQ2hFLDhDQUF3QztBQUN4Qyx3Q0FBaUM7QUFDakMseUNBQXFDO0FBRXJDLFFBQVEsQ0FBQyxtQkFBbUIsRUFBRSxHQUFHLEVBQUU7SUFDL0IsSUFBSSxJQUFlLENBQUM7SUFDcEIsTUFBTSxRQUFRLEdBQUcsQ0FBQyxDQUFDO0lBQ25CLE1BQU0sU0FBUyxHQUFHLElBQUksQ0FBQztJQUN2QixNQUFNLEtBQUssR0FBRztRQUNWLEVBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFDO1FBQzFCLEVBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFDO1FBQzdCLEVBQUMsTUFBTSxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFDO1FBQzlCLEVBQUMsTUFBTSxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUUsV0FBVyxFQUFDO0tBQ25DLENBQUM7SUFDRixNQUFNLFVBQVUsR0FBVSxFQUFFLENBQUM7SUFFN0IsVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNaLGlCQUFPLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ2hDLE1BQU0sUUFBUSxHQUFHLDJCQUEyQixDQUFDO1FBQzdDLElBQUksR0FBRyxVQUFJLENBQUMsTUFBTSxDQUFDLHNCQUFTLEVBQUUsb0JBQU8sQ0FBQyxlQUFFLENBQUMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUM1RCxDQUFDLENBQUMsQ0FBQztJQUVILElBQUksaUJBQWlCLEdBQUcsQ0FBQyxZQUFvQixFQUFFLElBQVksRUFBRSxVQUFrQixFQUFVLEVBQUU7UUFDdkYsTUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxZQUFZLEdBQUcsSUFBSSxFQUFFLFVBQVUsQ0FBQyxDQUFDO1FBQzFELE1BQU0sU0FBUyxH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QUMsQ0FBQyxDQUFDLENBQUM7UUFDckMsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ3hCLE1BQU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDckMsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ3hCLE1BQU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFckMsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ3hCLE1BQU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDckMsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ3hCLE1BQU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDckMsd0JBQXdCO1FBQ3hCLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUN4QixNQUFNLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBRXJDLHdCQUF3QjtRQUN4QixJQUFJLENBQUMsYUFBYSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQ3ZCLE1BQU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDdEMsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ3hCLE1BQU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLENBQUM7SUFDMUMsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMseUNBQXlDLEVBQUUsR0FBRyxFQUFFO1FBQy9DLE1BQU0sQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBRW5ELE1BQU0sS0FBSyxHQUFHLFVBQUksQ0FBQyxNQUFNLENBQUMsc0JBQVMsRUFBRSxvQkFBTyxDQUFDLGVBQUUsQ0FBQyxFQUFFLENBQUMseUJBQXlCLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDaEYsTUFBTSxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDeEQsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMseURBQXlELEVBQUUsR0FBRyxFQUFFO1FBQy9ELE1BQU0sS0FBSyxHQUFHLFVBQUksQ0FBQyxNQUFNLENBQUMsc0JBQVMsRUFBRSxvQkFBTyxDQUFDLGVBQUUsQ0FBQyxFQUFFLENBQUMsK0JBQStCLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDdEYsTUFBTSxDQUFDLEtBQUssQ0FBQyx3QkFBd0IsRUFBRSxDQUFDLENBQUMsVUFBVSxFQUFFLENBQUM7UUFDdEQsTUFBTSxDQUFDLEtBQUssQ0FBQyx5QkFBeUIsRUFBRSxDQUFDLENBQUMsVUFBVSxFQUFFLENBQUM7SUFDM0QsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDLENBQUMsQ0FBQyIsImZpbGUiOiJjb21wb25lbnRzL3BhZ2VyL3BhZ2VyLmUyZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7YnksIGVsZW1lbnQsIHByb21pc2V9IGZyb20gXCJAc29sYXJ3aW5kcy91emkvcHJvdHJhY3RvclwiO1xuaW1wb3J0IHtQYWdlckF0b219IGZyb20gXCIuLi9pbmRleC5hdG9tXCI7XG5pbXBvcnQgSGVscGVycyBmcm9tIFwiLi4vaGVscGVyc1wiO1xuaW1wb3J0IHtBdG9tfSBmcm9tIFwiQHNvbGFyd2luZHMvdXppXCI7XG5cbmRlc2NyaWJlKFwiVVNFUkNPTlRST0wgcGFnZXJcIiwgKCkgPT4ge1xuICAgIGxldCBhdG9tOiBQYWdlckF0b207XG4gICAgY29uc3QgYWRqYWNlbnQgPSAyO1xuICAgIGNvbnN0IGl0ZW1Db3VudCA9IDEwMTI7XG4gICAgY29uc3QgcGFnZXMgPSBbXG4gICAgICAgIHtudW1iZXI6IDEsIGl0ZW1zOiBcIjEtMjVcIn0sXG4gICAgICAgIHtudW1iZXI6IDUsIGl0ZW1zOiBcIjEwMS0xMjVcIn0sXG4gICAgICAgIHtudW1iZXI6IDE1LCBpdGVtczogXCIzNTEtMzc1XCJ9LFxuICAgICAgICB7bnVtYmVyOiA0MSwgaXRlbXM6IFwiMTAwMS0xMDEyXCJ9XG4gICAgXTtcbiAgICBjb25zdCBwYWdlVHdlbnR5Om51bWJlciA9IDIwO1xuXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICAgIEhlbHBlcnMucHJlcGFyZUJyb3dzZXIoXCJwYWdlclwiKTtcbiAgICAgICAgY29uc3QgcGFyZW50SWQgPSBcInh1aS1kZW1vLWNvbXBvbmVudHMtcGFnZXJcIjtcbiAgICAgICAgYXRvbSA9IEF0b20uZmluZEluKFBhZ2VyQXRvbSwgZWxlbWVudChieS5pZChwYXJlbnRJZCkpKTtcbiAgICB9KTtcblxuICAgIGxldCBnZXREaXNwbGF5aW5nVGV4dCA9IChpdGVtc1BlclBhZ2U6IG51bWJlciwgcGFnZTogbnVtYmVyLCB0b3RhbEl0ZW1zOiBudW1iZXIpOiBzdHJpbmcgPT4ge1xuICAgICAgICBjb25zdCBlbmRJdGVtID0gTWF0aC5taW4oaXRlbXNQZXJQYWdlICogcGFnZSwgdG90YWxJdGVtcyk7XG4gICAgICAgIGNvbnN0IHN0YXJ0SXRlbSA9IGl0ZW1zUGVyUGFnZSAqIChwYWdlIC0gMSkgKyAxO1xuICAgICAgICByZXR1cm4gc3RhcnRJdGVtLnRvU3RyaW5nKCkgKyBcIi1cIiArIGVuZEl0ZW0udG9TdHJpbmcoKTtcbiAgICB9O1xuXG4gICAgaXQoXCJzaG91bGQgYmUgXCIgKyBpdGVtQ291bnQgKyBcIiBpdGVtcyBpbiBwYWdlciBjb21wb25lbnRcIiwgKCkgPT4ge1xuICAgICAgICBleHBlY3QoYXRvbS5pdGVtQ291bnRUZXh0KCkpLnRvQmUoaXRlbUNvdW50LnRvU3RyaW5nKCkpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJzaG91bGQgY29ycmVjdGx5IHJlcG9ydCBpdGVtcyBwZXIgcGFnZVwiLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGV4cGVjdGVkSXRlbXNQZXJQYWdlID0gXCIyNVwiO1xuICAgICAgICBleHBlY3QoYXRvbS5pdGVtc1BlclBhZ2VTZWxlY3Rpb24oKSkudG9CZShleHBlY3RlZEl0ZW1zUGVyUGFnZSk7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCBkaXNwbGF5IGNvcnJlY3QgbnVtYmVyIG9mIHBhZ2UgbGlua3MsIGluY2x1ZGluZyBlbGxpcHNpcyBsaW5rc1wiLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHBhZ2VMaW5rQ291bnQgPSBNYXRoLmNlaWwoaXRlbUNvdW50IC8gMjUpO1xuICAgICAgICBleHBlY3QoYXRvbS5wYWdlQ291bnQoKSkudG9FcXVhbChwYWdlTGlua0NvdW50KTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIGRpc3BsYXkgZmlyc3QgcGFnZSBieSBkZWZhdWx0XCIsICgpID0+IHtcbiAgICAgICAgZXhwZWN0KGF0b20uYWN0aXZlUGFnZSgpKS50b0VxdWFsKDEpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJzaG91bGQgYWN0aXZhdGUgdGhlIHBhZ2UgY2xpY2tlZFwiLCAoKSA9PiB7XG4gICAgICAgIGV4cGVjdChhdG9tLmFjdGl2ZVBhZ2UoKSkudG9CZSgxKTtcbiAgICAgICAgZXhwZWN0KGF0b20uaXNBY3RpdmVQYWdlKDMpKS50b0JlKGZhbHNlKTtcbiAgICAgICAgYXRvbS5wYWdlTGlua0NsaWNrKDMpO1xuICAgICAgICBleHBlY3QoYXRvbS5pc0FjdGl2ZVBhZ2UoMSkpLnRvQmUoZmFsc2UpO1xuICAgICAgICBleHBlY3QoYXRvbS5pc0FjdGl2ZVBhZ2UoMykpLnRvQmUodHJ1ZSk7XG4gICAgICAgIGF0b20ucGFnZUxpbmtDbGljayg0KTtcbiAgICAgICAgZXhwZWN0KGF0b20uaXNBY3RpdmVQYWdlKDEpKS50b0JlKGZhbHNlKTtcbiAgICAgICAgZXhwZWN0KGF0b20uaXNBY3RpdmVQYWdlKDMpKS50b0JlKGZhbHNlKTtcbiAgICAgICAgZXhwZWN0KGF0b20uaXNBY3RpdmVQYWdlKDQpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJzaG91bGQgaG9ub3IgJ0l0ZW1zIHBlciBQYWdlJ1wiLCAoKSA9PiB7XG4gICAgICAgIGV4cGVjdChhdG9tLnBhZ2VDb3VudCgpKS50b0VxdWFsKDQxKTtcbiAgICAgICAgZXhwZWN0KGF0b20uaXRlbXNEaXNwbGF5ZWRUZXh0KCkpLnRvQmUoZ2V0RGlzcGxheWluZ1RleHQoMjUsIDEsIGl0ZW1Db3VudCkpO1xuXG4gICAgICAgIGF0b20ucGFnZUxpbmtDbGljayg1KTtcbiAgICAgICAgZXhwZWN0KGF0b20uaXRlbXNEaXNwbGF5ZWRUZXh0KCkpLnRvQmUoZ2V0RGlzcGxheWluZ1RleHQoMjUsIDUsIGl0ZW1Db3VudCkpO1xuXG4gICAgICAgIGF0b20ucGFnZUxpbmtDbGljayg0MSk7XG4gICAgICAgIGV4cGVjdChhdG9tLml0ZW1zRGlzcGxheWVkVGV4dCgpKS50b0JlKGdldERpc3BsYXlpbmdUZXh0KDI1LCA0MSwgaXRlbUNvdW50KSk7XG5cbiAgICAgICAgYXRvbS5zZXRJdGVtc1BlclBhZ2UoMTApO1xuICAgICAgICBleHBlY3QoYXRvbS5wYWdlQ291bnQoKSkudG9FcXVhbCgxMDIpO1xuICAgICAgICBleHBlY3QoYXRvbS5pdGVtc0Rpc3BsYXllZFRleHQoKSkudG9CZShnZXREaXNwbGF5aW5nVGV4dCgxMCwgMSwgaXRlbUNvdW50KSk7XG5cbiAgICAgICAgYXRvbS5wYWdlTGlua0NsaWNrKDUpO1xuICAgICAgICBleHBlY3QoYXRvbS5pdGVtc0Rpc3BsYXllZFRleHQoKSkudG9CZShnZXREaXNwbGF5aW5nVGV4dCgxMCwgNSwgaXRlbUNvdW50KSk7XG5cbiAgICAgICAgYXRvbS5wYWdlTGlua0NsaWNrKDEwMik7XG4gICAgICAgIGV4cGVjdChhdG9tLml0ZW1zRGlzcGxheWVkVGV4dCgpKS50b0JlKGdldERpc3BsYXlpbmdUZXh0KDEwLCAxMDIsIGl0ZW1Db3VudCkpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJzaG91bGQgZGlzcGxheSBlbGxpcHNlZCBwYWdlIGxpbmtzIG9uIGVsbGlwc2lzIGNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgZXhwZWN0KGF0b20uYWN0aXZlUGFnZSgpKS50b0JlKDEpO1xuICAgICAgICBleHBlY3QoYXRvbS5pc0FjdGl2ZVBhZ2UocGFnZVR3ZW50eSkpLnRvQmUoZmFsc2UpO1xuICAgICAgICBhdG9tLmVsbGlwc2lzTGlua0NsaWNrKDApO1xuICAgICAgICBhdG9tLmVsbGlwc2VkUGFnZUxpbmsocGFnZVR3ZW50eSkuY2xpY2soKTtcbiAgICAgICAgZXhwZWN0KGF0b20uaXNBY3RpdmVQYWdlKDEpKS50b0JlKGZhbHNlKTtcbiAgICAgICAgZXhwZWN0KGF0b20uaXNBY3RpdmVQYWdlKHBhZ2VUd2VudHkpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJzaG91bGQgZGlzcGxheSAyIGVsbGlwc2lzIGxpbmtzIHdoZW4gYWN0aXZlIHBhZ2UgaXMgbm90IGFuIGVuZHBvaW50IGxpbmtcIiwgKCkgPT4ge1xuICAgICAgICBleHBlY3QoYXRvbS5hY3RpdmVQYWdlKCkpLnRvQmUoMSk7XG4gICAgICAgIGV4cGVjdChhdG9tLmlzRWxsaXBzaXNMaW5rRGlzcGxheWVkKDApKS50b0JlKHRydWUpO1xuICAgICAgICBleHBlY3QoYXRvbS5pc0VsbGlwc2lzTGlua0Rpc3BsYXllZCgxKSkudG9CZShmYWxzZSk7XG4gICAgICAgIGF0b20uZWxsaXBzaXNMaW5rQ2xpY2soMCk7XG4gICAgICAgIGF0b20uZWxsaXBzZWRQYWdlTGluayhwYWdlVHdlbnR5KS5jbGljaygpO1xuICAgICAgICBleHBlY3QoYXRvbS5pc0FjdGl2ZVBhZ2UocGFnZVR3ZW50eSkpLnRvQmUodHJ1ZSk7XG4gICAgICAgIGV4cGVjdChhdG9tLmlzRWxsaXBzaXNMaW5rRGlzcGxheWVkKDApKS50b0JlKHRydWUpO1xuICAgICAgICBleHBlY3QoYXRvbS5pc0VsbGlwc2lzTGlua0Rpc3BsYXllZCgxKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIGRpc3BsYXkgJ2FkamFjZW50JyBwYWdlIGxpbmtzIG9uIGVhY2ggc2lkZSBvZiB0aGUgYWN0aXZlIHBhZ2UsIFwiICtcbiAgICAgICAgXCJ3aGVuIHRoZSBhY3RpdmUgcGFnZSBpcyBub3QgYW4gZW5kcG9pbnQgbGlua1wiLCAoKSA9PiB7XG5cbiAgICAgICAgZXhwZWN0KGF0b20uYWN0aXZlUGFnZSgpKS50b0VxdWFsKDEpO1xuICAgICAgICBhdG9tLmVsbGlwc2lzTGluaygwKS5jbGljaygpO1xuICAgICAgICBhdG9tLmVsbGlwc2VkUGFnZUxpbmsocGFnZVR3ZW50eSkuY2xpY2soKTtcblxuICAgICAgICBleHBlY3QoYXRvbS5pc0FjdGl2ZVBhZ2UocGFnZVR3ZW50eSkpLnRvQmUodHJ1ZSk7XG4gICAgICAgIGV4cGVjdChhdG9tLmlzUGFnZUxpbmtWaXNpYmxlKHBhZ2VUd2VudHkpKS50b0JlKHRydWUpO1xuXG4gICAgICAgIC8vIGxlZnQgYWRqYWNlbnRcbiAgICAgICAgZXhwZWN0KGF0b20uaXNQYWdlTGlua1Zpc2libGUocGFnZVR3ZW50eSAtIGFkamFjZW50IC0gMSkpLnRvQmUoZmFsc2UpO1xuICAgICAgICBmb3IgKGxldCBpID0gcGFnZVR3ZW50eSAtIGFkamFjZW50OyBpIDwgYWRqYWNlbnQ7ICsraSkge1xuICAgICAgICAgICAgZXhwZWN0KGF0b20uaXNQYWdlTGlua1Zpc2libGUoaSkpLnRvQmUodHJ1ZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyByaWdodCBhZGphY2VudFxuICAgICAgICBleHBlY3QoYXRvbS5pc1BhZ2VMaW5rVmlzaWJsZShwYWdlVHdlbnR5ICsgYWRqYWNlbnQgKyAxKSkudG9CZShmYWxzZSk7XG4gICAgICAgIGZvciAobGV0IGkgPSBwYWdlVHdlbnR5ICsgMTsgaSA8PSBwYWdlVHdlbnR5ICsgYWRqYWNlbnQ7ICsraSkge1xuICAgICAgICAgICAgZXhwZWN0KGF0b20uaXNQYWdlTGlua1Zpc2libGUoaSkpLnRvQmUodHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KFwicGFnZSBudW1iZXIgMTUgZnJvbSBwb3B1cCBkaWFsb2cgc2hvdWxkIGJlIGNsaWNrZWQgYW5kIHBhZ2VzIFwiICtcbiAgICAgICAgZ2V0RGlzcGxheWluZ1RleHQoMjUsIDE1LCBpdGVtQ291bnQpICsgXCIgc2hvdWxkIGJlIGRpc3BsYXllZFwiLCAoKSA9PiB7XG4gICAgICAgIGF0b20uZWxsaXBzaXNMaW5rKDApLmNsaWNrKCk7XG4gICAgICAgIGF0b20ucGFnZUxpbmtDbGljaygxNSk7XG4gICAgICAgIGV4cGVjdChhdG9tLml0ZW1zRGlzcGxheWVkVGV4dCgpKS50b0JlKGdldERpc3BsYXlpbmdUZXh0KDI1LCAxNSwgaXRlbUNvdW50KSk7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCBob25vciAnaGlkZUlmRW1wdHknIHdoZW4gcGFnZUNvdW50IDw9IDFcIiwgKCkgPT4ge1xuICAgICAgICBleHBlY3QoYXRvbS5pc0Rpc3BsYXllZCgpKS50b0JlKHRydWUpO1xuXG4gICAgICAgIGNvbnN0IGF0b20yID0gQXRvbS5maW5kSW4oUGFnZXJBdG9tLCBlbGVtZW50KGJ5LmlkKFwieHVpLWRlbW8taGlkZS1lbXB0eS1wYWdlci1zaW5nbGUtcGFnZVwiKSkpO1xuICAgICAgICBleHBlY3QoYXRvbTIuaXNEaXNwbGF5ZWQoKSkudG9CZShmYWxzZSk7XG5cbiAgICAgICAgY29uc3QgYXRvbTMgPSBBdG9tLmZpbmRJbihQYWdlckF0b20sIGVsZW1lbnQoYnkuaWQoXCJ4dWktZGVtby1oaWRlLWVtcHR5LXBhZ2VyLW5vLWl0ZW1zXCIpKSk7XG4gICAgICAgIGV4cGVjdChhdG9tMy5pc0Rpc3BsYXllZCgpKS50b0JlKGZhbHNlKTtcblxuICAgICAgICBjb25zdCBhdG9tNCA9IEF0b20uZmluZEluKFBhZ2VyQXRvbSwgZWxlbWVudChieS5pZChcInh1aS1kZW1vLXNob3ctZW1wdHktcGFnZXJcIikpKTtcbiAgICAgICAgZXhwZWN0KGF0b200LmlzRGlzcGxheWVkKCkpLnRvQmUodHJ1ZSk7XG5cbiAgICAgICAgY29uc3QgYXRvbTUgPSBBdG9tLmZpbmRJbihQYWdlckF0b20sIGVsZW1lbnQoYnkuaWQoXCJ4dWktZGVtby1oaWRlLXBhZ2VyLXdpdGgtd3JvbmctZGF0YVwiKSkpO1xuICAgICAgICBleHBlY3QoYXRvbTUuaXNEaXNwbGF5ZWQoKSkudG9CZShmYWxzZSk7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCBob25vciAnc2hvdy1wcmV2LW5leHQnIGFuZCBwcm92aWRlIGRlZmF1bHRcIiwgKCkgPT4ge1xuICAgICAgICBleHBlY3QoYXRvbS5hcmVQcmV2TmV4dExpbmtzRGlzcGxheWVkKCkpLnRvQmUodHJ1ZSk7XG5cbiAgICAgICAgY29uc3QgYXRvbTIgPSBBdG9tLmZpbmRJbihQYWdlckF0b20sIGVsZW1lbnQoYnkuaWQoXCJ4dWktZGVtby1oaWRlLXByZXYtbmV4dFwiKSkpO1xuICAgICAgICBleHBlY3QoYXRvbTIuYXJlUHJldk5leHRMaW5rc0Rpc3BsYXllZCgpKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIHNldCB0aGUgY29ycmVjdCBwYWdlIG9uIHByZXYvbmV4dCBjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIGV4cGVjdChhdG9tLmFjdGl2ZVBhZ2UoKSkudG9FcXVhbCgxKTtcbiAgICAgICAgYXRvbS5uZXh0TGluaygpLmNsaWNrKCk7XG4gICAgICAgIGV4cGVjdChhdG9tLmFjdGl2ZVBhZ2UoKSkudG9FcXVhbCgyKTtcbiAgICAgICAgYXRvbS5uZXh0TGluaygpLmNsaWNrKCk7XG4gICAgICAgIGV4cGVjdChhdG9tLmFjdGl2ZVBhZ2UoKSkudG9FcXVhbCgzKTtcblxuICAgICAgICBhdG9tLnByZXZMaW5rKCkuY2xpY2soKTtcbiAgICAgICAgZXhwZWN0KGF0b20uYWN0aXZlUGFnZSgpKS50b0VxdWFsKDIpO1xuICAgICAgICBhdG9tLnByZXZMaW5rKCkuY2xpY2soKTtcbiAgICAgICAgZXhwZWN0KGF0b20uYWN0aXZlUGFnZSgpKS50b0VxdWFsKDEpO1xuICAgICAgICAvLyB0ZXN0IHByZXYgZGlzYWJsZW1lbnRcbiAgICAgICAgYXRvbS5wcmV2TGluaygpLmNsaWNrKCk7XG4gICAgICAgIGV4cGVjdChhdG9tLmFjdGl2ZVBhZ2UoKSkudG9FcXVhbCgxKTtcblxuICAgICAgICAvLyB0ZXN0IG5leHQgZGlzYWJsZW1lbnRcbiAgICAgICAgYXRvbS5wYWdlTGlua0NsaWNrKDQxKTtcbiAgICAgICAgZXhwZWN0KGF0b20uYWN0aXZlUGFnZSgpKS50b0VxdWFsKDQxKTtcbiAgICAgICAgYXRvbS5uZXh0TGluaygpLmNsaWNrKCk7XG4gICAgICAgIGV4cGVjdChhdG9tLmFjdGl2ZVBhZ2UoKSkudG9FcXVhbCg0MSk7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCBob25vciAnZG90cycgYW5kIHByb3ZpZGUgZGVmYXVsdFwiLCAoKSA9PiB7XG4gICAgICAgIGV4cGVjdChhdG9tLmVsbGlwc2lzTGluaygwKS5nZXRUZXh0KCkpLnRvQmUoXCIuLi5cIik7XG5cbiAgICAgICAgY29uc3QgYXRvbTEgPSBBdG9tLmZpbmRJbihQYWdlckF0b20sIGVsZW1lbnQoYnkuaWQoXCJ4dWktZGVtby1oaWRlLXByZXYtbmV4dFwiKSkpO1xuICAgICAgICBleHBlY3QoYXRvbTEuZWxsaXBzaXNMaW5rKDApLmdldFRleHQoKSkudG9CZShcIioqKlwiKTtcbiAgICB9KTtcblxuICAgIGl0KFwiZWRnZSBkZXRlY3Rpb24gb2YgY29tcG9uZW50IHdpdGggeHVpLWVkZ2UtZGVmaW5lciBjbGFzc1wiLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGF0b202ID0gQXRvbS5maW5kSW4oUGFnZXJBdG9tLCBlbGVtZW50KGJ5LmlkKFwieHVpLWRlbW8tZWRnZS1kZXRlY3Rpb24tcGFnZXJcIikpKTtcbiAgICAgICAgZXhwZWN0KGF0b202LmlzRWxsaXBzaXNIYXNEcm9wdXBDbGFzcygpKS50b0JlVHJ1dGh5KCk7XG4gICAgICAgIGV4cGVjdChhdG9tNi5pc0l0ZW1zRGlzcEhhc0Ryb3B1cENsYXNzKCkpLnRvQmVUcnV0aHkoKTtcbiAgICB9KTtcbn0pO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
