"use strict";
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
Object.defineProperty(exports, "__esModule", { value: true });
const protractor_1 = require("@solarwinds/uzi/protractor");
const uzi_1 = require("@solarwinds/uzi");
class PagerAtom extends uzi_1.Atom {
    constructor() {
        super(...arguments);
        this.prevNextClass = "move-icon";
        this.isDisplayed = () => {
            return super.getElement().isDisplayed();
        };
        this.itemCountText = () => {
            return super.getElement().all(protractor_1.by.className("xui-pager__items-total")).get(0).getText();
        };
        this.setItemsPerPage = (itemsPerPage) => {
            super.getElement().all(protractor_1.by.id("pageNumberMenu1")).get(0).click();
            return super.getElement().element(protractor_1.by.css('[aria-labelledby="pageNumberMenu1"] .xui-pager__item-per-page'))
                .element(protractor_1.by.xpath(".//button[.=" + itemsPerPage + "]")).click();
        };
        this.itemsPerPageSelection = () => {
            return super.getElement().all(protractor_1.by.id("pageNumberMenu1")).get(0).getText().then((test) => {
                let pages = test.split("-");
                let start = parseInt(pages[0], 10);
                let end = parseInt(pages[1], 10);
                return (end - start + 1).toString();
            });
        };
        this.itemsDisplayedText = () => {
            return super.getElement().all(protractor_1.by.className("xui-pager__items-shown")).get(0).getText();
        };
        this.pageLinkClick = (pageNumber) => {
            return super.getElement().all(protractor_1.by.className("xui-pager__item-" + pageNumber)).get(0).click();
        };
        this.isPageLinkVisible = (pageNumber) => {
            return super.getElement()
                .all(protractor_1.by.css(".pagination li[value='" + pageNumber + "'] .xui-pager__item"))
                .then((elements) => {
                return elements.length === 1;
            });
        };
        this.ellipsedPageLink = (pageNumber) => {
            return super.getElement().all(protractor_1.by.className("xui-pager__item-" + pageNumber)).get(0);
        };
        this.ellipsisLink = (index) => {
            return super.getElement().all(protractor_1.by.className("xui-pager__dots")).get(index);
        };
        this.ellipsisLinkClick = (index) => {
            return this.ellipsisLink(index).click();
        };
        this.isEllipsisLinkDisplayed = (index) => {
            return super.getElement()
                .all(protractor_1.by.className("xui-pager__dots"))
                .count()
                .then((count) => {
                return count > index;
            });
        };
        this.prevLink = () => {
            return super.getElement().all(protractor_1.by.className(this.prevNextClass)).get(0);
        };
        this.nextLink = () => {
            return super.getElement().all(protractor_1.by.className(this.prevNextClass)).get(1);
        };
        this.arePrevNextLinksDisplayed = () => {
            return super.getElement()
                .all(protractor_1.by.css(".pagination li .move-icon"))
                .then((elements) => {
                return elements.length === 2;
            });
        };
        this.activePage = () => {
            return super.getElement()
                .all(protractor_1.by.css(".pagination li.active"))
                .get(0)
                .getText()
                .then((text) => {
                return parseInt(text, 10);
            });
        };
        this.isActivePage = (page) => {
            return this.activePage().then((activePage) => {
                return activePage === page;
            });
        };
        this.pageCount = () => {
            return super.getElement().all(protractor_1.by.css(".pagination li .xui-pager__item")).count();
        };
    }
    isEllipsisHasDropupClass() {
        const _super = name => super[name];
        return __awaiter(this, void 0, void 0, function* () {
            yield this.ellipsisLinkClick(0);
            const dropdownElement = yield _super("getElement").call(this)
                .all(protractor_1.by.css(".xui-pager__items *[uib-dropdown]")).get(0);
            return yield uzi_1.Atom.hasClass(dropdownElement, "dropup");
        });
    }
    isItemsDispHasDropupClass() {
        const _super = name => super[name];
        return __awaiter(this, void 0, void 0, function* () {
            const itemsShownElem = yield _super("getElement").call(this)
                .all(protractor_1.by.className("xui-pager__items-shown")).get(0);
            yield itemsShownElem.click();
            const dropdownElement = yield _super("getElement").call(this)
                .all(protractor_1.by.css(".xui-pager__info *[uib-dropdown]")).get(0);
            return yield uzi_1.Atom.hasClass(dropdownElement, "dropup");
        });
    }
    ;
}
PagerAtom.CSS_CLASS = "xui-pager";
exports.PagerAtom = PagerAtom;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvcGFnZXIvcGFnZXIuYXRvbS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUEsMkRBQXNFO0FBQ3RFLHlDQUFxQztBQUVyQyxlQUF1QixTQUFRLFVBQUk7SUFBbkM7O1FBR1ksa0JBQWEsR0FBRyxXQUFXLENBQUM7UUFFN0IsZ0JBQVcsR0FBRyxHQUE2QixFQUFFO1lBQ2hELE1BQU0sQ0FBQyxLQUFLLENBQUMsVUFBVSxFQUFFLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDNUMsQ0FBQyxDQUFDO1FBRUssa0JBQWEsR0FBRyxHQUE0QixFQUFFO1lBQ2pELE1BQU0sQ0FBQyxLQUFLLENBQUMsVUFBVSxFQUFFLENBQUMsR0FBRyxDQUFDLGVBQUUsQ0FBQyxTQUFTLENBQUMsd0JBQXdCLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUMzRixDQUFDLENBQUM7UUFFSyxvQkFBZSxHQUFHLENBQUMsWUFBb0IsRUFBeUIsRUFBRTtZQUNyRSxLQUFLLENBQUMsVUFBVSxFQUFFLENBQUMsR0FBRyxDQUFDLGVBQUUsQ0FBQyxFQUFFLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQztZQUNoRSxNQUFNLENBQUMsS0FBSyxDQUFDLFVBQVUsRUFBRSxDQUFDLE9BQU8sQ0FBQyxlQUFFLENBQUMsR0FBRyxDQUFDLCtEQUErRCxDQUFDLENBQUM7aUJBQ3JHLE9BQU8sQ0FBQyxlQUFFLENBQUMsS0FBSyxDQUFDLGNBQWMsR0FBRyxZQUFZLEdBQUcsR0FBRyxDQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUN4RSxDQUFDLENBQUM7UUFFSywwQkFBcUIsR0FBRyxHQUE0QixFQUFFO1lBQ3pELE1BQU0sQ0FBQyxLQUFLLENBQUMsVUFBVSxFQUFFLENBQUMsR0FBRyxDQUFDLGVBQUUsQ0FBQyxFQUFFLENB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QUM7S0FBQTtJQUFBLENBQUM7O0FBcEhZLG1CQUFTLEdBQUcsV0FBVyxDQUFDO0FBRDFDLDhCQXVIQyIsImZpbGUiOiJjb21wb25lbnRzL3BhZ2VyL3BhZ2VyLmF0b20uanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2J5LCBFbGVtZW50RmluZGVyLCBwcm9taXNlfSBmcm9tIFwiQHNvbGFyd2luZHMvdXppL3Byb3RyYWN0b3JcIjtcbmltcG9ydCB7QXRvbX0gZnJvbSBcIkBzb2xhcndpbmRzL3V6aVwiO1xuXG5leHBvcnQgY2xhc3MgUGFnZXJBdG9tIGV4dGVuZHMgQXRvbSB7XG4gICAgcHVibGljIHN0YXRpYyBDU1NfQ0xBU1MgPSBcInh1aS1wYWdlclwiO1xuXG4gICAgcHJpdmF0ZSBwcmV2TmV4dENsYXNzID0gXCJtb3ZlLWljb25cIjtcblxuICAgIHB1YmxpYyBpc0Rpc3BsYXllZCA9ICgpOiBwcm9taXNlLlByb21pc2U8Ym9vbGVhbj4gPT4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0RWxlbWVudCgpLmlzRGlzcGxheWVkKCk7XG4gICAgfTtcblxuICAgIHB1YmxpYyBpdGVtQ291bnRUZXh0ID0gKCk6IHByb21pc2UuUHJvbWlzZTxzdHJpbmc+ID0+IHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldEVsZW1lbnQoKS5hbGwoYnkuY2xhc3NOYW1lKFwieHVpLXBhZ2VyX19pdGVtcy10b3RhbFwiKSkuZ2V0KDApLmdldFRleHQoKTtcbiAgICB9O1xuXG4gICAgcHVibGljIHNldEl0ZW1zUGVyUGFnZSA9IChpdGVtc1BlclBhZ2U6IG51bWJlcik6IHByb21pc2UuUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgICAgIHN1cGVyLmdldEVsZW1lbnQoKS5hbGwoYnkuaWQoXCJwYWdlTnVtYmVyTWVudTFcIikpLmdldCgwKS5jbGljaygpO1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0RWxlbWVudCgpLmVsZW1lbnQoYnkuY3NzKCdbYXJpYS1sYWJlbGxlZGJ5PVwicGFnZU51bWJlck1lbnUxXCJdIC54dWktcGFnZXJfX2l0ZW0tcGVyLXBhZ2UnKSlcbiAgICAgICAgICAgIC5lbGVtZW50KGJ5LnhwYXRoKFwiLi8vYnV0dG9uWy49XCIgKyBpdGVtc1BlclBhZ2UgKyBcIl1cIikpLmNsaWNrKCk7XG4gICAgfTtcblxuICAgIHB1YmxpYyBpdGVtc1BlclBhZ2VTZWxlY3Rpb24gPSAoKTogcHJvbWlzZS5Qcm9taXNlPHN0cmluZz4gPT4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0RWxlbWVudCgpLmFsbChieS5pZChcInBhZ2VOdW1iZXJNZW51MVwiKSkuZ2V0KDApLmdldFRleHQoKS50aGVuKCh0ZXN0KSA9PiB7XG4gICAgICAgICAgICBsZXQgcGFnZXMgPSB0ZXN0LnNwbGl0KFwiLVwiKTtcbiAgICAgICAgICAgIGxldCBzdGFydCA9IHBhcnNlSW50KHBhZ2VzWzBdLCAxMCk7XG4gICAgICAgICAgICBsZXQgZW5kID0gcGFyc2VJbnQocGFnZXNbMV0sIDEwKTtcbiAgICAgICAgICAgIHJldHVybiAoZW5kIC0gc3RhcnQgKyAxKS50b1N0cmluZygpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcHVibGljIGl0ZW1zRGlzcGxheWVkVGV4dCA9ICgpOiBwcm9taXNlLlByb21pc2U8c3RyaW5nPiA9PiB7XG4gICAgICAgIHJldHVybiBzdXBlci5nZXRFbGVtZW50KCkuYWxsKGJ5LmNsYXNzTmFtZShcInh1aS1wYWdlcl9faXRlbXMtc2hvd25cIikpLmdldCgwKS5nZXRUZXh0KCk7XG4gICAgfTtcblxuICAgIHB1YmxpYyBwYWdlTGlua0NsaWNrID0gKHBhZ2VOdW1iZXI6IG51bWJlcik6IHByb21pc2UuUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgICAgIHJldHVybiBzdXBlci5nZXRFbGVtZW50KCkuYWxsKGJ5LmNsYXNzTmFtZShcInh1aS1wYWdlcl9faXRlbS1cIiArIHBhZ2VOdW1iZXIpKS5nZXQoMCkuY2xpY2soKTtcbiAgICB9O1xuXG4gICAgcHVibGljIGlzUGFnZUxpbmtWaXNpYmxlID0gKHBhZ2VOdW1iZXI6IG51bWJlcik6IHByb21pc2UuUHJvbWlzZTxib29sZWFuPiA9PiB7XG4gICAgICAgIHJldHVybiBzdXBlci5nZXRFbGVtZW50KClcbiAgICAgICAgICAgIC5hbGwoYnkuY3NzKFwiLnBhZ2luYXRpb24gbGlbdmFsdWU9J1wiICsgcGFnZU51bWJlciArIFwiJ10gLnh1aS1wYWdlcl9faXRlbVwiKSlcbiAgICAgICAgICAgIC50aGVuKChlbGVtZW50czogRWxlbWVudEZpbmRlcltdKSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnRzLmxlbmd0aCA9PT0gMTtcbiAgICAgICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBwdWJsaWMgZWxsaXBzZWRQYWdlTGluayA9IChwYWdlTnVtYmVyOiBudW1iZXIpOiBFbGVtZW50RmluZGVyID0+IHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldEVsZW1lbnQoKS5hbGwoYnkuY2xhc3NOYW1lKFwieHVpLXBhZ2VyX19pdGVtLVwiICsgcGFnZU51bWJlcikpLmdldCgwKTtcbiAgICB9O1xuXG4gICAgcHVibGljIGVsbGlwc2lzTGluayA9IChpbmRleDogbnVtYmVyKTogRWxlbWVudEZpbmRlciA9PiB7XG4gICAgICAgIHJldHVybiBzdXBlci5nZXRFbGVtZW50KCkuYWxsKGJ5LmNsYXNzTmFtZShcInh1aS1wYWdlcl9fZG90c1wiKSkuZ2V0KGluZGV4KTtcbiAgICB9O1xuXG4gICAgcHVibGljIGVsbGlwc2lzTGlua0NsaWNrID0gKGluZGV4OiBudW1iZXIpOiBwcm9taXNlLlByb21pc2U8dm9pZD4gPT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5lbGxpcHNpc0xpbmsoaW5kZXgpLmNsaWNrKCk7XG4gICAgfTtcblxuICAgIHB1YmxpYyBpc0VsbGlwc2lzTGlua0Rpc3BsYXllZCA9IChpbmRleDogbnVtYmVyKTogcHJvbWlzZS5Qcm9taXNlPGJvb2xlYW4+ID0+IHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldEVsZW1lbnQoKVxuICAgICAgICAgICAgLmFsbChieS5jbGFzc05hbWUoXCJ4dWktcGFnZXJfX2RvdHNcIikpXG4gICAgICAgICAgICAuY291bnQoKVxuICAgICAgICAgICAgLnRoZW4oKGNvdW50OiBudW1iZXIpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY291bnQgPiBpbmRleDtcbiAgICAgICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBwdWJsaWMgcHJldkxpbmsgPSAoKTogRWxlbWVudEZpbmRlciA9PiB7XG4gICAgICAgIHJldHVybiBzdXBlci5nZXRFbGVtZW50KCkuYWxsKGJ5LmNsYXNzTmFtZSh0aGlzLnByZXZOZXh0Q2xhc3MpKS5nZXQoMCk7XG4gICAgfTtcblxuICAgIHB1YmxpYyBuZXh0TGluayA9ICgpOiBFbGVtZW50RmluZGVyID0+IHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldEVsZW1lbnQoKS5hbGwoYnkuY2xhc3NOYW1lKHRoaXMucHJldk5leHRDbGFzcykpLmdldCgxKTtcbiAgICB9O1xuXG4gICAgcHVibGljIGFyZVByZXZOZXh0TGlua3NEaXNwbGF5ZWQgPSAoKTogcHJvbWlzZS5Qcm9taXNlPGJvb2xlYW4+ID0+IHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldEVsZW1lbnQoKVxuICAgICAgICAgICAgLmFsbChieS5jc3MoXCIucGFnaW5hdGlvbiBsaSAubW92ZS1pY29uXCIpKVxuICAgICAgICAgICAgLnRoZW4oKGVsZW1lbnRzOiBFbGVtZW50RmluZGVyW10pID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZWxlbWVudHMubGVuZ3RoID09PSAyO1xuICAgICAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHB1YmxpYyBhY3RpdmVQYWdlID0gKCk6IHByb21pc2UuUHJvbWlzZTxudW1iZXI+ID0+IHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldEVsZW1lbnQoKVxuICAgICAgICAgICAgLmFsbChieS5jc3MoXCIucGFnaW5hdGlvbiBsaS5hY3RpdmVcIikpXG4gICAgICAgICAgICAuZ2V0KDApXG4gICAgICAgICAgICAuZ2V0VGV4dCgpXG4gICAgICAgICAgICAudGhlbigodGV4dDogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KHRleHQsIDEwKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBwdWJsaWMgaXNBY3RpdmVQYWdlID0gKHBhZ2U6IG51bWJlcik6IHByb21pc2UuUHJvbWlzZTxib29sZWFuPiA9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmFjdGl2ZVBhZ2UoKS50aGVuKChhY3RpdmVQYWdlOiBudW1iZXIpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBhY3RpdmVQYWdlID09PSBwYWdlO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcHVibGljIHBhZ2VDb3VudCA9ICgpOiBwcm9taXNlLlByb21pc2U8bnVtYmVyPiA9PiB7XG4gICAgICAgIHJldHVybiBzdXBlci5nZXRFbGVtZW50KCkuYWxsKGJ5LmNzcyhcIi5wYWdpbmF0aW9uIGxpIC54dWktcGFnZXJfX2l0ZW1cIikpLmNvdW50KCk7XG4gICAgfTtcblxuICAgIHB1YmxpYyBhc3luYyBpc0VsbGlwc2lzSGFzRHJvcHVwQ2xhc3MoKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgICAgIGF3YWl0IHRoaXMuZWxsaXBzaXNMaW5rQ2xpY2soMCk7XG4gICAgICAgIGNvbnN0IGRyb3Bkb3duRWxlbWVudCA9IGF3YWl0IHN1cGVyLmdldEVsZW1lbnQoKVxuICAgICAgICAgICAgLmFsbChieS5jc3MoXCIueHVpLXBhZ2VyX19pdGVtcyAqW3VpYi1kcm9wZG93bl1cIikpLmdldCgwKTtcblxuICAgICAgICByZXR1cm4gYXdhaXQgQXRvbS5oYXNDbGFzcyhkcm9wZG93bkVsZW1lbnQsIFwiZHJvcHVwXCIpO1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBpc0l0ZW1zRGlzcEhhc0Ryb3B1cENsYXNzKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgICAgICBjb25zdCBpdGVtc1Nob3duRWxlbSA9IGF3YWl0IHN1cGVyLmdldEVsZW1lbnQoKVxuICAgICAgICAgICAgLmFsbChieS5jbGFzc05hbWUoXCJ4dWktcGFnZXJfX2l0ZW1zLXNob3duXCIpKS5nZXQoMCk7XG4gICAgICAgIGF3YWl0IGl0ZW1zU2hvd25FbGVtLmNsaWNrKCk7XG5cbiAgICAgICAgY29uc3QgZHJvcGRvd25FbGVtZW50ID0gYXdhaXQgc3VwZXIuZ2V0RWxlbWVudCgpXG4gICAgICAgICAgICAgICAgLmFsbChieS5jc3MoXCIueHVpLXBhZ2VyX19pbmZvICpbdWliLWRyb3Bkb3duXVwiKSkuZ2V0KDApO1xuICAgICAgICByZXR1cm4gYXdhaXQgQXRvbS5oYXNDbGFzcyhkcm9wZG93bkVsZW1lbnQsIFwiZHJvcHVwXCIpO1xuICAgIH07XG5cbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
