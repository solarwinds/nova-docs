"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const protractor = require("@solarwinds/uzi/protractor");
const protractor_1 = require("@solarwinds/uzi/protractor");
const helpers_1 = require("../helpers");
const index_atom_1 = require("../index.atom");
const uzi_1 = require("@solarwinds/uzi");
describe("USERCONTROL search", () => {
    const expectedCount = 3, expectedPromiseDelay = 1000;
    let atom;
    let wasSearched;
    let inputChanged;
    let searchFinished;
    let searchCancelled;
    beforeEach(() => {
        helpers_1.default.prepareBrowser("search");
        atom = uzi_1.Atom.find(index_atom_1.SearchAtom, "searchTest");
        wasSearched = uzi_1.Atom.find(index_atom_1.CheckboxAtom, "wasSearched");
        inputChanged = uzi_1.Atom.find(index_atom_1.CheckboxAtom, "inputChanged");
        searchFinished = uzi_1.Atom.find(index_atom_1.CheckboxAtom, "searchFinished");
        searchCancelled = uzi_1.Atom.find(index_atom_1.CheckboxAtom, "searchCancelled");
    });
    it("should show no suggestions by default ", () => {
        expect(atom.areSuggestionsDisplayed()).toBe(false);
    });
    it("should show suggestions", () => {
        atom.acceptInput("item");
        expect(atom.areSuggestionsDisplayed()).toBe(true);
        expect(atom.getSuggestions().count()).toBe(expectedCount);
    });
    it("should select correct suggestion", () => {
        atom.acceptInput("item");
        let suggestion = atom.getSuggestionLink(2);
        suggestion.getText().then((text) => {
            suggestion.click();
            expect(atom.getValueAttr()).toEqual(text);
        });
    });
    it("should search when search button clicked", () => {
        expect(wasSearched.isChecked()).toBe(false);
        atom.acceptInput("item");
        atom.getSearchButton().click();
        expect(wasSearched.isChecked()).toBe(true);
        protractor_1.browser.sleep(expectedPromiseDelay);
        expect(searchFinished.isChecked()).toBe(true);
    });
    it("should cancel search when cancel clicked", () => {
        expect(wasSearched.isChecked()).toBe(false);
        atom.acceptInput("item");
        atom.getSearchButton().click();
        expect(wasSearched.isChecked()).toBe(true);
        atom.getCancelButton().click();
        protractor_1.browser.sleep(expectedPromiseDelay);
        expect(searchCancelled.isChecked()).toBe(true);
        expect(searchFinished.isChecked()).toBe(false);
    });
    it("should cancel search when input changes", () => {
        expect(wasSearched.isChecked()).toBe(false);
        atom.acceptInput("item");
        atom.getSearchButton().click();
        expect(wasSearched.isChecked()).toBe(true);
        atom.acceptInput(" 999");
        protractor_1.browser.sleep(expectedPromiseDelay);
        expect(searchCancelled.isChecked()).toBe(true);
        expect(searchFinished.isChecked()).toBe(false);
    });
    it("should search when suggestion selected", () => {
        expect(wasSearched.isChecked()).toBe(false);
        atom.acceptInput("item");
        let suggestion = atom.getSuggestionLink(2);
        suggestion.click();
        expect(wasSearched.isChecked()).toBe(true);
        protractor_1.browser.sleep(expectedPromiseDelay);
        expect(searchFinished.isChecked()).toBe(true);
    });
    it("should evaluate onChange when input changes", () => {
        expect(inputChanged.isChecked()).toBe(false);
        atom.acceptInput("item");
        expect(inputChanged.isChecked()).toBe(true);
    });
    it("should evaluate onChange when clear clicked", () => {
        expect(inputChanged.isChecked()).toBe(false);
        atom.acceptInput("clear test");
        expect(inputChanged.isChecked()).toBe(true);
        inputChanged.click();
        expect(inputChanged.isChecked()).toBe(false);
        atom.getCancelButton().click();
        expect(inputChanged.isChecked()).toBe(true);
    });
    it("should search when enter key press", () => {
        expect(wasSearched.isChecked()).toBe(false);
        atom.acceptInput("item" + protractor.Key.ENTER);
        expect(wasSearched.isChecked()).toBe(true);
        protractor_1.browser.sleep(expectedPromiseDelay);
        expect(searchFinished.isChecked()).toBe(true);
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvc2VhcmNoL3NlYXJjaC5lMmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSx5REFBeUQ7QUFDekQsMkRBQTREO0FBQzVELHdDQUFpQztBQUNqQyw4Q0FBdUQ7QUFDdkQseUNBQXFDO0FBRXJDLFFBQVEsQ0FBQyxvQkFBb0IsRUFBRSxHQUFHLEVBQUU7SUFDaEMsTUFBTSxhQUFhLEdBQUcsQ0FBQyxFQUNuQixvQkFBb0IsR0FBRyxJQUFJLENBQUM7SUFDaEMsSUFBSSxJQUFnQixDQUFDO0lBQ3JCLElBQUksV0FBeUIsQ0FBQztJQUM5QixJQUFJLFlBQTBCLENBQUM7SUFDL0IsSUFBSSxjQUE0QixDQUFDO0lBQ2pDLElBQUksZUFBNkIsQ0FBQztJQUVsQyxVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ1osaUJBQU8sQ0FBQyxjQUFjLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDakMsSUFBSSxHQUFHLFVBQUksQ0FBQyxJQUFJLENBQUMsdUJBQVUsRUFBRSxZQUFZLENBQUMsQ0FBQztRQUMzQyxXQUFXLEdBQUcsVUFBSSxDQUFDLElBQUksQ0FBQyx5QkFBWSxFQUFFLGFBQWEsQ0FBQyxDQUFDO1FBQ3JELFlBQVksR0FBRyxVQUFJLENBQUMsSUFBSSxDQUFDLHlCQUFZLEVBQUUsY0FBYyxDQUFDLENBQUM7UUFDdkQsY0FBYyxHQUFHLFVBQUksQ0FBQyxJQUFJLENBQUMseUJBQVksRUFBRSxnQkFBZ0IsQ0FBQyxDQUFDO1FBQzNELGVBQWUsR0FBRyxVQUFJLENBQUMsSUFBSSxDQUFDLHlCQUFZLEVBQUUsaUJBQWlCLENBQUMsQ0FBQztJQUNqRSxDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyx3Q0FBd0MsRUFBRSxHQUFHLEVBQUU7UUFDOUMsTUFBTSxDQUFDLElBQUksQ0FBQyx1QkFBdUIsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3ZELENBQUMsQ0FBQyxDQUFDO0lBRUgsRUFBRSxDQUFDLHlC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aC5lMmUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBwcm90cmFjdG9yIGZyb20gXCJAc29sYXJ3aW5kcy91emkvcHJvdHJhY3RvclwiO1xuaW1wb3J0IHticm93c2VyLCBwcm9taXNlfSBmcm9tIFwiQHNvbGFyd2luZHMvdXppL3Byb3RyYWN0b3JcIjtcbmltcG9ydCBIZWxwZXJzIGZyb20gXCIuLi9oZWxwZXJzXCI7XG5pbXBvcnQge0NoZWNrYm94QXRvbSwgU2VhcmNoQXRvbX0gZnJvbSBcIi4uL2luZGV4LmF0b21cIjtcbmltcG9ydCB7QXRvbX0gZnJvbSBcIkBzb2xhcndpbmRzL3V6aVwiO1xuXG5kZXNjcmliZShcIlVTRVJDT05UUk9MIHNlYXJjaFwiLCAoKSA9PiB7XG4gICAgY29uc3QgZXhwZWN0ZWRDb3VudCA9IDMsXG4gICAgICAgIGV4cGVjdGVkUHJvbWlzZURlbGF5ID0gMTAwMDtcbiAgICBsZXQgYXRvbTogU2VhcmNoQXRvbTtcbiAgICBsZXQgd2FzU2VhcmNoZWQ6IENoZWNrYm94QXRvbTtcbiAgICBsZXQgaW5wdXRDaGFuZ2VkOiBDaGVja2JveEF0b207XG4gICAgbGV0IHNlYXJjaEZpbmlzaGVkOiBDaGVja2JveEF0b207XG4gICAgbGV0IHNlYXJjaENhbmNlbGxlZDogQ2hlY2tib3hBdG9tO1xuXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICAgIEhlbHBlcnMucHJlcGFyZUJyb3dzZXIoXCJzZWFyY2hcIik7XG4gICAgICAgIGF0b20gPSBBdG9tLmZpbmQoU2VhcmNoQXRvbSwgXCJzZWFyY2hUZXN0XCIpO1xuICAgICAgICB3YXNTZWFyY2hlZCA9IEF0b20uZmluZChDaGVja2JveEF0b20sIFwid2FzU2VhcmNoZWRcIik7XG4gICAgICAgIGlucHV0Q2hhbmdlZCA9IEF0b20uZmluZChDaGVja2JveEF0b20sIFwiaW5wdXRDaGFuZ2VkXCIpO1xuICAgICAgICBzZWFyY2hGaW5pc2hlZCA9IEF0b20uZmluZChDaGVja2JveEF0b20sIFwic2VhcmNoRmluaXNoZWRcIik7XG4gICAgICAgIHNlYXJjaENhbmNlbGxlZCA9IEF0b20uZmluZChDaGVja2JveEF0b20sIFwic2VhcmNoQ2FuY2VsbGVkXCIpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJzaG91bGQgc2hvdyBubyBzdWdnZXN0aW9ucyBieSBkZWZhdWx0IFwiLCAoKSA9PiB7XG4gICAgICAgIGV4cGVjdChhdG9tLmFyZVN1Z2dlc3Rpb25zRGlzcGxheWVkKCkpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJzaG91bGQgc2hvdyBzdWdnZXN0aW9uc1wiLCAoKSA9PiB7XG4gICAgICAgIGF0b20uYWNjZXB0SW5wdXQoXCJpdGVtXCIpO1xuICAgICAgICBleHBlY3QoYXRvbS5hcmVTdWdnZXN0aW9uc0Rpc3BsYXllZCgpKS50b0JlKHRydWUpO1xuICAgICAgICBleHBlY3QoYXRvbS5nZXRTdWdnZXN0aW9ucygpLmNvdW50KCkpLnRvQmUoZXhwZWN0ZWRDb3VudCk7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCBzZWxlY3QgY29ycmVjdCBzdWdnZXN0aW9uXCIsICgpID0+IHtcbiAgICAgICAgYXRvbS5hY2NlcHRJbnB1dChcIml0ZW1cIik7XG4gICAgICAgIGxldCBzdWdnZXN0aW9uID0gYXRvbS5nZXRTdWdnZXN0aW9uTGluaygyKTtcbiAgICAgICAgc3VnZ2VzdGlvbi5nZXRUZXh0KCkudGhlbigodGV4dCkgPT4ge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbi5jbGljaygpO1xuICAgICAgICAgICAgZXhwZWN0KGF0b20uZ2V0VmFsdWVBdHRyKCkpLnRvRXF1YWwodGV4dCk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoXCJzaG91bGQgc2VhcmNoIHdoZW4gc2VhcmNoIGJ1dHRvbiBjbGlja2VkXCIsICgpID0+IHtcbiAgICAgICAgZXhwZWN0KHdhc1NlYXJjaGVkLmlzQ2hlY2tlZCgpKS50b0JlKGZhbHNlKTtcbiAgICAgICAgYXRvbS5hY2NlcHRJbnB1dChcIml0ZW1cIik7XG4gICAgICAgIGF0b20uZ2V0U2VhcmNoQnV0dG9uKCkuY2xpY2soKTtcbiAgICAgICAgZXhwZWN0KHdhc1NlYXJjaGVkLmlzQ2hlY2tlZCgpKS50b0JlKHRydWUpO1xuXG4gICAgICAgIGJyb3dzZXIuc2xlZXAoZXhwZWN0ZWRQcm9taXNlRGVsYXkpO1xuXG4gICAgICAgIGV4cGVjdChzZWFyY2hGaW5pc2hlZC5pc0NoZWNrZWQoKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIGNhbmNlbCBzZWFyY2ggd2hlbiBjYW5jZWwgY2xpY2tlZFwiLCAoKSA9PiB7XG4gICAgICAgIGV4cGVjdCh3YXNTZWFyY2hlZC5pc0NoZWNrZWQoKSkudG9CZShmYWxzZSk7XG4gICAgICAgIGF0b20uYWNjZXB0SW5wdXQoXCJpdGVtXCIpO1xuICAgICAgICBhdG9tLmdldFNlYXJjaEJ1dHRvbigpLmNsaWNrKCk7XG4gICAgICAgIGV4cGVjdCh3YXNTZWFyY2hlZC5pc0NoZWNrZWQoKSkudG9CZSh0cnVlKTtcblxuICAgICAgICBhdG9tLmdldENhbmNlbEJ1dHRvbigpLmNsaWNrKCk7XG4gICAgICAgIGJyb3dzZXIuc2xlZXAoZXhwZWN0ZWRQcm9taXNlRGVsYXkpO1xuXG4gICAgICAgIGV4cGVjdChzZWFyY2hDYW5jZWxsZWQuaXNDaGVja2VkKCkpLnRvQmUodHJ1ZSk7XG4gICAgICAgIGV4cGVjdChzZWFyY2hGaW5pc2hlZC5pc0NoZWNrZWQoKSkudG9CZShmYWxzZSk7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCBjYW5jZWwgc2VhcmNoIHdoZW4gaW5wdXQgY2hhbmdlc1wiLCAoKSA9PiB7XG4gICAgICAgIGV4cGVjdCh3YXNTZWFyY2hlZC5pc0NoZWNrZWQoKSkudG9CZShmYWxzZSk7XG4gICAgICAgIGF0b20uYWNjZXB0SW5wdXQoXCJpdGVtXCIpO1xuICAgICAgICBhdG9tLmdldFNlYXJjaEJ1dHRvbigpLmNsaWNrKCk7XG4gICAgICAgIGV4cGVjdCh3YXNTZWFyY2hlZC5pc0NoZWNrZWQoKSkudG9CZSh0cnVlKTtcblxuICAgICAgICBhdG9tLmFjY2VwdElucHV0KFwiIDk5OVwiKTtcbiAgICAgICAgYnJvd3Nlci5zbGVlcChleHBlY3RlZFByb21pc2VEZWxheSk7XG5cbiAgICAgICAgZXhwZWN0KHNlYXJjaENhbmNlbGxlZC5pc0NoZWNrZWQoKSkudG9CZSh0cnVlKTtcbiAgICAgICAgZXhwZWN0KHNlYXJjaEZpbmlzaGVkLmlzQ2hlY2tlZCgpKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIHNlYXJjaCB3aGVuIHN1Z2dlc3Rpb24gc2VsZWN0ZWRcIiwgKCkgPT4ge1xuICAgICAgICBleHBlY3Qod2FzU2VhcmNoZWQuaXNDaGVja2VkKCkpLnRvQmUoZmFsc2UpO1xuICAgICAgICBhdG9tLmFjY2VwdElucHV0KFwiaXRlbVwiKTtcbiAgICAgICAgbGV0IHN1Z2dlc3Rpb24gPSBhdG9tLmdldFN1Z2dlc3Rpb25MaW5rKDIpO1xuICAgICAgICBzdWdnZXN0aW9uLmNsaWNrKCk7XG5cbiAgICAgICAgZXhwZWN0KHdhc1NlYXJjaGVkLmlzQ2hlY2tlZCgpKS50b0JlKHRydWUpO1xuXG4gICAgICAgIGJyb3dzZXIuc2xlZXAoZXhwZWN0ZWRQcm9taXNlRGVsYXkpO1xuXG4gICAgICAgIGV4cGVjdChzZWFyY2hGaW5pc2hlZC5pc0NoZWNrZWQoKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIGV2YWx1YXRlIG9uQ2hhbmdlIHdoZW4gaW5wdXQgY2hhbmdlc1wiLCAoKSA9PiB7XG4gICAgICAgIGV4cGVjdChpbnB1dENoYW5nZWQuaXNDaGVja2VkKCkpLnRvQmUoZmFsc2UpO1xuICAgICAgICBhdG9tLmFjY2VwdElucHV0KFwiaXRlbVwiKTtcbiAgICAgICAgZXhwZWN0KGlucHV0Q2hhbmdlZC5pc0NoZWNrZWQoKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIGV2YWx1YXRlIG9uQ2hhbmdlIHdoZW4gY2xlYXIgY2xpY2tlZFwiLCAoKSA9PiB7XG4gICAgICAgIGV4cGVjdChpbnB1dENoYW5nZWQuaXNDaGVja2VkKCkpLnRvQmUoZmFsc2UpO1xuICAgICAgICBhdG9tLmFjY2VwdElucHV0KFwiY2xlYXIgdGVzdFwiKTtcbiAgICAgICAgZXhwZWN0KGlucHV0Q2hhbmdlZC5pc0NoZWNrZWQoKSkudG9CZSh0cnVlKTtcbiAgICAgICAgaW5wdXRDaGFuZ2VkLmNsaWNrKCk7XG4gICAgICAgIGV4cGVjdChpbnB1dENoYW5nZWQuaXNDaGVja2VkKCkpLnRvQmUoZmFsc2UpO1xuICAgICAgICBhdG9tLmdldENhbmNlbEJ1dHRvbigpLmNsaWNrKCk7XG4gICAgICAgIGV4cGVjdChpbnB1dENoYW5nZWQuaXNDaGVja2VkKCkpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCBzZWFyY2ggd2hlbiBlbnRlciBrZXkgcHJlc3NcIiwgKCkgPT4ge1xuICAgICAgICBleHBlY3Qod2FzU2VhcmNoZWQuaXNDaGVja2VkKCkpLnRvQmUoZmFsc2UpO1xuICAgICAgICBhdG9tLmFjY2VwdElucHV0KFwiaXRlbVwiICsgcHJvdHJhY3Rvci5LZXkuRU5URVIpO1xuXG4gICAgICAgIGV4cGVjdCh3YXNTZWFyY2hlZC5pc0NoZWNrZWQoKSkudG9CZSh0cnVlKTtcblxuICAgICAgICBicm93c2VyLnNsZWVwKGV4cGVjdGVkUHJvbWlzZURlbGF5KTtcblxuICAgICAgICBleHBlY3Qoc2VhcmNoRmluaXNoZWQuaXNDaGVja2VkKCkpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG59KTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
