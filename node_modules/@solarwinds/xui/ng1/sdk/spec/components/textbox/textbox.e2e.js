"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const protractor_1 = require("@solarwinds/uzi/protractor");
const helpers_1 = require("../helpers");
const index_atom_1 = require("../index.atom");
const uzi_1 = require("@solarwinds/uzi");
describe("E2E USERCONTROL textbox", () => {
    beforeEach(() => {
        helpers_1.default.prepareBrowser("textbox");
    });
    it("should reject bad email", () => {
        const atom = uzi_1.Atom.find(index_atom_1.TextboxAtom, "validEmailTextboxMock");
        const validatorName = "email";
        expect(atom.isValid()).toBe(true);
        expect(atom.getValidationMessagesCount()).toBe(0);
        expect(atom.getValidationMessage(validatorName)).toBeUndefined();
        atom.acceptText("bad email");
        expect(atom.isValid()).toBe(false);
        expect(atom.getValidationMessagesCount()).toBe(1);
        expect(atom.getValidationMessage(validatorName)).toBe("This field must be a valid email address");
    });
    it("should use custom validator", () => {
        let atom = uzi_1.Atom.find(index_atom_1.TextboxAtom, "customStringValidatorMock");
        //make sure the box is empty, should trigger validation
        const validatorName = "customstringvalidator1";
        atom.acceptText("no f00");
        expect(index_atom_1.TextboxAtom.isFormValidWith(validatorName)).toBe(false);
        atom.clearText();
        expect(index_atom_1.TextboxAtom.isFormValidWith(validatorName)).toBe(false);
        atom.acceptText(" this contains the string foo in it");
        expect(index_atom_1.TextboxAtom.isFormValidWith(validatorName)).toBe(true);
    });
    it("should use numeric validator", () => {
        let atom = uzi_1.Atom.find(index_atom_1.TextboxAtom, "numberTextboxValidationMock");
        const requiredValidator = "required";
        atom.clearText();
        expect(index_atom_1.TextboxAtom.isFormValidWith(requiredValidator)).toBe(false);
        const maxValidator = "max";
        atom.acceptText("3");
        expect(index_atom_1.TextboxAtom.isFormValidWith(maxValidator)).toBe(true);
        atom.acceptText("127");
        expect(index_atom_1.TextboxAtom.isFormValidWith(maxValidator)).toBe(false);
    });
    it("should validate numbers on change (not on blur) UIF-1353", () => {
        let atom = uzi_1.Atom.find(index_atom_1.TextboxAtom, "numberTextboxValidationMock");
        const maxValidator = "max";
        const inputBox = atom.getInput();
        expect(index_atom_1.TextboxAtom.isFormValidWith(maxValidator)).toBe(true);
        inputBox.sendKeys("0"); //changing 42 -> 420; no enter key pushed
        expect(index_atom_1.TextboxAtom.isFormValidWith(maxValidator)).toBe(false);
    });
    it("should not clear text on validation fail UIF-1353", () => {
        let atom = uzi_1.Atom.find(index_atom_1.TextboxAtom, "validEmailTextboxMock");
        const validatorName = "email";
        const inputBox = atom.getInput();
        inputBox.sendKeys("bob@msn"); //this should pass validation
        expect(index_atom_1.TextboxAtom.isFormValidWith(validatorName)).toBe(true);
        inputBox.sendKeys("."); //this creates an invalid address
        expect(index_atom_1.TextboxAtom.isFormValidWith(validatorName)).toBe(false);
        expect(atom.getText()).toBe("bob@msn.");
        inputBox.sendKeys("com"); //final correct adddress
        expect(index_atom_1.TextboxAtom.isFormValidWith(validatorName)).toBe(true);
        expect(atom.getText()).toBe("bob@msn.com");
    });
    it("should not have blank space with no caption UIF-1539", () => {
        const totalDirective = protractor_1.element(protractor_1.by.id("thinTextBox"));
        totalDirective.getSize().then((directiveDimensions) => {
            //Spec defines text box height as 30 px
            expect(directiveDimensions.height).toBeLessThan(31);
        });
    });
    it("can programatically switch is-disabled UIF-1668", () => {
        const atom = uzi_1.Atom.find(index_atom_1.TextboxAtom, "disabledTextBox");
        const inputBox = atom.getInput();
        expect(inputBox.isEnabled()).toBe(true);
        const button = protractor_1.element(protractor_1.by.css("[id*='disableButton']"));
        button.click();
        expect(inputBox.isEnabled()).toBe(false);
    });
    it("will display async warning UIF-1675", () => {
        const atom = uzi_1.Atom.find(index_atom_1.TextboxAtom, "asyncWarningValidatorMock");
        const inputBox = atom.getInput();
        inputBox.sendKeys("x");
        expect(atom.isInWarningState()).toBe(true);
        inputBox.sendKeys("foo");
        expect(atom.isInWarningState()).toBe(false);
    });
    it("numeric up button will increase the value", () => {
        const atom = uzi_1.Atom.find(index_atom_1.TextboxAtom, "numericTextBox");
        const inputBox = atom.getInput();
        const upButton = atom.getNumericUpButton();
        upButton.click();
        expect(atom.getText()).toBe("1");
        upButton.click();
        expect(atom.getText()).toBe("2");
    });
    it("numeric down button will decrease the value", () => {
        const atom = uzi_1.Atom.find(index_atom_1.TextboxAtom, "numericTextBox");
        const inputBox = atom.getInput();
        const downButton = atom.getNumericDownButton();
        downButton.click();
        expect(atom.getText()).toBe("-1");
        downButton.click();
        expect(atom.getText()).toBe("-2");
    });
    it("buttons will fire validation", () => {
        let atom = uzi_1.Atom.find(index_atom_1.TextboxAtom, "numericTextBoxValidation");
        const upButton = atom.getNumericUpButton();
        const maxValidator = "max";
        upButton.click(); //1
        expect(index_atom_1.TextboxAtom.isFormValidWith(maxValidator)).toBe(true);
        upButton.click(); //2
        upButton.click(); //3
        expect(index_atom_1.TextboxAtom.isFormValidWith(maxValidator)).toBe(false);
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvdGV4dGJveC90ZXh0Ym94LmUyZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLDJEQUFnRTtBQUNoRSx3Q0FBaUM7QUFDakMsOENBQTBDO0FBQzFDLHlDQUFxQztBQUVyQyxRQUFRLENBQUMseUJBQXlCLEVBQUUsR0FBRyxFQUFFO0lBQ3JDLFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDWixpQkFBTyxDQUFDLGNBQWMsQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUN0QyxDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyx5QkFBeUIsRUFBRSxHQUFHLEVBQUU7UUFDL0IsTUFBTSxJQUFJLEdBQUcsVUFBSSxDQUFDLElBQUksQ0FBQyx3QkFBVyxFQUFFLHVCQUF1QixDQUFDLENBQUM7UUFDN0QsTUFBTSxhQUFhLEdBQUcsT0FBTyxDQUFDO1FBRTlCLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDbEMsTUFBTSxDQUFDLElBQUksQ0FBQywwQkFBMEIsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2xELE1BQU0sQ0FBQyxJQUFJLENBQUMsb0JBQW9CLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUVqRSxJQUFJLENBQUMsVUFBVSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1FBRTdCLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDbkMsTUFBTSxDQUFDLElBQUksQ0FBQywwQkFBMEIsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2xELE1BQU0sQ0FBQyxJQUFJLENBQUMsb0JBQW9CLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsMENBQTBDLENBQUMsQ0FBQztJQUN0RyxDQUFDLENB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QUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUM3RCxRQUFRLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxHQUFHO1FBQ3JCLFFBQVEsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLEdBQUc7UUFDckIsTUFBTSxDQUFDLHdCQUFXLENBQUMsZUFBZSxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ2xFLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQyxDQUFDLENBQUMiLCJmaWxlIjoiY29tcG9uZW50cy90ZXh0Ym94L3RleHRib3guZTJlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtieSwgZWxlbWVudCwgcHJvbWlzZX0gZnJvbSBcIkBzb2xhcndpbmRzL3V6aS9wcm90cmFjdG9yXCI7XG5pbXBvcnQgSGVscGVycyBmcm9tIFwiLi4vaGVscGVyc1wiO1xuaW1wb3J0IHtUZXh0Ym94QXRvbX0gZnJvbSBcIi4uL2luZGV4LmF0b21cIjtcbmltcG9ydCB7QXRvbX0gZnJvbSBcIkBzb2xhcndpbmRzL3V6aVwiO1xuXG5kZXNjcmliZShcIkUyRSBVU0VSQ09OVFJPTCB0ZXh0Ym94XCIsICgpID0+IHtcbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgICAgSGVscGVycy5wcmVwYXJlQnJvd3NlcihcInRleHRib3hcIik7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCByZWplY3QgYmFkIGVtYWlsXCIsICgpID0+IHtcbiAgICAgICAgY29uc3QgYXRvbSA9IEF0b20uZmluZChUZXh0Ym94QXRvbSwgXCJ2YWxpZEVtYWlsVGV4dGJveE1vY2tcIik7XG4gICAgICAgIGNvbnN0IHZhbGlkYXRvck5hbWUgPSBcImVtYWlsXCI7XG5cbiAgICAgICAgZXhwZWN0KGF0b20uaXNWYWxpZCgpKS50b0JlKHRydWUpO1xuICAgICAgICBleHBlY3QoYXRvbS5nZXRWYWxpZGF0aW9uTWVzc2FnZXNDb3VudCgpKS50b0JlKDApO1xuICAgICAgICBleHBlY3QoYXRvbS5nZXRWYWxpZGF0aW9uTWVzc2FnZSh2YWxpZGF0b3JOYW1lKSkudG9CZVVuZGVmaW5lZCgpO1xuXG4gICAgICAgIGF0b20uYWNjZXB0VGV4dChcImJhZCBlbWFpbFwiKTtcblxuICAgICAgICBleHBlY3QoYXRvbS5pc1ZhbGlkKCkpLnRvQmUoZmFsc2UpO1xuICAgICAgICBleHBlY3QoYXRvbS5nZXRWYWxpZGF0aW9uTWVzc2FnZXNDb3VudCgpKS50b0JlKDEpO1xuICAgICAgICBleHBlY3QoYXRvbS5nZXRWYWxpZGF0aW9uTWVzc2FnZSh2YWxpZGF0b3JOYW1lKSkudG9CZShcIlRoaXMgZmllbGQgbXVzdCBiZSBhIHZhbGlkIGVtYWlsIGFkZHJlc3NcIik7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCB1c2UgY3VzdG9tIHZhbGlkYXRvclwiLCAoKSA9PiB7XG4gICAgICAgIGxldCBhdG9tID0gQXRvbS5maW5kKFRleHRib3hBdG9tLCBcImN1c3RvbVN0cmluZ1ZhbGlkYXRvck1vY2tcIik7XG5cbiAgICAgICAgLy9tYWtlIHN1cmUgdGhlIGJveCBpcyBlbXB0eSwgc2hvdWxkIHRyaWdnZXIgdmFsaWRhdGlvblxuICAgICAgICBjb25zdCB2YWxpZGF0b3JOYW1lID0gXCJjdXN0b21zdHJpbmd2YWxpZGF0b3IxXCI7XG4gICAgICAgIGF0b20uYWNjZXB0VGV4dChcIm5vIGYwMFwiKTtcbiAgICAgICAgZXhwZWN0KFRleHRib3hBdG9tLmlzRm9ybVZhbGlkV2l0aCh2YWxpZGF0b3JOYW1lKSkudG9CZShmYWxzZSk7XG5cbiAgICAgICAgYXRvbS5jbGVhclRleHQoKTtcbiAgICAgICAgZXhwZWN0KFRleHRib3hBdG9tLmlzRm9ybVZhbGlkV2l0aCh2YWxpZGF0b3JOYW1lKSkudG9CZShmYWxzZSk7XG5cbiAgICAgICAgYXRvbS5hY2NlcHRUZXh0KFwiIHRoaXMgY29udGFpbnMgdGhlIHN0cmluZyBmb28gaW4gaXRcIik7XG4gICAgICAgIGV4cGVjdChUZXh0Ym94QXRvbS5pc0Zvcm1WYWxpZFdpdGgodmFsaWRhdG9yTmFtZSkpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCB1c2UgbnVtZXJpYyB2YWxpZGF0b3JcIiwgKCkgPT4ge1xuICAgICAgICBsZXQgYXRvbSA9IEF0b20uZmluZChUZXh0Ym94QXRvbSwgXCJudW1iZXJUZXh0Ym94VmFsaWRhdGlvbk1vY2tcIik7XG5cbiAgICAgICAgY29uc3QgcmVxdWlyZWRWYWxpZGF0b3IgPSBcInJlcXVpcmVkXCI7XG4gICAgICAgIGF0b20uY2xlYXJUZXh0KCk7XG4gICAgICAgIGV4cGVjdChUZXh0Ym94QXRvbS5pc0Zvcm1WYWxpZFdpdGgocmVxdWlyZWRWYWxpZGF0b3IpKS50b0JlKGZhbHNlKTtcblxuICAgICAgICBjb25zdCBtYXhWYWxpZGF0b3IgPSBcIm1heFwiO1xuICAgICAgICBhdG9tLmFjY2VwdFRleHQoXCIzXCIpO1xuICAgICAgICBleHBlY3QoVGV4dGJveEF0b20uaXNGb3JtVmFsaWRXaXRoKG1heFZhbGlkYXRvcikpLnRvQmUodHJ1ZSk7XG5cbiAgICAgICAgYXRvbS5hY2NlcHRUZXh0KFwiMTI3XCIpO1xuICAgICAgICBleHBlY3QoVGV4dGJveEF0b20uaXNGb3JtVmFsaWRXaXRoKG1heFZhbGlkYXRvcikpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJzaG91bGQgdmFsaWRhdGUgbnVtYmVycyBvbiBjaGFuZ2UgKG5vdCBvbiBibHVyKSBVSUYtMTM1M1wiLCAoKSA9PiB7XG4gICAgICAgIGxldCBhdG9tID0gQXRvbS5maW5kKFRleHRib3hBdG9tLCBcIm51bWJlclRleHRib3hWYWxpZGF0aW9uTW9ja1wiKTtcbiAgICAgICAgY29uc3QgbWF4VmFsaWRhdG9yID0gXCJtYXhcIjtcbiAgICAgICAgY29uc3QgaW5wdXRCb3ggPSBhdG9tLmdldElucHV0KCk7XG4gICAgICAgIGV4cGVjdChUZXh0Ym94QXRvbS5pc0Zvcm1WYWxpZFdpdGgobWF4VmFsaWRhdG9yKSkudG9CZSh0cnVlKTtcbiAgICAgICAgaW5wdXRCb3guc2VuZEtleXMoXCIwXCIpOyAvL2NoYW5naW5nIDQyIC0+IDQyMDsgbm8gZW50ZXIga2V5IHB1c2hlZFxuICAgICAgICBleHBlY3QoVGV4dGJveEF0b20uaXNGb3JtVmFsaWRXaXRoKG1heFZhbGlkYXRvcikpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJzaG91bGQgbm90IGNsZWFyIHRleHQgb24gdmFsaWRhdGlvbiBmYWlsIFVJRi0xMzUzXCIsICgpID0+IHtcbiAgICAgICAgbGV0IGF0b20gPSBBdG9tLmZpbmQoVGV4dGJveEF0b20sIFwidmFsaWRFbWFpbFRleHRib3hNb2NrXCIpO1xuICAgICAgICBjb25zdCB2YWxpZGF0b3JOYW1lID0gXCJlbWFpbFwiO1xuICAgICAgICBjb25zdCBpbnB1dEJveCA9IGF0b20uZ2V0SW5wdXQoKTtcbiAgICAgICAgaW5wdXRCb3guc2VuZEtleXMoXCJib2JAbXNuXCIpOyAvL3RoaXMgc2hvdWxkIHBhc3MgdmFsaWRhdGlvblxuICAgICAgICBleHBlY3QoVGV4dGJveEF0b20uaXNGb3JtVmFsaWRXaXRoKHZhbGlkYXRvck5hbWUpKS50b0JlKHRydWUpO1xuICAgICAgICBpbnB1dEJveC5zZW5kS2V5cyhcIi5cIik7IC8vdGhpcyBjcmVhdGVzIGFuIGludmFsaWQgYWRkcmVzc1xuICAgICAgICBleHBlY3QoVGV4dGJveEF0b20uaXNGb3JtVmFsaWRXaXRoKHZhbGlkYXRvck5hbWUpKS50b0JlKGZhbHNlKTtcbiAgICAgICAgZXhwZWN0KGF0b20uZ2V0VGV4dCgpKS50b0JlKFwiYm9iQG1zbi5cIik7XG4gICAgICAgIGlucHV0Qm94LnNlbmRLZXlzKFwiY29tXCIpOyAvL2ZpbmFsIGNvcnJlY3QgYWRkZHJlc3NcbiAgICAgICAgZXhwZWN0KFRleHRib3hBdG9tLmlzRm9ybVZhbGlkV2l0aCh2YWxpZGF0b3JOYW1lKSkudG9CZSh0cnVlKTtcbiAgICAgICAgZXhwZWN0KGF0b20uZ2V0VGV4dCgpKS50b0JlKFwiYm9iQG1zbi5jb21cIik7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCBub3QgaGF2ZSBibGFuayBzcGFjZSB3aXRoIG5vIGNhcHRpb24gVUlGLTE1MzlcIiwgKCkgPT4ge1xuICAgICAgICBjb25zdCB0b3RhbERpcmVjdGl2ZSA9IGVsZW1lbnQoYnkuaWQoXCJ0aGluVGV4dEJveFwiKSk7XG4gICAgICAgIHRvdGFsRGlyZWN0aXZlLmdldFNpemUoKS50aGVuKChkaXJlY3RpdmVEaW1lbnNpb25zKSA9PiB7XG4gICAgICAgICAgICAvL1NwZWMgZGVmaW5lcyB0ZXh0IGJveCBoZWlnaHQgYXMgMzAgcHhcbiAgICAgICAgICAgIGV4cGVjdChkaXJlY3RpdmVEaW1lbnNpb25zLmhlaWdodCkudG9CZUxlc3NUaGFuKDMxKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdChcImNhbiBwcm9ncmFtYXRpY2FsbHkgc3dpdGNoIGlzLWRpc2FibGVkIFVJRi0xNjY4XCIsICgpID0+IHtcbiAgICAgICAgY29uc3QgYXRvbSA9IEF0b20uZmluZChUZXh0Ym94QXRvbSwgXCJkaXNhYmxlZFRleHRCb3hcIik7XG4gICAgICAgIGNvbnN0IGlucHV0Qm94ID0gYXRvbS5nZXRJbnB1dCgpO1xuICAgICAgICBleHBlY3QoaW5wdXRCb3guaXNFbmFibGVkKCkpLnRvQmUodHJ1ZSk7XG5cbiAgICAgICAgY29uc3QgYnV0dG9uID0gZWxlbWVudChieS5jc3MoXCJbaWQqPSdkaXNhYmxlQnV0dG9uJ11cIikpO1xuICAgICAgICBidXR0b24uY2xpY2soKTtcbiAgICAgICAgZXhwZWN0KGlucHV0Qm94LmlzRW5hYmxlZCgpKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcblxuICAgIGl0KFwid2lsbCBkaXNwbGF5IGFzeW5jIHdhcm5pbmcgVUlGLTE2NzVcIiwgKCkgPT4ge1xuICAgICAgICBjb25zdCBhdG9tID0gQXRvbS5maW5kKFRleHRib3hBdG9tLCBcImFzeW5jV2FybmluZ1ZhbGlkYXRvck1vY2tcIik7XG4gICAgICAgIGNvbnN0IGlucHV0Qm94ID0gYXRvbS5nZXRJbnB1dCgpO1xuICAgICAgICBpbnB1dEJveC5zZW5kS2V5cyhcInhcIik7XG4gICAgICAgIGV4cGVjdChhdG9tLmlzSW5XYXJuaW5nU3RhdGUoKSkudG9CZSh0cnVlKTtcbiAgICAgICAgaW5wdXRCb3guc2VuZEtleXMoXCJmb29cIik7XG4gICAgICAgIGV4cGVjdChhdG9tLmlzSW5XYXJuaW5nU3RhdGUoKSkudG9CZShmYWxzZSk7XG4gICAgfSk7XG5cbiAgICBpdChcIm51bWVyaWMgdXAgYnV0dG9uIHdpbGwgaW5jcmVhc2UgdGhlIHZhbHVlXCIsICgpID0+IHtcbiAgICAgICAgY29uc3QgYXRvbSA9IEF0b20uZmluZChUZXh0Ym94QXRvbSwgXCJudW1lcmljVGV4dEJveFwiKTtcbiAgICAgICAgY29uc3QgaW5wdXRCb3ggPSBhdG9tLmdldElucHV0KCk7XG4gICAgICAgIGNvbnN0IHVwQnV0dG9uID0gYXRvbS5nZXROdW1lcmljVXBCdXR0b24oKTtcbiAgICAgICAgdXBCdXR0b24uY2xpY2soKTtcbiAgICAgICAgZXhwZWN0KGF0b20uZ2V0VGV4dCgpKS50b0JlKFwiMVwiKTtcbiAgICAgICAgdXBCdXR0b24uY2xpY2soKTtcbiAgICAgICAgZXhwZWN0KGF0b20uZ2V0VGV4dCgpKS50b0JlKFwiMlwiKTtcbiAgICB9KTtcblxuICAgIGl0KFwibnVtZXJpYyBkb3duIGJ1dHRvbiB3aWxsIGRlY3JlYXNlIHRoZSB2YWx1ZVwiLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGF0b20gPSBBdG9tLmZpbmQoVGV4dGJveEF0b20sIFwibnVtZXJpY1RleHRCb3hcIik7XG4gICAgICAgIGNvbnN0IGlucHV0Qm94ID0gYXRvbS5nZXRJbnB1dCgpO1xuICAgICAgICBjb25zdCBkb3duQnV0dG9uID0gYXRvbS5nZXROdW1lcmljRG93bkJ1dHRvbigpO1xuICAgICAgICBkb3duQnV0dG9uLmNsaWNrKCk7XG4gICAgICAgIGV4cGVjdChhdG9tLmdldFRleHQoKSkudG9CZShcIi0xXCIpO1xuICAgICAgICBkb3duQnV0dG9uLmNsaWNrKCk7XG4gICAgICAgIGV4cGVjdChhdG9tLmdldFRleHQoKSkudG9CZShcIi0yXCIpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJidXR0b25zIHdpbGwgZmlyZSB2YWxpZGF0aW9uXCIsICgpID0+IHtcbiAgICAgICAgbGV0IGF0b20gPSBBdG9tLmZpbmQoVGV4dGJveEF0b20sIFwibnVtZXJpY1RleHRCb3hWYWxpZGF0aW9uXCIpO1xuICAgICAgICBjb25zdCB1cEJ1dHRvbiA9IGF0b20uZ2V0TnVtZXJpY1VwQnV0dG9uKCk7XG5cbiAgICAgICAgY29uc3QgbWF4VmFsaWRhdG9yID0gXCJtYXhcIjtcbiAgICAgICAgdXBCdXR0b24uY2xpY2soKTsgLy8xXG4gICAgICAgIGV4cGVjdChUZXh0Ym94QXRvbS5pc0Zvcm1WYWxpZFdpdGgobWF4VmFsaWRhdG9yKSkudG9CZSh0cnVlKTtcbiAgICAgICAgdXBCdXR0b24uY2xpY2soKTsgLy8yXG4gICAgICAgIHVwQnV0dG9uLmNsaWNrKCk7IC8vM1xuICAgICAgICBleHBlY3QoVGV4dGJveEF0b20uaXNGb3JtVmFsaWRXaXRoKG1heFZhbGlkYXRvcikpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xufSk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
