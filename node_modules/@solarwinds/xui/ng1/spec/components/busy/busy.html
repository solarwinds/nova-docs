<div ng-controller="TestBusyController as vm" style="width:100vw; max-width:100%">
    <form>
        <div id="xuiBusyElement"
             xui-busy="vm.isBusy"
             xui-busy-message="{{ vm.busyMessage }}"
             xui-busy-on-cancel="vm.onCancel()">
            <xui-textbox ng-model="vm.firstName" caption="First Name" id="firstname"></xui-textbox>
            <xui-textbox ng-model="vm.lastName" caption="Last Name" id="lastname"></xui-textbox>
            <xui-textbox ng-model="vm.email" caption="Email" type="email"></xui-textbox>
            <xui-textbox ng-model="vm.phone" caption="Phone" type="phone"></xui-textbox>
        </div>
    </form>
    <xui-button name="saveButton" display-style="primary" is-busy="vm.isBusy" ng-click="vm.save()">Save</xui-button>
    <xui-divider></xui-divider>
    <form>
        <div id="xuiBusyElementNotes"
             xui-busy="vm.isBusyNotes"
             xui-busy-message="{{ vm.busyMessageNotes }}"
             xui-busy-on-cancel="vm.onCancelNotes()"
             xui-busy-show-progress="true"
             xui-busy-percent="{{vm.percent}}"
             xui-busy-help-text="{{vm.helpText}}">
            <xui-textbox ng-model="vm.notes" caption="Notes" rows="5" id="textarea"></xui-textbox>
        </div>
    </form>
    <xui-button name="saveButtonNotes"
                display-style="primary"
                is-busy="vm.isBusyNotes" ng-click="vm.saveNotes()">Save With Progress
    </xui-button>

    <xui-divider></xui-divider>
    <form>
        <div id="xui-demo-listview-single-selection" style="margin: 30px 0;">
            <div class="doc-color-row">
                <xui-button name="makeBusyButton" ng-click="vm.makeBusy()">Make Busy</xui-button>
                <xui-button name="makeIdleButton" ng-click="vm.makeIdle()">Make Idle</xui-button>
            </div>
            <div id="xuiListViewBusy"
                 style="display:flex; flex-direction:column; overflow:scroll; height:300px; padding:0 15px;"
                 xui-busy="vm.isLoadingPeople"
                 xui-busy-message="hang tight...adding new people."
                 xui-allow-cancel="false">
                <xui-listview stripe="true"
                              items-source="vm.people"
                              template-url="/demoPeopleTemplate.tpl"
                              selection-mode="single"
                              selection="vm.peopleSelection">
                </xui-listview>
            </div>
        </div>
    </form>
</div>

<script type="text/ng-template" id="/demoPeopleTemplate.tpl">
    <div class='xui-demo-components-listitem'>
        <div class='flex-row-container'>
            <xui-icon css-class='flex-row-item' icon='user'></xui-icon>
            <div class='flex-row-item flex-column-container'>
                <div class='name-item'>{{item.name}}</div>
                <div class='level ng-class:item.level;'>{{item.level}}</div>
                <div class='status-item'>{{item.status}}</div>
            </div>
        </div>
    </div>
</script>

<script type="text/javascript">
    (function () {
        "use strict";

        Xui.controller("TestBusyController", controller, []);
        function controller() {
            var vm = this;

            vm.busyMessage = "We're loading something very heavy...";
            vm.isBusy = false;

            vm.busyMessageNotes = "We're loading something very heavy...";
            vm.isBusyNotes = false;

            vm.people = [
                {name: "Jo Smith", level: "bronze", status: "active"},
                {name: "Claire Rogan", level: "gold", status: "active"},
                {name: "Declan McGregor", level: "platinum", status: "active"},
                {name: "Fergus O'Brien", level: "bronze", status: "inactive"},
                {name: "Catriona Kildare", level: "gold", status: "active"}
            ];
            vm.peopleSelection = vm.people[2];
            vm.isLoadingPeople = false;

            vm.save = function () {
                vm.isBusy = true;
                vm.helpText = "";
            };

            vm.onCancel = function () {
                vm.isBusy = false;
            };

            vm.saveNotes = function () {
                vm.isBusyNotes = true;
                vm.percent = 0;
                vm.helpText = "This won't take long...";
            };

            vm.onCancelNotes = function () {
                vm.isBusyNotes = false;
            };

            vm.makeBusy = function () {
                vm.isLoadingPeople = true;
            };

            vm.makeIdle = function () {
                vm.isLoadingPeople = false;
            };
        }
    })();
</script>
