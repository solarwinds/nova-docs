import {by, element, promise} from "@solarwinds/uzi/protractor";
import Helpers from "../helpers";
import {CheckboxAtom} from "../index.atom";
import {Atom} from "@solarwinds/uzi";

describe("USERCONTROL Checkbox", () => {
    let atom: CheckboxAtom;

    beforeEach(() => {
        Helpers.prepareBrowser("checkbox");
        atom = Atom.find(CheckboxAtom, "testElement");
    });

    describe("Value section:", () => {
        it("should check and uncheck when clicked", () => {
            expect(atom).toBeDefined();
            expect(atom.isChecked()).toBe(true);

            atom.click();
            expect(atom.isChecked()).toBe(false);

            atom.click();
            expect(atom.isChecked()).toBe(true);
        });

        it("should check and uncheck when the model changes", () => {
            expect(atom).toBeDefined();
            expect(atom.isChecked()).toBe(true);

            const toggle = element(by.id("valueToggle"));
            toggle.click();

            expect(atom.isChecked()).toBe(false);

            toggle.click();
            expect(atom.isChecked()).toBe(true);
        });
    });

    describe("Disable section:", () => {
        it("should disable and enable when the model changes", () => {
            expect(atom).toBeDefined();
            expect(atom.isDisabled()).toBe(false);

            const toggle = element(by.id("disableToggle"));
            toggle.click();

            expect(atom.isDisabled()).toBe(true);

            toggle.click();
            expect(atom.isDisabled()).toBe(false);
        });
    });

    describe("Attribute section:", () => {
        it("should have title based on 'title' attribute", () => {
            const label = atom.getLabel();
            expect(label.getAttribute("title")).toEqual("TITLE TEXT");
        });

        it("should use help text based 'help-text' attribute", () => {
            expect(atom.getHelpHintText()).toEqual("HELP TEXT");
        });

        it("should be required if 'require-text' is set", function () {
            expect(atom.isRequired()).toBe(true);
        });

        xit("should show validation message from 'require-text' attribute", function () {
            const text = atom.getValidationText();
            expect(text).toEqual("REQUIRED TEXT");
        });

        it("should set indeterminate value on script object from 'is-indeterminate' attribute", function () {
            expect(atom.isIndeterminate()).toEqual(true);
        });
    });

    describe("Content section:", () => {
        it("content should be transcluded", () => {
            expect(atom.getContent()).toEqual("INNER CONTENT");
        });
    });
});
