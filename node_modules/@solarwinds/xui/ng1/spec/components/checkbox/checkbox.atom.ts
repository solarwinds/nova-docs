import {by, ElementFinder, promise} from "@solarwinds/uzi/protractor";
import {Atom} from "@solarwinds/uzi";

export class CheckboxAtom extends Atom {
    public static CSS_CLASS = "xui-checkbox";

    constructor(element: ElementFinder) {
        super(element);
    }

    public getInputElement = () => {
        return super.getElement().element(by.className("xui-checkbox-input"));
    };

    public getLabel = () => {
        return super.getElement().element(by.className("xui-checkbox-label"));
    };

    public getContent = () => {
        const element = super.getElement().element(by.className("xui-checkbox-transclude"));
        return element.getText();
    };

    public getHelpHintText = () => {
        const element = super.getElement().element(by.className("xui-input-help"));
        return element.getText();
    };

    public getValidationText = () => {
        const element = super.getElement().element(by.className("xui-validation"));
        return element.getText();
    };

    public isInvalid = () => {
        return this.getInputElement().getAttribute("aria-invalid").then((value) => {
            return value === "true";
        });
    };

    public isIndeterminate = () => {
        return this.getInputElement().getAttribute("indeterminate").then((value) => {
            return value === "true";
        });
    };

    public isRequired = () => {
        return this.getInputElement().getAttribute("required").then((value) => {
            return value === "true";
        });
    };

    public isChecked = () => {
        const cbInput = this.getInputElement();
        return cbInput.getAttribute("checked").then((value) => {
            return value === "true";
        });
    };

    public isDisabled = () => {
        return this.getInputElement().isEnabled().then((value) => {
            return !value;
        });
    };

    public click = () => {
        return this.getMark().click();
    };

    private getMark(): ElementFinder {
        return this.getElement().element(by.className("xui-checkbox-mark"));
    }
}
