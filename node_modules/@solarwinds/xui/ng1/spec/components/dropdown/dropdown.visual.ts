import {browser, by, promise} from "@solarwinds/uzi/protractor";
import Helpers from "../helpers";
import {Atom} from "@solarwinds/uzi";
import {DropdownAtom} from "../index.atom";
import {Eyes} from "eyes.protractor";

describe("Xui e2e page", function () {
    let eyes: Eyes;
    let ddBasic = Atom.find(DropdownAtom, "dropdownBasic");
    beforeAll(() => {
        eyes = Helpers.prepareEyes();
        Helpers.prepareBrowser("dropdown");
    });

    it("for dropdown", function () {
        eyes.open(browser, "XUI", "Dropdown");
        eyes.checkWindow("Default");
        // element.getWebDriver() sometimes throws an error when we use it in mouseMove method
        browser.actions()
            .mouseMove(browser.driver.findElement(by.xpath("//*[@id='dropdownBasic']/div[1]/div/button")))
            .perform();
        eyes.checkWindow("Mouseover");
        ddBasic.click();
        eyes.checkWindow("Opened");
        browser.actions()
            .mouseMove(browser.driver.findElement(
                by.xpath("//*[@id='dropdownBasic']/div[1]/div/ul/li[3]/div/ng-include/div")))
            .perform();
        eyes.checkWindow("Focused");
        browser.driver.findElement(by.xpath("//*[@id='dropdownBasic']/div[1]/div/ul/li[3]/div/ng-include/div")).click();
        eyes.checkWindow("Choosen item");
        eyes.close();
    }, 60000);
});
