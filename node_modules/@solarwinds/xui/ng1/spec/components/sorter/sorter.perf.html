<div class="xui" ng-controller="PerfSorterController as vm">
    <xui-sorter id="xuiSorterElement"
                caption="xui-sorter with several fields"
                selected-item="vm.selectedItem"
                items-source="vm.items"
                display-value="{{::vm.displayValue}}"
                sort-direction="vm.direction"
                on-change="vm.onChange(newValue, oldValue)">
    </xui-sorter>
    <div>Sort by: {{vm.selectedItem[vm.displayValue]}}, Direction: {{vm.direction}}</div>
    <xui-divider></xui-divider>
    <xui-listview stripe="true"
                  items-source="vm.table"
                  header-template-url="demo-listview-header-template"
                  template-url="demo-listview-template">
    </xui-listview>
</div>

<script>
    (function () {
        "use strict";

        Xui.controller("PerfSorterController", PerfSorterController, ["$scope", "$templateCache", "perfService"]);

        function PerfSorterController($scope, $templateCache, perfService) {

            var vm = this;

            vm.displayValue = "value";
            vm.direction = "asc";
            vm.items = [{name: "animal", value: "Animals"}];
            vm.table = [
                {animal: "Kangaroo", stone: "Quartz", fruit: "Kiwi"},
                {animal: "Bonobo", stone: "Slate", fruit: "Banana"},
                {animal: "Ape", stone: "Diamond", fruit: "Blueberry"},
                {animal: "Zebra", stone: "Granite", fruit: "Orange"},
                {animal: "Chimp", stone: "Marble", fruit: "Cherry"},
                {animal: "Whale", stone: "Limestone", fruit: "Pineapple"}
            ];
            vm.selectedItem = vm.items[0];

            vm.onChange = function (newValue, oldValue) {
                vm.table = _.orderBy(vm.table, [newValue.sortBy.name], [newValue.direction]);
            };

            $templateCache.put("demo-listview-header-template",
                "<div class='row'>" +
                "<div class='col-xs-4' style='padding:0px 0px 20px 30px; font-weight:bold;'>Animals</div>" +
                "<div class='col-xs-4' style='padding:0px 0px 20px 15px; font-weight:bold;'>Stone</div>" +
                "<div class='col-xs-4' style='padding:0px 0px 20px 15px; font-weight:bold;'>Fruit</div>" +
                "</div>");

            $templateCache.put("demo-listview-template",
                "<div class='row'>" +
                "<div class='col-xs-4'>{{item.animal}}</div>" +
                "<div class='col-xs-4'>{{item.stone}}</div>" +
                "<div class='col-xs-4'>{{item.fruit}}</div>" +
                "</div>");

            //register custom user metrics
            perfService.registerMetrics(["watchersCount", "digestLoop", "pageLoad"], $scope);

        }
    })();
</script>

