<div id="treeview" class="xui" ng-controller="PerfTreeviewController as vm">
    <xui-treeview model="vm.model" options="vm.options" context="vm.context">
        {{::node.$model.label}}
    </xui-treeview>
    <div id="reverseBtn">
        <xui-button ng-click="vm.reverse()">Reverse root</xui-button>
    </div>
</div>

<script type="text/javascript">
    Xui.controller('PerfTreeviewController', PerfTreeviewController, ["$scope", "perfService"]);

    function PerfTreeviewController($scope, perfService) {

        var vm = this;

        vm.context = {};
        vm.options = {
            selectionMode: "multi"
        };
        vm.model = [];

        vm.reverse = function () {
            vm.model.reverse();
        };

        function generateTree(children, count, depth, callbackFn, childrenName) {
            childrenName = childrenName || 'children';
            if (depth <= 0) {
                return;
            }
            for (var i = 0; i < count; i++) {
                var node = {label: 'Node' + (i + 1), id: 'id_' + i};
                if (depth > 1) {
                    node[childrenName] = [];
                }
                if (callbackFn) {
                    callbackFn(node);
                }
                children.push(node);
                generateTree(node[childrenName], count, depth - 1, callbackFn, childrenName);
            }
        }

        generateTree(vm.model, 10, 4);

        perfService.registerMetrics(["watchersCount", "digestLoop", "pageLoad"], $scope);

    }
</script>
