import * as protractor from "@solarwinds/uzi/protractor";
import {browser, by, promise} from "@solarwinds/uzi/protractor";
import {Atom} from "@solarwinds/uzi";

export class XuiAtom extends Atom {
    public static CSS_CLASS = "N/A";

    public scrollIntoView(): promise.Promise<any> {
        let container = super.getElement().element(by.xpath( ".//ancestor::*[@xui-scrollbar]"));
        return container.isPresent().then((isPresent) => {
            if (isPresent) {
                return protractor.promise.all([container.getLocation(), super.getElement().getLocation()])
                    .then((results) => {
                    return browser.executeScript(
                        `arguments[0].scrollTop += arguments[2].y - arguments[1].y;
                            arguments[0].scrollLeft += arguments[2].x - arguments[1].x;`,
                        container.getWebElement(), ...results);
                });
            } else {
                return browser.executeScript(() => arguments[0].scrollIntoView(false),
                    super.getElement().getWebElement());
            }
        });
    };
}
