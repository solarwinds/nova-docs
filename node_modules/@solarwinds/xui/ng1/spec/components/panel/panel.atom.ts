import {by, promise, ElementFinder} from "@solarwinds/uzi/protractor";
import {Atom} from "@solarwinds/uzi";

export class PanelAtom extends Atom {
    public static CSS_CLASS = "xui-panel";
    public static COLLAPSED_CSS = "xui-is-collapsed";
    public static EXPANDED_ICON_CSS = "xui-icon-double-caret-left";
    public static COLLAPSED_ICON_CSS = "xui-icon-double-caret-right";
    public static ICON_CSS = "xui-panel__heading-icon";

    public toggleButton = (): ElementFinder => {
        return super.getElement().element(by.className("xui-panel__heading-btn"));
    };

    public icon = (): ElementFinder => {
        return super.getElement().element(by.className("xui-panel__heading-icon"));
    };

    public getHeaderIconCounter = (state: string): promise.Promise<string> => {
        const selector = `${PanelAtom.ICON_CSS}--${state}`;
        const headerIconElement = super.getElement().element(by.className(selector));

        return headerIconElement.getAttribute("counter");
    };

    public isCollapsed = () => {
        return super.hasClass(PanelAtom.COLLAPSED_CSS);
    };

    public isExpanded = () => {
        return super.hasClass(PanelAtom.COLLAPSED_CSS).then((value: boolean) => {
            return !value;
        });
    };

    public iconShowsCollapsed = () => {
        return Atom.hasClass(this.icon(), PanelAtom.COLLAPSED_ICON_CSS);
    };

    public iconShowsExpanded = () => {
        return Atom.hasClass(this.icon(), PanelAtom.EXPANDED_ICON_CSS);
    };

    public headingText = () => {
        return super.getElement().element(by.css(".xui-panel__heading-content h4")).getText();
    };
}
