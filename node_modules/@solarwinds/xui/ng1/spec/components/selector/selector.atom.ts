import {by, promise, ElementFinder} from "@solarwinds/uzi/protractor";
import {Atom} from "@solarwinds/uzi";
import {WebElementPromise} from "@solarwinds/uzi/webdriver";

export class SelectorAtom extends Atom {
    public static CSS_CLASS = "xui-selector";

    public getCheckboxElement = (): ElementFinder => {
        return super.getElement().element(by.className("xui-checkbox-input"));
    };

    public getCheckboxButton = (): ElementFinder => {
        return super.getElement().element(by.className("xui-selector__action"));
    };

    public getDropdownButton = (): ElementFinder => {
        return super.getElement().element(by.className("xui-selector__toggle"));
    };

    public clickOnDropdownItem = (index: number) => {
        this.getDropdownButton().click();
        this.getElementFromListByIndex(index).click();
    };

    public isChecked = () => {
        const cbInput = this.getCheckboxElement();
        return cbInput.getAttribute("checked").then((value) => {
            return value === "true";
        });
    };

    public isIndeterminate = () => {
        return this.getCheckboxElement().getAttribute("indeterminate").then((value) => {
            return value === "true";
        });
    };

    public getElementsList() {
        return super.getElement().element(by.className("xui-selector__menu")).getWebElement();
    }

    public getElementFromListByIndex(index: number): WebElementPromise {
        return super.getElement().all(by.className("xui-selector__menuitem"))
            .get(index).getWebElement();
    }
}
