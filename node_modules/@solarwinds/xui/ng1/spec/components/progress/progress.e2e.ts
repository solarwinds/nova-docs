import { by, element, promise } from "@solarwinds/uzi/protractor";
import { ProgressAtom } from "../index.atom";
import { Atom } from "@solarwinds/uzi";
import Helpers from "../helpers";

describe("USERCONTROL progress", () => {
    let atom: ProgressAtom;

    beforeEach(() => {
        Helpers.prepareBrowser("progress");
        atom = Atom.findIn(ProgressAtom, undefined, 0);
        element(by.className("xui-demo-start-progress-btn")).click();
    });

    it("bar should have value greater than 0", () => {
        expect(atom.getWidth()).toBeGreaterThan(0);
    });

    it("should show cancel button when allow-cancel is true and hide when false", () => {
        const thickAtom = Atom.findIn(ProgressAtom, undefined, 0);
        expect(thickAtom.canCancel()).toBe(true);
        const thinAtom = Atom.findIn(ProgressAtom, undefined, 1);
        expect(thinAtom.canCancel()).toBe(false);
    });

    it("should handle onCancel() callback", () => {
        atom.cancelProgress();
        expect(element(by.className("cancel-clicked")).isPresent()).toBe(true);
    });

    it("thin mode should be thin", () => {
        const thickAtom = Atom.findIn(ProgressAtom, undefined, 0);
        expect(thickAtom.getActualHeight()).toBeGreaterThan(50);
        const thinAtom = Atom.findIn(ProgressAtom, undefined, 1);
        expect(thinAtom.getActualHeight()).toBeLessThan(30);
    });    
});
