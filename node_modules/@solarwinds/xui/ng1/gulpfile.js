/***********************************************************************************
 *  ANGULAR 1 gulpfile
 ***********************************************************************************/

"use strict";

const gulp = require("gulp");

const template = require("@solarwinds/buildmeister/templates/library-with-demo");

// --- buildmeister stuff ---
const config = template(gulp, {
    name: "xui",
    libraryName: "Xui",
    resources: require("./config/resources.json")
});

config.addHook("install:finished", "dist:icons");
config.addHook("clean:finished", "clean:root-dist");
config.addHook("clean:finished", "copy:runtime-scripts");
config.addHook("dist:finished", "dist:resources");
config.addHook("dist:finished", "ngdocs:fonts");
config.addHook("dist:finished", "dist:icons");
config.addHook("assemble:finished", "dist:copy-to-root");
config.addHook("ngdocs:finished", "ngdocs:replace");
config.addHook("ngdocs:finished", "dist:data");
config.addHook("ngdocs:finished", "synchronize-colors");

// this runtime.js contains angular-mocks, so it cannot be used via runtimeScripts
// (it would load angular-mocks before Angular)
config.features.karma.filesEnd = ["sdk/runtime/js/runtime.js"];

config.features.ngdocs = require("./config/ngdocs.json");
config.features.e2e = true;
config.features.visual = true;
config.features.perf = true;
config.features.browserSync = {
    server: {
        baseDir: "."
    },
    startPath: "/demo/index.html",
    port: 8282
};
config.features.concatSvg = {
    iconDirectory : "../images/icons",
    outputFile: "../data/icons.json",
    configuration:{
        "busy": {
            name: "busy-cube",
            cssAmendments:"xui-spinner xui-spinner-20",
            cat_namespace: "no-coloring"
        },
        "child-health-status": {
            cat_namespace: "status_",
            files:{
                }
        },
        "command":{
            omitNamepaceInName:true,
            brushType: "filled",
            files:{
            }
        },
        "health-status":{
            cat_namespace: "status_",
            files:{
                "shutdown.svg" : {
                    name: "status_notrunning"
                }
            }
        },
        "object":{
            omitNamepaceInName:true,
            brushType: "filled",
            files:{
                }
        },
        "tab": {
            omitNamepaceInName: true,
            cat_namespace: null,
            brushType: "filled",
            files: {
                }
        }
    }
};

require("@solarwinds/buildmeister").tasks(gulp, config);

// --- additional gulp tasks ---
require("./config/gulp/dist");
require("./config/gulp/runtime");
require("./config/gulp/ngdocs");
require("./config/gulp/clean");
require("./config/gulp/synchronize-colors");
require("./config/gulp/icons");
