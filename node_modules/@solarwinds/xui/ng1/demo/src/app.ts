"use strict";
const demoContent = require("./content");

angular.module("xui.demo", ["xui", "ui.router", "ui.router.state.events"])
    .config(function ($stateProvider: ng.ui.IStateProvider, $urlRouterProvider: ng.ui.IUrlRouterProvider,
                      $locationProvider: ng.ILocationProvider, xuiDemoConfig:any) {
        if (!xuiDemoConfig.nested) {
            $locationProvider.html5Mode(false).hashPrefix("");
            $urlRouterProvider.otherwise("/");
        }
        // generate routes from config
        _.each(demoContent, function (item:any) {
            if (item.template) {
                // remove <link /> to external resources
                const $template = $(`<div>${item.template}</div>`);
                $("link", $template).remove();
                item.template = $template.get(0).outerHTML;
            }
            const stateConfig: angular.ui.IState = angular.copy(item);
            if (xuiDemoConfig.parentState) {
                stateConfig.parent = xuiDemoConfig.parentState;
            }
            $stateProvider.state(item.id, stateConfig);
        });
    });
