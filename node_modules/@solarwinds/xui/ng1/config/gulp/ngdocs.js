"use strict";

const gulp = require("gulp");
const $ = require("@solarwinds/buildmeister/gulp-load-plugins")(gulp);

const getUrls = function () {
    const result = {};
    if (process.env.BUILD_CI) {
        const server = process.env.SERVER_URL || "http://qa-brfitnen-apl-01.swdev.local";
        result.css = {
            xui: server + "/css/xui.css"
        };
    } else {
        const localhost = "http://localhost:8282";
        result.css = {
            xui: localhost + "/dist/css/xui.css"
        };
    }
    return result;
};

/**
 * Replace paths in ng-docs files
 */
gulp.task("ngdocs:replace", function () {
    const urls = getUrls();

    return gulp.src("sdk/api-docs/partials/**/*.html",
        {base: "sdk/api-docs/partials/"})
        .pipe($.replace("_xui-css-url_", urls.css.xui))
        .pipe(gulp.dest("sdk/api-docs/partials/"));
});

gulp.task("ngdocs:fonts", function () {
    return gulp.src("src/fonts/*").pipe(gulp.dest("sdk/api-docs/fonts"));
});
